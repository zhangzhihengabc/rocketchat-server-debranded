)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/apps/RealAppsEngineUIHost.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { AppsEngineUIHost } from '@rocket.chat/apps-engine/client/AppsEngineUIHost';\nimport { Meteor } from 'meteor/meteor';\n\nimport { ChatRoom } from '../../../app/models/client';\nimport { getUserAvatarURL } from '../../../app/utils/client/getUserAvatarURL';\nimport { sdk } from '../../../app/utils/client/lib/SDKClient';\nimport { RoomManager } from '../../../client/lib/RoomManager';\nimport { baseURI } from '../../../client/lib/baseURI';\n\nexport class RealAppsEngineUIHost extends AppsEngineUIHost {\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis._baseURL = baseURI.replace(/\\/$/, '');\n\t}\n\n\tgetUserAvatarUrl(username) {\n\t\tconst avatarUrl = getUserAvatarURL(username);\n\n\t\tif (!avatarUrl.startsWith('http') && !avatarUrl.startsWith('data')) {\n\t\t\treturn `${this._baseURL}${avatarUrl}`;\n\t\t}\n\n\t\treturn avatarUrl;\n\t}\n\n\tasync getClientRoomInfo() {\n\t\tconst { name: slugifiedName, _id: id } = ChatRoom.findOne(RoomManager.opened);\n\n\t\tlet cachedMembers = [];\n\t\ttry {\n\t\t\tconst { members } = await sdk.rest.get('/v1/groups.members', { roomId: id });\n\n\t\t\tcachedMembers = members.map(({ _id, username }) => ({\n\t\t\t\tid: _id,\n\t\t\t\tusername,\n\t\t\t\tavatarUrl: this.getUserAvatarUrl(username),\n\t\t\t}));\n\t\t} catch (error) {\n\t\t\tconsole.warn(error);\n\t\t}\n\n\t\treturn {\n\t\t\tid,\n\t\t\tslugifiedName,\n\t\t\tmembers: cachedMembers,\n\t\t};\n\t}\n\n\tasync getClientUserInfo() {\n\t\tconst { username, _id } = Meteor.user();\n\n\t\treturn {\n\t\t\tid: _id,\n\t\t\tusername,\n\t\t\tavatarUrl: this.getUserAvatarUrl(username) || '',\n\t\t};\n\t}\n}\n",null],"names":["module","link","default","v","_regeneratorRuntime","_inheritsLoose","export","RealAppsEngineUIHost","AppsEngineUIHost","Meteor","ChatRoom","getUserAvatarURL","sdk","RoomManager","baseURI","_AppsEngineUIHost","_this","call","_baseURL","replace","_proto","prototype","getUserAvatarUrl","username","avatarUrl","startsWith","getClientRoomInfo","_ChatRoom$findOne","slugifiedName","id","cachedMembers","_this2","async","_context","prev","next","findOne","opened","name","_id","awrap","rest","get","roomId","members","_await$sdk$rest$get","sent","map","_ref","t0","console","warn","abrupt","stop","Promise","getClientUserInfo","_Meteor$user","_context2","user"],"mappings":"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"}