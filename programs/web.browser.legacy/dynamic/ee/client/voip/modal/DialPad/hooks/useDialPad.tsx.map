)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/voip/modal/DialPad/hooks/useDialPad.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ChangeEvent, RefCallback } from 'react';\nimport { useCallback, useEffect, useState } from 'react';\nimport { useForm } from 'react-hook-form';\n\nimport { useDialModal } from '../../../../../../client/hooks/useDialModal';\nimport { useOutboundDialer } from '../../../../hooks/useOutboundDialer';\nimport type { PadDigit } from '../Pad';\n\ntype DialPadStateHandlers = {\n\tinputName: string;\n\tinputRef: RefCallback<HTMLInputElement>;\n\tinputError: string | undefined;\n\tisButtonDisabled: boolean;\n\thandleOnChange: (e: ChangeEvent<HTMLInputElement>) => void;\n\thandleBackspaceClick: () => void;\n\thandlePadButtonClick: (digit: PadDigit[0]) => void;\n\thandlePadButtonLongPressed: (digit: PadDigit[1]) => void;\n\thandleCallButtonClick: () => void;\n};\n\ntype DialPadProps = {\n\tinitialValue?: string;\n\tinitialErrorMessage?: string;\n};\n\nexport const useDialPad = ({ initialValue, initialErrorMessage }: DialPadProps): DialPadStateHandlers => {\n\tconst t = useTranslation();\n\tconst outboundClient = useOutboundDialer();\n\tconst { closeDialModal } = useDialModal();\n\n\tconst {\n\t\tsetFocus,\n\t\tregister,\n\t\tsetValue,\n\t\tsetError,\n\t\tclearErrors,\n\t\twatch,\n\t\tformState: { errors, isDirty },\n\t} = useForm<{ PhoneInput: string }>({\n\t\tdefaultValues: {\n\t\t\tPhoneInput: initialValue || '',\n\t\t},\n\t});\n\n\tconst { ref, onChange } = register('PhoneInput');\n\n\tconst value = watch('PhoneInput');\n\n\tconst [disabled, setDisabled] = useState(true);\n\n\tconst handleBackspaceClick = useCallback((): void => {\n\t\tclearErrors();\n\t\tsetValue('PhoneInput', value.slice(0, -1), { shouldDirty: true });\n\t}, [clearErrors, setValue, value]);\n\n\tconst handlePadButtonClick = useCallback(\n\t\t(digit: PadDigit[0]): void => {\n\t\t\tclearErrors();\n\n\t\t\tsetValue('PhoneInput', value + digit, { shouldDirty: true });\n\t\t},\n\t\t[clearErrors, setValue, value],\n\t);\n\n\tconst handlePadButtonLongPressed = useCallback(\n\t\t(digit: PadDigit[1]): void => {\n\t\t\tif (digit !== '+') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsetValue('PhoneInput', value + digit);\n\t\t},\n\t\t[setValue, value],\n\t);\n\n\tconst handleCallButtonClick = useCallback((): void => {\n\t\tif (!outboundClient) {\n\t\t\treturn setError('PhoneInput', { message: t('Something_went_wrong_try_again_later') });\n\t\t}\n\n\t\toutboundClient.makeCall(value);\n\t\tcloseDialModal();\n\t}, [outboundClient, setError, t, value, closeDialModal]);\n\n\tconst handleOnChange = useCallback((e) => onChange(e), [onChange]);\n\n\tuseEffect(() => {\n\t\tsetDisabled(!value);\n\t}, [value]);\n\n\tuseEffect(() => {\n\t\tsetFocus('PhoneInput');\n\t}, [setFocus]);\n\n\treturn {\n\t\tinputName: 'PhoneInput',\n\t\tinputRef: ref,\n\t\tinputError: isDirty ? errors.PhoneInput?.message : initialErrorMessage,\n\t\tisButtonDisabled: disabled,\n\t\thandleOnChange,\n\t\thandleBackspaceClick,\n\t\thandlePadButtonClick,\n\t\thandlePadButtonLongPressed,\n\t\thandleCallButtonClick,\n\t};\n};\n",null],"names":["module","link","default","_slicedToArray","export","useDialPad","useTranslation","useCallback","useEffect","useState","useForm","useDialModal","useOutboundDialer","_ref","_errors$PhoneInput","initialValue","initialErrorMessage","t","outboundClient","closeDialModal","_useDialModal","_useForm","defaultValues","PhoneInput","setFocus","register","setValue","setError","clearErrors","watch","_useForm$formState","formState","errors","isDirty","_register","ref","onChange","value","_useState2","disabled","setDisabled","handleBackspaceClick","slice","shouldDirty","handlePadButtonClick","digit","handlePadButtonLongPressed","handleCallButtonClick","message","makeCall","handleOnChange","e","inputName","inputRef","inputError","isButtonDisabled"],"mappings":"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"}