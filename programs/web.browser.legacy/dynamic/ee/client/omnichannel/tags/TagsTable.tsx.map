)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/tags/TagsTable.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { IconButton, Pagination } from '@rocket.chat/fuselage';\nimport { useDebouncedValue, useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation, useEndpoint, useRouter } from '@rocket.chat/ui-contexts';\nimport { useQuery, hashQueryKey } from '@tanstack/react-query';\nimport React, { useMemo, useState } from 'react';\n\nimport FilterByText from '../../../../client/components/FilterByText';\nimport GenericNoResults from '../../../../client/components/GenericNoResults';\nimport {\n\tGenericTable,\n\tGenericTableRow,\n\tGenericTableCell,\n\tGenericTableHeader,\n\tGenericTableHeaderCell,\n\tGenericTableBody,\n\tGenericTableLoadingRow,\n} from '../../../../client/components/GenericTable';\nimport { usePagination } from '../../../../client/components/GenericTable/hooks/usePagination';\nimport { useSort } from '../../../../client/components/GenericTable/hooks/useSort';\nimport { useRemoveTag } from './useRemoveTag';\n\nconst TagsTable = () => {\n\tconst t = useTranslation();\n\tconst [filter, setFilter] = useState('');\n\tconst debouncedFilter = useDebouncedValue(filter, 500);\n\tconst router = useRouter();\n\n\tconst { current, itemsPerPage, setItemsPerPage: onSetItemsPerPage, setCurrent: onSetCurrent, ...paginationProps } = usePagination();\n\tconst { sortBy, sortDirection, setSort } = useSort<'name' | 'description'>('name');\n\n\tconst onRowClick = useMutableCallback((id) => router.navigate(`/omnichannel/tags/edit/${id}`));\n\tconst handleAddNew = useMutableCallback(() => router.navigate('/omnichannel/tags/new'));\n\tconst handleDeleteTag = useRemoveTag();\n\n\tconst query = useMemo(\n\t\t() => ({\n\t\t\tviewAll: 'true' as const,\n\t\t\tfields: JSON.stringify({ name: 1 }),\n\t\t\ttext: debouncedFilter,\n\t\t\tsort: JSON.stringify({ [sortBy]: sortDirection === 'asc' ? 1 : -1 }),\n\t\t\t...(itemsPerPage && { count: itemsPerPage }),\n\t\t\t...(current && { offset: current }),\n\t\t}),\n\t\t[debouncedFilter, itemsPerPage, current, sortBy, sortDirection],\n\t);\n\n\tconst getTags = useEndpoint('GET', '/v1/livechat/tags');\n\tconst { data, isSuccess, isLoading } = useQuery(['livechat-tags', query], async () => getTags(query), { refetchOnWindowFocus: false });\n\n\tconst [defaultQuery] = useState(hashQueryKey([query]));\n\tconst queryHasChanged = defaultQuery !== hashQueryKey([query]);\n\n\tconst headers = (\n\t\t<>\n\t\t\t<GenericTableHeaderCell key='name' direction={sortDirection} active={sortBy === 'name'} onClick={setSort} sort='name'>\n\t\t\t\t{t('Name')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell\n\t\t\t\tkey='description'\n\t\t\t\tdirection={sortDirection}\n\t\t\t\tactive={sortBy === 'description'}\n\t\t\t\tonClick={setSort}\n\t\t\t\tsort='description'\n\t\t\t>\n\t\t\t\t{t('Description')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell key='remove' w='x60' />\n\t\t</>\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t{((isSuccess && data?.tags.length > 0) || queryHasChanged) && <FilterByText onChange={({ text }): void => setFilter(text)} />}\n\t\t\t{isLoading && (\n\t\t\t\t<GenericTable>\n\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t<GenericTableLoadingRow cols={3} />\n\t\t\t\t\t</GenericTableBody>\n\t\t\t\t</GenericTable>\n\t\t\t)}\n\t\t\t{isSuccess && data?.tags.length === 0 && queryHasChanged && <GenericNoResults />}\n\t\t\t{isSuccess && data?.tags.length === 0 && !queryHasChanged && (\n\t\t\t\t<GenericNoResults\n\t\t\t\t\ticon='tag'\n\t\t\t\t\ttitle={t('No_tags_yet')}\n\t\t\t\t\tdescription={t('No_tags_yet_description')}\n\t\t\t\t\tbuttonTitle={t('Create_tag')}\n\t\t\t\t\tbuttonAction={handleAddNew}\n\t\t\t\t\tlinkHref='https://go.rocket.chat/omnichannel-docs'\n\t\t\t\t\tlinkText={t('Learn_more_about_tags')}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t{isSuccess && data?.tags.length > 0 && (\n\t\t\t\t<>\n\t\t\t\t\t<GenericTable>\n\t\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t\t{data?.tags.map(({ _id, name, description }) => (\n\t\t\t\t\t\t\t\t<GenericTableRow key={_id} tabIndex={0} role='link' onClick={() => onRowClick(_id)} action qa-user-id={_id}>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>{name}</GenericTableCell>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>{description}</GenericTableCell>\n\t\t\t\t\t\t\t\t\t<GenericTableCell>\n\t\t\t\t\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\t\t\t\t\ticon='trash'\n\t\t\t\t\t\t\t\t\t\t\tsmall\n\t\t\t\t\t\t\t\t\t\t\ttitle={t('Remove')}\n\t\t\t\t\t\t\t\t\t\t\tonClick={(e) => {\n\t\t\t\t\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\t\t\t\t\thandleDeleteTag(_id);\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</GenericTableCell>\n\t\t\t\t\t\t\t\t</GenericTableRow>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</GenericTableBody>\n\t\t\t\t\t</GenericTable>\n\t\t\t\t\t<Pagination\n\t\t\t\t\t\tdivider\n\t\t\t\t\t\tcurrent={current}\n\t\t\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\t\t\tcount={data?.total || 0}\n\t\t\t\t\t\tonSetItemsPerPage={onSetItemsPerPage}\n\t\t\t\t\t\tonSetCurrent={onSetCurrent}\n\t\t\t\t\t\t{...paginationProps}\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default TagsTable;\n",null],"names":["_regeneratorRuntime","_extends","_objectSpread","_objectWithoutProperties","_slicedToArray","IconButton","Pagination","useDebouncedValue","useMutableCallback","useTranslation","useEndpoint","useRouter","useQuery","hashQueryKey","React","useMemo","useState","FilterByText","GenericNoResults","GenericTable","GenericTableRow","GenericTableCell","GenericTableHeader","GenericTableHeaderCell","GenericTableBody","GenericTableLoadingRow","usePagination","useSort","useRemoveTag","module","link","default","v","exportDefault","t","_useState2","filter","setFilter","debouncedFilter","router","_usePagination","current","itemsPerPage","onSetItemsPerPage","setItemsPerPage","onSetCurrent","setCurrent","paginationProps","_excluded","_useSort","sortBy","sortDirection","setSort","onRowClick","id","navigate","handleAddNew","handleDeleteTag","query","_JSON$stringify","viewAll","fields","JSON","stringify","name","text","sort","count","offset","getTags","_useQuery","async","_context","prev","next","abrupt","stop","Promise","refetchOnWindowFocus","data","isSuccess","isLoading","queryHasChanged","defaultQuery","_useState4","headers","createElement","Fragment","key","direction","active","onClick","w","tags","length","onChange","_ref","cols","icon","title","description","buttonTitle","buttonAction","linkHref","linkText","map","_ref2","_id","tabIndex","role","action","withTruncatedText","small","e","stopPropagation","divider","total"],"mappings":"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"}