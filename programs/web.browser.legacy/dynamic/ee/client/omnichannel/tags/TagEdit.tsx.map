)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/tags/TagEdit.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { ILivechatDepartment, ILivechatTag, Serialized } from '@rocket.chat/core-typings';\nimport { Field, FieldLabel, FieldRow, FieldError, TextInput, Button, ButtonGroup, FieldGroup, Box } from '@rocket.chat/fuselage';\nimport { useMutableCallback, useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport { useToastMessageDispatch, useRouter, useMethod, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useQueryClient } from '@tanstack/react-query';\nimport React from 'react';\nimport { useForm, Controller } from 'react-hook-form';\n\nimport AutoCompleteDepartmentMultiple from '../../../../client/components/AutoCompleteDepartmentMultiple';\nimport {\n\tContextualbarScrollableContent,\n\tContextualbarFooter,\n\tContextualbarTitle,\n\tContextualbar,\n\tContextualbarHeader,\n\tContextualbarClose,\n} from '../../../../client/components/Contextualbar';\nimport { useRemoveTag } from './useRemoveTag';\n\ntype TagEditPayload = {\n\tname: string;\n\tdescription: string;\n\tdepartments: { label: string; value: string }[];\n};\n\ntype TagEditProps = {\n\ttagData?: ILivechatTag;\n\tcurrentDepartments?: Serialized<ILivechatDepartment>[];\n};\n\nconst TagEdit = ({ tagData, currentDepartments }: TagEditProps) => {\n\tconst t = useTranslation();\n\tconst router = useRouter();\n\tconst queryClient = useQueryClient();\n\tconst handleDeleteTag = useRemoveTag();\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst saveTag = useMethod('livechat:saveTag');\n\n\tconst { _id, name, description } = tagData || {};\n\n\tconst {\n\t\tcontrol,\n\t\tformState: { isDirty, errors },\n\t\thandleSubmit,\n\t} = useForm<TagEditPayload>({\n\t\tmode: 'onBlur',\n\t\tvalues: {\n\t\t\tname: name || '',\n\t\t\tdescription: description || '',\n\t\t\tdepartments: currentDepartments?.map((dep) => ({ label: dep.name, value: dep._id })) || [],\n\t\t},\n\t});\n\n\tconst handleSave = useMutableCallback(async ({ name, description, departments }: TagEditPayload) => {\n\t\tconst departmentsId = departments?.map((dep) => dep.value) || [''];\n\n\t\ttry {\n\t\t\tawait saveTag(_id as unknown as string, { name, description }, departmentsId);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\tqueryClient.invalidateQueries(['livechat-tags']);\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t} finally {\n\t\t\trouter.navigate('/omnichannel/tags');\n\t\t}\n\t});\n\n\tconst formId = useUniqueId();\n\tconst nameField = useUniqueId();\n\tconst descriptionField = useUniqueId();\n\tconst departmentsField = useUniqueId();\n\n\treturn (\n\t\t<Contextualbar>\n\t\t\t<ContextualbarHeader>\n\t\t\t\t<ContextualbarTitle>{_id ? t('Edit_Tag') : t('New_Tag')}</ContextualbarTitle>\n\t\t\t\t<ContextualbarClose onClick={() => router.navigate('/omnichannel/tags')}></ContextualbarClose>\n\t\t\t</ContextualbarHeader>\n\t\t\t<ContextualbarScrollableContent>\n\t\t\t\t<Box id={formId} is='form' autoComplete='off' onSubmit={handleSubmit(handleSave)}>\n\t\t\t\t\t<FieldGroup>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<FieldLabel htmlFor={nameField} required>\n\t\t\t\t\t\t\t\t{t('Name')}\n\t\t\t\t\t\t\t</FieldLabel>\n\t\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t\t<Controller\n\t\t\t\t\t\t\t\t\tname='name'\n\t\t\t\t\t\t\t\t\tcontrol={control}\n\t\t\t\t\t\t\t\t\trules={{ required: t('The_field_is_required', 'name') }}\n\t\t\t\t\t\t\t\t\trender={({ field }) => <TextInput {...field} error={errors?.name?.message} aria-describedby={`${nameField}-error`} />}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t\t{errors?.name && (\n\t\t\t\t\t\t\t\t<FieldError aria-live='assertive' id={`${nameField}-error`}>\n\t\t\t\t\t\t\t\t\t{errors?.name?.message}\n\t\t\t\t\t\t\t\t</FieldError>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<FieldLabel htmlFor={descriptionField}>{t('Description')}</FieldLabel>\n\t\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t\t<Controller name='description' control={control} render={({ field }) => <TextInput id={descriptionField} {...field} />} />\n\t\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<FieldLabel htmlFor={departmentsField}>{t('Departments')}</FieldLabel>\n\t\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t\t<Controller\n\t\t\t\t\t\t\t\t\tname='departments'\n\t\t\t\t\t\t\t\t\tcontrol={control}\n\t\t\t\t\t\t\t\t\trender={({ field: { onChange, value, onBlur } }) => (\n\t\t\t\t\t\t\t\t\t\t<AutoCompleteDepartmentMultiple id={departmentsField} onChange={onChange} value={value} onBlur={onBlur} showArchived />\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t</FieldGroup>\n\t\t\t\t</Box>\n\t\t\t</ContextualbarScrollableContent>\n\t\t\t<ContextualbarFooter>\n\t\t\t\t<ButtonGroup stretch>\n\t\t\t\t\t<Button onClick={() => router.navigate('/omnichannel/tags')}>{t('Cancel')}</Button>\n\t\t\t\t\t<Button form={formId} disabled={!isDirty} type='submit' primary>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t\t{_id && (\n\t\t\t\t\t<ButtonGroup stretch mbs={8}>\n\t\t\t\t\t\t<Button icon='trash' danger onClick={() => handleDeleteTag(_id)}>\n\t\t\t\t\t\t\t{t('Delete')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</ButtonGroup>\n\t\t\t\t)}\n\t\t\t</ContextualbarFooter>\n\t\t</Contextualbar>\n\t);\n};\n\nexport default TagEdit;\n",null],"names":["_extends","_regeneratorRuntime","Field","FieldLabel","FieldRow","FieldError","TextInput","Button","ButtonGroup","FieldGroup","Box","useMutableCallback","useUniqueId","useToastMessageDispatch","useRouter","useMethod","useTranslation","useQueryClient","React","useForm","Controller","AutoCompleteDepartmentMultiple","ContextualbarScrollableContent","ContextualbarFooter","ContextualbarTitle","Contextualbar","ContextualbarHeader","ContextualbarClose","useRemoveTag","module","link","default","v","exportDefault","_ref","_errors$name2","tagData","currentDepartments","t","router","queryClient","handleDeleteTag","dispatchToastMessage","saveTag","_ref2","_id","_useForm","mode","values","name","description","departments","map","dep","label","value","control","_useForm$formState","formState","isDirty","errors","handleSubmit","handleSave","_ref3","departmentsId","async","_context","prev","next","awrap","type","message","invalidateQueries","t0","navigate","finish","stop","Promise","formId","nameField","descriptionField","departmentsField","createElement","onClick","id","is","autoComplete","onSubmit","htmlFor","required","rules","render","_ref4","_errors$name","field","error","_ref5","_ref6","_ref6$field","onChange","onBlur","showArchived","stretch","form","disabled","primary","mbs","icon","danger"],"mappings":"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"}