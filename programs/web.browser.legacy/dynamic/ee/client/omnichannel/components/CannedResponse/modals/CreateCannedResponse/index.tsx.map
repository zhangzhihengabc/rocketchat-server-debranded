)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/components/CannedResponse/modals/CreateCannedResponse/index.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useSetModal, useToastMessageDispatch, usePermission, useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { FC } from 'react';\nimport React, { memo, useCallback, useEffect, useMemo, useState } from 'react';\n\nimport { useForm } from '../../../../../../../client/hooks/useForm';\nimport CreateCannedResponseModal from './CreateCannedResponseModal';\n\nconst WrapCreateCannedResponseModal: FC<{ data?: any; reloadCannedList?: any }> = ({ data, reloadCannedList }) => {\n\tconst t = useTranslation();\n\tconst closeModal = useSetModal();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst saveCannedResponse = useEndpoint('POST', '/v1/canned-responses');\n\n\tconst hasManagerPermission = usePermission('view-all-canned-responses');\n\tconst hasMonitorPermission = usePermission('save-department-canned-responses');\n\n\tconst form = useForm({\n\t\t_id: data ? data._id : '',\n\t\tshortcut: data ? data.shortcut : '',\n\t\ttext: data ? data.text : '',\n\t\ttags: data?.tags && Array.isArray(data.tags) ? data.tags.map((tag: string) => ({ label: tag, value: tag })) : [],\n\t\tscope: data ? data.scope : 'user',\n\t\tdepartmentId: data?.departmentId ? data.departmentId : '',\n\t});\n\n\tconst { values, handlers, hasUnsavedChanges } = form;\n\n\tconst [errors, setErrors] = useState<any>({});\n\tconst [radioDescription, setRadioDescription] = useState<string>(t('Canned_Response_Sharing_Private_Description'));\n\tconst [preview, setPreview] = useState(false);\n\n\tconst listErrors = useMemo(() => {\n\t\tconst empty: any = {};\n\n\t\tfor (const [key, value] of Object.entries(values)) {\n\t\t\tif (['shortcut', 'text'].includes(key) && !value) {\n\t\t\t\tempty[key] = t('Field_required');\n\t\t\t}\n\t\t}\n\n\t\tif (values.scope === 'department' && !values.departmentId) {\n\t\t\tempty.departmentId = t('Field_required');\n\t\t}\n\n\t\treturn empty;\n\t}, [t, values]);\n\n\tuseEffect(() => {\n\t\tsetErrors(listErrors);\n\t}, [values.shortcut, values.text, values.departmentId, listErrors]);\n\n\tconst radioHandlers = {\n\t\tsetPublic: (): void => {\n\t\t\thandlers.handleScope('global');\n\t\t\thandlers.handleDepartmentId('');\n\t\t\tsetRadioDescription(t('Canned_Response_Sharing_Public_Description'));\n\t\t},\n\t\tsetDepartment: (): void => {\n\t\t\thandlers.handleScope('department');\n\t\t\tsetRadioDescription(t('Canned_Response_Sharing_Department_Description'));\n\t\t},\n\t\tsetPrivate: (): void => {\n\t\t\thandlers.handleScope('user');\n\t\t\thandlers.handleDepartmentId('');\n\t\t\tsetRadioDescription(t('Canned_Response_Sharing_Private_Description'));\n\t\t},\n\t};\n\n\tconst onSave = useCallback(async (): Promise<void> => {\n\t\ttry {\n\t\t\tconst { _id, shortcut, text, scope, tags, departmentId } = values as {\n\t\t\t\t_id: string;\n\t\t\t\tshortcut: string;\n\t\t\t\ttext: string;\n\t\t\t\tscope: string;\n\t\t\t\ttags: any;\n\t\t\t\tdepartmentId: string;\n\t\t\t};\n\t\t\tawait saveCannedResponse({\n\t\t\t\t...(_id && { _id }),\n\t\t\t\tshortcut,\n\t\t\t\ttext,\n\t\t\t\tscope,\n\t\t\t\ttags,\n\t\t\t\t...(departmentId && { departmentId }),\n\t\t\t});\n\t\t\tdispatchToastMessage({\n\t\t\t\ttype: 'success',\n\t\t\t\tmessage: t(_id ? 'Canned_Response_Updated' : 'Canned_Response_Created'),\n\t\t\t});\n\t\t\tcloseModal(null);\n\t\t\treloadCannedList?.();\n\t\t} catch (error: unknown) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t}, [values, saveCannedResponse, dispatchToastMessage, t, closeModal, reloadCannedList]);\n\n\tconst onPreview = (): void => {\n\t\tsetPreview(!preview);\n\t};\n\n\treturn (\n\t\t<CreateCannedResponseModal\n\t\t\tisManager={hasManagerPermission}\n\t\t\tisMonitor={hasMonitorPermission}\n\t\t\tvalues={values}\n\t\t\thandlers={handlers}\n\t\t\terrors={errors}\n\t\t\thasUnsavedChanges={hasUnsavedChanges}\n\t\t\tradioHandlers={radioHandlers}\n\t\t\tradioDescription={radioDescription}\n\t\t\tonClose={closeModal}\n\t\t\tonSave={onSave}\n\t\t\tonPreview={onPreview}\n\t\t\tpreviewState={preview}\n\t\t/>\n\t);\n};\n\nexport default memo(WrapCreateCannedResponseModal);\n",null],"names":["_regeneratorRuntime","_objectSpread","_slicedToArray","useSetModal","useToastMessageDispatch","usePermission","useEndpoint","useTranslation","React","memo","useCallback","useEffect","useMemo","useState","useForm","CreateCannedResponseModal","module","default","v","exportDefault","_ref","data","reloadCannedList","t","closeModal","dispatchToastMessage","saveCannedResponse","hasManagerPermission","hasMonitorPermission","form","_id","shortcut","text","tags","Array","isArray","map","tag","label","value","scope","departmentId","values","handlers","hasUnsavedChanges","_useState2","errors","setErrors","_useState4","radioDescription","setRadioDescription","_useState6","preview","setPreview","listErrors","empty","_i","_Object$entries","Object","entries","length","_ref3","key","includes","onSave","async","_context","prev","next","awrap","type","message","t0","stop","Promise","createElement","isManager","isMonitor","radioHandlers","setPublic","handleScope","handleDepartmentId","setDepartment","setPrivate","onClose","onPreview","previewState"],"mappings":"uBAOA,IAPAA,EAAiGC,EAA2BC,EAA5HC,EAASC,EAAaC,EAAyBC,EAAeC,EAA8DC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAtGC,EAAAA,IAAAA,CAAAA,6BAAwC,CAAAC,QAAW,SAAEC,CAAAA,EAAAlB,EAAsBkB,CAAA,CAAA,EAAA,GAA2BF,EAAAA,IAAAA,CAAAA,uCAAAA,CAAAC,QAAAA,SAAAA,CAAAA,EAAAhB,EAAAA,CAAA,CAAA,EAAA,GAAAe,EAAAA,IAAAA,CAAAA,uCAAAA,CAAAC,QAAAA,SAAAA,CAAAA,EAAAf,EAAAA,CAAA,CAAA,EAAA,GAAjDc,EAAAA,IAAgB,CAAA,2BAAM,CAAAb,YAA2B,SAAAe,CAAA,EAAAf,EAAAA,CAAA,EAAAC,wBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,cAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAS,EAAAA,IAAAA,CAAAA,QAAAA,CAAA,QAAA,SAAAE,CAAA,EAAAV,EAAAA,CAAA,EAAAC,KAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,UAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,QAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,SAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,4CAAAA,CAAAF,QAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,8BAAAA,CAAA,QAAA,SAAAE,CAAA,EAAAH,EAAAA,CAAA,CAAA,EAAA,GAA5HC,EAAOG,aAAa,CAwHLV,EAjHmE,SAAAW,CAAA,EAA+B,IAA5BC,EAAID,EAAJC,IAAI,CAAEC,EAAgBF,EAAhBE,gBAAgB,CACpGC,EAAIhB,IACJiB,EAAarB,IACbsB,EAAuBrB,IAEvBsB,EAAqBpB,EAAY,OAAQ,wBAEzCqB,EAAuBtB,EAAc,6BACrCuB,EAAuBvB,EAAc,oCAErCwB,EAAOf,EAAQ,CACpBgB,IAAKT,EAAOA,EAAKS,GAAG,CAAG,GACvBC,SAAUV,EAAOA,EAAKU,QAAQ,CAAG,GACjCC,KAAMX,EAAOA,EAAKW,IAAI,CAAG,GACzBC,KAAMZ,MAAAA,GAAAA,EAAMY,IAAI,EAAIC,MAAMC,OAAO,CAACd,EAAKY,IAAI,EAAIZ,EAAKY,IAAI,CAACG,GAAG,CAAC,SAACC,CAAW,EAAA,MAAM,CAAEC,MAAOD,EAAKE,MAAOF,CAAG,CAAE,GAAK,EAAE,CAChHG,MAAOnB,EAAOA,EAAKmB,KAAK,CAAG,OAC3BC,aAAcpB,MAAAA,GAAAA,EAAMoB,YAAY,CAAGpB,EAAKoB,YAAY,CAAG,KAGhDC,EAAwCb,EAAxCa,MAAM,CAAEC,EAAgCd,EAAhCc,QAAQ,CAAEC,EAAsBf,EAAtBe,iBAAiB,CAEEC,EAAA3C,EAAjBW,EAAc,CAAA,GAAG,GAAtCiC,EAAMD,CAAA,CAAA,EAAA,CAAEE,EAASF,CAAA,CAAA,EAAA,CAC0FG,EAAA9C,EAAlEW,EAAiBU,EAAE,gDAA+C,GAA3G0B,EAAgBD,CAAA,CAAA,EAAA,CAAEE,EAAmBF,CAAA,CAAA,EAAA,CACCG,EAAAjD,EAAfW,EAAS,CAAA,GAAM,GAAtCuC,EAAOD,CAAA,CAAA,EAAA,CAAEE,EAAUF,CAAA,CAAA,EAAA,CAEpBG,EAAa1C,EAAQ,WAG1B,IAAA,IAFM2C,EAAa,CAAA,EAEnBC,EAAA,EAAAC,EAA2BC,OAAOC,OAAO,CAACjB,GAAOc,EAAAC,EAAAG,MAAA,CAAAJ,IAAE,CAAA,IAAAK,EAAA3D,EAAAuD,CAAA,CAAAD,EAAA,CAAA,GAAvCM,EAAGD,CAAA,CAAA,EAAA,CAAEtB,EAAKsB,CAAA,CAAA,EAAA,CACjB,CAAC,WAAY,OAAO,CAACE,QAAQ,CAACD,IAAQ,CAACvB,GAC1CgB,CAAAA,CAAK,CAACO,EAAI,CAAGvC,EAAE,iBAAgB,EAQjC,MAJqB,eAAjBmB,EAAOF,KAAK,EAAsBE,EAAOD,YAAY,EACxDc,CAAAA,EAAMd,YAAY,CAAGlB,EAAE,iBAAgB,EAGjCgC,CACR,EAAG,CAAChC,EAAGmB,EAAO,EAEd/B,EAAU,WACToC,EAAUO,EACX,EAAG,CAACZ,EAAOX,QAAQ,CAAEW,EAAOV,IAAI,CAAEU,EAAOD,YAAY,CAAEa,EAAW,EAmBlE,IAAMU,EAAStD,EAAY,WAAA,IAAAoB,EAAAC,EAAAC,EAAAQ,EAAAP,EAAAQ,EAAA,OAAAzC,EAAAiE,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAE6B,OAF7BF,EAAAC,IAAA,CAAA,EAEjBrC,EAAmDY,EAAnDZ,GAAG,CAAEC,EAA8CW,EAA9CX,QAAQ,CAAEC,EAAoCU,EAApCV,IAAI,CAAEQ,EAA8BE,EAA9BF,KAAK,CAAEP,EAAuBS,EAAvBT,IAAI,CAAEQ,EAAiBC,EAAjBD,YAAY,CAAAyB,EAAAE,IAAA,CAAA,EAAApE,EAAAqE,KAAA,CAQhD3C,EAAkBzB,EAAAA,EAAA,CAAA,EACnB6B,GAAO,CAAEA,IAAAA,CAAG,GAAE,CAAA,EAAA,CAClBC,SAAAA,EACAC,KAAAA,EACAQ,MAAAA,EACAP,KAAAA,CAAI,EACAQ,GAAgB,CAAEA,aAAAA,CAAY,IACjC,MAAA,EACFhB,EAAqB,CACpB6C,KAAM,UACNC,QAAShD,EAAEO,EAAM,0BAA4B,6BAE9CN,EAAW,MACXF,MAAAA,GAAAA,IAAqB4C,EAAAE,IAAA,CAAA,GAAA,KAAA,MAAA,EAAAF,EAAAC,IAAA,CAAA,EAAAD,EAAAM,EAAA,CAAAN,EAAA,KAAA,CAAA,GAErBzC,EAAqB,CAAE6C,KAAM,QAASC,QAAOL,EAAAM,EAAA,AAAO,EAAI,MAAA,GAAA,IAAA,MAAA,OAAAN,EAAAO,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAAC,QAAA,EAEvD,CAAChC,EAAQhB,EAAoBD,EAAsBF,EAAGC,EAAYF,EAAiB,EAMtF,OACCd,EAAAmE,aAAA,CAAC5D,EAAyB,CACzB6D,UAAWjD,EACXkD,UAAWjD,EACXc,OAAQA,EACRC,SAAUA,EACVG,OAAQA,EACRF,kBAAmBA,EACnBkC,cA1DoB,CACrBC,UAAW,WACVpC,EAASqC,WAAW,CAAC,UACrBrC,EAASsC,kBAAkB,CAAC,IAC5B/B,EAAoB3B,EAAE,8CACvB,EACA2D,cAAe,WACdvC,EAASqC,WAAW,CAAC,cACrB9B,EAAoB3B,EAAE,kDACvB,EACA4D,WAAY,WACXxC,EAASqC,WAAW,CAAC,QACrBrC,EAASsC,kBAAkB,CAAC,IAC5B/B,EAAoB3B,EAAE,+CACvB,GA6CC0B,iBAAkBA,EAClBmC,QAAS5D,EACTwC,OAAQA,EACRqB,UAhBgB,WACjBhC,EAAW,CAACD,EACb,EAeEkC,aAAclC,CAAQ,EAGzB"}