)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/units/UnitsTable.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Pagination, IconButton } from '@rocket.chat/fuselage';\nimport { useDebouncedValue, useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useEndpoint, useRouter, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useQuery, hashQueryKey } from '@tanstack/react-query';\nimport React, { useMemo, useState } from 'react';\n\nimport FilterByText from '../../../../client/components/FilterByText';\nimport GenericNoResults from '../../../../client/components/GenericNoResults/GenericNoResults';\nimport {\n\tGenericTable,\n\tGenericTableHeader,\n\tGenericTableHeaderCell,\n\tGenericTableBody,\n\tGenericTableCell,\n\tGenericTableLoadingRow,\n\tGenericTableRow,\n} from '../../../../client/components/GenericTable';\nimport { usePagination } from '../../../../client/components/GenericTable/hooks/usePagination';\nimport { useSort } from '../../../../client/components/GenericTable/hooks/useSort';\nimport { useRemoveUnit } from './useRemoveUnit';\n\nconst UnitsTable = () => {\n\tconst t = useTranslation();\n\tconst [filter, setFilter] = useState('');\n\tconst debouncedFilter = useDebouncedValue(filter, 500);\n\tconst router = useRouter();\n\n\tconst { current, itemsPerPage, setItemsPerPage: onSetItemsPerPage, setCurrent: onSetCurrent, ...paginationProps } = usePagination();\n\tconst { sortBy, sortDirection, setSort } = useSort<'name' | 'visibility'>('name');\n\n\tconst query = useMemo(\n\t\t() => ({\n\t\t\tfields: JSON.stringify({ name: 1 }),\n\t\t\ttext: debouncedFilter,\n\t\t\tsort: JSON.stringify({ [sortBy]: sortDirection === 'asc' ? 1 : -1 }),\n\t\t\t...(itemsPerPage && { count: itemsPerPage }),\n\t\t\t...(current && { offset: current }),\n\t\t}),\n\t\t[debouncedFilter, itemsPerPage, current, sortBy, sortDirection],\n\t);\n\n\tconst getUnits = useEndpoint('GET', '/v1/livechat/units');\n\tconst { isSuccess, isLoading, data } = useQuery(['livechat-units', query], async () => getUnits(query));\n\n\tconst [defaultQuery] = useState(hashQueryKey([query]));\n\tconst queryHasChanged = defaultQuery !== hashQueryKey([query]);\n\n\tconst handleAddNew = useMutableCallback(() => router.navigate('/omnichannel/units/new'));\n\tconst onRowClick = useMutableCallback((id) => () => router.navigate(`/omnichannel/units/edit/${id}`));\n\tconst handleDelete = useRemoveUnit();\n\n\tconst headers = (\n\t\t<>\n\t\t\t<GenericTableHeaderCell key='name' direction={sortDirection} active={sortBy === 'name'} onClick={setSort} sort='name'>\n\t\t\t\t{t('Name')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell\n\t\t\t\tkey='visibility'\n\t\t\t\tdirection={sortDirection}\n\t\t\t\tactive={sortBy === 'visibility'}\n\t\t\t\tonClick={setSort}\n\t\t\t\tsort='visibility'\n\t\t\t>\n\t\t\t\t{t('Visibility')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell key='remove' w='x60' />\n\t\t</>\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t{((isSuccess && data?.units.length > 0) || queryHasChanged) && <FilterByText onChange={({ text }): void => setFilter(text)} />}\n\t\t\t{isLoading && (\n\t\t\t\t<GenericTable>\n\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t<GenericTableLoadingRow cols={3} />\n\t\t\t\t\t</GenericTableBody>\n\t\t\t\t</GenericTable>\n\t\t\t)}\n\t\t\t{isSuccess && data.units.length === 0 && queryHasChanged && <GenericNoResults />}\n\t\t\t{isSuccess && data.units.length === 0 && !queryHasChanged && (\n\t\t\t\t<GenericNoResults\n\t\t\t\t\ticon='business'\n\t\t\t\t\ttitle={t('No_units_yet')}\n\t\t\t\t\tdescription={t('No_units_yet_description')}\n\t\t\t\t\tlinkHref='https://go.rocket.chat/omnichannel-docs'\n\t\t\t\t\tbuttonAction={handleAddNew}\n\t\t\t\t\tbuttonTitle={t('Create_unit')}\n\t\t\t\t\tlinkText={t('Learn_more_about_units')}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t{isSuccess && data?.units.length > 0 && (\n\t\t\t\t<>\n\t\t\t\t\t<GenericTable>\n\t\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t\t{data.units.map(({ _id, name, visibility }) => (\n\t\t\t\t\t\t\t\t<GenericTableRow key={_id} tabIndex={0} role='link' onClick={onRowClick(_id)} action qa-user-id={_id}>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>{name}</GenericTableCell>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>{visibility}</GenericTableCell>\n\t\t\t\t\t\t\t\t\t<GenericTableCell>\n\t\t\t\t\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\t\t\t\t\ticon='trash'\n\t\t\t\t\t\t\t\t\t\t\tsmall\n\t\t\t\t\t\t\t\t\t\t\ttitle={t('Remove')}\n\t\t\t\t\t\t\t\t\t\t\tonClick={(e) => {\n\t\t\t\t\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\t\t\t\t\thandleDelete(_id);\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</GenericTableCell>\n\t\t\t\t\t\t\t\t</GenericTableRow>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</GenericTableBody>\n\t\t\t\t\t</GenericTable>\n\t\t\t\t\t<Pagination\n\t\t\t\t\t\tdivider\n\t\t\t\t\t\tcurrent={current}\n\t\t\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\t\t\tcount={data?.total || 0}\n\t\t\t\t\t\tonSetItemsPerPage={onSetItemsPerPage}\n\t\t\t\t\t\tonSetCurrent={onSetCurrent}\n\t\t\t\t\t\t{...paginationProps}\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default UnitsTable;\n",null],"names":["_regeneratorRuntime","_extends","_objectSpread","_objectWithoutProperties","_slicedToArray","Pagination","IconButton","useDebouncedValue","useMutableCallback","useEndpoint","useRouter","useTranslation","useQuery","hashQueryKey","React","useMemo","useState","FilterByText","GenericNoResults","GenericTable","GenericTableHeader","GenericTableHeaderCell","GenericTableBody","GenericTableCell","GenericTableLoadingRow","GenericTableRow","usePagination","useSort","useRemoveUnit","module","link","default","v","exportDefault","t","_useState2","filter","setFilter","debouncedFilter","router","_usePagination","current","itemsPerPage","onSetItemsPerPage","setItemsPerPage","onSetCurrent","setCurrent","paginationProps","_excluded","_useSort","sortBy","sortDirection","setSort","query","_JSON$stringify","fields","JSON","stringify","name","text","sort","count","offset","getUnits","_useQuery","async","_context","prev","next","abrupt","stop","Promise","isSuccess","isLoading","data","queryHasChanged","defaultQuery","_useState4","handleAddNew","navigate","onRowClick","id","handleDelete","headers","createElement","Fragment","key","direction","active","onClick","w","units","length","onChange","_ref","cols","icon","title","description","linkHref","buttonAction","buttonTitle","linkText","map","_ref2","_id","visibility","tabIndex","role","action","withTruncatedText","small","e","stopPropagation","divider","total"],"mappings":"2BAAAA,EAA+DC,EAAAC,EAAAC,EAAAC,EAA/DC,EAASC,EAAsDC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,8DAA1CC,EAAUC,IAAE,CAAA,6BAA8B,CAAAC,QAAAA,SAAAA,CAAAA,EAAA/B,EAAAA,CAAA,CAAA,EAAA,GAAA6B,EAAAA,IAAAA,CAAAA,iCAAAA,CAAAE,QAAAA,SAAAA,CAAAA,EAAA9B,EAAAA,CAAA,CAAA,EAAA,GAAA4B,EAAAA,IAAAA,CAAAA,uCAAAA,CAAAE,QAAAA,SAAAA,CAAAA,EAAA7B,EAAAA,CAAA,CAAA,EAAA,GAAA2B,EAAAA,IAAAA,CAAAA,iDAAAA,CAAAE,QAAAA,SAAAA,CAAAA,EAAA5B,EAAAA,CAAA,CAAA,EAAA,GAAA0B,EAAAA,IAAAA,CAAAA,uCAAAA,CAAAE,QAAAA,SAAAA,CAAAA,EAAA3B,EAAAA,CAAA,CAAA,EAAA,GAA1CyB,EAAYC,IAAAA,CAAAA,wBAA6B,CAACzB,WAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,WAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAuB,EAAAA,IAAAA,CAAAA,8BAAAA,CAAAtB,kBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,mBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAqB,EAAAA,IAAAA,CAAAA,2BAAAA,CAAApB,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,UAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAkB,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAjB,SAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,aAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAgB,EAAAA,IAAAA,CAAAA,QAAAA,CAAA,QAAA,SAAAG,CAAA,EAAAlB,EAAAA,CAAA,EAAAC,QAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,SAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAa,EAAAA,IAAAA,CAAAA,6CAAAA,CAAA,QAAA,SAAAG,CAAA,EAAAf,EAAAA,CAAA,CAAA,EAAA,GAAAY,EAAAA,IAAAA,CAAAA,kEAAAA,CAAA,QAAA,SAAAG,CAAA,EAAAd,EAAAA,CAAA,CAAA,EAAA,GAAAW,EAAAA,IAAAA,CAAAA,6CAAAA,CAAAV,aAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,mBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,uBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,iBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,iBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,uBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,gBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,iEAAAA,CAAAH,cAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,2DAAAA,CAAAF,QAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,kBAAAA,CAAAD,cAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,IAA/DC,EAAOI,aAAY,CAqBA,WAClB,IAAMC,EAAIvB,IAC8BwB,EAAA/B,EAAZY,EAAS,IAAG,GAAjCoB,EAAMD,CAAA,CAAA,EAAA,CAAEE,EAASF,CAAA,CAAA,EAAA,CAClBG,EAAkB/B,EAAkB6B,EAAQ,KAC5CG,EAAS7B,IAEf8B,EAAoHd,IAA5Ge,EAAOD,EAAPC,OAAO,CAAEC,EAAYF,EAAZE,YAAY,CAAmBC,EAAiBH,EAAlCI,eAAe,CAAiCC,EAAYL,EAAxBM,UAAU,CAAmBC,EAAe5C,EAAAqC,EAAAQ,GAC/GC,EAA2CtB,EAA+B,QAAlEuB,EAAMD,EAANC,MAAM,CAAEC,EAAaF,EAAbE,aAAa,CAAEC,EAAOH,EAAPG,OAAO,CAEhCC,EAAQtC,EACb,WAAA,IAAAuC,EAAA,OAAApD,EAAAA,EAAA,CACCqD,OAAQC,KAAKC,SAAS,CAAC,CAAEC,KAAM,CAAC,GAChCC,KAAMrB,EACNsB,KAAMJ,KAAKC,SAAS,CAAAH,CAAAA,CAAAA,EAAA,CAAA,CAAA,CAAA,CAAIJ,EAAM,CAAGC,AAAkB,QAAlBA,EAA0B,EAAI,GAAEG,CAAA,EAAG,EAChEZ,GAAgB,CAAEmB,MAAOnB,CAAY,GACrCD,GAAW,CAAEqB,OAAQrB,CAAO,EAAE,EAEnC,CAACH,EAAiBI,EAAcD,EAASS,EAAQC,EAAc,EAG1DY,EAAWtD,EAAY,MAAO,sBACpCuD,EAAuCpD,EAAS,CAAC,iBAAkByC,EAAM,CAAE,WAAA,OAAArD,EAAAiE,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAAA,OAAAF,EAAAG,MAAA,CAAA,SAAYN,EAASV,GAAM,MAAA,EAAA,IAAA,MAAA,OAAAa,EAAAI,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,GAA9FC,EAASR,EAATQ,SAAS,CAAEC,EAAST,EAATS,SAAS,CAAEC,EAAIV,EAAJU,IAAI,CAG5BC,EAAkBC,AADLC,AAAmCzE,EAA/BY,EAASH,EAAa,CAACwC,EAAM,GAAE,EAAnC,CAAA,EAAA,GACsBxC,EAAa,CAACwC,EAAM,EAEvDyB,EAAetE,EAAmB,WAAA,OAAM+B,EAAOwC,QAAQ,CAAC,yBAAyB,GACjFC,GAAaxE,EAAmB,SAACyE,CAAE,EAAA,OAAK,WAAA,OAAM1C,EAAOwC,QAAQ,CAAA,2BAA4BE,EAAK,CAAA,GAC9FC,GAAetD,IAEfuD,GACLrE,EAAAsE,aAAA,CAAAtE,EAAAuE,QAAA,CAAA,KACCvE,EAAAsE,aAAA,CAAC/D,EAAsB,CAACiE,IAAI,OAAOC,UAAWpC,EAAeqC,OAAQtC,AAAW,SAAXA,EAAmBuC,QAASrC,EAASQ,KAAK,MAAM,EACnH1B,EAAE,SAEJpB,EAAAsE,aAAA,CAAC/D,EAAsB,CACtBiE,IAAI,aACJC,UAAWpC,EACXqC,OAAQtC,AAAW,eAAXA,EACRuC,QAASrC,EACTQ,KAAK,YAAY,EAEhB1B,EAAE,eAEJpB,EAAAsE,aAAA,CAAC/D,EAAsB,CAACiE,IAAI,SAASI,EAAE,KAAK,IAI9C,OACC5E,EAAAsE,aAAA,CAAAtE,EAAAuE,QAAA,CAAA,KACE,AAAEb,CAAAA,GAAa,AAAAE,CAAAA,MAAAA,EAAI,KAAA,EAAJA,EAAMiB,KAAK,CAACC,MAAM,AAANA,EAAS,GAAMjB,CAAAA,GAAoB7D,EAAAsE,aAAA,CAACnE,EAAY,CAAC4E,SAAU,SAAAC,CAAA,EAAO,OAAazD,EAAbyD,EAAJnC,IAAI,CAA4B,CAAC,GAC1Hc,GACA3D,EAAAsE,aAAA,CAACjE,EAAY,KACZL,EAAAsE,aAAA,CAAChE,EAAkB,KAAE+D,IACrBrE,EAAAsE,aAAA,CAAC9D,EAAgB,KAChBR,EAAAsE,aAAA,CAAC5D,EAAsB,CAACuE,KAAM,CAAE,KAIlCvB,GAAaE,AAAsB,IAAtBA,EAAKiB,KAAK,CAACC,MAAM,EAAUjB,GAAmB7D,EAAAsE,aAAA,CAAClE,EAAgB,MAC5EsD,GAAaE,AAAsB,IAAtBA,EAAKiB,KAAK,CAACC,MAAM,EAAU,CAACjB,GACzC7D,EAAAsE,aAAA,CAAClE,EAAgB,CAChB8E,KAAK,WACLC,MAAO/D,EAAE,gBACTgE,YAAahE,EAAE,4BACfiE,SAAS,0CACTC,aAActB,EACduB,YAAanE,EAAE,eACfoE,SAAUpE,EAAE,yBAA0B,GAGvCsC,GAAa,AAAAE,CAAAA,MAAAA,EAAI,KAAA,EAAJA,EAAMiB,KAAK,CAACC,MAAM,AAANA,EAAS,GAClC9E,EAAAsE,aAAA,CAAAtE,EAAAuE,QAAA,CAAA,KACCvE,EAAAsE,aAAA,CAACjE,EAAY,KACZL,EAAAsE,aAAA,CAAChE,EAAkB,KAAE+D,IACrBrE,EAAAsE,aAAA,CAAC9D,EAAgB,KACfoD,EAAKiB,KAAK,CAACY,GAAG,CAAC,SAAAC,CAAA,EAAA,IAAGC,EAAGD,EAAHC,GAAG,CAAE/C,EAAI8C,EAAJ9C,IAAI,CAAEgD,EAAUF,EAAVE,UAAU,CAAA,OACvC5F,EAAAsE,aAAA,CAAC3D,EAAe,CAAC6D,IAAKmB,EAAKE,SAAU,EAAGC,KAAK,OAAOnB,QAAST,GAAWyB,GAAMI,OAAM,CAAA,EAAC,aAAYJ,CAAI,EACpG3F,EAAAsE,aAAA,CAAC7D,EAAgB,CAACuF,kBAAiB,CAAA,CAAA,EAAEpD,GACrC5C,EAAAsE,aAAA,CAAC7D,EAAgB,CAACuF,kBAAiB,CAAA,CAAA,EAAEJ,GACrC5F,EAAAsE,aAAA,CAAC7D,EAAgB,KAChBT,EAAAsE,aAAA,CAAC9E,EAAU,CACV0F,KAAK,QACLe,MAAK,CAAA,EACLd,MAAO/D,EAAE,UACTuD,QAAS,SAACuB,CAAC,EACVA,EAAEC,eAAe,GACjB/B,GAAauB,EACd,CAAE,IAGa,KAIrB3F,EAAAsE,aAAA,CAAC/E,EAAUJ,EAAA,CACViH,QAAO,CAAA,EACPzE,QAASA,EACTC,aAAcA,EACdmB,MAAO,AAAAa,CAAAA,MAAAA,EAAI,KAAA,EAAJA,EAAMyC,KAAK,AAALA,GAAS,EACtBxE,kBAAmBA,EACnBE,aAAcA,CAAa,EACvBE,KAMV"}