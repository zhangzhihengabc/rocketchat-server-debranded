)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/hooks/useOmnichannelPrioritiesMenu.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { LivechatPriorityWeight } from '@rocket.chat/core-typings';\nimport type { Menu } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useQueryClient } from '@tanstack/react-query';\nimport type { ComponentProps } from 'react';\nimport React, { useCallback, useMemo } from 'react';\n\nimport { dispatchToastMessage } from '../../../../client/lib/toast';\nimport { PriorityIcon } from '../priorities/PriorityIcon';\nimport { useOmnichannelPriorities } from './useOmnichannelPriorities';\n\nexport const useOmnichannelPrioritiesMenu = (rid: string): ComponentProps<typeof Menu>['options'] | Record<string, never> => {\n\tconst t = useTranslation();\n\tconst queryClient = useQueryClient();\n\tconst updateRoomPriority = useEndpoint('POST', '/v1/livechat/room/:rid/priority', { rid });\n\tconst removeRoomPriority = useEndpoint('DELETE', '/v1/livechat/room/:rid/priority', { rid });\n\tconst { data: priorities } = useOmnichannelPriorities();\n\n\tconst handlePriorityChange = useMutableCallback((priorityId: string) => async () => {\n\t\ttry {\n\t\t\tpriorityId ? await updateRoomPriority({ priorityId }) : await removeRoomPriority();\n\t\t\tqueryClient.invalidateQueries(['current-chats']);\n\t\t\tqueryClient.invalidateQueries(['/v1/rooms.info', rid]);\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst renderOption = useCallback((label: string, weight: LivechatPriorityWeight) => {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<PriorityIcon level={weight || LivechatPriorityWeight.NOT_SPECIFIED} showUnprioritized /> {label}\n\t\t\t</>\n\t\t);\n\t}, []);\n\n\treturn useMemo<ComponentProps<typeof Menu>['options']>(() => {\n\t\tconst menuHeading = {\n\t\t\ttype: 'heading',\n\t\t\tlabel: t('Priorities'),\n\t\t};\n\n\t\tconst unprioritizedOption = {\n\t\t\ttype: 'option',\n\t\t\taction: handlePriorityChange(''),\n\t\t\tlabel: {\n\t\t\t\tlabel: renderOption(t('Unprioritized'), LivechatPriorityWeight.NOT_SPECIFIED),\n\t\t\t},\n\t\t};\n\n\t\tconst options = priorities.reduce<Record<string, object>>((items, { _id: priorityId, name, i18n, dirty, sortItem }) => {\n\t\t\tconst label = dirty && name ? name : i18n;\n\n\t\t\titems[label] = {\n\t\t\t\taction: handlePriorityChange(priorityId),\n\t\t\t\tlabel: {\n\t\t\t\t\tlabel: renderOption(label, sortItem),\n\t\t\t\t},\n\t\t\t};\n\n\t\t\treturn items;\n\t\t}, {});\n\n\t\treturn priorities.length ? { menuHeading, Unprioritized: unprioritizedOption, ...options } : {};\n\t}, [t, handlePriorityChange, priorities, renderOption]);\n};\n",null],"names":["module","default","_objectSpread","_regeneratorRuntime","export","useOmnichannelPrioritiesMenu","LivechatPriorityWeight","useMutableCallback","useEndpoint","useTranslation","useQueryClient","v","React","useCallback","useMemo","dispatchToastMessage","PriorityIcon","useOmnichannelPriorities","rid","t","queryClient","updateRoomPriority","removeRoomPriority","priorities","_useOmnichannelPriori","data","handlePriorityChange","priorityId","async","_context","prev","next","awrap","invalidateQueries","t0","type","message","stop","Promise","renderOption","label","weight","createElement","Fragment","level","NOT_SPECIFIED","showUnprioritized","menuHeading","unprioritizedOption","action","options","reduce","items","_ref","_id","name","i18n","dirty","sortItem","length","Unprioritized"],"mappings":"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"}