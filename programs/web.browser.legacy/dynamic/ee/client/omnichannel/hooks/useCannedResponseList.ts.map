)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/hooks/useCannedResponseList.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useCallback, useEffect, useState } from 'react';\n\nimport { useScrollableRecordList } from '../../../../client/hooks/lists/useScrollableRecordList';\nimport { useComponentDidUpdate } from '../../../../client/hooks/useComponentDidUpdate';\nimport { CannedResponseList } from '../../../../client/lib/lists/CannedResponseList';\n\nexport const useCannedResponseList = (\n\toptions: any,\n): {\n\treload: () => void;\n\tcannedList: CannedResponseList;\n\tinitialItemCount: number;\n\tloadMoreItems: (start: number, end: number) => void;\n} => {\n\tconst [cannedList, setCannedList] = useState(() => new CannedResponseList(options));\n\tconst reload = useCallback(() => setCannedList(new CannedResponseList(options)), [options]);\n\n\tuseComponentDidUpdate(() => {\n\t\toptions && reload();\n\t}, [options, reload]);\n\n\tuseEffect(() => {\n\t\tif (cannedList.options !== options) {\n\t\t\tcannedList.updateFilters(options);\n\t\t}\n\t}, [cannedList, options]);\n\n\tconst getCannedResponses = useEndpoint('GET', '/v1/canned-responses');\n\tconst getDepartments = useEndpoint('GET', '/v1/livechat/department');\n\n\tconst fetchData = useCallback(\n\t\tasync (start, end) => {\n\t\t\tconst { cannedResponses, total } = await getCannedResponses({\n\t\t\t\t...(options.filter && { text: options.filter }),\n\t\t\t\t...(options.type && ['global', 'user'].find((option) => option === options.type) && { scope: options.type }),\n\t\t\t\t...(options.type &&\n\t\t\t\t\t!['global', 'user', 'all'].find((option) => option === options.type) && {\n\t\t\t\t\t\tscope: 'department',\n\t\t\t\t\t\tdepartmentId: options.type,\n\t\t\t\t\t}),\n\t\t\t\toffset: start,\n\t\t\t\tcount: end + start,\n\t\t\t});\n\n\t\t\tconst { departments } = await getDepartments({ text: '' });\n\n\t\t\treturn {\n\t\t\t\titems: cannedResponses.map((cannedResponse: any) => {\n\t\t\t\t\tif (cannedResponse.departmentId) {\n\t\t\t\t\t\tdepartments.forEach((department: any) => {\n\t\t\t\t\t\t\tif (cannedResponse.departmentId === department._id) {\n\t\t\t\t\t\t\t\tcannedResponse.departmentName = department.name;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tcannedResponse._updatedAt = new Date(cannedResponse._updatedAt);\n\t\t\t\t\tcannedResponse._createdAt = new Date(cannedResponse._createdAt);\n\t\t\t\t\treturn cannedResponse;\n\t\t\t\t}),\n\t\t\t\titemCount: total,\n\t\t\t};\n\t\t},\n\t\t[getCannedResponses, getDepartments, options.filter, options.type],\n\t);\n\n\tconst { loadMoreItems, initialItemCount } = useScrollableRecordList(cannedList, fetchData);\n\n\treturn {\n\t\treload,\n\t\tcannedList,\n\t\tloadMoreItems,\n\t\tinitialItemCount,\n\t};\n};\n",null],"names":["module","link","default","_regeneratorRuntime","_objectSpread","_slicedToArray","export","useCannedResponseList","useEndpoint","useCallback","useEffect","useState","useScrollableRecordList","useComponentDidUpdate","CannedResponseList","options","_useState2","cannedList","setCannedList","reload","updateFilters","getCannedResponses","getDepartments","_useScrollableRecordL","start","end","_await$getCannedRespo","cannedResponses","total","departments","async","_context","prev","next","awrap","filter","text","type","find","option","scope","departmentId","offset","count","sent","_await$getDepartments","abrupt","items","map","cannedResponse","forEach","department","_id","departmentName","name","_updatedAt","Date","_createdAt","itemCount","stop","Promise","loadMoreItems","initialItemCount"],"mappings":"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"}