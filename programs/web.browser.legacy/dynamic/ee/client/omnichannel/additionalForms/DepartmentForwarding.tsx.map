)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/additionalForms/DepartmentForwarding.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Field, FieldLabel, FieldRow, FieldHint, Box, PaginatedMultiSelectFiltered } from '@rocket.chat/fuselage';\nimport type { PaginatedMultiSelectOption } from '@rocket.chat/fuselage';\nimport { useDebouncedValue } from '@rocket.chat/fuselage-hooks';\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\nimport { useTranslation } from '@rocket.chat/ui-contexts';\nimport React, { useMemo, useState } from 'react';\n\nimport { useDepartmentsList } from '../../../../client/components/Omnichannel/hooks/useDepartmentsList';\nimport { useRecordList } from '../../../../client/hooks/lists/useRecordList';\nimport { AsyncStatePhase } from '../../../../client/hooks/useAsyncState';\nimport { useHasLicenseModule } from '../../hooks/useHasLicenseModule';\n\ntype DepartmentForwardingProps = {\n\tdepartmentId: string;\n\tvalue?: PaginatedMultiSelectOption[];\n\thandler: (value: PaginatedMultiSelectOption[]) => void;\n\tlabel: TranslationKey;\n};\n\nexport const DepartmentForwarding = ({ departmentId, value = [], handler, label }: DepartmentForwardingProps) => {\n\tconst t = useTranslation();\n\tconst [departmentsFilter, setDepartmentsFilter] = useState('');\n\tconst hasLicense = useHasLicenseModule('livechat-enterprise');\n\n\tconst debouncedDepartmentsFilter = useDebouncedValue(departmentsFilter, 500);\n\n\tconst { itemsList: departmentsList, loadMoreItems: loadMoreDepartments } = useDepartmentsList(\n\t\tuseMemo(() => ({ filter: departmentsFilter, departmentId, showArchived: true }), [departmentId, departmentsFilter]),\n\t);\n\n\tconst { phase: departmentsPhase, items: departmentsItems, itemCount: departmentsTotal } = useRecordList(departmentsList);\n\n\tconst options = useMemo(() => {\n\t\tconst pending = value.filter(({ value }) => !departmentsItems.find((dep) => dep.value === value));\n\t\treturn [...departmentsItems, ...pending];\n\t}, [departmentsItems, value]);\n\n\tif (!hasLicense) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<Field>\n\t\t\t<FieldLabel>{t(label)}</FieldLabel>\n\t\t\t<FieldRow>\n\t\t\t\t<Box w='100%'>\n\t\t\t\t\t<PaginatedMultiSelectFiltered\n\t\t\t\t\t\twithTitle\n\t\t\t\t\t\tmaxWidth='100%'\n\t\t\t\t\t\tw='100%'\n\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\tfilter={debouncedDepartmentsFilter}\n\t\t\t\t\t\tsetFilter={setDepartmentsFilter}\n\t\t\t\t\t\tonChange={handler}\n\t\t\t\t\t\toptions={options}\n\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\tplaceholder={t('Select_an_option')}\n\t\t\t\t\t\tendReached={\n\t\t\t\t\t\t\tdepartmentsPhase === AsyncStatePhase.LOADING\n\t\t\t\t\t\t\t\t? () => undefined\n\t\t\t\t\t\t\t\t: (start?: number) => {\n\t\t\t\t\t\t\t\t\t\tif (start === undefined) {\n\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tloadMoreDepartments(start, Math.min(50, departmentsTotal));\n\t\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t</Box>\n\t\t\t</FieldRow>\n\t\t\t<FieldHint>{t('List_of_departments_for_forward_description')}</FieldHint>\n\t\t</Field>\n\t);\n};\n\nexport default DepartmentForwarding;\n",null],"names":["module","link","default","v","_toConsumableArray","_slicedToArray","export","DepartmentForwarding","Field","FieldLabel","FieldRow","FieldHint","Box","PaginatedMultiSelectFiltered","useDebouncedValue","useTranslation","React","useMemo","useState","useDepartmentsList","useRecordList","AsyncStatePhase","useHasLicenseModule","_ref","departmentId","_ref$value","value","handler","label","t","_useState2","departmentsFilter","setDepartmentsFilter","hasLicense","debouncedDepartmentsFilter","_useDepartmentsList","filter","showArchived","departmentsList","itemsList","loadMoreDepartments","loadMoreItems","_useRecordList","departmentsPhase","phase","departmentsItems","items","departmentsTotal","itemCount","options","pending","_ref2","find","dep","concat","createElement","w","withTitle","maxWidth","flexGrow","setFilter","onChange","placeholder","endReached","LOADING","start","undefined","Math","min","exportDefault"],"mappings":"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"}