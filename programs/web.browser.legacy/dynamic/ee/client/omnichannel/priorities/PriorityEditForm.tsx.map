)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/priorities/PriorityEditForm.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { ILivechatPriority, Serialized } from '@rocket.chat/core-typings';\nimport { Field, FieldError, Button, Box, ButtonGroup } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\nimport { useToastMessageDispatch, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useState } from 'react';\nimport { Controller, useForm } from 'react-hook-form';\n\nimport StringSettingInput from '../../../../client/views/admin/settings/inputs/StringSettingInput';\n\nexport type PriorityFormData = { name: string; reset: boolean };\n\ntype ILivechatClientPriority = Serialized<ILivechatPriority> & {\n\ti18n: TranslationKey;\n};\n\nexport type PriorityEditFormProps = {\n\tdata: ILivechatClientPriority;\n\tonCancel: () => void;\n\tonSave: (values: PriorityFormData) => Promise<void>;\n};\n\ntype PrioritySaveException = { success: false; error: TranslationKey | undefined };\n\nconst PriorityEditForm = ({ data, onSave, onCancel }: PriorityEditFormProps): ReactElement => {\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst t = useTranslation();\n\tconst [isSaving, setSaving] = useState(false);\n\n\tconst { name, i18n, dirty } = data;\n\tconst defaultName = t(i18n);\n\n\tconst {\n\t\tcontrol,\n\t\tgetValues,\n\t\tsetValue,\n\t\tformState: { errors, isValid, isDirty },\n\t\tsetError,\n\t\thandleSubmit,\n\t} = useForm<PriorityFormData>({\n\t\tmode: 'onChange',\n\t\tdefaultValues: data ? { name: dirty ? name : defaultName } : {},\n\t});\n\n\tconst handleSave = useMutableCallback(async () => {\n\t\tconst { name } = getValues();\n\n\t\tif (!isValid) {\n\t\t\treturn dispatchToastMessage({ type: 'error', message: t('The_field_is_required') });\n\t\t}\n\n\t\ttry {\n\t\t\tsetSaving(true);\n\t\t\tawait onSave({ name, reset: name === defaultName });\n\t\t} catch (e) {\n\t\t\tconst { error } = e as PrioritySaveException;\n\n\t\t\tif (error) {\n\t\t\t\tsetError('name', { message: t(error) });\n\t\t\t}\n\t\t} finally {\n\t\t\tsetSaving(false);\n\t\t}\n\t});\n\n\tconst onReset = (): void => {\n\t\tsetValue('name', defaultName, {\n\t\t\tshouldDirty: true,\n\t\t\tshouldValidate: true,\n\t\t});\n\t};\n\n\treturn (\n\t\t<Box is='form' onSubmit={handleSubmit(handleSave)} display='flex' flexDirection='column' justifyContent='space-between' flexGrow={1}>\n\t\t\t<Field>\n\t\t\t\t<Controller\n\t\t\t\t\tname='name'\n\t\t\t\t\tcontrol={control}\n\t\t\t\t\trules={{ required: t('The_field_is_required', t('Name')), validate: (v) => v?.trim() !== '' }}\n\t\t\t\t\trender={({ field: { value, onChange } }): ReactElement => (\n\t\t\t\t\t\t<StringSettingInput\n\t\t\t\t\t\t\t_id=''\n\t\t\t\t\t\t\tdisabled={isSaving}\n\t\t\t\t\t\t\terror={errors.name?.message}\n\t\t\t\t\t\t\tlabel={`${t('Name')}*`}\n\t\t\t\t\t\t\tplaceholder={t('Name')}\n\t\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\t\tname='name'\n\t\t\t\t\t\t\thasResetButton={value !== t(i18n)}\n\t\t\t\t\t\t\tonResetButtonClick={onReset}\n\t\t\t\t\t\t\tonChangeValue={onChange}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t/>\n\t\t\t\t<FieldError>{errors.name?.message}</FieldError>\n\t\t\t</Field>\n\n\t\t\t<ButtonGroup stretch>\n\t\t\t\t<Button onClick={(): void => onCancel()} disabled={isSaving}>\n\t\t\t\t\t{t('Cancel')}\n\t\t\t\t</Button>\n\n\t\t\t\t<Button primary disabled={!isDirty || !isValid} loading={isSaving} onClick={handleSave}>\n\t\t\t\t\t{t('Save')}\n\t\t\t\t</Button>\n\t\t\t</ButtonGroup>\n\t\t</Box>\n\t);\n};\n\nexport default PriorityEditForm;\n",null],"names":["_regeneratorRuntime","_slicedToArray","Field","FieldError","Button","Box","useMutableCallback","useToastMessageDispatch","useTranslation","React","useState","Controller","useForm","StringSettingInput","module","link","default","v","ButtonGroup","exportDefault","_ref","_errors$name2","data","onSave","onCancel","dispatchToastMessage","t","_useState2","isSaving","setSaving","name","i18n","dirty","defaultName","_useForm","mode","defaultValues","control","getValues","setValue","_useForm$formState","formState","errors","isValid","isDirty","setError","handleSubmit","handleSave","error","async","_context","prev","next","_getValues","abrupt","type","message","awrap","reset","t0","finish","stop","Promise","onReset","shouldDirty","shouldValidate","createElement","is","onSubmit","display","flexDirection","justifyContent","flexGrow","rules","required","validate","trim","render","_ref2","_errors$name","_ref2$field","field","value","onChange","_id","disabled","label","placeholder","hasResetButton","onResetButtonClick","onChangeValue","stretch","onClick","primary","loading"],"mappings":"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"}