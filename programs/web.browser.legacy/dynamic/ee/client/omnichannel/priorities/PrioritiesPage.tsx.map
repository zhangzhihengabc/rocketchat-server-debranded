)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/priorities/PrioritiesPage.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Button, ButtonGroup } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useEndpoint, useRoute, useSetModal, useToastMessageDispatch, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useQueryClient } from '@tanstack/react-query';\nimport type { ReactElement } from 'react';\nimport React, { useMemo, useState } from 'react';\n\nimport Page from '../../../../client/components/Page';\nimport { useOmnichannelPriorities } from '../hooks/useOmnichannelPriorities';\nimport { PrioritiesResetModal } from './PrioritiesResetModal';\nimport { PrioritiesTable } from './PrioritiesTable';\nimport type { PriorityFormData } from './PriorityEditForm';\nimport PriorityList from './PriorityList';\n\ntype PrioritiesPageProps = {\n\tpriorityId: string;\n\tcontext: 'edit' | undefined;\n};\n\nexport const PrioritiesPage = ({ priorityId, context }: PrioritiesPageProps): ReactElement => {\n\tconst t = useTranslation();\n\tconst queryClient = useQueryClient();\n\tconst prioritiesRoute = useRoute('omnichannel-priorities');\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst setModal = useSetModal();\n\n\tconst [isResetting, setResetting] = useState(false);\n\n\tconst savePriority = useEndpoint('PUT', `/v1/livechat/priorities/:priorityId`, { priorityId });\n\tconst resetPriorities = useEndpoint('POST', '/v1/livechat/priorities.reset');\n\n\tconst { data: priorities, isLoading } = useOmnichannelPriorities();\n\n\tconst isPrioritiesDirty = useMemo(() => !!priorities.length && priorities.some((p) => p.dirty), [priorities]);\n\n\tconst handleReset = (): void => {\n\t\tconst onReset = async (): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tsetResetting(true);\n\t\t\t\tsetModal(null);\n\n\t\t\t\tawait resetPriorities();\n\t\t\t\tawait queryClient.invalidateQueries(['/v1/livechat/priorities'], { exact: true });\n\n\t\t\t\tprioritiesRoute.push({});\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Priorities_restored') });\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t} finally {\n\t\t\t\tsetResetting(false);\n\t\t\t}\n\t\t};\n\n\t\tsetModal(<PrioritiesResetModal onReset={onReset} onCancel={(): void => setModal(null)} />);\n\t};\n\n\tconst onRowClick = useMutableCallback((id: string): void => {\n\t\tprioritiesRoute.push({ context: 'edit', id });\n\t});\n\n\tconst onContextualbarClose = (): void => {\n\t\tprioritiesRoute.push({});\n\t};\n\n\tconst onSavePriority = async ({ reset, ...payload }: PriorityFormData): Promise<void> => {\n\t\tawait savePriority(reset ? { reset } : payload);\n\t\tawait queryClient.invalidateQueries(['/v1/livechat/priorities']);\n\n\t\tdispatchToastMessage({ type: 'success', message: t('Priority_saved') });\n\t\tawait queryClient.invalidateQueries(['/v1/livechat/priorities'], { exact: true });\n\t\tprioritiesRoute.push({});\n\t};\n\n\treturn (\n\t\t<Page flexDirection='row'>\n\t\t\t<Page>\n\t\t\t\t<Page.Header title={t('Priorities')}>\n\t\t\t\t\t<ButtonGroup>\n\t\t\t\t\t\t<Button onClick={handleReset} title={t('Reset')} disabled={!isPrioritiesDirty} loading={isResetting}>\n\t\t\t\t\t\t\t{t('Reset')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</ButtonGroup>\n\t\t\t\t</Page.Header>\n\t\t\t\t<Page.Content>\n\t\t\t\t\t<PrioritiesTable priorities={priorities} isLoading={isLoading} onRowClick={onRowClick} />\n\t\t\t\t</Page.Content>\n\t\t\t</Page>\n\n\t\t\t{context === 'edit' && (\n\t\t\t\t<PriorityList priorityId={priorityId} context={context} onSave={onSavePriority} onClose={onContextualbarClose} />\n\t\t\t)}\n\t\t</Page>\n\t);\n};\n",null],"names":["_objectWithoutProperties","_regeneratorRuntime","_slicedToArray","Button","ButtonGroup","useMutableCallback","useEndpoint","useRoute","useSetModal","useToastMessageDispatch","useTranslation","useQueryClient","React","useMemo","useState","Page","useOmnichannelPriorities","PrioritiesResetModal","PrioritiesTable","PriorityList","module","link","default","export","PrioritiesPage","v","_ref","priorityId","context","t","queryClient","prioritiesRoute","dispatchToastMessage","setModal","_useState2","isResetting","setResetting","savePriority","resetPriorities","_useOmnichannelPriori","priorities","data","isLoading","isPrioritiesDirty","length","some","p","dirty","onRowClick","id","push","createElement","flexDirection","Header","title","onClick","onReset","async","_context","prev","next","awrap","invalidateQueries","exact","type","message","t0","finish","stop","Promise","onCancel","disabled","loading","Content","onSave","_ref2","reset","payload","_context2","_excluded","onClose"],"mappings":"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"}