)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/slaPolicies/SlaEdit.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IOmnichannelServiceLevelAgreements, Serialized } from '@rocket.chat/core-typings';\nimport { Field, FieldLabel, FieldRow, FieldError, TextInput, Button, Margins, Box, NumberInput } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useToastMessageDispatch, useRoute, useTranslation, useEndpoint } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React from 'react';\nimport { useController, useForm } from 'react-hook-form';\n\nimport { ContextualbarScrollableContent } from '../../../../client/components/Contextualbar';\n\ntype SlaEditProps = {\n\tisNew?: boolean;\n\tslaId?: string;\n\treload: () => void;\n\tdata?: Serialized<IOmnichannelServiceLevelAgreements>;\n};\n\nfunction SlaEdit({ data, isNew, slaId, reload, ...props }: SlaEditProps): ReactElement {\n\tconst slasRoute = useRoute('omnichannel-sla-policies');\n\tconst saveSLA = useEndpoint('POST', '/v1/livechat/sla');\n\tconst updateSLA = useEndpoint('PUT', `/v1/livechat/sla/:slaId`, { slaId: slaId || '' });\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst t = useTranslation();\n\n\tconst { name, description, dueTimeInMinutes } = data || {};\n\n\tconst {\n\t\tcontrol,\n\t\tgetValues,\n\t\tformState: { errors, isValid, isDirty },\n\t\treset,\n\t} = useForm({\n\t\tmode: 'onChange',\n\t\tdefaultValues: { name, description, dueTimeInMinutes },\n\t});\n\n\tconst { field: nameField } = useController({\n\t\tcontrol,\n\t\tname: 'name',\n\t\trules: { required: t('The_field_is_required', t('Name')) },\n\t});\n\n\tconst { field: dueTimeField } = useController({\n\t\tcontrol,\n\t\tname: 'dueTimeInMinutes',\n\t\trules: {\n\t\t\tvalidate(value) {\n\t\t\t\treturn Number(value || 0) <= 0 ? t('The_field_is_required', t('Estimated_wait_time_in_minutes')) : true;\n\t\t\t},\n\t\t},\n\t});\n\n\tconst { field: descField } = useController({ control, name: 'description' });\n\n\tconst handleSave = useMutableCallback(async () => {\n\t\tconst { name, description, dueTimeInMinutes } = getValues();\n\n\t\tif (!isValid || !name || dueTimeInMinutes === undefined) {\n\t\t\treturn dispatchToastMessage({ type: 'error', message: t('The_field_is_required') });\n\t\t}\n\n\t\ttry {\n\t\t\tconst payload = { name, description, dueTimeInMinutes: Number(dueTimeInMinutes) };\n\t\t\tif (slaId) {\n\t\t\t\tawait updateSLA(payload);\n\t\t\t} else {\n\t\t\t\tawait saveSLA(payload);\n\t\t\t}\n\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\treload();\n\t\t\tslasRoute.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\treturn (\n\t\t<ContextualbarScrollableContent is='form' {...props}>\n\t\t\t<Field>\n\t\t\t\t<FieldLabel>{t('Name')}*</FieldLabel>\n\t\t\t\t<FieldRow>\n\t\t\t\t\t<TextInput placeholder={t('Name')} flexGrow={1} {...nameField} error={errors.name?.message} />\n\t\t\t\t</FieldRow>\n\t\t\t\t<FieldError>{errors.name?.message}</FieldError>\n\t\t\t</Field>\n\t\t\t<Field>\n\t\t\t\t<FieldLabel>{t('Description')}</FieldLabel>\n\t\t\t\t<FieldRow>\n\t\t\t\t\t<TextInput placeholder={t('Description')} flexGrow={1} {...descField} />\n\t\t\t\t</FieldRow>\n\t\t\t</Field>\n\t\t\t<Field>\n\t\t\t\t<FieldLabel>{t('Estimated_wait_time_in_minutes')}*</FieldLabel>\n\t\t\t\t<FieldRow>\n\t\t\t\t\t<NumberInput\n\t\t\t\t\t\tplaceholder={t('Estimated_wait_time_in_minutes')}\n\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t{...dueTimeField}\n\t\t\t\t\t\terror={errors.dueTimeInMinutes?.message}\n\t\t\t\t\t/>\n\t\t\t\t</FieldRow>\n\t\t\t\t<FieldError>{errors.dueTimeInMinutes?.message}</FieldError>\n\t\t\t</Field>\n\t\t\t<Field>\n\t\t\t\t<FieldRow>\n\t\t\t\t\t<Box display='flex' flexDirection='row' justifyContent='space-between' w='full'>\n\t\t\t\t\t\t<Margins inlineEnd={4}>\n\t\t\t\t\t\t\t{!isNew && (\n\t\t\t\t\t\t\t\t<Button flexGrow={1} type='reset' disabled={!isDirty} onClick={(): void => reset()}>\n\t\t\t\t\t\t\t\t\t{t('Reset')}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<Button primary mie='none' flexGrow={1} disabled={!isDirty || !isValid} onClick={handleSave}>\n\t\t\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Margins>\n\t\t\t\t\t</Box>\n\t\t\t\t</FieldRow>\n\t\t\t</Field>\n\t\t</ContextualbarScrollableContent>\n\t);\n}\n\nexport default SlaEdit;\n",null],"names":["_regeneratorRuntime","_extends","_objectWithoutProperties","Field","FieldLabel","FieldRow","FieldError","TextInput","Button","Margins","Box","NumberInput","useMutableCallback","useToastMessageDispatch","useRoute","useTranslation","useEndpoint","React","useController","useForm","ContextualbarScrollableContent","module","link","default","v","exportDefault","_ref","_errors$name","_errors$name2","_errors$dueTimeInMinu","_errors$dueTimeInMinu2","data","isNew","slaId","reload","props","_excluded","slasRoute","saveSLA","updateSLA","dispatchToastMessage","t","_ref2","_useForm","mode","defaultValues","name","description","dueTimeInMinutes","control","getValues","_useForm$formState","formState","errors","isValid","isDirty","reset","nameField","_useController","rules","required","field","dueTimeField","_useController2","validate","value","Number","descField","_useController3","handleSave","_getValues","payload","async","_context","prev","next","undefined","abrupt","type","message","awrap","push","t0","stop","Promise","createElement","is","placeholder","flexGrow","error","display","flexDirection","justifyContent","w","inlineEnd","disabled","onClick","primary","mie"],"mappings":"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"}