)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/slaPolicies/SlaTable.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Pagination } from '@rocket.chat/fuselage';\nimport { useDebouncedValue, useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation, useEndpoint, useRouter } from '@rocket.chat/ui-contexts';\nimport { useQuery, hashQueryKey } from '@tanstack/react-query';\nimport type { MutableRefObject } from 'react';\nimport React, { useMemo, useState, useEffect } from 'react';\n\nimport FilterByText from '../../../../client/components/FilterByText';\nimport GenericNoResults from '../../../../client/components/GenericNoResults/GenericNoResults';\nimport {\n\tGenericTable,\n\tGenericTableHeaderCell,\n\tGenericTableHeader,\n\tGenericTableLoadingRow,\n\tGenericTableBody,\n\tGenericTableRow,\n\tGenericTableCell,\n} from '../../../../client/components/GenericTable';\nimport { usePagination } from '../../../../client/components/GenericTable/hooks/usePagination';\nimport { useSort } from '../../../../client/components/GenericTable/hooks/useSort';\nimport RemoveSlaButton from './RemoveSlaButton';\n\nconst SlaTable = ({ reload }: { reload: MutableRefObject<() => void> }) => {\n\tconst t = useTranslation();\n\tconst router = useRouter();\n\n\tconst [filter, setFilter] = useState('');\n\tconst debouncedFilter = useDebouncedValue(filter, 500);\n\n\tconst { current, itemsPerPage, setItemsPerPage: onSetItemsPerPage, setCurrent: onSetCurrent, ...paginationProps } = usePagination();\n\tconst { sortBy, sortDirection, setSort } = useSort<'name' | 'description' | 'dueTimeInMinutes'>('name');\n\n\tconst query = useMemo(\n\t\t() => ({\n\t\t\ttext: debouncedFilter,\n\t\t\tsort: JSON.stringify({ [sortBy]: sortDirection === 'asc' ? 1 : -1 }),\n\t\t\t...(itemsPerPage && { count: itemsPerPage }),\n\t\t\t...(current && { offset: current }),\n\t\t}),\n\t\t[debouncedFilter, itemsPerPage, current, sortBy, sortDirection],\n\t);\n\n\tconst getSlaData = useEndpoint('GET', '/v1/livechat/sla');\n\tconst { data, isSuccess, isLoading, refetch } = useQuery(['/v1/livechat/sla', query], () => getSlaData(query));\n\n\tconst [defaultQuery] = useState(hashQueryKey([query]));\n\tconst queryHasChanged = defaultQuery !== hashQueryKey([query]);\n\n\tuseEffect(() => {\n\t\treload.current = refetch;\n\t}, [reload, refetch]);\n\n\tconst handleAddNew = useMutableCallback(() => router.navigate('/omnichannel/sla-policies/new'));\n\tconst onRowClick = useMutableCallback((id) => () => router.navigate(`/omnichannel/sla-policies/edit/${id}`));\n\n\tconst headers = (\n\t\t<>\n\t\t\t<GenericTableHeaderCell key='name' direction={sortDirection} active={sortBy === 'name'} onClick={setSort} sort='name'>\n\t\t\t\t{t('Name')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell\n\t\t\t\tkey='description'\n\t\t\t\tdirection={sortDirection}\n\t\t\t\tactive={sortBy === 'description'}\n\t\t\t\tonClick={setSort}\n\t\t\t\tsort='description'\n\t\t\t>\n\t\t\t\t{t('Description')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell\n\t\t\t\tkey='dueTimeInMinutes'\n\t\t\t\tdirection={sortDirection}\n\t\t\t\tactive={sortBy === 'dueTimeInMinutes'}\n\t\t\t\tonClick={setSort}\n\t\t\t\tsort='dueTimeInMinutes'\n\t\t\t>\n\t\t\t\t{t('Estimated_wait_time')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell key='remove' w='x60'>\n\t\t\t\t{t('Remove')}\n\t\t\t</GenericTableHeaderCell>\n\t\t</>\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t{((isSuccess && data?.sla.length > 0) || queryHasChanged) && <FilterByText onChange={({ text }): void => setFilter(text)} />}\n\t\t\t{isLoading && (\n\t\t\t\t<GenericTable>\n\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t<GenericTableLoadingRow cols={4} />\n\t\t\t\t\t</GenericTableBody>\n\t\t\t\t</GenericTable>\n\t\t\t)}\n\t\t\t{isSuccess && data?.sla.length === 0 && queryHasChanged && <GenericNoResults />}\n\t\t\t{isSuccess && data?.sla.length === 0 && !queryHasChanged && (\n\t\t\t\t<GenericNoResults\n\t\t\t\t\ticon='flag'\n\t\t\t\t\ttitle={t('No_SLA_policies_yet')}\n\t\t\t\t\tdescription={t('No_SLA_policies_yet_description')}\n\t\t\t\t\tbuttonTitle={t('Create_SLA_policy')}\n\t\t\t\t\tbuttonAction={handleAddNew}\n\t\t\t\t\tlinkHref='https://go.rocket.chat/omnichannel-docs'\n\t\t\t\t\tlinkText={t('Learn_more_about_SLA_policies')}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t{isSuccess && data?.sla.length > 0 && (\n\t\t\t\t<>\n\t\t\t\t\t<GenericTable>\n\t\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t\t{data?.sla.map(({ _id, name, description, dueTimeInMinutes }) => (\n\t\t\t\t\t\t\t\t<GenericTableRow key={_id} tabIndex={0} role='link' onClick={onRowClick(_id)} action qa-user-id={_id}>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>{name}</GenericTableCell>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>{description}</GenericTableCell>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>\n\t\t\t\t\t\t\t\t\t\t{dueTimeInMinutes} {t('minutes')}\n\t\t\t\t\t\t\t\t\t</GenericTableCell>\n\t\t\t\t\t\t\t\t\t<RemoveSlaButton _id={_id} reload={refetch} />\n\t\t\t\t\t\t\t\t</GenericTableRow>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</GenericTableBody>\n\t\t\t\t\t</GenericTable>\n\t\t\t\t\t<Pagination\n\t\t\t\t\t\tdivider\n\t\t\t\t\t\tcurrent={current}\n\t\t\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\t\t\tcount={data?.total || 0}\n\t\t\t\t\t\tonSetItemsPerPage={onSetItemsPerPage}\n\t\t\t\t\t\tonSetCurrent={onSetCurrent}\n\t\t\t\t\t\t{...paginationProps}\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default SlaTable;\n",null],"names":["_extends","_objectSpread","_objectWithoutProperties","_slicedToArray","Pagination","useDebouncedValue","useMutableCallback","useTranslation","useEndpoint","useRouter","useQuery","hashQueryKey","React","useMemo","useState","useEffect","FilterByText","GenericNoResults","GenericTable","GenericTableHeaderCell","GenericTableHeader","GenericTableLoadingRow","GenericTableBody","GenericTableRow","GenericTableCell","usePagination","useSort","RemoveSlaButton","module","link","default","v","exportDefault","_ref","reload","t","router","_useState2","filter","setFilter","debouncedFilter","_usePagination","current","itemsPerPage","onSetItemsPerPage","setItemsPerPage","onSetCurrent","setCurrent","paginationProps","_excluded","_useSort","sortBy","sortDirection","setSort","query","_JSON$stringify","text","sort","JSON","stringify","count","offset","getSlaData","_useQuery","data","isSuccess","isLoading","refetch","queryHasChanged","defaultQuery","_useState4","handleAddNew","navigate","onRowClick","id","headers","createElement","Fragment","key","direction","active","onClick","w","sla","length","onChange","_ref2","cols","icon","title","description","buttonTitle","buttonAction","linkHref","linkText","map","_ref3","_id","name","dueTimeInMinutes","tabIndex","role","action","withTruncatedText","divider","total"],"mappings":"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"}