)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/reports/hooks/useTagsSection.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Palette } from '@rocket.chat/fuselage';\nimport { useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useQuery } from '@tanstack/react-query';\nimport { useMemo } from 'react';\n\nimport { getPeriodRange } from '../../../components/dashboards/periods';\nimport { usePeriodSelectorStorage } from '../../../components/dashboards/usePeriodSelectorStorage';\nimport { PERIOD_OPTIONS } from '../components/constants';\nimport { formatPeriodDescription } from '../utils/formatPeriodDescription';\nimport { useDefaultDownload } from './useDefaultDownload';\n\nconst colors = {\n\twarning: Palette.statusColor['status-font-on-warning'].toString(),\n\tdanger: Palette.statusColor['status-font-on-danger'].toString(),\n\tsuccess: Palette.statusColor['status-font-on-success'].toString(),\n\tinfo: Palette.statusColor['status-font-on-info'].toString(),\n};\n\nconst formatChartData = (data: { label: string; value: number }[] | undefined = []) =>\n\tdata.map((item) => ({\n\t\t...item,\n\t\tcolor: colors.info,\n\t}));\n\nexport const useTagsSection = () => {\n\tconst t = useTranslation();\n\tconst [period, periodSelectorProps] = usePeriodSelectorStorage('reports-tags-period', PERIOD_OPTIONS);\n\tconst getConversationsByTags = useEndpoint('GET', '/v1/livechat/analytics/dashboards/conversations-by-tags');\n\n\tconst {\n\t\tdata: { data, total = 0, unspecified = 0 } = { data: [], total: 0 },\n\t\trefetch,\n\t\tisLoading,\n\t\tisError,\n\t\tisSuccess,\n\t} = useQuery(\n\t\t['omnichannel-reports', 'conversations-by-tags', period],\n\t\tasync () => {\n\t\t\tconst { start, end } = getPeriodRange(period);\n\t\t\tconst response = await getConversationsByTags({ start: start.toISOString(), end: end.toISOString() });\n\t\t\treturn { ...response, data: formatChartData(response.data) };\n\t\t},\n\t\t{\n\t\t\trefetchInterval: 5 * 60 * 1000,\n\t\t},\n\t);\n\n\tconst title = t('Conversations_by_tag');\n\tconst subtitleTotals = t('__count__tags__and__count__conversations__period__', {\n\t\tcount: data.length,\n\t\tconversations: total,\n\t\tperiod: formatPeriodDescription(period, t),\n\t});\n\tconst subtitleUnspecified = unspecified > 0 ? `(${t('__count__without__tags__', { count: unspecified })})` : '';\n\tconst subtitle = `${subtitleTotals} ${subtitleUnspecified}`;\n\tconst emptyStateSubtitle = t('Omnichannel_Reports_Tags_Empty_Subtitle');\n\n\tconst downloadProps = useDefaultDownload({ columnName: t('Tags'), title, data, period });\n\n\treturn useMemo(\n\t\t() => ({\n\t\t\tid: 'conversations-by-tags',\n\t\t\ttitle,\n\t\t\tsubtitle,\n\t\t\temptyStateSubtitle,\n\t\t\tdata,\n\t\t\ttotal,\n\t\t\tperiod,\n\t\t\tperiodSelectorProps,\n\t\t\tdownloadProps,\n\t\t\tisError,\n\t\t\tisLoading,\n\t\t\tisDataFound: isSuccess && data.length > 0,\n\t\t\tonRetry: refetch,\n\t\t}),\n\t\t[title, subtitle, emptyStateSubtitle, data, total, isError, isLoading, isSuccess, periodSelectorProps, period, downloadProps, refetch],\n\t);\n};\n",null],"names":["module","default","_regeneratorRuntime","_slicedToArray","_objectSpread","export","useTagsSection","Palette","useEndpoint","useTranslation","useQuery","useMemo","getPeriodRange","usePeriodSelectorStorage","PERIOD_OPTIONS","formatPeriodDescription","useDefaultDownload","colors","warning","statusColor","toString","danger","success","info","formatChartData","data","map","item","color","t","_usePeriodSelectorSto2","period","periodSelectorProps","getConversationsByTags","_useQuery","_getPeriodRange","start","end","response","async","_context","prev","next","awrap","toISOString","sent","abrupt","stop","Promise","refetchInterval","_useQuery$data","total","_useQuery$data$total","_useQuery$data$unspec","unspecified","refetch","isLoading","isError","isSuccess","title","subtitle","subtitleTotals","count","length","conversations","emptyStateSubtitle","downloadProps","columnName","id","isDataFound","onRetry"],"mappings":"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"}