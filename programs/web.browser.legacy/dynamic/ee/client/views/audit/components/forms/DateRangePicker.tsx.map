)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/views/audit/components/forms/DateRangePicker.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Box, InputBox, Menu, Margins, Option } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation } from '@rocket.chat/ui-contexts';\nimport moment from 'moment';\nimport type { ReactElement, ComponentProps, SetStateAction } from 'react';\nimport React, { useMemo } from 'react';\n\nimport type { DateRange } from '../../utils/dateRange';\n\nconst formatToDateInput = (date: Date | undefined) => {\n\tif (!date) {\n\t\treturn '';\n\t}\n\n\tconst yearPart = date.getFullYear().toString().padStart(4, '0').slice(0, 4);\n\tconst monthPart = (date.getMonth() + 1).toString().padStart(2, '0').slice(0, 2);\n\tconst dayPart = date.getDate().toString().padStart(2, '0').slice(0, 2);\n\treturn `${yearPart}-${monthPart}-${dayPart}`;\n};\n\nconst parseFromStartDateInput = (date: string) => {\n\tif (!date) {\n\t\treturn undefined;\n\t}\n\n\treturn moment(date, 'YYYY-MM-DD').startOf('day').toDate();\n};\n\nconst parseFromEndDateInput = (date: string) => {\n\tif (!date) {\n\t\treturn undefined;\n\t}\n\n\treturn moment(date, 'YYYY-MM-DD').endOf('day').toDate();\n};\n\ntype DateRangeAction =\n\t| SetStateAction<DateRange>\n\t| 'today'\n\t| 'yesterday'\n\t| 'this-week'\n\t| 'last-week'\n\t| 'this-month'\n\t| 'last-month'\n\t| { newStart: string }\n\t| { newEnd: string };\n\nconst dateRangeReducer = (state: DateRange, action: DateRangeAction): DateRange => {\n\tswitch (action) {\n\t\tcase 'today': {\n\t\t\treturn {\n\t\t\t\tstart: moment().startOf('day').toDate(),\n\t\t\t\tend: moment().endOf('day').toDate(),\n\t\t\t};\n\t\t}\n\n\t\tcase 'yesterday': {\n\t\t\treturn {\n\t\t\t\tstart: moment().subtract(1, 'day').startOf('day').toDate(),\n\t\t\t\tend: moment().subtract(1, 'day').endOf('day').toDate(),\n\t\t\t};\n\t\t}\n\n\t\tcase 'this-week': {\n\t\t\treturn {\n\t\t\t\tstart: moment().startOf('week').toDate(),\n\t\t\t\tend: moment().endOf('day').toDate(),\n\t\t\t};\n\t\t}\n\n\t\tcase 'last-week': {\n\t\t\treturn {\n\t\t\t\tstart: moment().subtract(1, 'week').startOf('week').toDate(),\n\t\t\t\tend: moment().subtract(1, 'week').endOf('week').toDate(),\n\t\t\t};\n\t\t}\n\n\t\tcase 'this-month': {\n\t\t\treturn {\n\t\t\t\tstart: moment().startOf('month').toDate(),\n\t\t\t\tend: moment().endOf('day').toDate(),\n\t\t\t};\n\t\t}\n\n\t\tcase 'last-month': {\n\t\t\treturn {\n\t\t\t\tstart: moment().subtract(1, 'month').startOf('month').toDate(),\n\t\t\t\tend: moment().subtract(1, 'month').endOf('month').toDate(),\n\t\t\t};\n\t\t}\n\n\t\tdefault:\n\t\t\tif (typeof action === 'object' && 'newStart' in action) {\n\t\t\t\tif (action.newStart === formatToDateInput(state.start)) {\n\t\t\t\t\treturn state;\n\t\t\t\t}\n\n\t\t\t\treturn { ...state, start: parseFromStartDateInput(action.newStart) };\n\t\t\t}\n\n\t\t\tif (typeof action === 'object' && 'newEnd' in action) {\n\t\t\t\tif (action.newEnd === formatToDateInput(state.end)) {\n\t\t\t\t\treturn state;\n\t\t\t\t}\n\n\t\t\t\treturn { ...state, end: parseFromEndDateInput(action.newEnd) };\n\t\t\t}\n\n\t\t\tconst newState = typeof action === 'function' ? action(state) : action;\n\t\t\treturn newState;\n\t}\n};\n\ntype DateRangePickerProps = Omit<ComponentProps<typeof Box>, 'value' | 'onChange'> & {\n\tvalue?: DateRange;\n\tonChange?: (dateRange: DateRange) => void;\n};\n\nconst DateRangePicker = ({ value, onChange, ...props }: DateRangePickerProps): ReactElement => {\n\tconst dispatch = useMutableCallback((action: DateRangeAction): void => {\n\t\tconst newRange = dateRangeReducer(value ?? { start: undefined, end: undefined }, action);\n\t\tonChange?.(newRange);\n\t});\n\n\tconst handleChangeStart = useMutableCallback(({ currentTarget }) => {\n\t\tdispatch({ newStart: currentTarget.value });\n\t});\n\n\tconst handleChangeEnd = useMutableCallback(({ currentTarget }) => {\n\t\tdispatch({ newEnd: currentTarget.value });\n\t});\n\n\tconst startDate = useMemo(() => formatToDateInput(value?.start), [value?.start]);\n\tconst endDate = useMemo(() => formatToDateInput(value?.end), [value?.end]);\n\tconst maxStartDate = useMemo(() => {\n\t\treturn formatToDateInput(value?.end ? moment.min(moment(value.end), moment()).toDate() : new Date());\n\t}, [value?.end]);\n\tconst minEndDate = startDate;\n\tconst maxEndDate = useMemo(() => formatToDateInput(new Date()), []);\n\n\tconst t = useTranslation();\n\n\tconst presets = useMemo(\n\t\t() =>\n\t\t\t({\n\t\t\t\ttoday: {\n\t\t\t\t\tlabel: t('Today'),\n\t\t\t\t\taction: () => dispatch('today'),\n\t\t\t\t},\n\t\t\t\tyesterday: {\n\t\t\t\t\tlabel: t('Yesterday'),\n\t\t\t\t\taction: () => dispatch('yesterday'),\n\t\t\t\t},\n\t\t\t\tthisWeek: {\n\t\t\t\t\tlabel: t('This_week'),\n\t\t\t\t\taction: () => dispatch('this-week'),\n\t\t\t\t},\n\t\t\t\tpreviousWeek: {\n\t\t\t\t\tlabel: t('Previous_week'),\n\t\t\t\t\taction: () => dispatch('last-week'),\n\t\t\t\t},\n\t\t\t\tthisMonth: {\n\t\t\t\t\tlabel: t('This_month'),\n\t\t\t\t\taction: () => dispatch('this-month'),\n\t\t\t\t},\n\t\t\t\tlastMonth: {\n\t\t\t\t\tlabel: t('Previous_month'),\n\t\t\t\t\taction: () => dispatch('last-month'),\n\t\t\t\t},\n\t\t\t} as const),\n\t\t[dispatch, t],\n\t);\n\n\treturn (\n\t\t<Box marginInline={-4} {...props}>\n\t\t\t<Margins inline={4}>\n\t\t\t\t<InputBox type='date' value={startDate} max={maxStartDate} flexGrow={1} height={20} onChange={handleChangeStart} />\n\t\t\t\t<InputBox type='date' min={minEndDate} value={endDate} max={maxEndDate} flexGrow={1} height={20} onChange={handleChangeEnd} />\n\t\t\t\t<Menu\n\t\t\t\t\toptions={presets}\n\t\t\t\t\trenderItem={(props: ComponentProps<typeof Option>) => <Option icon='history' {...props} />}\n\t\t\t\t\talignSelf='center'\n\t\t\t\t/>\n\t\t\t</Margins>\n\t\t</Box>\n\t);\n};\n\nexport default DateRangePicker;\n",null],"names":["_extends","_objectWithoutProperties","_objectSpread","_typeof","Box","InputBox","Menu","Margins","Option","useMutableCallback","useTranslation","moment","React","useMemo","module","link","default","v","formatToDateInput","date","yearPart","getFullYear","toString","padStart","slice","getMonth","getDate","parseFromStartDateInput","startOf","toDate","parseFromEndDateInput","endOf","dateRangeReducer","state","action","start","end","subtract","newStart","newEnd","exportDefault","_ref","value","onChange","props","_excluded","dispatch","newRange","undefined","handleChangeStart","_ref2","currentTarget","handleChangeEnd","_ref3","startDate","endDate","maxStartDate","min","Date","maxEndDate","t","presets","today","label","yesterday","thisWeek","previousWeek","thisMonth","lastMonth","createElement","marginInline","inline","type","max","flexGrow","height","options","renderItem","icon","alignSelf"],"mappings":"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"}