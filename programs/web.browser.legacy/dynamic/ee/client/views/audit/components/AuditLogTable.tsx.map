)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/views/audit/components/AuditLogTable.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Field, FieldLabel, FieldRow } from '@rocket.chat/fuselage';\nimport { useTranslation, useMethod, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\nimport { useQuery } from '@tanstack/react-query';\nimport type { ReactElement } from 'react';\nimport React, { useState } from 'react';\n\nimport GenericNoResults from '../../../../../client/components/GenericNoResults';\nimport {\n\tGenericTable,\n\tGenericTableHeaderCell,\n\tGenericTableBody,\n\tGenericTableLoadingRow,\n\tGenericTableHeader,\n} from '../../../../../client/components/GenericTable';\nimport { createEndOfToday, createStartOfToday } from '../utils/dateRange';\nimport type { DateRange } from '../utils/dateRange';\nimport AuditLogEntry from './AuditLogEntry';\nimport DateRangePicker from './forms/DateRangePicker';\n\nconst AuditLogTable = (): ReactElement => {\n\tconst t = useTranslation();\n\n\tconst [dateRange, setDateRange] = useState<DateRange>(() => ({\n\t\tstart: createStartOfToday(),\n\t\tend: createEndOfToday(),\n\t}));\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst getAudits = useMethod('auditGetAuditions');\n\n\tconst { data, isLoading, isSuccess } = useQuery(\n\t\t['audits', dateRange],\n\t\tasync () => {\n\t\t\tconst { start, end } = dateRange;\n\t\t\treturn getAudits({ startDate: start ?? new Date(0), endDate: end ?? new Date() });\n\t\t},\n\t\t{\n\t\t\tonError: (error) => {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t},\n\t\t},\n\t);\n\n\tconst headers = (\n\t\t<>\n\t\t\t<GenericTableHeaderCell>{t('User')}</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell>{t('Looked_for')}</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell>{t('When')}</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell width={80}>{t('Results')}</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell>{t('Filters_applied')}</GenericTableHeaderCell>\n\t\t</>\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t<Field alignSelf='stretch'>\n\t\t\t\t<FieldLabel>{t('Date')}</FieldLabel>\n\t\t\t\t<FieldRow>\n\t\t\t\t\t<DateRangePicker display='flex' flexGrow={1} value={dateRange} onChange={setDateRange} />\n\t\t\t\t</FieldRow>\n\t\t\t</Field>\n\t\t\t{isLoading && (\n\t\t\t\t<GenericTable>\n\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t<GenericTableLoadingRow cols={4} />\n\t\t\t\t\t</GenericTableBody>\n\t\t\t\t</GenericTable>\n\t\t\t)}\n\t\t\t{isSuccess && data.length === 0 && <GenericNoResults />}\n\t\t\t{isSuccess && data.length > 0 && (\n\t\t\t\t<GenericTable>\n\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t{data.map((auditLog) => (\n\t\t\t\t\t\t\t<AuditLogEntry key={auditLog._id} value={auditLog} />\n\t\t\t\t\t\t))}\n\t\t\t\t\t</GenericTableBody>\n\t\t\t\t</GenericTable>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default AuditLogTable;\n",null],"names":["_regeneratorRuntime","_slicedToArray","Field","FieldLabel","FieldRow","useTranslation","useMethod","useToastMessageDispatch","useQuery","React","useState","GenericNoResults","GenericTable","GenericTableHeaderCell","GenericTableBody","GenericTableLoadingRow","GenericTableHeader","createEndOfToday","createStartOfToday","AuditLogEntry","DateRangePicker","module","link","default","v","exportDefault","t","_useState2","start","end","dateRange","setDateRange","dispatchToastMessage","getAudits","_useQuery","async","_context","prev","next","abrupt","startDate","Date","endDate","stop","Promise","onError","error","type","message","data","isLoading","isSuccess","headers","createElement","Fragment","width","alignSelf","display","flexGrow","value","onChange","cols","length","map","auditLog","key","_id"],"mappings":"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"}