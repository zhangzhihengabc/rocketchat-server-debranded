)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/views/admin/deviceManagement/DeviceManagementAdminTable/DeviceManagementAdminTable.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { DeviceManagementPopulatedSession, DeviceManagementSession, Serialized } from '@rocket.chat/core-typings';\nimport { useDebouncedValue, useMediaQuery } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement, MutableRefObject } from 'react';\nimport React, { useState, useMemo, useEffect } from 'react';\n\nimport FilterByText from '../../../../../../client/components/FilterByText';\nimport { GenericTableHeaderCell } from '../../../../../../client/components/GenericTable';\nimport { usePagination } from '../../../../../../client/components/GenericTable/hooks/usePagination';\nimport { useSort } from '../../../../../../client/components/GenericTable/hooks/useSort';\nimport { useEndpointData } from '../../../../../../client/hooks/useEndpointData';\nimport DeviceManagementTable from '../../../../components/deviceManagement/DeviceManagementTable';\nimport DeviceManagementAdminRow from './DeviceManagementAdminRow';\n\nconst sortMapping = {\n\tclient: 'device.name',\n\tusername: '_user.username',\n\tos: 'device.os.name',\n\tloginAt: 'loginAt',\n};\n\nconst isSessionPopulatedSession = (\n\tsession: Serialized<DeviceManagementPopulatedSession | DeviceManagementSession>,\n): session is Serialized<DeviceManagementPopulatedSession> => '_user' in session;\n\nconst DeviceManagementAdminTable = ({ reloadRef }: { reloadRef: MutableRefObject<() => void> }): ReactElement => {\n\tconst t = useTranslation();\n\tconst [text, setText] = useState('');\n\tconst { current, itemsPerPage, setCurrent, setItemsPerPage, ...paginationProps } = usePagination();\n\tconst { sortBy, sortDirection, setSort } = useSort<'client' | 'os' | 'username' | 'loginAt'>('username');\n\n\tconst query = useDebouncedValue(\n\t\tuseMemo(\n\t\t\t() => ({\n\t\t\t\tfilter: text,\n\t\t\t\tsort: JSON.stringify({ [sortMapping[sortBy]]: sortDirection === 'asc' ? 1 : -1 }),\n\t\t\t\tcount: itemsPerPage,\n\t\t\t\toffset: text ? undefined : current,\n\t\t\t}),\n\t\t\t[text, itemsPerPage, current, sortBy, sortDirection],\n\t\t),\n\t\t500,\n\t);\n\n\tconst { value: data, phase, error, reload } = useEndpointData('/v1/sessions/list.all', { params: query });\n\n\tuseEffect(() => {\n\t\treloadRef.current = reload;\n\t}, [reloadRef, reload]);\n\n\tconst mediaQuery = useMediaQuery('(min-width: 1024px)');\n\n\tconst headers = useMemo(\n\t\t() => [\n\t\t\t<GenericTableHeaderCell key='client' direction={sortDirection} active={sortBy === 'client'} onClick={setSort} sort='client'>\n\t\t\t\t{t('Client')}\n\t\t\t</GenericTableHeaderCell>,\n\t\t\t<GenericTableHeaderCell key='rcVersion'>{t('Version')}</GenericTableHeaderCell>,\n\t\t\t<GenericTableHeaderCell key='os' direction={sortDirection} active={sortBy === 'os'} onClick={setSort} sort='os'>\n\t\t\t\t{t('OS')}\n\t\t\t</GenericTableHeaderCell>,\n\t\t\t<GenericTableHeaderCell key='username' direction={sortDirection} active={sortBy === 'username'} onClick={setSort} sort='username'>\n\t\t\t\t{t('User')}\n\t\t\t</GenericTableHeaderCell>,\n\t\t\tmediaQuery && (\n\t\t\t\t<GenericTableHeaderCell key='loginAt' direction={sortDirection} active={sortBy === 'loginAt'} onClick={setSort} sort='loginAt'>\n\t\t\t\t\t{t('Last_login')}\n\t\t\t\t</GenericTableHeaderCell>\n\t\t\t),\n\t\t\tmediaQuery && <GenericTableHeaderCell key='_id'>{t('Device_ID')}</GenericTableHeaderCell>,\n\t\t\tmediaQuery && <GenericTableHeaderCell key='ip'>{t('IP_Address')}</GenericTableHeaderCell>,\n\t\t\t<GenericTableHeaderCell width='5%' key='menu' />,\n\t\t],\n\t\t[t, mediaQuery, setSort, sortDirection, sortBy],\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t<FilterByText placeholder={t('Search_Devices_Users')} onChange={({ text }): void => setText(text)} />\n\t\t\t<DeviceManagementTable\n\t\t\t\tdata={data}\n\t\t\t\tphase={phase}\n\t\t\t\terror={error}\n\t\t\t\treload={reload}\n\t\t\t\theaders={headers}\n\t\t\t\trenderRow={(session): ReactElement => (\n\t\t\t\t\t<DeviceManagementAdminRow\n\t\t\t\t\t\tkey={session._id}\n\t\t\t\t\t\t_id={session._id}\n\t\t\t\t\t\tusername={isSessionPopulatedSession(session) ? session._user?.username : ''}\n\t\t\t\t\t\tip={session.ip}\n\t\t\t\t\t\tdeviceName={session?.device?.name}\n\t\t\t\t\t\tdeviceType={session?.device?.type}\n\t\t\t\t\t\tdeviceOSName={session?.device?.os?.name}\n\t\t\t\t\t\trcVersion={session?.device?.version}\n\t\t\t\t\t\tloginAt={session.loginAt}\n\t\t\t\t\t\tonReload={reload}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\tcurrent={current}\n\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\tsetCurrent={setCurrent}\n\t\t\t\tsetItemsPerPage={setItemsPerPage}\n\t\t\t\tpaginationProps={paginationProps}\n\t\t\t/>\n\t\t</>\n\t);\n};\n\nexport default DeviceManagementAdminTable;\n",null],"names":["_objectWithoutProperties","_slicedToArray","useDebouncedValue","useMediaQuery","useTranslation","React","useState","useMemo","useEffect","FilterByText","GenericTableHeaderCell","usePagination","useSort","useEndpointData","DeviceManagementTable","DeviceManagementAdminRow","module","default","link","v","sortMapping","client","username","os","loginAt","exportDefault","_ref","reloadRef","t","_useState2","text","setText","_usePagination","current","itemsPerPage","setCurrent","setItemsPerPage","paginationProps","_excluded","_useSort","sortBy","sortDirection","setSort","_useEndpointData","params","_JSON$stringify","filter","sort","JSON","stringify","count","offset","undefined","data","value","phase","error","reload","mediaQuery","headers","createElement","key","direction","active","onClick","width","Fragment","placeholder","onChange","_ref2","renderRow","session","_session$_user","_session$device","_session$device2","_session$device3","_session$device3$os","_session$device4","_id","isSessionPopulatedSession","_user","ip","deviceName","device","name","deviceType","type","deviceOSName","rcVersion","version","onReload"],"mappings":"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"}