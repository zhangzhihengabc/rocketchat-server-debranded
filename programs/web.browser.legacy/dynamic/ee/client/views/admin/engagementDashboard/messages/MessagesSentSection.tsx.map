)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/views/admin/engagementDashboard/messages/MessagesSentSection.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { ResponsiveBar } from '@nivo/bar';\nimport { Box, Flex, Skeleton, Palette, Tooltip } from '@rocket.chat/fuselage';\nimport colors from '@rocket.chat/fuselage-tokens/colors.json';\nimport { useTranslation } from '@rocket.chat/ui-contexts';\nimport moment from 'moment';\nimport type { ReactElement } from 'react';\nimport React, { useMemo } from 'react';\n\nimport CounterSet from '../../../../../../client/components/dataView/CounterSet';\nimport DownloadDataButton from '../../../../components/dashboards/DownloadDataButton';\nimport PeriodSelector from '../../../../components/dashboards/PeriodSelector';\nimport { usePeriodLabel } from '../../../../components/dashboards/usePeriodLabel';\nimport { usePeriodSelectorState } from '../../../../components/dashboards/usePeriodSelectorState';\nimport EngagementDashboardCardFilter from '../EngagementDashboardCardFilter';\nimport { useMessagesSent } from './useMessagesSent';\n\nconst MessagesSentSection = (): ReactElement => {\n\tconst [period, periodSelectorProps] = usePeriodSelectorState('last 7 days', 'last 30 days', 'last 90 days');\n\tconst periodLabel = usePeriodLabel(period);\n\n\tconst t = useTranslation();\n\n\tconst { data } = useMessagesSent({ period });\n\n\tconst [countFromPeriod, variatonFromPeriod, countFromYesterday, variationFromYesterday, values] = useMemo(() => {\n\t\tif (!data) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst values = Array.from({ length: moment(data.end).diff(data.start, 'days') + 1 }, (_, i) => ({\n\t\t\tdate: moment(data.start).add(i, 'days').toISOString(),\n\t\t\tnewMessages: 0,\n\t\t}));\n\n\t\tfor (const { day, messages } of data.days ?? []) {\n\t\t\tconst i = moment(day).diff(data.start, 'days');\n\t\t\tif (i >= 0) {\n\t\t\t\tvalues[i].newMessages += messages;\n\t\t\t}\n\t\t}\n\n\t\treturn [data.period?.count, data.period?.variation, data.yesterday?.count, data.yesterday?.variation, values];\n\t}, [data]);\n\n\treturn (\n\t\t<>\n\t\t\t<EngagementDashboardCardFilter>\n\t\t\t\t<PeriodSelector {...periodSelectorProps} />\n\t\t\t\t<DownloadDataButton\n\t\t\t\t\tattachmentName={`MessagesSentSection_start_${data?.start}_end_${data?.end}`}\n\t\t\t\t\theaders={['Date', 'Messages']}\n\t\t\t\t\tdataAvailable={!!data}\n\t\t\t\t\tdataExtractor={(): unknown[][] | undefined => values?.map(({ date, newMessages }) => [date, newMessages])}\n\t\t\t\t/>\n\t\t\t</EngagementDashboardCardFilter>\n\n\t\t\t<CounterSet\n\t\t\t\tcounters={[\n\t\t\t\t\t{\n\t\t\t\t\t\tcount: countFromPeriod ?? <Skeleton variant='rect' width='3ex' height='1em' />,\n\t\t\t\t\t\tvariation: variatonFromPeriod ?? 0,\n\t\t\t\t\t\tdescription: periodLabel,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcount: countFromYesterday ?? <Skeleton variant='rect' width='3ex' height='1em' />,\n\t\t\t\t\t\tvariation: variationFromYesterday ?? 0,\n\t\t\t\t\t\tdescription: t('Yesterday'),\n\t\t\t\t\t},\n\t\t\t\t]}\n\t\t\t/>\n\t\t\t<Flex.Container>\n\t\t\t\t{values ? (\n\t\t\t\t\t<Box style={{ height: 240 }}>\n\t\t\t\t\t\t<Flex.Item align='stretch' grow={1} shrink={0}>\n\t\t\t\t\t\t\t<Box style={{ position: 'relative' }}>\n\t\t\t\t\t\t\t\t<Box\n\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\t\t\t\t\theight: '100%',\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<ResponsiveBar\n\t\t\t\t\t\t\t\t\t\tdata={values}\n\t\t\t\t\t\t\t\t\t\tindexBy='date'\n\t\t\t\t\t\t\t\t\t\tkeys={['newMessages']}\n\t\t\t\t\t\t\t\t\t\tgroupMode='grouped'\n\t\t\t\t\t\t\t\t\t\tpadding={0.25}\n\t\t\t\t\t\t\t\t\t\tmargin={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\tbottom: 20,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tcolors={[\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\tPalette.statusColor['status-font-on-info'].toString(),\n\t\t\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\t\t\tenableLabel={false}\n\t\t\t\t\t\t\t\t\t\tenableGridY={false}\n\t\t\t\t\t\t\t\t\t\taxisTop={null}\n\t\t\t\t\t\t\t\t\t\taxisRight={null}\n\t\t\t\t\t\t\t\t\t\taxisBottom={\n\t\t\t\t\t\t\t\t\t\t\t(values.length === 7 && {\n\t\t\t\t\t\t\t\t\t\t\t\ttickSize: 0,\n\t\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\t\ttickPadding: 4,\n\t\t\t\t\t\t\t\t\t\t\t\ttickRotation: 0,\n\t\t\t\t\t\t\t\t\t\t\t\tformat: (date): string => moment(date).format('dddd'),\n\t\t\t\t\t\t\t\t\t\t\t}) ||\n\t\t\t\t\t\t\t\t\t\t\tnull\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\taxisLeft={null}\n\t\t\t\t\t\t\t\t\t\tanimate={true}\n\t\t\t\t\t\t\t\t\t\tmotionConfig='stiff'\n\t\t\t\t\t\t\t\t\t\ttheme={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\taxis: {\n\t\t\t\t\t\t\t\t\t\t\t\tticks: {\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill: colors.n600,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontFamily:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Inter, -apple-system, system-ui, \"Segoe UI\", Roboto, Oxygen, Ubuntu, Cantarell, \"Helvetica Neue\", \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Meiryo UI\", Arial, sans-serif',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontSize: '10px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontStyle: 'normal',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontWeight: 600,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tletterSpacing: '0.2px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlineHeight: '12px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\ttooltip={({ value }) => <Tooltip>{t('Value_messages', { value })}</Tooltip>}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Flex.Item>\n\t\t\t\t\t</Box>\n\t\t\t\t) : (\n\t\t\t\t\t<Skeleton variant='rect' height={240} />\n\t\t\t\t)}\n\t\t\t</Flex.Container>\n\t\t</>\n\t);\n};\n\nexport default MessagesSentSection;\n",null],"names":["_createForOfIteratorHelperLoose","_slicedToArray","ResponsiveBar","Box","Flex","Skeleton","Palette","Tooltip","colors","useTranslation","moment","React","useMemo","CounterSet","DownloadDataButton","PeriodSelector","usePeriodLabel","usePeriodSelectorState","EngagementDashboardCardFilter","useMessagesSent","module","link","default","v","exportDefault","_usePeriodSelectorSta2","period","periodSelectorProps","periodLabel","t","data","_useMessagesSent","_useMemo2","_data$period","_data$period2","_data$yesterday","_data$yesterday2","_step","values","Array","from","length","end","diff","start","_","i","date","add","toISOString","newMessages","_iterator","_data$days","days","done","_ref","value","day","messages","count","variation","yesterday","countFromPeriod","variatonFromPeriod","countFromYesterday","variationFromYesterday","createElement","Fragment","attachmentName","headers","dataAvailable","dataExtractor","map","_ref2","counters","variant","width","height","description","Container","style","Item","align","grow","shrink","position","indexBy","keys","groupMode","padding","margin","bottom","statusColor","toString","enableLabel","enableGridY","axisTop","axisRight","axisBottom","tickSize","tickPadding","tickRotation","format","axisLeft","animate","motionConfig","theme","axis","ticks","text","fill","n600","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","tooltip","_ref3"],"mappings":"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"}