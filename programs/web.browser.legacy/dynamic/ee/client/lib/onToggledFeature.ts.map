)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/lib/onToggledFeature.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { LicenseModule } from '@rocket.chat/core-typings';\nimport { QueryObserver } from '@tanstack/react-query';\n\nimport { queryClient } from '../../../client/lib/queryClient';\nimport { fetchFeatures } from './fetchFeatures';\n\nexport const onToggledFeature = (\n\tfeature: LicenseModule,\n\t{\n\t\tup,\n\t\tdown,\n\t}: {\n\t\tup?: () => void;\n\t\tdown?: () => void;\n\t},\n): (() => void) => {\n\tconst observer = new QueryObserver(queryClient, {\n\t\tqueryKey: ['ee.features'],\n\t\tqueryFn: fetchFeatures,\n\t\tstaleTime: Infinity,\n\t});\n\n\tlet enabled = false;\n\n\treturn observer.subscribe((result) => {\n\t\tif (!result.isSuccess) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst features = result.data;\n\t\tconst hasFeature = features.includes(feature);\n\n\t\tif (!enabled && hasFeature) {\n\t\t\tup?.();\n\t\t\tenabled = true;\n\t\t}\n\n\t\tif (enabled && !hasFeature) {\n\t\t\tdown?.();\n\t\t\tenabled = false;\n\t\t}\n\t});\n};\n",null],"names":["module","export","onToggledFeature","QueryObserver","queryClient","fetchFeatures","feature","_ref","up","down","observer","queryKey","queryFn","staleTime","Infinity","enabled","subscribe","result","isSuccess","hasFeature","features","data","includes"],"mappings":"uBACAA,EAAOC,MAAE,CAAA,CAAAC,iBAAqB,WAAA,OAAAA,CAAwB,CAAA,GAAAF,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAG,cAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAH,EAAAA,IAAAA,CAAAA,kCAAAA,CAAAI,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAJ,EAAAA,IAAAA,CAAAA,kBAAAA,CAAAK,cAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAK/C,IAL+CF,EAAAC,EAAAC,EAKzCH,EAAmB,SAC/BI,CAAsB,CAAAC,CAAA,EAQL,IANhBC,EAAED,EAAFC,EAAE,CACFC,EAAIF,EAAJE,IAAI,CAMCC,EAAW,IAAIP,EAAcC,EAAa,CAC/CO,SAAU,CAAC,cAAc,CACzBC,QAASP,EACTQ,UAAWC,MAGRC,EAAU,CAAA,EAEd,OAAOL,EAASM,SAAS,CAAC,SAACC,CAAM,EAChC,GAAKA,EAAOC,SAAS,EAKrB,IAAMC,EAAaC,AADFH,EAAOI,IAAI,CACAC,QAAQ,CAAChB,EAEjC,EAACS,GAAWI,IACfX,MAAAA,GAAAA,IACAO,EAAU,CAAA,GAGPA,GAAW,CAACI,IACfV,MAAAA,GAAAA,IACAM,EAAU,CAAA,GAEZ,EACD"}