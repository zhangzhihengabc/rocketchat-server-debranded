)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/app/canned-responses/client/startup/responses.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { Tracker } from 'meteor/tracker';\n\nimport { hasPermission } from '../../../../../app/authorization/client';\nimport { settings } from '../../../../../app/settings/client';\nimport { sdk } from '../../../../../app/utils/client/lib/SDKClient';\nimport { CannedResponse } from '../collections/CannedResponse';\n\nconst events = {\n\tchanged: ({ type, ...response }) => {\n\t\tCannedResponse.upsert({ _id: response._id }, response);\n\t},\n\tremoved: (response) => CannedResponse.remove({ _id: response._id }),\n};\n\nMeteor.startup(() => {\n\tTracker.autorun(async (c) => {\n\t\tif (!Meteor.userId()) {\n\t\t\treturn;\n\t\t}\n\t\tif (!settings.get('Canned_Responses_Enable')) {\n\t\t\treturn;\n\t\t}\n\t\tif (!hasPermission('view-canned-responses')) {\n\t\t\treturn;\n\t\t}\n\t\tTracker.afterFlush(() => {\n\t\t\ttry {\n\t\t\t\t// TODO: check options\n\t\t\t\tsdk.stream('canned-responses', ['canned-responses'], (response, options) => {\n\t\t\t\t\tconst { agentsId } = options || {};\n\t\t\t\t\tif (Array.isArray(agentsId) && !agentsId.includes(Meteor.userId())) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tevents[response.type](response);\n\t\t\t\t});\n\t\t\t} catch (error) {\n\t\t\t\tconsole.log(error);\n\t\t\t}\n\t\t});\n\n\t\tconst { responses } = await sdk.rest.get('/v1/canned-responses.get');\n\t\tresponses.forEach((response) => CannedResponse.insert(response));\n\t\tc.stop();\n\t});\n});\n",null],"names":["_regeneratorRuntime","_objectWithoutProperties","Meteor","Tracker","hasPermission","settings","sdk","CannedResponse","module","link","default","v","events","changed","_ref","type","response","_excluded","upsert","_id","removed","remove","startup","autorun","c","async","_context","prev","next","userId","abrupt","get","afterFlush","stream","options","agentsId","_ref2","Array","isArray","includes","error","console","log","awrap","rest","responses","_await$sdk$rest$get","sent","forEach","insert","stop","Promise"],"mappings":"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"}