)]}'
{"version":3,"sources":["meteor://ðŸ’»app/app/webrtc/client/WebRTCClass.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Emitter } from '@rocket.chat/emitter';\nimport { Meteor } from 'meteor/meteor';\nimport { ReactiveVar } from 'meteor/reactive-var';\nimport { Tracker } from 'meteor/tracker';\n\nimport GenericModal from '../../../client/components/GenericModal';\nimport { imperativeModal } from '../../../client/lib/imperativeModal';\nimport { goToRoomById } from '../../../client/lib/utils/goToRoomById';\nimport { ChatSubscription } from '../../models/client';\nimport { Notifications } from '../../notifications/client';\nimport { settings } from '../../settings/client';\nimport { t } from '../../utils/lib/i18n';\nimport { WEB_RTC_EVENTS } from '../lib/constants';\nimport { ChromeScreenShare } from './screenShare';\n\nclass WebRTCTransportClass extends Emitter {\n\tconstructor(webrtcInstance) {\n\t\tsuper();\n\t\tthis.debug = false;\n\t\tthis.webrtcInstance = webrtcInstance;\n\t\tNotifications.onRoom(this.webrtcInstance.room, WEB_RTC_EVENTS.WEB_RTC, (type, data) => {\n\t\t\tthis.log('WebRTCTransportClass - onRoom', type, data);\n\t\t\tthis.emit(type, data);\n\t\t});\n\t}\n\n\tlog(...args) {\n\t\tif (this.debug === true) {\n\t\t\tconsole.log(...args);\n\t\t}\n\t}\n\n\tonUserStream(type, data) {\n\t\tif (data.room !== this.webrtcInstance.room) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.log('WebRTCTransportClass - onUser', type, data);\n\t\tthis.emit(type, data);\n\t}\n\n\tstartCall(data) {\n\t\tthis.log('WebRTCTransportClass - startCall', this.webrtcInstance.room, this.webrtcInstance.selfId);\n\t\tNotifications.notifyUsersOfRoom(this.webrtcInstance.room, WEB_RTC_EVENTS.WEB_RTC, WEB_RTC_EVENTS.CALL, {\n\t\t\tfrom: this.webrtcInstance.selfId,\n\t\t\troom: this.webrtcInstance.room,\n\t\t\tmedia: data.media,\n\t\t\tmonitor: data.monitor,\n\t\t});\n\t}\n\n\tjoinCall(data) {\n\t\tthis.log('WebRTCTransportClass - joinCall', this.webrtcInstance.room, this.webrtcInstance.selfId);\n\t\tif (data.monitor === true) {\n\t\t\tNotifications.notifyUser(data.to, WEB_RTC_EVENTS.WEB_RTC, WEB_RTC_EVENTS.JOIN, {\n\t\t\t\tfrom: this.webrtcInstance.selfId,\n\t\t\t\troom: this.webrtcInstance.room,\n\t\t\t\tmedia: data.media,\n\t\t\t\tmonitor: data.monitor,\n\t\t\t});\n\t\t} else {\n\t\t\tNotifications.notifyUsersOfRoom(this.webrtcInstance.room, WEB_RTC_EVENTS.WEB_RTC, WEB_RTC_EVENTS.JOIN, {\n\t\t\t\tfrom: this.webrtcInstance.selfId,\n\t\t\t\troom: this.webrtcInstance.room,\n\t\t\t\tmedia: data.media,\n\t\t\t\tmonitor: data.monitor,\n\t\t\t});\n\t\t}\n\t}\n\n\tsendCandidate(data) {\n\t\tdata.from = this.webrtcInstance.selfId;\n\t\tdata.room = this.webrtcInstance.room;\n\t\tthis.log('WebRTCTransportClass - sendCandidate', data);\n\t\tNotifications.notifyUser(data.to, WEB_RTC_EVENTS.WEB_RTC, WEB_RTC_EVENTS.CANDIDATE, data);\n\t}\n\n\tsendDescription(data) {\n\t\tdata.from = this.webrtcInstance.selfId;\n\t\tdata.room = this.webrtcInstance.room;\n\t\tthis.log('WebRTCTransportClass - sendDescription', data);\n\t\tNotifications.notifyUser(data.to, WEB_RTC_EVENTS.WEB_RTC, WEB_RTC_EVENTS.DESCRIPTION, data);\n\t}\n\n\tsendStatus(data) {\n\t\tthis.log('WebRTCTransportClass - sendStatus', data, this.webrtcInstance.room);\n\t\tdata.from = this.webrtcInstance.selfId;\n\t\tNotifications.notifyRoom(this.webrtcInstance.room, WEB_RTC_EVENTS.WEB_RTC, WEB_RTC_EVENTS.STATUS, data);\n\t}\n\n\tonRemoteCall(fn) {\n\t\treturn this.on(WEB_RTC_EVENTS.CALL, fn);\n\t}\n\n\tonRemoteJoin(fn) {\n\t\treturn this.on(WEB_RTC_EVENTS.JOIN, fn);\n\t}\n\n\tonRemoteCandidate(fn) {\n\t\treturn this.on(WEB_RTC_EVENTS.CANDIDATE, fn);\n\t}\n\n\tonRemoteDescription(fn) {\n\t\treturn this.on(WEB_RTC_EVENTS.DESCRIPTION, fn);\n\t}\n\n\tonRemoteStatus(fn) {\n\t\treturn this.on(WEB_RTC_EVENTS.STATUS, fn);\n\t}\n}\n\nclass WebRTCClass {\n\t/*\n  \t\t@param seldId {String}\n  \t\t@param room {String}\n   */\n\n\tconstructor(selfId, room, autoAccept = false) {\n\t\tthis.config = {\n\t\t\ticeServers: [],\n\t\t};\n\t\tthis.debug = false;\n\t\tthis.TransportClass = WebRTCTransportClass;\n\t\tthis.selfId = selfId;\n\t\tthis.room = room;\n\t\tlet servers = settings.get('WebRTC_Servers');\n\t\tif (servers && servers.trim() !== '') {\n\t\t\tservers = servers.replace(/\\s/g, '');\n\t\t\tservers = servers.split(',');\n\n\t\t\tservers.forEach((server) => {\n\t\t\t\tserver = server.split('@');\n\t\t\t\tconst serverConfig = {\n\t\t\t\t\turls: server.pop(),\n\t\t\t\t};\n\t\t\t\tif (server.length === 1) {\n\t\t\t\t\tserver = server[0].split(':');\n\t\t\t\t\tserverConfig.username = decodeURIComponent(server[0]);\n\t\t\t\t\tserverConfig.credential = decodeURIComponent(server[1]);\n\t\t\t\t}\n\t\t\t\tthis.config.iceServers.push(serverConfig);\n\t\t\t});\n\t\t}\n\t\tthis.peerConnections = {};\n\t\tthis.remoteItems = new ReactiveVar([]);\n\t\tthis.remoteItemsById = new ReactiveVar({});\n\t\tthis.callInProgress = new ReactiveVar(false);\n\t\tthis.audioEnabled = new ReactiveVar(false);\n\t\tthis.videoEnabled = new ReactiveVar(false);\n\t\tthis.overlayEnabled = new ReactiveVar(false);\n\t\tthis.screenShareEnabled = new ReactiveVar(false);\n\t\tthis.localUrl = new ReactiveVar();\n\t\tthis.active = false;\n\t\tthis.remoteMonitoring = false;\n\t\tthis.monitor = false;\n\t\tthis.autoAccept = autoAccept;\n\t\tthis.navigator = undefined;\n\t\tconst userAgent = navigator.userAgent.toLocaleLowerCase();\n\n\t\tif (userAgent.indexOf('electron') !== -1) {\n\t\t\tthis.navigator = 'electron';\n\t\t} else if (userAgent.indexOf('chrome') !== -1) {\n\t\t\tthis.navigator = 'chrome';\n\t\t} else if (userAgent.indexOf('firefox') !== -1) {\n\t\t\tthis.navigator = 'firefox';\n\t\t} else if (userAgent.indexOf('safari') !== -1) {\n\t\t\tthis.navigator = 'safari';\n\t\t}\n\n\t\tthis.screenShareAvailable = ['chrome', 'firefox', 'electron'].includes(this.navigator);\n\t\tthis.media = {\n\t\t\tvideo: true,\n\t\t\taudio: true,\n\t\t};\n\t\tthis.transport = new this.TransportClass(this);\n\t\tthis.transport.onRemoteCall(this.onRemoteCall.bind(this));\n\t\tthis.transport.onRemoteJoin(this.onRemoteJoin.bind(this));\n\t\tthis.transport.onRemoteCandidate(this.onRemoteCandidate.bind(this));\n\t\tthis.transport.onRemoteDescription(this.onRemoteDescription.bind(this));\n\t\tthis.transport.onRemoteStatus(this.onRemoteStatus.bind(this));\n\n\t\tsetInterval(this.checkPeerConnections.bind(this), 1000);\n\t}\n\n\tonUserStream(...args) {\n\t\treturn this.transport.onUserStream(...args);\n\t}\n\n\tlog(...args) {\n\t\tif (this.debug === true) {\n\t\t\tconsole.log.apply(console, args);\n\t\t}\n\t}\n\n\tonError(...args) {\n\t\tconsole.error.apply(console, args);\n\t}\n\n\tcheckPeerConnections() {\n\t\tconst { peerConnections } = this;\n\t\tconst date = Date.now();\n\t\tObject.entries(peerConnections).some(([id, peerConnection]) => {\n\t\t\tif (!['connected', 'completed'].includes(peerConnection.iceConnectionState) && peerConnection.createdAt + 5000 < date) {\n\t\t\t\tthis.stopPeerConnection(id);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t}\n\n\tupdateRemoteItems() {\n\t\tconst items = [];\n\t\tconst itemsById = {};\n\t\tconst { peerConnections } = this;\n\n\t\tObject.entries(peerConnections).forEach(([id, peerConnection]) => {\n\t\t\tpeerConnection.getRemoteStreams().forEach((remoteStream) => {\n\t\t\t\tconst item = {\n\t\t\t\t\tid,\n\t\t\t\t\turl: remoteStream,\n\t\t\t\t\tstate: peerConnection.iceConnectionState,\n\t\t\t\t};\n\t\t\t\tswitch (peerConnection.iceConnectionState) {\n\t\t\t\t\tcase 'checking':\n\t\t\t\t\t\titem.stateText = 'Connecting...';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'connected':\n\t\t\t\t\tcase 'completed':\n\t\t\t\t\t\titem.stateText = 'Connected';\n\t\t\t\t\t\titem.connected = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'disconnected':\n\t\t\t\t\t\titem.stateText = 'Disconnected';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'failed':\n\t\t\t\t\t\titem.stateText = 'Failed';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'closed':\n\t\t\t\t\t\titem.stateText = 'Closed';\n\t\t\t\t}\n\t\t\t\titems.push(item);\n\t\t\t\titemsById[id] = item;\n\t\t\t});\n\t\t});\n\t\tthis.remoteItems.set(items);\n\t\tthis.remoteItemsById.set(itemsById);\n\t}\n\n\tresetCallInProgress = () => {\n\t\tthis.callInProgress.set(false);\n\t};\n\n\tbroadcastStatus() {\n\t\tif (this.active !== true || this.monitor === true || this.remoteMonitoring === true) {\n\t\t\treturn;\n\t\t}\n\t\tconst remoteConnections = [];\n\t\tconst { peerConnections } = this;\n\t\tObject.keys(peerConnections).entries(([id, { remoteMedia: media }]) => {\n\t\t\tremoteConnections.push({\n\t\t\t\tid,\n\t\t\t\tmedia,\n\t\t\t});\n\t\t});\n\n\t\tthis.transport.sendStatus({\n\t\t\tmedia: this.media,\n\t\t\tremoteConnections,\n\t\t});\n\t}\n\n\t/*\n  \t\t@param data {Object}\n  \t\t\tfrom {String}\n  \t\t\tmedia {Object}\n  \t\t\tremoteConnections {Array[Object]}\n  \t\t\t\tid {String}\n  \t\t\t\tmedia {Object}\n   */\n\n\tonRemoteStatus(data) {\n\t\t// this.log(onRemoteStatus, arguments);\n\t\tthis.callInProgress.set(true);\n\t\tclearTimeout(this.callInProgressTimeout);\n\t\tthis.callInProgressTimeout = setTimeout(this.resetCallInProgress, 2000);\n\t\tif (this.active !== true) {\n\t\t\treturn;\n\t\t}\n\t\tconst remoteConnections = [\n\t\t\t{\n\t\t\t\tid: data.from,\n\t\t\t\tmedia: data.media,\n\t\t\t},\n\t\t\t...data.remoteConnections,\n\t\t];\n\n\t\tremoteConnections.forEach((remoteConnection) => {\n\t\t\tif (remoteConnection.id !== this.selfId && this.peerConnections[remoteConnection.id] == null) {\n\t\t\t\tthis.log('reconnecting with', remoteConnection.id);\n\t\t\t\tthis.onRemoteJoin({\n\t\t\t\t\tfrom: remoteConnection.id,\n\t\t\t\t\tmedia: remoteConnection.media,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\t/*\n  \t\t@param id {String}\n   */\n\n\tgetPeerConnection(id) {\n\t\tif (this.peerConnections[id] != null) {\n\t\t\treturn this.peerConnections[id];\n\t\t}\n\t\tconst peerConnection = new RTCPeerConnection(this.config);\n\n\t\tpeerConnection.createdAt = Date.now();\n\t\tpeerConnection.remoteMedia = {};\n\t\tthis.peerConnections[id] = peerConnection;\n\t\tconst eventNames = [\n\t\t\t'icecandidate',\n\t\t\t'addstream',\n\t\t\t'removestream',\n\t\t\t'iceconnectionstatechange',\n\t\t\t'datachannel',\n\t\t\t'identityresult',\n\t\t\t'idpassertionerror',\n\t\t\t'idpvalidationerror',\n\t\t\t'negotiationneeded',\n\t\t\t'peeridentity',\n\t\t\t'signalingstatechange',\n\t\t];\n\n\t\teventNames.forEach((eventName) => {\n\t\t\tpeerConnection.addEventListener(eventName, (e) => {\n\t\t\t\tthis.log(id, e.type, e);\n\t\t\t});\n\t\t});\n\n\t\tpeerConnection.addEventListener('icecandidate', (e) => {\n\t\t\tif (e.candidate == null) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.transport.sendCandidate({\n\t\t\t\tto: id,\n\t\t\t\tcandidate: {\n\t\t\t\t\tcandidate: e.candidate.candidate,\n\t\t\t\t\tsdpMLineIndex: e.candidate.sdpMLineIndex,\n\t\t\t\t\tsdpMid: e.candidate.sdpMid,\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t\tpeerConnection.addEventListener('addstream', () => {\n\t\t\tthis.updateRemoteItems();\n\t\t});\n\t\tpeerConnection.addEventListener('removestream', () => {\n\t\t\tthis.updateRemoteItems();\n\t\t});\n\t\tpeerConnection.addEventListener('iceconnectionstatechange', () => {\n\t\t\tif (\n\t\t\t\t(peerConnection.iceConnectionState === 'disconnected' || peerConnection.iceConnectionState === 'closed') &&\n\t\t\t\tpeerConnection === this.peerConnections[id]\n\t\t\t) {\n\t\t\t\tthis.stopPeerConnection(id);\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tif (Object.keys(this.peerConnections).length === 0) {\n\t\t\t\t\t\tthis.stop();\n\t\t\t\t\t}\n\t\t\t\t}, 3000);\n\t\t\t}\n\t\t\tthis.updateRemoteItems();\n\t\t});\n\t\treturn peerConnection;\n\t}\n\n\t_getUserMedia(media, onSuccess, onError) {\n\t\tconst onSuccessLocal = (stream) => {\n\t\t\tif (AudioContext && stream.getAudioTracks().length > 0) {\n\t\t\t\tconst audioContext = new AudioContext();\n\t\t\t\tconst source = audioContext.createMediaStreamSource(stream);\n\t\t\t\tconst volume = audioContext.createGain();\n\t\t\t\tsource.connect(volume);\n\t\t\t\tconst peer = audioContext.createMediaStreamDestination();\n\t\t\t\tvolume.connect(peer);\n\t\t\t\tvolume.gain.value = 0.6;\n\t\t\t\tstream.removeTrack(stream.getAudioTracks()[0]);\n\t\t\t\tstream.addTrack(peer.stream.getAudioTracks()[0]);\n\t\t\t\tstream.volume = volume;\n\t\t\t\tthis.audioContext = audioContext;\n\t\t\t}\n\t\t\tonSuccess(stream);\n\t\t};\n\t\tif (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n\t\t\treturn navigator.mediaDevices.getUserMedia(media).then(onSuccessLocal).catch(onError);\n\t\t}\n\n\t\tnavigator.getUserMedia(media, onSuccessLocal, onError);\n\t}\n\n\tgetUserMedia(media, onSuccess, onError = this.onError) {\n\t\tif (media.desktop !== true) {\n\t\t\tthis._getUserMedia(media, onSuccess, onError);\n\t\t\treturn;\n\t\t}\n\t\tif (this.screenShareAvailable !== true) {\n\t\t\tconsole.log('Screen share is not avaliable');\n\t\t\treturn;\n\t\t}\n\t\tconst getScreen = (audioStream) => {\n\t\t\tconst refresh = function () {\n\t\t\t\timperativeModal.open({\n\t\t\t\t\tcomponent: GenericModal,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tvariant: 'warning',\n\t\t\t\t\t\ttitle: t('Refresh_your_page_after_install_to_enable_screen_sharing'),\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tconst isChromeExtensionInstalled = this.navigator === 'chrome' && ChromeScreenShare.installed;\n\t\t\tconst isFirefoxExtensionInstalled = this.navigator === 'firefox' && window.rocketchatscreenshare != null;\n\n\t\t\tif (!isChromeExtensionInstalled && !isFirefoxExtensionInstalled) {\n\t\t\t\timperativeModal.open({\n\t\t\t\t\tcomponent: GenericModal,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\ttitle: t('Screen_Share'),\n\t\t\t\t\t\tvariant: 'warning',\n\t\t\t\t\t\tconfirmText: t('Install_Extension'),\n\t\t\t\t\t\tcancelText: t('Cancel'),\n\t\t\t\t\t\tchildren: t('You_need_install_an_extension_to_allow_screen_sharing'),\n\t\t\t\t\t\tonConfirm: () => {\n\t\t\t\t\t\t\tif (this.navigator === 'chrome') {\n\t\t\t\t\t\t\t\tconst url = 'https://chrome.google.com/webstore/detail/rocketchat-screen-share/nocfbnnmjnndkbipkabodnheejiegccf';\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tchrome.webstore.install(url, refresh, () => {\n\t\t\t\t\t\t\t\t\t\twindow.open(url);\n\t\t\t\t\t\t\t\t\t\trefresh();\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} catch (_error) {\n\t\t\t\t\t\t\t\t\tconsole.log(_error);\n\t\t\t\t\t\t\t\t\twindow.open(url);\n\t\t\t\t\t\t\t\t\trefresh();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if (this.navigator === 'firefox') {\n\t\t\t\t\t\t\t\twindow.open('https://addons.mozilla.org/en-GB/firefox/addon/rocketchat-screen-share/');\n\t\t\t\t\t\t\t\trefresh();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\treturn onError(false);\n\t\t\t}\n\n\t\t\tconst getScreenSuccess = (stream) => {\n\t\t\t\tif (audioStream != null) {\n\t\t\t\t\tstream.addTrack(audioStream.getAudioTracks()[0]);\n\t\t\t\t}\n\t\t\t\tonSuccess(stream);\n\t\t\t};\n\t\t\tif (this.navigator === 'firefox') {\n\t\t\t\tmedia = {\n\t\t\t\t\taudio: media.audio,\n\t\t\t\t\tvideo: {\n\t\t\t\t\t\tmozMediaSource: 'window',\n\t\t\t\t\t\tmediaSource: 'window',\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t\tthis._getUserMedia(media, getScreenSuccess, onError);\n\t\t\t} else {\n\t\t\t\tChromeScreenShare.getSourceId(this.navigator, (id) => {\n\t\t\t\t\tmedia = {\n\t\t\t\t\t\taudio: false,\n\t\t\t\t\t\tvideo: {\n\t\t\t\t\t\t\tmandatory: {\n\t\t\t\t\t\t\t\tchromeMediaSource: 'desktop',\n\t\t\t\t\t\t\t\tchromeMediaSourceId: id,\n\t\t\t\t\t\t\t\tmaxWidth: 1280,\n\t\t\t\t\t\t\t\tmaxHeight: 720,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t\tthis._getUserMedia(media, getScreenSuccess, onError);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t\tif (this.navigator === 'firefox' || media.audio == null || media.audio === false) {\n\t\t\tgetScreen();\n\t\t} else {\n\t\t\tconst getAudioSuccess = (audioStream) => {\n\t\t\t\tgetScreen(audioStream);\n\t\t\t};\n\t\t\tconst getAudioError = () => {\n\t\t\t\tgetScreen();\n\t\t\t};\n\n\t\t\tthis._getUserMedia(\n\t\t\t\t{\n\t\t\t\t\taudio: media.audio,\n\t\t\t\t},\n\t\t\t\tgetAudioSuccess,\n\t\t\t\tgetAudioError,\n\t\t\t);\n\t\t}\n\t}\n\n\t/*\n  \t\t@param callback {Function}\n   */\n\n\tgetLocalUserMedia(callback, ...args) {\n\t\tthis.log('getLocalUserMedia', [callback, ...args]);\n\t\tif (this.localStream != null) {\n\t\t\treturn callback(null, this.localStream);\n\t\t}\n\t\tconst onSuccess = (stream) => {\n\t\t\tthis.localStream = stream;\n\t\t\t!this.audioEnabled.get() && this.disableAudio();\n\t\t\t!this.videoEnabled.get() && this.disableVideo();\n\t\t\tthis.localUrl.set(stream);\n\t\t\tconst { peerConnections } = this;\n\t\t\tObject.entries(peerConnections).forEach(([, peerConnection]) => peerConnection.addStream(stream));\n\t\t\tdocument.querySelector('video#localVideo').srcObject = stream;\n\t\t\tcallback(null, this.localStream);\n\t\t};\n\t\tconst onError = (error) => {\n\t\t\tcallback(false);\n\t\t\tthis.onError(error);\n\t\t};\n\t\tthis.getUserMedia(this.media, onSuccess, onError);\n\t}\n\n\t/*\n  \t\t@param id {String}\n   */\n\n\tstopPeerConnection = (id) => {\n\t\tconst peerConnection = this.peerConnections[id];\n\t\tif (peerConnection == null) {\n\t\t\treturn;\n\t\t}\n\t\tdelete this.peerConnections[id];\n\t\tpeerConnection.close();\n\t\tthis.updateRemoteItems();\n\t};\n\n\tstopAllPeerConnections() {\n\t\tconst { peerConnections } = this;\n\n\t\tObject.keys(peerConnections).forEach(this.stopPeerConnection);\n\n\t\twindow.audioContext && window.audioContext.close();\n\t}\n\n\tsetAudioEnabled(enabled = true) {\n\t\tif (this.localStream != null) {\n\t\t\tthis.localStream.getAudioTracks().forEach((audio) => {\n\t\t\t\taudio.enabled = enabled;\n\t\t\t});\n\t\t\tthis.audioEnabled.set(enabled);\n\t\t}\n\t}\n\n\tdisableAudio() {\n\t\tthis.setAudioEnabled(false);\n\t}\n\n\tenableAudio() {\n\t\tthis.setAudioEnabled(true);\n\t}\n\n\ttoggleAudio() {\n\t\tif (this.audioEnabled.get()) {\n\t\t\treturn this.disableAudio();\n\t\t}\n\t\treturn this.enableAudio();\n\t}\n\n\tsetVideoEnabled(enabled = true) {\n\t\tif (this.localStream != null) {\n\t\t\tthis.localStream.getVideoTracks().forEach((video) => {\n\t\t\t\tvideo.enabled = enabled;\n\t\t\t});\n\t\t\tthis.videoEnabled.set(enabled);\n\t\t}\n\t}\n\n\tdisableScreenShare() {\n\t\tthis.setScreenShareEnabled(false);\n\t}\n\n\tenableScreenShare() {\n\t\tthis.setScreenShareEnabled(true);\n\t}\n\n\tsetScreenShareEnabled(enabled = true) {\n\t\tif (this.localStream != null) {\n\t\t\tthis.media.desktop = enabled;\n\t\t\tdelete this.localStream;\n\t\t\tthis.getLocalUserMedia((err) => {\n\t\t\t\tif (err != null) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.screenShareEnabled.set(enabled);\n\t\t\t\tthis.stopAllPeerConnections();\n\t\t\t\tthis.joinCall();\n\t\t\t});\n\t\t}\n\t}\n\n\tdisableVideo() {\n\t\tthis.setVideoEnabled(false);\n\t}\n\n\tenableVideo() {\n\t\tthis.setVideoEnabled(true);\n\t}\n\n\ttoggleVideo() {\n\t\tif (this.videoEnabled.get()) {\n\t\t\treturn this.disableVideo();\n\t\t}\n\t\treturn this.enableVideo();\n\t}\n\n\tstop() {\n\t\tthis.active = false;\n\t\tthis.monitor = false;\n\t\tthis.remoteMonitoring = false;\n\t\tif (this.localStream != null && typeof this.localStream !== 'undefined') {\n\t\t\tthis.localStream.getTracks().forEach((track) => track.stop());\n\t\t}\n\t\tthis.localUrl.set(undefined);\n\t\tdelete this.localStream;\n\t\tthis.stopAllPeerConnections();\n\t}\n\n\t/*\n  \t\t@param media {Object}\n  \t\t\taudio {Boolean}\n  \t\t\tvideo {Boolean}\n   */\n\n\tstartCall(media = {}, ...args) {\n\t\tthis.log('startCall', [media, ...args]);\n\t\tthis.media = media;\n\t\tthis.getLocalUserMedia(() => {\n\t\t\tthis.active = true;\n\t\t\tthis.transport.startCall({\n\t\t\t\tmedia: this.media,\n\t\t\t});\n\t\t});\n\t}\n\n\tstartCallAsMonitor(media = {}, ...args) {\n\t\tthis.log('startCallAsMonitor', [media, ...args]);\n\t\tthis.media = media;\n\t\tthis.active = true;\n\t\tthis.monitor = true;\n\t\tthis.transport.startCall({\n\t\t\tmedia: this.media,\n\t\t\tmonitor: true,\n\t\t});\n\t}\n\n\t/*\n  \t\t@param data {Object}\n  \t\t\tfrom {String}\n  \t\t\tmonitor {Boolean}\n  \t\t\tmedia {Object}\n  \t\t\t\taudio {Boolean}\n  \t\t\t\tvideo {Boolean}\n   */\n\n\tonRemoteCall(data) {\n\t\tif (this.autoAccept === true) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.joinCall({\n\t\t\t\t\tto: data.from,\n\t\t\t\t\tmonitor: data.monitor,\n\t\t\t\t\tmedia: data.media,\n\t\t\t\t});\n\t\t\t}, 0);\n\t\t\treturn;\n\t\t}\n\n\t\tconst user = Meteor.users.findOne(data.from);\n\t\tlet fromUsername = undefined;\n\t\tif (user && user.username) {\n\t\t\tfromUsername = user.username;\n\t\t}\n\t\tconst subscription = ChatSubscription.findOne({\n\t\t\trid: data.room,\n\t\t});\n\n\t\tlet icon;\n\t\tlet title;\n\t\tif (data.monitor === true) {\n\t\t\ticon = 'eye';\n\t\t\ttitle = t('WebRTC_monitor_call_from_%s', fromUsername);\n\t\t} else if (subscription && subscription.t === 'd') {\n\t\t\tif (data.media && data.media.video) {\n\t\t\t\ticon = 'videocam';\n\t\t\t\ttitle = t('WebRTC_direct_video_call_from_%s', fromUsername);\n\t\t\t} else {\n\t\t\t\ticon = 'phone';\n\t\t\t\ttitle = t('WebRTC_direct_audio_call_from_%s', fromUsername);\n\t\t\t}\n\t\t} else if (data.media && data.media.video) {\n\t\t\ticon = 'videocam';\n\t\t\ttitle = t('WebRTC_group_video_call_from_%s', subscription.name);\n\t\t} else {\n\t\t\ticon = 'phone';\n\t\t\ttitle = t('WebRTC_group_audio_call_from_%s', subscription.name);\n\t\t}\n\n\t\timperativeModal.open({\n\t\t\tcomponent: GenericModal,\n\t\t\tprops: {\n\t\t\t\ttitle,\n\t\t\t\ticon,\n\t\t\t\tconfirmText: t('Yes'),\n\t\t\t\tcancelText: t('No'),\n\t\t\t\tchildren: t('Do_you_want_to_accept'),\n\t\t\t\tonConfirm: () => {\n\t\t\t\t\tgoToRoomById(data.room);\n\t\t\t\t\treturn this.joinCall({\n\t\t\t\t\t\tto: data.from,\n\t\t\t\t\t\tmonitor: data.monitor,\n\t\t\t\t\t\tmedia: data.media,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tonCancel: () => this.stop(),\n\t\t\t\tonClose: () => this.stop(),\n\t\t\t},\n\t\t});\n\t}\n\n\t/*\n  \t\t@param data {Object}\n  \t\t\tto {String}\n  \t\t\tmonitor {Boolean}\n  \t\t\tmedia {Object}\n  \t\t\t\taudio {Boolean}\n  \t\t\t\tvideo {Boolean}\n  \t\t\t\tdesktop {Boolean}\n   */\n\n\tjoinCall(data = {}, ...args) {\n\t\tdata.media = this.media;\n\t\tthis.log('joinCall', [data, ...args]);\n\t\tthis.getLocalUserMedia(() => {\n\t\t\tthis.remoteMonitoring = data.monitor;\n\t\t\tthis.active = true;\n\t\t\tthis.transport.joinCall(data);\n\t\t});\n\t}\n\n\tonRemoteJoin(data, ...args) {\n\t\tif (this.active !== true) {\n\t\t\treturn;\n\t\t}\n\t\tthis.log('onRemoteJoin', [data, ...args]);\n\t\tlet peerConnection = this.getPeerConnection(data.from);\n\n\t\t// needsRefresh = false\n\t\t// if peerConnection.iceConnectionState isnt 'new'\n\t\t// needsAudio = data.media.audio is true and peerConnection.remoteMedia.audio isnt true\n\t\t// needsVideo = data.media.video is true and peerConnection.remoteMedia.video isnt true\n\t\t// needsRefresh = needsAudio or needsVideo or data.media.desktop isnt peerConnection.remoteMedia.desktop\n\n\t\t// # if peerConnection.signalingState is \"have-local-offer\" or needsRefresh\n\n\t\tif (peerConnection.signalingState !== 'checking') {\n\t\t\tthis.stopPeerConnection(data.from);\n\t\t\tpeerConnection = this.getPeerConnection(data.from);\n\t\t}\n\t\tif (peerConnection.iceConnectionState !== 'new') {\n\t\t\treturn;\n\t\t}\n\t\tpeerConnection.remoteMedia = data.media;\n\t\tif (this.localStream) {\n\t\t\tpeerConnection.addStream(this.localStream);\n\t\t}\n\t\tconst onOffer = (offer) => {\n\t\t\tconst onLocalDescription = () => {\n\t\t\t\tthis.transport.sendDescription({\n\t\t\t\t\tto: data.from,\n\t\t\t\t\ttype: 'offer',\n\t\t\t\t\tts: peerConnection.createdAt,\n\t\t\t\t\tmedia: this.media,\n\t\t\t\t\tdescription: {\n\t\t\t\t\t\tsdp: offer.sdp,\n\t\t\t\t\t\ttype: offer.type,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tpeerConnection.setLocalDescription(new RTCSessionDescription(offer), onLocalDescription, this.onError);\n\t\t};\n\n\t\tif (data.monitor === true) {\n\t\t\tpeerConnection.createOffer(onOffer, this.onError, {\n\t\t\t\tmandatory: {\n\t\t\t\t\tOfferToReceiveAudio: data.media.audio,\n\t\t\t\t\tOfferToReceiveVideo: data.media.video,\n\t\t\t\t},\n\t\t\t});\n\t\t} else {\n\t\t\tpeerConnection.createOffer(onOffer, this.onError);\n\t\t}\n\t}\n\n\tonRemoteOffer(data, ...args) {\n\t\tif (this.active !== true) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.log('onRemoteOffer', [data, ...args]);\n\t\tlet peerConnection = this.getPeerConnection(data.from);\n\n\t\tif (['have-local-offer', 'stable'].includes(peerConnection.signalingState) && peerConnection.createdAt < data.ts) {\n\t\t\tthis.stopPeerConnection(data.from);\n\t\t\tpeerConnection = this.getPeerConnection(data.from);\n\t\t}\n\n\t\tif (peerConnection.iceConnectionState !== 'new') {\n\t\t\treturn;\n\t\t}\n\n\t\tpeerConnection.setRemoteDescription(new RTCSessionDescription(data.description));\n\n\t\ttry {\n\t\t\tif (this.localStream) {\n\t\t\t\tpeerConnection.addStream(this.localStream);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.log(error);\n\t\t}\n\n\t\tconst onAnswer = (answer) => {\n\t\t\tconst onLocalDescription = () => {\n\t\t\t\tthis.transport.sendDescription({\n\t\t\t\t\tto: data.from,\n\t\t\t\t\ttype: 'answer',\n\t\t\t\t\tts: peerConnection.createdAt,\n\t\t\t\t\tdescription: {\n\t\t\t\t\t\tsdp: answer.sdp,\n\t\t\t\t\t\ttype: answer.type,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tpeerConnection.setLocalDescription(new RTCSessionDescription(answer), onLocalDescription, this.onError);\n\t\t};\n\n\t\tpeerConnection.createAnswer(onAnswer, this.onError);\n\t}\n\n\t/*\n  \t\t@param data {Object}\n  \t\t\tto {String}\n  \t\t\tfrom {String}\n  \t\t\tcandidate {RTCIceCandidate JSON encoded}\n   */\n\n\tonRemoteCandidate(data, ...args) {\n\t\tif (this.active !== true) {\n\t\t\treturn;\n\t\t}\n\t\tif (data.to !== this.selfId) {\n\t\t\treturn;\n\t\t}\n\t\tthis.log('onRemoteCandidate', [data, ...args]);\n\t\tconst peerConnection = this.getPeerConnection(data.from);\n\t\tif (\n\t\t\tpeerConnection.iceConnectionState !== 'closed' &&\n\t\t\tpeerConnection.iceConnectionState !== 'failed' &&\n\t\t\tpeerConnection.iceConnectionState !== 'disconnected' &&\n\t\t\tpeerConnection.iceConnectionState !== 'completed'\n\t\t) {\n\t\t\tpeerConnection.addIceCandidate(new RTCIceCandidate(data.candidate));\n\t\t}\n\t\tdocument.querySelector('video#remoteVideo').srcObject = this.remoteItems.get()[0]?.url;\n\t}\n\n\t/*\n  \t\t@param data {Object}\n  \t\t\tto {String}\n  \t\t\tfrom {String}\n  \t\t\ttype {String} [offer, answer]\n  \t\t\tdescription {RTCSessionDescription JSON encoded}\n  \t\t\tts {Integer}\n  \t\t\tmedia {Object}\n  \t\t\t\taudio {Boolean}\n  \t\t\t\tvideo {Boolean}\n  \t\t\t\tdesktop {Boolean}\n   */\n\n\tonRemoteDescription(data, ...args) {\n\t\tif (this.active !== true) {\n\t\t\treturn;\n\t\t}\n\t\tif (data.to !== this.selfId) {\n\t\t\treturn;\n\t\t}\n\t\tthis.log('onRemoteDescription', [data, ...args]);\n\t\tconst peerConnection = this.getPeerConnection(data.from);\n\t\tif (data.type === 'offer') {\n\t\t\tpeerConnection.remoteMedia = data.media;\n\t\t\tthis.onRemoteOffer({\n\t\t\t\tfrom: data.from,\n\t\t\t\tts: data.ts,\n\t\t\t\tdescription: data.description,\n\t\t\t});\n\t\t} else {\n\t\t\tpeerConnection.setRemoteDescription(new RTCSessionDescription(data.description));\n\t\t}\n\t}\n}\n\nconst WebRTC = new (class {\n\tconstructor() {\n\t\tthis.instancesByRoomId = {};\n\t}\n\n\tgetInstanceByRoomId(rid, visitorId = null) {\n\t\tlet enabled = false;\n\t\tif (!visitorId) {\n\t\t\tconst subscription = ChatSubscription.findOne({ rid });\n\t\t\tif (!subscription) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tswitch (subscription.t) {\n\t\t\t\tcase 'd':\n\t\t\t\t\tenabled = settings.get('WebRTC_Enable_Direct');\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'p':\n\t\t\t\t\tenabled = settings.get('WebRTC_Enable_Private');\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'c':\n\t\t\t\t\tenabled = settings.get('WebRTC_Enable_Channel');\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'l':\n\t\t\t\t\tenabled = settings.get('Omnichannel_call_provider') === 'WebRTC';\n\t\t\t}\n\t\t} else {\n\t\t\tenabled = settings.get('Omnichannel_call_provider') === 'WebRTC';\n\t\t}\n\t\tenabled = enabled && settings.get('WebRTC_Enabled');\n\t\tif (enabled === false) {\n\t\t\treturn;\n\t\t}\n\t\tif (this.instancesByRoomId[rid] == null) {\n\t\t\tlet uid = Meteor.userId();\n\t\t\tlet autoAccept = false;\n\t\t\tif (visitorId) {\n\t\t\t\tuid = visitorId;\n\t\t\t\tautoAccept = true;\n\t\t\t}\n\t\t\tthis.instancesByRoomId[rid] = new WebRTCClass(uid, rid, autoAccept);\n\t\t}\n\t\treturn this.instancesByRoomId[rid];\n\t}\n})();\n\nMeteor.startup(() => {\n\tTracker.autorun(() => {\n\t\tif (Meteor.userId()) {\n\t\t\tNotifications.onUser(WEB_RTC_EVENTS.WEB_RTC, (type, data) => {\n\t\t\t\tif (data.room == null) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst webrtc = WebRTC.getInstanceByRoomId(data.room);\n\t\t\t\twebrtc.onUserStream(type, data);\n\t\t\t});\n\t\t}\n\t});\n});\n\nexport { WebRTC };\n",null],"names":["module","link","default","v","_toConsumableArray","_slicedToArray","_inheritsLoose","export","WebRTC","Emitter","Meteor","ReactiveVar","Tracker","GenericModal","imperativeModal","goToRoomById","ChatSubscription","Notifications","settings","t","WEB_RTC_EVENTS","ChromeScreenShare","WebRTCTransportClass","_Emitter","webrtcInstance","_this","call","debug","onRoom","room","WEB_RTC","type","data","log","emit","_proto","prototype","_console","console","apply","arguments","onUserStream","startCall","selfId","notifyUsersOfRoom","CALL","from","media","monitor","joinCall","notifyUser","to","JOIN","sendCandidate","CANDIDATE","sendDescription","DESCRIPTION","sendStatus","notifyRoom","STATUS","onRemoteCall","fn","on","onRemoteJoin","onRemoteCandidate","onRemoteDescription","onRemoteStatus","WebRTCClass","_this2","autoAccept","length","undefined","resetCallInProgress","callInProgress","set","stopPeerConnection","id","peerConnection","peerConnections","close","updateRemoteItems","config","iceServers","TransportClass","servers","get","trim","replace","split","forEach","server","serverConfig","urls","pop","username","decodeURIComponent","credential","push","remoteItems","remoteItemsById","audioEnabled","videoEnabled","overlayEnabled","screenShareEnabled","localUrl","active","remoteMonitoring","navigator","userAgent","toLocaleLowerCase","indexOf","screenShareAvailable","includes","video","audio","transport","bind","setInterval","checkPeerConnections","_proto2","_this$transport","_len","args","Array","_key","onError","_len2","_key2","error","_this3","date","Date","now","Object","entries","some","_ref","_ref2","iceConnectionState","createdAt","items","itemsById","_ref3","_ref4","getRemoteStreams","remoteStream","item","url","state","stateText","connected","broadcastStatus","remoteConnections","keys","_ref5","_ref6","remoteMedia","_this4","clearTimeout","callInProgressTimeout","setTimeout","concat","remoteConnection","getPeerConnection","_this5","RTCPeerConnection","eventNames","eventName","addEventListener","e","candidate","sdpMLineIndex","sdpMid","stop","_getUserMedia","onSuccess","_this6","onSuccessLocal","stream","AudioContext","getAudioTracks","audioContext","source","createMediaStreamSource","volume","createGain","connect","peer","createMediaStreamDestination","gain","value","removeTrack","addTrack","mediaDevices","getUserMedia","then","catch","_this7","desktop","getScreen","audioStream","refresh","open","component","props","variant","title","isChromeExtensionInstalled","installed","isFirefoxExtensionInstalled","window","rocketchatscreenshare","confirmText","cancelText","children","onConfirm","chrome","webstore","install","_error","getScreenSuccess","mozMediaSource","mediaSource","getSourceId","mandatory","chromeMediaSource","chromeMediaSourceId","maxWidth","maxHeight","getLocalUserMedia","callback","_this8","_len3","_key3","localStream","disableAudio","disableVideo","_ref7","_ref8","addStream","document","querySelector","srcObject","stopAllPeerConnections","setAudioEnabled","enabled","enableAudio","toggleAudio","setVideoEnabled","getVideoTracks","disableScreenShare","setScreenShareEnabled","enableScreenShare","_this9","err","enableVideo","toggleVideo","getTracks","track","_this10","_len4","_key4","startCallAsMonitor","_len5","_key5","icon","_this11","user","users","findOne","fromUsername","subscription","rid","name","onCancel","onClose","_this12","_len6","_key6","_this13","_len7","_key7","signalingState","onOffer","offer","setLocalDescription","RTCSessionDescription","ts","description","sdp","createOffer","OfferToReceiveAudio","OfferToReceiveVideo","onRemoteOffer","_this14","_len8","_key8","setRemoteDescription","createAnswer","answer","_this$remoteItems$get","_len9","_key9","addIceCandidate","RTCIceCandidate","_len10","_key10","_class","instancesByRoomId","_proto3","getInstanceByRoomId","visitorId","uid","userId","startup","autorun","onUser","webrtc"],"mappings":"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"}