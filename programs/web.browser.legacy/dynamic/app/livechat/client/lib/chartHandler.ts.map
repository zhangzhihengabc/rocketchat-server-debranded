)]}'
{"version":3,"sources":["meteor://ðŸ’»app/app/livechat/client/lib/chartHandler.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { ChartItem, Chart as ChartType, ChartConfiguration } from 'chart.js';\n\nimport { t } from '../../../utils/lib/i18n';\n\ntype LineChartConfigOptions = Partial<{\n\tlegends: boolean;\n\tanim: boolean;\n\tdisplayColors: boolean;\n\ttooltipCallbacks: any;\n}>;\n\nconst lineChartConfiguration = ({\n\tlegends = false,\n\tanim = false,\n\ttooltipCallbacks = {},\n}: LineChartConfigOptions): Partial<ChartConfiguration<'line', number, string>['options']> => {\n\tconst config: ChartConfiguration<'line', number, string>['options'] = {\n\t\tlayout: {\n\t\t\tpadding: {\n\t\t\t\ttop: 10,\n\t\t\t\tbottom: 0,\n\t\t\t},\n\t\t},\n\t\tlegend: {\n\t\t\tdisplay: false,\n\t\t},\n\t\tplugins: {\n\t\t\ttooltip: {\n\t\t\t\tusePointStyle: true,\n\t\t\t\tenabled: true,\n\t\t\t\tmode: 'point',\n\t\t\t\tyAlign: 'bottom',\n\t\t\t\tdisplayColors: true,\n\t\t\t\t...tooltipCallbacks,\n\t\t\t},\n\t\t},\n\t\tscales: {\n\t\t\txAxis: {\n\t\t\t\ttitle: {\n\t\t\t\t\tdisplay: false,\n\t\t\t\t},\n\t\t\t\tgrid: {\n\t\t\t\t\tdisplay: true,\n\t\t\t\t\tcolor: 'rgba(0, 0, 0, 0.03)',\n\t\t\t\t},\n\t\t\t},\n\t\t\tyAxis: {\n\t\t\t\ttitle: {\n\t\t\t\t\tdisplay: false,\n\t\t\t\t},\n\t\t\t\tgrid: {\n\t\t\t\t\tdisplay: true,\n\t\t\t\t\tcolor: 'rgba(0, 0, 0, 0.03)',\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\thover: {\n\t\t\tintersect: false, // duration of animations when hovering an item\n\t\t\tmode: 'index',\n\t\t},\n\t\tresponsive: true,\n\t\tmaintainAspectRatio: false,\n\t\t...(!anim ? { animation: { duration: 0 } } : {}),\n\t\t...(legends ? { legend: { display: true, labels: { boxWidth: 20, fontSize: 8 } } } : {}),\n\t};\n\n\treturn config;\n};\n\nconst doughnutChartConfiguration = (\n\ttitle: string,\n\ttooltipCallbacks = {},\n): Partial<ChartConfiguration<'doughnut', number, string>['options']> => ({\n\tlayout: {\n\t\tpadding: {\n\t\t\ttop: 0,\n\t\t\tbottom: 0,\n\t\t},\n\t},\n\tplugins: {\n\t\tlegend: {\n\t\t\tdisplay: true,\n\t\t\tposition: 'right',\n\t\t\tlabels: {\n\t\t\t\tboxWidth: 20,\n\t\t\t},\n\t\t},\n\t\ttitle: {\n\t\t\tdisplay: true,\n\t\t\ttext: title,\n\t\t},\n\t\ttooltip: {\n\t\t\tenabled: true,\n\t\t\tmode: 'point',\n\t\t\tdisplayColors: true, // hide color box\n\t\t\t...tooltipCallbacks,\n\t\t},\n\t},\n\t// animation: {\n\t// \tduration: 0 // general animation time\n\t// },\n\thover: {\n\t\tintersect: true, // duration of animations when hovering an item\n\t},\n\tresponsive: true,\n\tmaintainAspectRatio: false,\n});\n\ntype ChartDataSet = {\n\tlabel: string;\n\tdata: number;\n\tbackgroundColor: string;\n\tborderColor: string;\n\tborderWidth: number;\n\tfill: boolean;\n};\n\n/**\n *\n * @param {Object} chart - chart element\n * @param {Object} chartContext - Context of chart\n * @param {Array(String)} chartLabel\n * @param {Array(String)} dataLabels\n * @param {Array(Array(Double))} dataPoints\n */\nexport const drawLineChart = async (\n\tchart: HTMLCanvasElement,\n\tchartContext: { destroy: () => void } | undefined,\n\tchartLabels: string[],\n\tdataLabels: string[],\n\tdataSets: number[],\n\toptions: LineChartConfigOptions = {},\n): Promise<ChartType<'line', number, string> | void> => {\n\tif (!chart) {\n\t\tconsole.error('No chart element');\n\t\treturn;\n\t}\n\tif (chartContext) {\n\t\tchartContext.destroy();\n\t}\n\tconst colors = ['#2de0a5', '#ffd21f', '#f5455c', '#cbced1'];\n\n\tconst datasets: ChartDataSet[] = [];\n\n\tchartLabels.forEach((chartLabel: string, index: number) => {\n\t\tdatasets.push({\n\t\t\tlabel: t(chartLabel), // chart label\n\t\t\tdata: dataSets[index], // data points corresponding to data labels, x-axis points\n\t\t\tbackgroundColor: colors[index],\n\t\t\tborderColor: colors[index],\n\t\t\tborderWidth: 3,\n\t\t\tfill: false,\n\t\t});\n\t});\n\tconst chartjs = await import('chart.js/auto');\n\tconst Chart = chartjs.default;\n\treturn new Chart(chart, {\n\t\ttype: 'line',\n\t\tdata: {\n\t\t\tlabels: dataLabels, // data labels, y-axis points\n\t\t\tdatasets,\n\t\t},\n\t\toptions: lineChartConfiguration(options),\n\t});\n};\n\n/**\n *\n * @param {Object} chart - chart element\n * @param {Object} chartContext - Context of chart\n * @param {Array(String)} dataLabels\n * @param {Array(Double)} dataPoints\n */\nexport const drawDoughnutChart = async (\n\tchart: ChartItem,\n\ttitle: string,\n\tchartContext: { destroy: () => void } | undefined,\n\tdataLabels: string[],\n\tdataPoints: number[],\n): Promise<ChartType<'doughnut', number[], string> | void> => {\n\tif (!chart) {\n\t\tconsole.error('No chart element');\n\t\treturn;\n\t}\n\tif (chartContext) {\n\t\tchartContext.destroy();\n\t}\n\tconst chartjs = await import('chart.js/auto');\n\tconst Chart = chartjs.default;\n\treturn new Chart(chart, {\n\t\ttype: 'doughnut',\n\t\tdata: {\n\t\t\tlabels: dataLabels, // data labels, y-axis points\n\t\t\tdatasets: [\n\t\t\t\t{\n\t\t\t\t\tdata: dataPoints, // data points corresponding to data labels, x-axis points\n\t\t\t\t\tbackgroundColor: ['#2de0a5', '#cbced1', '#f5455c', '#ffd21f'],\n\t\t\t\t\tborderWidth: 0,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\toptions: doughnutChartConfiguration(title),\n\t});\n};\n\n/**\n * Update chart\n * @param  {Object} chart [Chart context]\n * @param  {String} label [chart label]\n * @param  {Array(Double)} data  [updated data]\n */\nexport const updateChart = async (c: ChartType, label: string, data: { [x: string]: number }): Promise<void> => {\n\tconst chart = await c;\n\tif (chart.data?.labels?.indexOf(label) === -1) {\n\t\t// insert data\n\t\tchart.data.labels.push(label);\n\t\tchart.data.datasets.forEach((dataset: { data: any[] }, idx: string | number) => {\n\t\t\tdataset.data.push(data[idx]);\n\t\t});\n\t} else {\n\t\t// update data\n\t\tconst index = chart.data?.labels?.indexOf(label);\n\t\tif (typeof index === 'undefined') {\n\t\t\treturn;\n\t\t}\n\n\t\tchart.data.datasets.forEach((dataset: { data: { [x: string]: any } }, idx: string | number) => {\n\t\t\tdataset.data[index] = data[idx];\n\t\t});\n\t}\n\n\tchart.update();\n};\n",null],"names":["module","default","_regeneratorRuntime","_objectSpread","export","drawLineChart","drawDoughnutChart","updateChart","t","lineChartConfiguration","_ref","_ref$legends","legends","_ref$anim","anim","_ref$tooltipCallbacks","tooltipCallbacks","layout","padding","top","bottom","legend","display","plugins","tooltip","usePointStyle","enabled","mode","yAlign","displayColors","scales","xAxis","title","grid","color","yAxis","hover","intersect","responsive","maintainAspectRatio","animation","duration","labels","boxWidth","fontSize","doughnutChartConfiguration","arguments","length","undefined","position","text","chart","chartContext","chartLabels","dataLabels","dataSets","options","colors","datasets","Chart","_args","async","_context","prev","next","console","error","abrupt","destroy","forEach","chartLabel","index","push","label","data","backgroundColor","borderColor","borderWidth","fill","awrap","dynamicImport","chartjs","sent","type","stop","Promise","dataPoints","_context2","c","_chart$data","_chart$data$labels","_chart$data2","_chart$data2$labels","_context3","indexOf","dataset","idx","update"],"mappings":"uBAEkBA,EAAAA,IAAAA,CAAAA,6BAA0B,CAAAC,QAAAA,SAAAA,CAAAA,EAAAC,EAAAA,CAAA,CAAA,EAAA,GAAAF,EAAAA,IAAAA,CAAAA,uCAAAA,CAAAC,QAAAA,SAAAA,CAAAA,EAAAE,EAAAA,CAAA,CAAA,EAAA,GAA5CH,EAAOI,MAAK,CAAA,CAAAC,cAAM,WAAA,OAA0BA,CAAA,EAAAC,kBAAAA,WAAA,OAAAA,CAAA,EAAAC,YAAAA,WAAA,OAAAA,CAAA,CAAA,GAAAP,EAAAA,IAAAA,CAAAA,0BAAAA,CAAAQ,EAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAS5C,IATAN,EAA4CC,EAAAK,EAStCC,EAAyB,SAAAC,CAAA,EAI8D,IAAAC,EAAAD,EAH5FE,OAAO,CAAPA,EAAOD,AAAA,KAAA,IAAAA,GAAQA,EAAAE,EAAAH,EACfI,IAAI,CAAJA,EAAID,AAAA,KAAA,IAAAA,GAAQA,EAAAE,EAAAL,EACZM,gBAAgB,CAoDhB,OAlDYb,EAAAA,EAAA,CACXc,OAAQ,CACPC,QAAS,CACRC,IAAK,GACLC,OAAQ,IAGVC,OAAQ,CACPC,QAAS,CAAA,GAEVC,QAAS,CACRC,QAAOrB,EAAA,CACNsB,cAAe,CAAA,EACfC,QAAS,CAAA,EACTC,KAAM,QACNC,OAAQ,SACRC,cAAe,CAAA,CAAI,EAlBNd,AAAA,KAAA,IAAAA,EAAG,CAAA,EAAEA,IAsBpBe,OAAQ,CACPC,MAAO,CACNC,MAAO,CACNV,QAAS,CAAA,GAEVW,KAAM,CACLX,QAAS,CAAA,EACTY,MAAO,wBAGTC,MAAO,CACNH,MAAO,CACNV,QAAS,CAAA,GAEVW,KAAM,CACLX,QAAS,CAAA,EACTY,MAAO,yBAIVE,MAAO,CACNC,UAAW,CAAA,EACXV,KAAM,SAEPW,WAAY,CAAA,EACZC,oBAAqB,CAAA,CAAK,EACtB,AAACzB,EAAwC,CAAA,EAAjC,CAAE0B,UAAW,CAAEC,SAAU,CAAC,CAAE,GACpC7B,EAAU,CAAES,OAAQ,CAAEC,QAAS,CAAA,EAAMoB,OAAQ,CAAEC,SAAU,GAAIC,SAAU,CAAC,CAAE,CAAE,EAAK,CAAA,EAIvF,EAEMC,EAA6B,SAClCb,CAAa,EAAA,IACbhB,EAAgB8B,UAAAC,MAAA,CAAA,GAAAD,AAAAE,KAAAA,IAAAF,SAAA,CAAA,EAAA,CAAAA,SAAA,CAAA,EAAA,CAAG,CAAA,EAAE,MACoD,CACzE7B,OAAQ,CACPC,QAAS,CACRC,IAAK,EACLC,OAAQ,IAGVG,QAAS,CACRF,OAAQ,CACPC,QAAS,CAAA,EACT2B,SAAU,QACVP,OAAQ,CACPC,SAAU,KAGZX,MAAO,CACNV,QAAS,CAAA,EACT4B,KAAMlB,GAEPR,QAAOrB,EAAA,CACNuB,QAAS,CAAA,EACTC,KAAM,QACNE,cAAe,CAAA,CAAI,EAChBb,IAMLoB,MAAO,CACNC,UAAW,CAAA,GAEZC,WAAY,CAAA,EACZC,oBAAqB,CAAA,EACrB,EAmBYlC,EAAgB,SAC5B8C,CAAwB,CACxBC,CAAiD,CACjDC,CAAqB,CACrBC,CAAoB,CACpBC,CAAkB,EAAA,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAd,UAAA,OAAA5C,EAAA2D,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EACkB,GAApCR,EAAAA,EAAAA,MAAAA,CAAAA,GAAAA,KAAAA,IAAAA,CAAAA,CAAAA,EAAAA,CAAAA,CAAAA,CAAAA,EAAAA,CAAkC,CAAA,EAE7BL,EAAK,CAAAW,EAAAE,IAAA,CAAA,EAAA,KAAA,CACyB,OAAlCC,QAAQC,KAAK,CAAC,oBAAoBJ,EAAAK,MAAA,CAAA,SAAA,MAAA,EAmBhC,OAhBCf,GACHA,EAAagB,OAAO,GAEfX,EAAS,CAAC,UAAW,UAAW,UAAW,UAAU,CAErDC,EAA2B,EAAE,CAEnCL,EAAYgB,OAAO,CAAC,SAACC,CAAkB,CAAEC,CAAa,EACrDb,EAASc,IAAI,CAAC,CACbC,MAAOjE,EAAE8D,GACTI,KAAMnB,CAAQ,CAACgB,EAAM,CACrBI,gBAAiBlB,CAAM,CAACc,EAAM,CAC9BK,YAAanB,CAAM,CAACc,EAAM,CAC1BM,YAAa,EACbC,KAAM,CAAA,GAER,GAAGhB,EAAAE,IAAA,CAAA,GAAA9D,EAAA6E,KAAA,CACmB/E,EAAAgF,aAAA,CAAO,iBAAgB,MAAA,GAChB,OAAvBrB,EAAQsB,AADDnB,EAAAoB,IAAA,CACSjF,OAAO,CAAA6D,EAAAK,MAAA,CAAA,SACtB,IAAIR,EAAMR,EAAO,CACvBgC,KAAM,OACNT,KAAM,CACLhC,OAAQY,EACRI,SAAAA,GAEDF,QAAS/C,EAAuB+C,KAC/B,MAAA,GAAA,IAAA,MAAA,OAAAM,EAAAsB,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,EAUU/E,EAAoB,SAChC6C,CAAgB,CAChBnB,CAAa,CACboB,CAAiD,CACjDE,CAAoB,CACpBgC,CAAoB,EAAA,IAAA3B,EAAA,OAAAzD,EAAA2D,KAAA,CAAA,SAAA0B,CAAA,EAAA,OAAA,OAAAA,EAAAxB,IAAA,CAAAwB,EAAAvB,IAAA,EAAA,KAAA,EAAA,GAEfb,EAAK,CAAAoC,EAAAvB,IAAA,CAAA,EAAA,KAAA,CACyB,OAAlCC,QAAQC,KAAK,CAAC,oBAAoBqB,EAAApB,MAAA,CAAA,SAAA,MAAA,EAKlC,OAFGf,GACHA,EAAagB,OAAO,GACpBmB,EAAAvB,IAAA,CAAA,EAAA9D,EAAA6E,KAAA,CACqB/E,EAAAgF,aAAA,CAAO,iBAAgB,MAAA,EAChB,OAAvBrB,EAAQsB,AADDM,EAAAL,IAAA,CACSjF,OAAO,CAAAsF,EAAApB,MAAA,CAAA,SACtB,IAAIR,EAAMR,EAAO,CACvBgC,KAAM,WACNT,KAAM,CACLhC,OAAQY,EACRI,SAAU,CACT,CACCgB,KAAMY,EACNX,gBAAiB,CAAC,UAAW,UAAW,UAAW,UAAU,CAC7DE,YAAa,GACb,EAGHrB,QAASX,EAA2Bb,KACnC,MAAA,EAAA,IAAA,MAAA,OAAAuD,EAAAH,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,EASU9E,EAAc,SAAOiF,CAAY,CAAEf,CAAa,CAAEC,CAA6B,MAAAe,EAAAC,EAAAvC,EAAAwC,EAAAC,EAAArB,EAAA,OAAArE,EAAA2D,KAAA,CAAA,SAAAgC,CAAA,EAAA,OAAA,OAAAA,EAAA9B,IAAA,CAAA8B,EAAA7B,IAAA,EAAA,KAAA,EAAA,OAAA6B,EAAA7B,IAAA,CAAA,EAAA9D,EAAA6E,KAAA,CACvES,EAAC,MAAA,EAAV,GAAA,AACP,CAAA,AAAU,OAAVC,CAAAA,EAAAtC,AADEA,CAAAA,EAAK0C,EAAAX,IAAA,EACDR,IAAI,AAAJA,GAAIe,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAA,AAAQ,OAARC,CAAAA,EAAVD,EAAY/C,MAAM,AAANA,GAAMgD,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAlBA,EAAoBI,OAAO,CAACrB,EAAK,IAAM,GAAE,CAAAoB,EAAA7B,IAAA,CAAA,EAAA,KAAA,CAE5Cb,EAAMuB,IAAI,CAAChC,MAAM,CAAC8B,IAAI,CAACC,GACvBtB,EAAMuB,IAAI,CAAChB,QAAQ,CAACW,OAAO,CAAC,SAAC0B,CAAwB,CAAEC,CAAoB,EAC1ED,EAAQrB,IAAI,CAACF,IAAI,CAACE,CAAI,CAACsB,EAAI,CAC5B,GAAGH,EAAA7B,IAAA,CAAA,GAAA,KAAA,MAAA,EAG6C,GAAA,AAC3B,KAAA,IADfO,CAAAA,EAAK,AAAa,OAAboB,CAAAA,EAAGxC,EAAMuB,IAAI,AAAJA,GAAIiB,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAA,AAAQ,OAARC,CAAAA,EAAVD,EAAYjD,MAAM,AAANA,GAAMkD,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAlBA,EAAoBE,OAAO,CAACrB,EAAK,EACf,CAAAoB,EAAA7B,IAAA,CAAA,GAAA,KAAA,CAAA,OAAA6B,EAAA1B,MAAA,CAAA,SAAA,MAAA,GAIhChB,EAAMuB,IAAI,CAAChB,QAAQ,CAACW,OAAO,CAAC,SAAC0B,CAAuC,CAAEC,CAAoB,EACzFD,EAAQrB,IAAI,CAACH,EAAM,CAAGG,CAAI,CAACsB,EAAI,AAChC,EAAG,MAAA,GAGJ7C,EAAM8C,MAAM,EAAG,MAAA,GAAA,IAAA,MAAA,OAAAJ,EAAAT,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA"}