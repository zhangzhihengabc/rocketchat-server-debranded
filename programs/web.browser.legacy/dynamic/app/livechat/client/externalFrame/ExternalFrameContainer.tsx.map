)]}'
{"version":3,"sources":["meteor://ðŸ’»app/app/livechat/client/externalFrame/ExternalFrameContainer.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useSetting, useUserId } from '@rocket.chat/ui-contexts';\nimport { useQuery } from '@tanstack/react-query';\nimport React, { useMemo } from 'react';\n\nimport { useRoom } from '../../../../client/views/room/contexts/RoomContext';\nimport { sdk } from '../../../utils/client/lib/SDKClient';\nimport { encrypt, getKeyFromString } from './crypto';\n\nconst ExternalFrameContainer = () => {\n\tconst uid = useUserId();\n\tconst room = useRoom();\n\tconst { 'X-Auth-Token': authToken } = sdk.rest.getCredentials() || {};\n\tconst keyStr = useSetting<string>('Omnichannel_External_Frame_Encryption_JWK');\n\tconst frameURLSetting = useSetting<string>('Omnichannel_External_Frame_URL');\n\n\tconst token = useQuery(['externalFrame', keyStr, authToken], async () => {\n\t\tif (!keyStr || !authToken) {\n\t\t\treturn '';\n\t\t}\n\t\treturn encrypt(authToken, await getKeyFromString(keyStr));\n\t});\n\n\tconst externalFrameUrl = useMemo(() => {\n\t\tif (!frameURLSetting || !uid || !room._id || !authToken || !token.data) {\n\t\t\treturn '';\n\t\t}\n\t\tconst frameURL = new URL(frameURLSetting);\n\n\t\tframeURL.searchParams.append('uid', uid);\n\t\tframeURL.searchParams.append('rid', room._id);\n\t\tframeURL.searchParams.append('t', authToken);\n\n\t\treturn frameURL.toString();\n\t}, [frameURLSetting, uid, room._id, authToken, token.data]);\n\n\tif (!externalFrameUrl) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<div className='flex-nav'>\n\t\t\t<iframe className='external-frame' src={externalFrameUrl} />\n\t\t</div>\n\t);\n};\n\nexport default ExternalFrameContainer;\n",null],"names":["_regeneratorRuntime","useSetting","useUserId","useQuery","React","useMemo","useRoom","sdk","encrypt","getKeyFromString","module","link","default","v","exportDefault","uid","room","authToken","_ref","rest","getCredentials","keyStr","frameURLSetting","token","async","_context","prev","next","abrupt","t0","t1","awrap","t2","sent","stop","Promise","externalFrameUrl","_id","data","frameURL","URL","searchParams","append","toString","createElement","className","src"],"mappings":"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"}