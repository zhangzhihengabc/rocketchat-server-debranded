)]}'
{"version":3,"sources":["meteor://ðŸ’»app/app/message-mark-as-unread/client/actionButton.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Meteor } from 'meteor/meteor';\n\nimport { roomCoordinator } from '../../../client/lib/rooms/roomCoordinator';\nimport { dispatchToastMessage } from '../../../client/lib/toast';\nimport { messageArgs } from '../../../client/lib/utils/messageArgs';\nimport { router } from '../../../client/providers/RouterProvider';\nimport { ChatSubscription } from '../../models/client';\nimport { LegacyRoomManager, MessageAction } from '../../ui-utils/client';\nimport { sdk } from '../../utils/client/lib/SDKClient';\n\nMeteor.startup(() => {\n\tMessageAction.addButton({\n\t\tid: 'mark-message-as-unread',\n\t\ticon: 'flag',\n\t\tlabel: 'Mark_unread',\n\t\tcontext: ['message', 'message-mobile', 'threads'],\n\t\ttype: 'interaction',\n\t\tasync action(_, props) {\n\t\t\tconst { message = messageArgs(this).msg } = props;\n\n\t\t\ttry {\n\t\t\t\tawait sdk.call('unreadMessages', message);\n\t\t\t\tconst subscription = ChatSubscription.findOne({\n\t\t\t\t\trid: message.rid,\n\t\t\t\t});\n\n\t\t\t\tif (subscription == null) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tawait LegacyRoomManager.close(subscription.t + subscription.name);\n\t\t\t\treturn router.navigate('/home');\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t},\n\t\tcondition({ message, user, room }) {\n\t\t\tconst isLivechatRoom = roomCoordinator.isLivechatRoom(room.t);\n\t\t\tif (isLivechatRoom) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!user) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn message.u._id !== user._id;\n\t\t},\n\t\torder: 4,\n\t\tgroup: 'menu',\n\t});\n});\n",null],"names":["_regeneratorRuntime","Meteor","roomCoordinator","dispatchToastMessage","messageArgs","router","ChatSubscription","LegacyRoomManager","MessageAction","sdk","module","default","link","startup","addButton","id","icon","label","context","type","action","_","props","_props$message","message","subscription","async","_context","prev","next","msg","awrap","call","findOne","rid","abrupt","close","t","name","navigate","t0","stop","Promise","condition","_ref","user","room","isLivechatRoom","u","_id","order","group"],"mappings":"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"}