)]}'
{"version":3,"sources":["meteor://ðŸ’»app/app/wordpress/client/lib.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { OauthConfig } from '@rocket.chat/core-typings';\nimport { Meteor } from 'meteor/meteor';\nimport { Tracker } from 'meteor/tracker';\nimport _ from 'underscore';\n\nimport { CustomOAuth } from '../../custom-oauth/client/custom_oauth_client';\nimport { settings } from '../../settings/client';\n\nconst config: OauthConfig = {\n\tserverURL: '',\n\tidentityPath: '/oauth/me',\n\n\taddAutopublishFields: {\n\t\tforLoggedInUser: ['services.wordpress'],\n\t\tforOtherUsers: ['services.wordpress.user_login'],\n\t},\n\taccessTokenParam: 'access_token',\n};\n\nconst WordPress = new CustomOAuth('wordpress', config);\n\nconst fillSettings = _.debounce(async (): Promise<void> => {\n\tconfig.serverURL = settings.get('API_Wordpress_URL');\n\tif (!config.serverURL) {\n\t\tif (config.serverURL === undefined) {\n\t\t\treturn fillSettings();\n\t\t}\n\t\treturn;\n\t}\n\n\tdelete config.identityPath;\n\tdelete config.identityTokenSentVia;\n\tdelete config.authorizePath;\n\tdelete config.tokenPath;\n\tdelete config.scope;\n\n\tconst serverType = settings.get('Accounts_OAuth_Wordpress_server_type');\n\tswitch (serverType) {\n\t\tcase 'custom':\n\t\t\tif (settings.get('Accounts_OAuth_Wordpress_identity_path')) {\n\t\t\t\tconfig.identityPath = settings.get('Accounts_OAuth_Wordpress_identity_path');\n\t\t\t}\n\n\t\t\tif (settings.get('Accounts_OAuth_Wordpress_identity_token_sent_via')) {\n\t\t\t\tconfig.identityTokenSentVia = settings.get('Accounts_OAuth_Wordpress_identity_token_sent_via');\n\t\t\t}\n\n\t\t\tif (settings.get('Accounts_OAuth_Wordpress_token_path')) {\n\t\t\t\tconfig.tokenPath = settings.get('Accounts_OAuth_Wordpress_token_path');\n\t\t\t}\n\n\t\t\tif (settings.get('Accounts_OAuth_Wordpress_authorize_path')) {\n\t\t\t\tconfig.authorizePath = settings.get('Accounts_OAuth_Wordpress_authorize_path');\n\t\t\t}\n\n\t\t\tif (settings.get('Accounts_OAuth_Wordpress_scope')) {\n\t\t\t\tconfig.scope = settings.get('Accounts_OAuth_Wordpress_scope');\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'wordpress-com':\n\t\t\tconfig.identityPath = 'https://public-api.wordpress.com/rest/v1/me';\n\t\t\tconfig.identityTokenSentVia = 'header';\n\t\t\tconfig.authorizePath = 'https://public-api.wordpress.com/oauth2/authorize';\n\t\t\tconfig.tokenPath = 'https://public-api.wordpress.com/oauth2/token';\n\t\t\tconfig.scope = 'auth';\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tconfig.identityPath = '/oauth/me';\n\t\t\tbreak;\n\t}\n\n\tconst result = WordPress.configure(config);\n\treturn result;\n}, 100);\n\nMeteor.startup(() => {\n\treturn Tracker.autorun(() => {\n\t\treturn fillSettings();\n\t});\n});\n",null],"names":["module","default","_regeneratorRuntime","link","Meteor","Tracker","v","_","CustomOAuth","settings","config","serverURL","identityPath","addAutopublishFields","forLoggedInUser","forOtherUsers","accessTokenParam","WordPress","fillSettings","debounce","serverType","result","async","_context","prev","next","get","undefined","abrupt","identityTokenSentVia","authorizePath","tokenPath","scope","t0","configure","stop","Promise","startup","autorun"],"mappings":"uBACuBA,EAAAA,IAAAA,CAAAA,6BAAgB,CAAAC,QAAAA,SAAAA,CAAAA,EAAAC,EAAAA,CAAA,CAAA,EAAA,GAA9BF,EAAQG,IAAA,CAAM,gBAAgB,CAAAC,OAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAJ,EAAAA,IAAAA,CAAAA,iBAAAA,CAAAK,QAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAL,EAAAA,IAAAA,CAAAA,aAAAA,CAAA,QAAA,SAAAM,CAAA,EAAAC,EAAAA,CAAA,CAAA,EAAA,GAAAP,EAAAA,IAAAA,CAAAA,gDAAAA,CAAAQ,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAR,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAS,SAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAOvC,IAPAP,EAAAE,EAAuCC,EAAAE,EAAAC,EAAAC,EAOjCC,EAAsB,CAC3BC,UAAW,GACXC,aAAc,YAEdC,qBAAsB,CACrBC,gBAAiB,CAAC,qBAAqB,CACvCC,cAAe,CAAC,gCAA+B,EAEhDC,iBAAkB,gBAGbC,EAAY,IAAIT,EAAY,YAAaE,GAEzCQ,EAAeX,EAAEY,QAAQ,CAAC,WAAA,IAAAC,EAAAC,EAAA,OAAAnB,EAAAoB,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EACsB,GAArDf,EAAOC,SAAS,CAAGF,EAASiB,GAAG,CAAC,qBAC3BhB,EAAOC,SAAS,CAAA,CAAAY,EAAAE,IAAA,CAAA,EAAA,KAAA,CAAA,GAAA,AACKE,KAAAA,IAArBjB,EAAOC,SAAS,CAAc,CAAAY,EAAAE,IAAA,CAAA,EAAA,KAAA,CAAA,OAAAF,EAAAK,MAAA,CAAA,SAC1BV,IAAc,MAAA,EAAA,OAAAK,EAAAK,MAAA,CAAA,SAAA,MAAA,EAKvB,OAAOlB,EAAOE,YAAY,CAC1B,OAAOF,EAAOmB,oBAAoB,CAClC,OAAOnB,EAAOoB,aAAa,CAC3B,OAAOpB,EAAOqB,SAAS,CACvB,OAAOrB,EAAOsB,KAAK,CAEbZ,EAAaX,EAASiB,GAAG,CAAC,wCAAuCH,EAAAU,EAAA,CAC/Db,EAAUG,EAAAE,IAAA,CAAAF,AACZ,WADYA,EAAAU,EAAA,CACJ,GAAAV,AAqBR,kBArBQA,EAAAU,EAAA,CAqBO,GAAA,GAAA,KAAA,MAAA,GAFlB,OAlBGxB,EAASiB,GAAG,CAAC,2CAChBhB,CAAAA,EAAOE,YAAY,CAAGH,EAASiB,GAAG,CAAC,yCAAwC,EAGxEjB,EAASiB,GAAG,CAAC,qDAChBhB,CAAAA,EAAOmB,oBAAoB,CAAGpB,EAASiB,GAAG,CAAC,mDAAkD,EAG1FjB,EAASiB,GAAG,CAAC,wCAChBhB,CAAAA,EAAOqB,SAAS,CAAGtB,EAASiB,GAAG,CAAC,sCAAqC,EAGlEjB,EAASiB,GAAG,CAAC,4CAChBhB,CAAAA,EAAOoB,aAAa,CAAGrB,EAASiB,GAAG,CAAC,0CAAyC,EAG1EjB,EAASiB,GAAG,CAAC,mCAChBhB,CAAAA,EAAOsB,KAAK,CAAGvB,EAASiB,GAAG,CAAC,iCAAgC,EAC5DH,EAAAK,MAAA,CAAA,QAAA,GAAA,MAAA,GAOqB,OAJtBlB,EAAOE,YAAY,CAAG,8CACtBF,EAAOmB,oBAAoB,CAAG,SAC9BnB,EAAOoB,aAAa,CAAG,oDACvBpB,EAAOqB,SAAS,CAAG,gDACnBrB,EAAOsB,KAAK,CAAG,OAAOT,EAAAK,MAAA,CAAA,QAAA,GAAA,MAAA,GAGY,OAAlClB,EAAOE,YAAY,CAAG,YAAYW,EAAAK,MAAA,CAAA,QAAA,GAAA,MAAA,GAIM,OAApCP,EAASJ,EAAUiB,SAAS,CAACxB,GAAOa,EAAAK,MAAA,CAAA,SACnCP,EAAM,MAAA,GAAA,IAAA,MAAA,OAAAE,EAAAY,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,EACX,KAEHhC,EAAOiC,OAAO,CAAC,WACd,OAAOhC,EAAQiC,OAAO,CAAC,WACtB,OAAOpB,GACR,EACD"}