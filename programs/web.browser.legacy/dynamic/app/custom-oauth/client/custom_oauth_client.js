function module(e,t,n){n.link("@babel/runtime/regenerator",{default:function(e){i=e}},0),n.export({CustomOAuth:function(){return p}}),n.link("@rocket.chat/random",{Random:function(e){r=e}},0),n.link("@rocket.chat/string-helpers",{capitalize:function(e){o=e}},1),n.link("meteor/accounts-base",{Accounts:function(e){s=e}},2),n.link("meteor/check",{Match:function(e){u=e}},3),n.link("meteor/meteor",{Meteor:function(e){a=e}},4),n.link("meteor/oauth",{OAuth:function(e){c=e}},5),n.link("meteor/service-configuration",{ServiceConfiguration:function(e){h=e}},6),n.link("../../../lib/utils/isURL",{isURL:function(e){l=e}},7);var i,r,o,s,u,a,c,h,l,p=function(){function e(e,t){if(this.name=e,!u.test(this.name,String))throw new a.Error("CustomOAuth: Name is required and must be String");this.configure(t),s.oauth.registerService(this.name),this.configureLogin()}var t=e.prototype;return t.configure=function(e){if(!u.test(e,Object))throw new a.Error("CustomOAuth: Options is required and must be Object");if(!u.test(e.serverURL,String))throw new a.Error("CustomOAuth: Options.serverURL is required and must be String");u.test(e.authorizePath,String)||(e.authorizePath="/oauth/authorize"),u.test(e.scope,String)||(e.scope="openid"),this.serverURL=e.serverURL,this.authorizePath=e.authorizePath,this.scope=e.scope,this.responseType=e.responseType||"code",l(this.authorizePath)||(this.authorizePath=this.serverURL+this.authorizePath)},t.configureLogin=function(){var e=this;a["loginWith"+o(String(this.name||""))]=function(t,n){var r;return i.async(function(o){for(;;)switch(o.prev=o.next){case 0:return n||"function"!=typeof t||(n=t,t=null),r=s.oauth.credentialRequestCompleteHandler(n),o.next=4,i.awrap(e.requestCredential(t,r));case 4:case"end":return o.stop()}},null,null,null,Promise)}},t.requestCredential=function(e,t){var n,o,s,u,a;return i.async(function(l){for(;;)switch(l.prev=l.next){case 0:return t||"function"!=typeof e||(t=e,e={}),l.next=3,i.awrap(h.configurations.findOneAsync({service:this.name}));case 3:if(n=l.sent){l.next=7;break}return t&&t(new h.ConfigError),l.abrupt("return");case 7:o=r.secret(),s=c._loginStyle(this.name,n,e),u=-1!==this.authorizePath.indexOf("?")?"&":"?",a=""+this.authorizePath+u+"client_id="+n.clientId+"&redirect_uri="+encodeURIComponent(c._redirectUri(this.name,n))+"&response_type="+encodeURIComponent(this.responseType)+"&state="+encodeURIComponent(c._stateParam(s,o,e.redirectUrl))+"&scope="+encodeURIComponent(this.scope),c.launchLogin({loginService:this.name,loginStyle:s,loginUrl:a,credentialRequestCompleteCallback:t,credentialToken:o,popupOptions:{width:900,height:450}});case 12:case"end":return l.stop()}},null,this,null,Promise)},e}()}
//# sourceMappingURL=/dynamic/app/custom-oauth/client/e44484272ec1414e43a146ca71cf7ab74716680d.map
