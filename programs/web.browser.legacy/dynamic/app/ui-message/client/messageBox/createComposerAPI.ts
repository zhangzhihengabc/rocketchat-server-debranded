function module(e,n,t){t.link("@babel/runtime/helpers/slicedToArray",{default:function(e){i=e}},0),t.link("@babel/runtime/helpers/toConsumableArray",{default:function(e){r=e}},1),t.link("@babel/runtime/regenerator",{default:function(e){o=e}},2),t.export({createComposerAPI:function(){return a}}),t.link("@rocket.chat/emitter",{Emitter:function(e){u=e}},0),t.link("meteor/meteor",{Meteor:function(e){c=e}},1),t.link("../../../../lib/utils/highOrderFunctions",{withDebouncing:function(e){l=e}},2),t.link("./messageBoxFormatting",{formattingButtons:function(e){s=e}},3);var i,r,o,u,c,l,s,a=function(e,n){var t,a=function(e,n){var t=new Event(n,{bubbles:!0}),i=e._valueTracker;i&&i.setValue(new Date().toString()),e.dispatchEvent(t)},d=new u,f=[],g=l({wait:300})(function(){if(e.value){c._localStorage.setItem(n,e.value);return}c._localStorage.removeItem(n)}),v=function(){d.emit("quotedMessagesUpdate")};e.addEventListener("input",g);var m,h,p,b,x,S=function(n){var t,i,r,o,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=u.selection,l=u.skipFocus;l||k();var s=e.selectionStart,d=e.selectionEnd,f=e.value;"function"==typeof c&&(c=c({start:s,end:d})),c&&(!(null!==(t=(i=document).execCommand)&&void 0!==t&&t.call(i,"insertText",!1,n))&&(e.value=f.substring(0,s)+n+f.substring(s),l||k()),e.setSelectionRange(null!==(r=c.start)&&void 0!==r?r:0,null!==(o=c.end)&&void 0!==o?o:n.length)),c||(e.value=n),a(e,"input"),a(e,"change"),l||k()},E=function(e){S(e,{selection:function(n){var t=n.start,i=n.end;return{start:t+e.length,end:i+e.length}}})},k=function(){e.focus()},T=i((m=!1,[{get:function(){return m},subscribe:function(e){return d.on("editing",e)}},function(e){m=e,d.emit("editing")}]),2),w=T[0],M=T[1],y=i((h=!1,[{get:function(){return h},subscribe:function(e){return d.on("recording",e)}},function(e){h=e,d.emit("recording")}]),2),C=y[0],_=y[1],D=i((p=!1,[{get:function(){return p},subscribe:function(e){return d.on("recordingVideo",e)}},function(e){p=e,d.emit("recordingVideo")}]),2),P=D[0],I=D[1],V=i((b=!1,[{get:function(){return b},subscribe:function(e){return d.on("mircophoneDenied",e)}},function(e){b=e,d.emit("mircophoneDenied")}]),2),q=V[0],A=V[1],F=i((x=[],[{get:function(){return x},subscribe:function(e){return d.on("formatting",e)}},Tracker.autorun(function(){x=s.filter(function(e){var n=e.condition;return!n||n()}),d.emit("formatting")})]),2),O=F[0],R=F[1];return S(null!==(t=c._localStorage.getItem(n))&&void 0!==t?t:"",{skipFocus:!0}),{replaceText:function(n,t){var i,r,o,u,c=e.selectionStart,l=e.selectionEnd;e.setSelectionRange(null!==(i=t.start)&&void 0!==i?i:0,null!==(r=t.end)&&void 0!==r?r:n.length);var s=e.value;null!==(o=(u=document).execCommand)&&void 0!==o&&o.call(u,"insertText",!1,n)||(e.value=s.substring(0,t.start)+n+s.substring(t.end)),e.selectionStart=c+n.length,e.selectionEnd=c+n.length,c!==l&&(e.selectionStart=c),a(e,"input"),a(e,"change"),k()},insertNewLine:function(){return E("\n")},blur:function(){return e.blur()},substring:function(n,t){return e.value.substring(n,t)},getCursorPosition:function(){return e.selectionStart},setCursorToEnd:function(){e.selectionEnd=e.value.length,e.selectionStart=e.selectionEnd,k()},setCursorToStart:function(){e.selectionStart=0,e.selectionEnd=e.selectionStart,k()},release:function(){e.removeEventListener("input",g),R.stop()},wrapSelection:function(n){var t=e.selectionEnd,i=void 0===t?e.value.length:t,o=e.selectionStart,u=void 0===o?0:o,c=e.value.slice(0,u),l=e.value.slice(u,i),s=e.value.slice(i,e.value.length);k();var d=n.slice(0,n.indexOf("{{text}}"));if(r(d).reverse().every(function(n,t){return e.value.slice(u-t-1,1)===n})){var f,g,v,m,h=n.slice(n.indexOf("{{text}}")+8);if(r(h).every(function(n,t){return e.value.slice(i+t,1)===n})){E(l),e.selectionStart=u-d.length,e.selectionEnd=i+h.length,null!==(v=(m=document).execCommand)&&void 0!==v&&v.call(m,"insertText",!1,l)||(e.value=c.slice(0,c.length-d.length)+l+s.slice(h.length)),e.selectionStart=u-d.length,e.selectionEnd=e.selectionStart+l.length,a(e,"input"),a(e,"change"),k();return}}null!==(f=(g=document).execCommand)&&void 0!==f&&f.call(g,"insertText",!1,n.replace("{{text}}",l))||(e.value=c+n.replace("{{text}}",l)+s),e.selectionStart=u+n.indexOf("{{text}}"),e.selectionEnd=e.selectionStart+l.length,a(e,"input"),a(e,"change"),k()},get text(){return e.value},get selection(){return{start:e.selectionStart,end:e.selectionEnd}},editing:w,setEditingMode:function(e){M(e)},recording:C,setRecordingMode:_,recordingVideo:P,setRecordingVideo:I,insertText:E,setText:S,clear:function(){S("")},focus:k,replyWith:function(n){return o.async(function(t){for(;;)switch(t.prev=t.next){case 0:e&&(e.value=n,e.focus());case 1:case"end":return t.stop()}},null,null,null,Promise)},quoteMessage:function(n){return o.async(function(t){for(;;)switch(t.prev=t.next){case 0:f=[].concat(r(f.filter(function(e){return e._id!==n._id})),[n]),v(),e.focus();case 3:case"end":return t.stop()}},null,null,null,Promise)},dismissQuotedMessage:function(e){return o.async(function(n){for(;;)switch(n.prev=n.next){case 0:f=f.filter(function(n){return n._id!==e}),v();case 2:case"end":return n.stop()}},null,null,null,Promise)},dismissAllQuotedMessages:function(){return o.async(function(e){for(;;)switch(e.prev=e.next){case 0:f=[],v();case 2:case"end":return e.stop()}},null,null,null,Promise)},quotedMessages:{get:function(){return f},subscribe:function(e){return d.on("quotedMessagesUpdate",e)}},formatters:O,isMicrophoneDenied:q,setIsMicrophoneDenied:A}}}
//# sourceMappingURL=/dynamic/app/ui-message/client/messageBox/0a895a6ead7dd664b9c0383634ac27a4082df543.map
