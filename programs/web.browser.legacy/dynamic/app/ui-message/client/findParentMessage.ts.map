)]}'
{"version":3,"sources":["meteor://ðŸ’»app/app/ui-message/client/findParentMessage.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IMessage } from '@rocket.chat/core-typings';\n\nimport { callWithErrorHandling } from '../../../client/lib/utils/callWithErrorHandling';\nimport { withDebouncing } from '../../../lib/utils/highOrderFunctions';\nimport { ChatMessage } from '../../models/client';\n\nexport const findParentMessage = (() => {\n\tconst waiting: string[] = [];\n\tlet resolve: (resolved: IMessage[] | PromiseLike<IMessage[]>) => void;\n\tlet pending = new Promise<IMessage[]>((r) => {\n\t\tresolve = r;\n\t});\n\n\tconst getMessages = withDebouncing({ wait: 500 })(async () => {\n\t\tconst _tmp = [...waiting];\n\t\twaiting.length = 0;\n\t\tresolve(callWithErrorHandling('getMessages', _tmp));\n\t\tpending = new Promise<IMessage[]>((r) => {\n\t\t\tresolve = r;\n\t\t});\n\t});\n\n\tconst get = async (tmid: IMessage['_id']) => {\n\t\tvoid getMessages();\n\t\tconst messages = await pending;\n\t\treturn messages.find(({ _id }) => _id === tmid);\n\t};\n\n\treturn async (tmid: IMessage['_id']) => {\n\t\tconst message = ChatMessage.findOne({ _id: tmid });\n\n\t\tif (message) {\n\t\t\treturn message;\n\t\t}\n\n\t\tif (waiting.indexOf(tmid) === -1) {\n\t\t\twaiting.push(tmid);\n\t\t}\n\t\treturn get(tmid);\n\t};\n})();\n",null],"names":["module","link","default","_regeneratorRuntime","v","export","findParentMessage","callWithErrorHandling","withDebouncing","ChatMessage","resolve","waiting","pending","getMessages","get","Promise","r","wait","_tmp","async","_context","prev","next","concat","length","stop","tmid","messages","_context2","awrap","sent","abrupt","find","_ref","_id","message","_context3","findOne","indexOf","push"],"mappings":"uBAESA,EAAqBC,IAAE,CAAA,6BAAM,CAAAC,QAAAA,SAAAA,CAAAA,EAAAC,EAAkDC,CAAA,CAAA,EAAA,GAAxFJ,EAAOK,MAAE,CAAA,CAAAC,kBAAuB,WAAM,OAAAA,CAAA,CAAA,GAAkDN,EAAAA,IAAAA,CAAAA,kDAAAA,CAAAO,sBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAP,EAAAA,IAAAA,CAAAA,wCAAAA,CAAAQ,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAR,EAAAA,IAAAA,CAAAA,sBAAAA,CAAAS,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAIjF,IAEFC,EADEC,EAEFC,EAIEC,EASAC,EApBPX,EAAsCI,EAAkDC,EAAAC,EAI3EH,GACNK,EAAoB,EAAE,CAExBC,EAAU,IAAIG,QAAoB,SAACC,CAAC,EACvCN,EAAUM,CACX,GAEMH,EAAcL,EAAe,CAAES,KAAM,GAAG,GAAI,WAAA,IAAAC,EAAA,OAAAf,EAAAgB,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAC3CJ,EAAI,EAAA,CAAAK,MAAA,CAAOZ,GACjBA,EAAQa,MAAM,CAAG,EACjBd,EAAQH,EAAsB,cAAeW,IAC7CN,EAAU,IAAIG,QAAoB,SAACC,CAAC,EACnCN,EAAUM,CACX,EAAG,MAAA,EAAA,IAAA,MAAA,OAAAI,EAAAK,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAV,QAAA,GAGED,EAAM,SAAOY,CAAqB,EAAA,IAAAC,EAAA,OAAAxB,EAAAgB,KAAA,CAAA,SAAAS,CAAA,EAAA,OAAA,OAAAA,EAAAP,IAAA,CAAAO,EAAAN,IAAA,EAAA,KAAA,EACpB,OAAdT,IAAce,EAAAN,IAAA,CAAA,EAAAnB,EAAA0B,KAAA,CACIjB,EAAO,MAAA,EAAhB,OAARe,EAAQC,EAAAE,IAAA,CAAAF,EAAAG,MAAA,CAAA,SACPJ,EAASK,IAAI,CAAC,SAAAC,CAAA,EAAM,OAAOC,AAAPD,EAAHC,GAAG,GAAeR,CAAI,GAAC,MAAA,EAAA,IAAA,MAAA,OAAAE,EAAAH,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAV,QAAA,EAGzC,SAAOW,CAAqB,EAAA,IAAAS,EAAA,OAAAhC,EAAAgB,KAAA,CAAA,SAAAiB,CAAA,EAAA,OAAA,OAAAA,EAAAf,IAAA,CAAAe,EAAAd,IAAA,EAAA,KAAA,EACgB,GAAA,CAA5Ca,CAAAA,EAAU1B,EAAY4B,OAAO,CAAC,CAAEH,IAAKR,CAAI,EAAE,EAEtC,CAAAU,EAAAd,IAAA,CAAA,EAAA,KAAA,CAAA,OAAAc,EAAAL,MAAA,CAAA,SACHI,EAAO,MAAA,EAKd,OAF6B,KAA1BxB,EAAQ2B,OAAO,CAACZ,IACnBf,EAAQ4B,IAAI,CAACb,GACbU,EAAAL,MAAA,CAAA,SACMjB,EAAIY,GAAK,MAAA,EAAA,IAAA,MAAA,OAAAU,EAAAX,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAV,QAAA"}