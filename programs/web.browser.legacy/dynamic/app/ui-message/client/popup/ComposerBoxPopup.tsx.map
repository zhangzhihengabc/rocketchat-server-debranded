)]}'
{"version":3,"sources":["meteor://ðŸ’»app/app/ui-message/client/popup/ComposerBoxPopup.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Box, Option, OptionSkeleton, Tile } from '@rocket.chat/fuselage';\nimport { useUniqueId, useContentBoxSize } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation } from '@rocket.chat/ui-contexts';\nimport type { UseQueryResult } from '@tanstack/react-query';\nimport type { ReactElement } from 'react';\nimport React, { useEffect, memo, useMemo, useRef } from 'react';\n\nexport type ComposerBoxPopupProps<\n\tT extends {\n\t\t_id: string;\n\t\tsort?: number;\n\t},\n> = {\n\ttitle?: string;\n\tfocused?: T;\n\titems: UseQueryResult<T[]>[];\n\tselect: (item: T) => void;\n\trenderItem?: ({ item }: { item: T }) => ReactElement;\n};\n\nconst ComposerBoxPopup = <\n\tT extends {\n\t\t_id: string;\n\t\tsort?: number;\n\t},\n>({\n\ttitle,\n\titems,\n\tfocused,\n\tselect,\n\trenderItem = ({ item }: { item: T }) => <>{JSON.stringify(item)}</>,\n}: ComposerBoxPopupProps<T>): ReactElement | null => {\n\tconst t = useTranslation();\n\tconst id = useUniqueId();\n\tconst composerBoxPopupRef = useRef<HTMLElement>(null);\n\tconst popupSizes = useContentBoxSize(composerBoxPopupRef);\n\n\tconst variant = popupSizes && popupSizes.inlineSize < 480 ? 'small' : 'large';\n\n\tconst getOptionTitle = <T extends { _id: string; sort?: number; outside?: boolean; suggestion?: boolean }>(item: T) => {\n\t\tif (variant !== 'small') {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (item.outside) {\n\t\t\treturn t('Not_in_channel');\n\t\t}\n\n\t\tif (item.suggestion) {\n\t\t\treturn t('Suggestion_from_recent_messages');\n\t\t}\n\t};\n\n\tconst itemsFlat = useMemo(\n\t\t() =>\n\t\t\titems\n\t\t\t\t.flatMap((item) => {\n\t\t\t\t\tif (item.isSuccess) {\n\t\t\t\t\t\treturn item.data;\n\t\t\t\t\t}\n\t\t\t\t\treturn [];\n\t\t\t\t})\n\t\t\t\t.sort((a, b) => (('sort' in a && a.sort) || 0) - (('sort' in b && b.sort) || 0)),\n\t\t[items],\n\t);\n\n\tconst isLoading = items.some((item) => item.isLoading && item.fetchStatus !== 'idle');\n\n\tuseEffect(() => {\n\t\tif (focused) {\n\t\t\tconst element = document.getElementById(`popup-item-${focused._id}`);\n\t\t\tif (element) {\n\t\t\t\telement.scrollIntoView({ behavior: 'smooth', block: 'nearest' });\n\t\t\t}\n\t\t}\n\t}, [focused]);\n\n\treturn (\n\t\t<Box className='message-popup-position' position='relative'>\n\t\t\t<Tile ref={composerBoxPopupRef} className='message-popup' padding={0} role='menu' mbe={8} overflow='hidden' aria-labelledby={id}>\n\t\t\t\t{title && (\n\t\t\t\t\t<Box bg='tint' pi={16} pb={8} id={id}>\n\t\t\t\t\t\t{title}\n\t\t\t\t\t</Box>\n\t\t\t\t)}\n\t\t\t\t<Box pb={8} maxHeight='x320'>\n\t\t\t\t\t{!isLoading && itemsFlat.length === 0 && <Option>{t('No_results_found')}</Option>}\n\t\t\t\t\t{isLoading && <OptionSkeleton />}\n\t\t\t\t\t{itemsFlat.map((item, index) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<Option\n\t\t\t\t\t\t\t\ttitle={getOptionTitle(item)}\n\t\t\t\t\t\t\t\tonClick={() => select(item)}\n\t\t\t\t\t\t\t\tselected={item === focused}\n\t\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\t\tid={`popup-item-${item._id}`}\n\t\t\t\t\t\t\t\ttabIndex={item === focused ? 0 : -1}\n\t\t\t\t\t\t\t\taria-selected={item === focused}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{renderItem({ item: { ...item, variant } })}\n\t\t\t\t\t\t\t</Option>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</Box>\n\t\t\t</Tile>\n\t\t</Box>\n\t);\n};\n\nexport default memo(ComposerBoxPopup);\n",null],"names":["_objectSpread","Box","Option","OptionSkeleton","Tile","useUniqueId","useContentBoxSize","useTranslation","React","useEffect","memo","useMemo","useRef","module","link","default","v","exportDefault","_ref","title","items","focused","select","_ref$renderItem","renderItem","_ref2","item","createElement","Fragment","JSON","stringify","t","id","composerBoxPopupRef","popupSizes","variant","inlineSize","itemsFlat","flatMap","isSuccess","data","sort","a","b","isLoading","some","fetchStatus","element","document","getElementById","_id","scrollIntoView","behavior","block","className","position","ref","padding","role","mbe","overflow","bg","pi","pb","maxHeight","length","map","index","outside","suggestion","onClick","selected","key","tabIndex"],"mappings":"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"}