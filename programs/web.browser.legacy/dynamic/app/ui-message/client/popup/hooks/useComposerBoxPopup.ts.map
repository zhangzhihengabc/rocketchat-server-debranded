)]}'
{"version":3,"sources":["meteor://ðŸ’»app/app/ui-message/client/popup/hooks/useComposerBoxPopup.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { UseQueryResult } from '@tanstack/react-query';\nimport type { MutableRefObject } from 'react';\nimport { useEffect, useCallback, useState, useRef } from 'react';\n\nimport { useChat } from '../../../../../client/views/room/contexts/ChatContext';\nimport type { ComposerPopupOption } from '../../../../../client/views/room/contexts/ComposerPopupContext';\nimport { useComposerBoxPopupQueries } from './useComposerBoxPopupQueries';\n\ntype ComposerBoxPopupImperativeCommands<T> = MutableRefObject<\n\t| {\n\t\t\tgetFilter?: () => unknown;\n\t\t\tselect?: (s: T) => void;\n\t  }\n\t| undefined\n>;\n\ntype ComposerBoxPopupOptions<T extends { _id: string; sort?: number | undefined }> = ComposerPopupOption<T>;\n\ntype ComposerBoxPopupResult<T extends { _id: string; sort?: number }> =\n\t| {\n\t\t\tpopup: ComposerPopupOption<T>;\n\t\t\titems: UseQueryResult<T[]>[];\n\t\t\tfocused: T | undefined;\n\t\t\tariaActiveDescendant: string | undefined;\n\t\t\tselect: (item: T) => void;\n\t\t\tcallbackRef: (node: HTMLElement) => void;\n\t\t\tcommandsRef: ComposerBoxPopupImperativeCommands<T>;\n\t\t\tsuspended: boolean;\n\t\t\tfilter: unknown;\n\t\t\tclearPopup: () => void;\n\t  }\n\t| {\n\t\t\tpopup: undefined;\n\t\t\titems: undefined;\n\t\t\tfocused: undefined;\n\t\t\tariaActiveDescendant: undefined;\n\t\t\tcallbackRef: (node: HTMLElement) => void;\n\t\t\tselect: undefined;\n\t\t\tcommandsRef: ComposerBoxPopupImperativeCommands<T>;\n\t\t\tsuspended: boolean;\n\t\t\tfilter: unknown;\n\t\t\tclearPopup: () => void;\n\t  };\n\nconst keys = {\n\tTAB: 9,\n\tENTER: 13,\n\tESC: 27,\n\tARROW_LEFT: 37,\n\tARROW_UP: 38,\n\tARROW_RIGHT: 39,\n\tARROW_DOWN: 40,\n};\n\nexport const useComposerBoxPopup = <T extends { _id: string; sort?: number }>({\n\tconfigurations,\n}: {\n\tconfigurations: ComposerBoxPopupOptions<T>[];\n}): ComposerBoxPopupResult<T> => {\n\tconst [popup, setPopup] = useState<ComposerBoxPopupOptions<T> | undefined>(undefined);\n\tconst [focused, setFocused] = useState<T | undefined>(undefined);\n\tconst [filter, setFilter] = useState<unknown>('');\n\n\tconst commandsRef: ComposerBoxPopupImperativeCommands<T> = useRef();\n\n\tconst { queries: items, suspended } = useComposerBoxPopupQueries(filter, popup) as {\n\t\tqueries: UseQueryResult<T[]>[];\n\t\tsuspended: boolean;\n\t};\n\n\tconst chat = useChat();\n\n\tconst ariaActiveDescendant = focused ? `popup-item-${focused._id}` : undefined;\n\n\tuseEffect(() => {\n\t\tif (!popup) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (popup?.preview && suspended) {\n\t\t\tsetFocused(undefined);\n\t\t\treturn;\n\t\t}\n\t\tsetFocused((focused) => {\n\t\t\tconst sortedItems = items\n\t\t\t\t.filter((item) => item.isSuccess)\n\t\t\t\t.flatMap((item) => item.data as T[])\n\t\t\t\t.sort((a, b) => (('sort' in a && a.sort) || 0) - (('sort' in b && b.sort) || 0));\n\t\t\treturn sortedItems.find((item) => item._id === focused?._id) ?? sortedItems[0];\n\t\t});\n\t}, [items, popup, suspended]);\n\n\tconst select = useMutableCallback((item: T) => {\n\t\tif (!popup) {\n\t\t\tthrow new Error('No popup is open');\n\t\t}\n\n\t\tif (commandsRef.current?.select) {\n\t\t\tcommandsRef.current.select(item);\n\t\t} else {\n\t\t\tconst value = chat?.composer?.substring(0, chat?.composer?.selection.start);\n\t\t\tconst selector =\n\t\t\t\tpopup.matchSelectorRegex ??\n\t\t\t\t(popup.triggerAnywhere ? new RegExp(`(?:^| |\\n)(${popup.trigger})([^\\\\s]*$)`) : new RegExp(`(?:^)(${popup.trigger})([^\\\\s]*$)`));\n\n\t\t\tconst result = value?.match(selector);\n\t\t\tif (!result || !value) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tchat?.composer?.replaceText((popup.prefix ?? popup.trigger ?? '') + popup.getValue(item) + (popup.suffix ?? ''), {\n\t\t\t\tstart: value.lastIndexOf(result[1] + result[2]),\n\t\t\t\tend: chat?.composer?.selection.start,\n\t\t\t});\n\t\t}\n\t\tsetPopup(undefined);\n\t\tsetFocused(undefined);\n\t});\n\n\tconst setConfigByInput = useMutableCallback((): ComposerBoxPopupOptions<T> | undefined => {\n\t\tconst value = chat?.composer?.substring(0, chat?.composer?.selection.start);\n\n\t\tif (!value) {\n\t\t\tsetPopup(undefined);\n\t\t\tsetFocused(undefined);\n\t\t\treturn;\n\t\t}\n\n\t\tconst configuration = configurations.find(({ trigger, matchSelectorRegex, triggerAnywhere, triggerLength }) => {\n\t\t\tconst selector =\n\t\t\t\tmatchSelectorRegex ?? (triggerAnywhere ? new RegExp(`(?:^| |\\n)(${trigger})[^\\\\s]*$`) : new RegExp(`(?:^)(${trigger})[^\\\\s]*$`));\n\t\t\tconst result = selector.test(value);\n\t\t\tif (!triggerLength || !result) {\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\tconst filter = value.match(selector);\n\t\t\treturn filter && triggerLength < filter[0].length;\n\t\t});\n\t\tsetPopup(configuration);\n\t\tif (!configuration) {\n\t\t\tsetFocused(undefined);\n\t\t\tsetFilter('');\n\t\t}\n\n\t\tif (configuration) {\n\t\t\tconst selector =\n\t\t\t\tconfiguration.matchSelectorRegex ??\n\t\t\t\t(configuration.triggerAnywhere\n\t\t\t\t\t? new RegExp(`(?:^| |\\n)(${configuration.trigger})([^\\\\s]*$)`)\n\t\t\t\t\t: new RegExp(`(?:^)(${configuration.trigger})([^\\\\s]*$)`));\n\t\t\tconst result = value.match(selector);\n\t\t\tsetFilter(commandsRef.current?.getFilter?.() ?? (result ? result[2] : ''));\n\t\t}\n\t\treturn configuration;\n\t});\n\n\tconst onFocus = useMutableCallback(() => {\n\t\tif (popup) {\n\t\t\treturn;\n\t\t}\n\t\tsetConfigByInput();\n\t});\n\n\tconst keyup = useMutableCallback((event: KeyboardEvent) => {\n\t\tif (!setConfigByInput()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!popup) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (popup.closeOnEsc === true && event.which === keys.ESC) {\n\t\t\tsetPopup(undefined);\n\t\t\tsetFocused(undefined);\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\t}\n\t});\n\n\tconst keydown = useMutableCallback((event: KeyboardEvent) => {\n\t\tif (!popup) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (event.which === keys.ENTER || event.which === keys.TAB) {\n\t\t\tif (!focused) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tselect(focused);\n\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\t\treturn true;\n\t\t}\n\t\tif (event.which === keys.ARROW_UP && !(event.shiftKey || event.ctrlKey || event.altKey || event.metaKey)) {\n\t\t\tsetFocused((focused) => {\n\t\t\t\tconst list = items\n\t\t\t\t\t.filter((item) => item.isSuccess)\n\t\t\t\t\t.flatMap((item) => item.data as T[])\n\t\t\t\t\t.sort((a, b) => (('sort' in a && a.sort) || 0) - (('sort' in b && b.sort) || 0));\n\n\t\t\t\tif (!list) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst focusedIndex = list.findIndex((item) => item === focused);\n\n\t\t\t\treturn (focusedIndex > 0 ? list[focusedIndex - 1] : list[list.length - 1]) as T;\n\t\t\t});\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\t\treturn true;\n\t\t}\n\t\tif (event.which === keys.ARROW_DOWN && !(event.shiftKey || event.ctrlKey || event.altKey || event.metaKey)) {\n\t\t\tsetFocused((focused) => {\n\t\t\t\tconst list = items\n\t\t\t\t\t.filter((item) => item.isSuccess)\n\t\t\t\t\t.flatMap((item) => item.data as T[])\n\t\t\t\t\t.sort((a, b) => (('sort' in a && a.sort) || 0) - (('sort' in b && b.sort) || 0));\n\n\t\t\t\tif (!list) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\tconst focusedIndex = list.findIndex((item) => item === focused);\n\n\t\t\t\treturn (focusedIndex < list.length - 1 ? list[focusedIndex + 1] : list[0]) as T;\n\t\t\t});\n\t\t\tevent.preventDefault();\n\t\t\tevent.stopPropagation();\n\t\t\treturn true;\n\t\t}\n\t});\n\n\tconst clearPopup = useMutableCallback(() => {\n\t\tif (!popup) {\n\t\t\treturn;\n\t\t}\n\n\t\tsetPopup(undefined);\n\t\tsetFocused(undefined);\n\t\tsetFilter('');\n\t});\n\n\tconst callbackRef = useCallback(\n\t\t(node: HTMLElement | null) => {\n\t\t\tif (!node) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tnode.addEventListener('keyup', keyup);\n\t\t\tnode.addEventListener('keydown', keydown);\n\t\t\tnode.addEventListener('focus', onFocus);\n\t\t},\n\t\t[keyup, keydown, onFocus],\n\t);\n\n\tif (!popup) {\n\t\treturn {\n\t\t\tcallbackRef,\n\t\t\tfocused: undefined,\n\t\t\titems: undefined,\n\t\t\tariaActiveDescendant: undefined,\n\t\t\tpopup: undefined,\n\t\t\tselect: undefined,\n\t\t\tsuspended: true,\n\t\t\tcommandsRef,\n\t\t\tfilter: undefined,\n\t\t\tclearPopup,\n\t\t};\n\t}\n\n\treturn {\n\t\tfocused,\n\t\titems,\n\t\tariaActiveDescendant,\n\t\tpopup,\n\t\tselect,\n\t\tfilter,\n\t\tsuspended,\n\t\tcommandsRef,\n\t\tcallbackRef,\n\t\tclearPopup,\n\t};\n};\n",null],"names":["module","default","_slicedToArray","export","useComposerBoxPopup","useMutableCallback","useEffect","useCallback","useState","useRef","useChat","useComposerBoxPopupQueries","keys","TAB","ENTER","ESC","ARROW_UP","ARROW_DOWN","_ref","configurations","_useState2","undefined","popup","setPopup","_useState4","focused","setFocused","_useState6","filter","setFilter","commandsRef","_useComposerBoxPopupQ","items","queries","suspended","chat","ariaActiveDescendant","_id","preview","_sortedItems$find","sortedItems","item","isSuccess","flatMap","data","sort","a","b","find","select","_commandsRef$current","Error","current","_chat$composer","_chat$composer2","_popup$matchSelectorR","_chat$composer3","_ref2","_popup$prefix","_popup$suffix","_chat$composer4","value","composer","substring","selection","start","selector","matchSelectorRegex","triggerAnywhere","RegExp","trigger","result","match","replaceText","prefix","getValue","suffix","lastIndexOf","end","setConfigByInput","_chat$composer5","_chat$composer6","configuration","_ref3","triggerLength","test","length","_configuration$matchS","_commandsRef$current$","_commandsRef$current2","_commandsRef$current3","getFilter","call","onFocus","keyup","event","closeOnEsc","which","preventDefault","stopPropagation","keydown","shiftKey","ctrlKey","altKey","metaKey","list","focusedIndex","findIndex","clearPopup","callbackRef","node","addEventListener"],"mappings":"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"}