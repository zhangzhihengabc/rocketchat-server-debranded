function module(e,n,r){r.export({usersFromRoomMessages:function(){return c}}),r.link("meteor/meteor",{Meteor:function(e){t=e}},0),r.link("meteor/mongo",{Mongo:function(e){o=e}},1),r.link("meteor/tracker",{Tracker:function(e){u=e}},2),r.link("../../../../client/lib/RoomManager",{RoomManager:function(e){i=e}},3),r.link("../../../../client/lib/tracker",{asReactiveSource:function(e){s=e}},4),r.link("../../../models/client",{Messages:function(e){a=e}},5);var t,o,u,i,s,a,c=new o.Collection(null);t.startup(function(){u.autorun(function(){var e=t.userId(),n=s(function(e){return i.on("changed",e)},function(){return i.opened}),r=e?t.users.findOne(e,{fields:{username:1}}):void 0;if(n&&r){c.remove({});var o={};a.find({rid:n,"u.username":{$ne:r.username},t:{$exists:!1}},{fields:{"u.username":1,"u.name":1,"u._id":1,ts:1},sort:{ts:-1}}).fetch().filter(function(e){var n=e.u.username,r=!o[n];return o[n]=!0,r}).forEach(function(e){var n=e.u,r=n.username,t=n.name,o=n._id,u=e.ts;return c.upsert(o,{_id:o,username:r,name:t,ts:u})})}})})}
//# sourceMappingURL=/dynamic/app/ui-message/client/popup/822a69812cdee48eda4b2b3c8cee02cb8b276d9e.map
