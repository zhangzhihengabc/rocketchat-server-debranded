function module(e,n,r){var t,a,i,s,u,o,c,l,d;r.link("@babel/runtime/regenerator",{default:function(e){t=e}},0),r.link("@babel/runtime/helpers/typeof",{default:function(e){a=e}},1),r.link("meteor/meteor",{Meteor:function(e){i=e}},0),r.link("../../../../client/lib/rooms/roomCoordinator",{roomCoordinator:function(e){s=e}},1),r.link("../../../../lib/callbacks",{callbacks:function(e){u=e}},2),r.link("../../../emoji/client",{emoji:function(e){o=e}},3),r.link("../../../models/client",{Messages:function(e){c=e},ChatRoom:function(e){l=e},Subscriptions:function(e){d=e}},4),i.methods({setReaction:function(e,n){var r,f,b,m;return t.async(function(k){for(;;)switch(k.prev=k.next){case 0:if(i.userId()){k.next=2;break}throw new i.Error(203,"User_logged_out");case 2:if(null!=(f=i.user())&&f.username){k.next=5;break}return k.abrupt("return",!1);case 5:if(b=c.findOne({_id:n})){k.next=8;break}return k.abrupt("return",!1);case 8:if(m=l.findOne({_id:b.rid})){k.next=11;break}return k.abrupt("return",!1);case 11:if(!b.private){k.next=13;break}return k.abrupt("return",!1);case 13:if(o.list[e]){k.next=15;break}return k.abrupt("return",!1);case 15:if(!s.readOnly(m._id,f)){k.next=17;break}return k.abrupt("return",!1);case 17:if(d.findOne({rid:b.rid})){k.next=19;break}return k.abrupt("return",!1);case 19:if(!(null!==(r=b.reactions)&&void 0!==r&&r[e]&&-1!==b.reactions[e].usernames.indexOf(f.username))){k.next=34;break}if(b.reactions[e].usernames.splice(b.reactions[e].usernames.indexOf(f.username),1),0===b.reactions[e].usernames.length&&delete b.reactions[e],!(!b.reactions||"object"!==a(b.reactions)||0===Object.keys(b.reactions).length)){k.next=29;break}return delete b.reactions,c.update({_id:n},{$unset:{reactions:1}}),k.next=27,t.awrap(u.run("unsetReaction",n,e));case 27:k.next=32;break;case 29:return c.update({_id:n},{$set:{reactions:b.reactions}}),k.next=32,t.awrap(u.run("setReaction",n,e));case 32:k.next=40;break;case 34:return b.reactions||(b.reactions={}),b.reactions[e]||(b.reactions[e]={usernames:[]}),b.reactions[e].usernames.push(f.username),c.update({_id:n},{$set:{reactions:b.reactions}}),k.next=40,t.awrap(u.run("setReaction",n,e));case 40:case"end":return k.stop()}},null,null,null,Promise)}})}
//# sourceMappingURL=/dynamic/app/reactions/client/methods/1dc33ba9034cf40738f1d572982ad7729bd51c10.map
