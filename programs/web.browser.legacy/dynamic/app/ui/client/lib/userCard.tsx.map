)]}'
{"version":3,"sources":["meteor://ðŸ’»app/app/ui/client/lib/userCard.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { ComponentProps } from 'react';\nimport React, { Suspense, createElement, lazy } from 'react';\nimport { createPortal } from 'react-dom';\nimport { useSyncExternalStore } from 'use-sync-external-store/shim';\n\nimport { registerPortal } from '../../../../client/lib/portals/portalsSubscription';\nimport { queueMicrotask } from '../../../../client/lib/utils/queueMicrotask';\n\nconst UserCard = lazy(() => import('../../../../client/views/room/UserCard'));\n\ntype UserCardProps = ComponentProps<typeof UserCard>;\n\nlet props: UserCardProps;\n\nconst subscribers = new Set<() => void>();\n\nconst updateProps = (newProps: Partial<UserCardProps>) => {\n\tprops = { ...props, ...newProps };\n\tsubscribers.forEach((subscriber) => subscriber());\n};\n\nconst getProps = () => props;\n\nconst subscribeToProps = (callback: () => void) => {\n\tsubscribers.add(callback);\n\n\treturn () => {\n\t\tsubscribers.delete(callback);\n\t};\n};\n\nconst UserCardWithProps = () => {\n\tconst props = useSyncExternalStore(subscribeToProps, getProps);\n\n\treturn (\n\t\t<Suspense fallback={null}>\n\t\t\t<UserCard {...props} />\n\t\t</Suspense>\n\t);\n};\n\nconst createContainer = () => {\n\tconst container = document.createElement('div');\n\tcontainer.id = 'react-user-card';\n\tdocument.body.appendChild(container);\n\n\treturn container;\n};\n\nlet container: HTMLDivElement | undefined;\nlet unregisterPortal: (() => void) | undefined;\n\nexport const closeUserCard = () => {\n\tqueueMicrotask(() => {\n\t\tif (unregisterPortal) {\n\t\t\tunregisterPortal();\n\t\t\tunregisterPortal = undefined;\n\t\t}\n\t});\n};\n\nexport const openUserCard = (params: Omit<UserCardProps, 'onClose'>) => {\n\tupdateProps({ ...params, onClose: closeUserCard });\n\n\tif (!container) {\n\t\tcontainer = createContainer();\n\t}\n\n\tif (!unregisterPortal) {\n\t\tconst children = createElement(UserCardWithProps);\n\t\tconst portal = <>{createPortal(children, container)}</>;\n\t\tunregisterPortal = registerPortal(container, portal);\n\t}\n\n\treturn closeUserCard;\n};\n",null],"names":["module","link","default","_objectSpread","export","closeUserCard","openUserCard","v","React","Suspense","createElement","lazy","createPortal","useSyncExternalStore","registerPortal","queueMicrotask","props","container","unregisterPortal","UserCard","dynamicImport","subscribers","Set","updateProps","newProps","forEach","subscriber","getProps","subscribeToProps","callback","add","delete","UserCardWithProps","fallback","createContainer","document","id","body","appendChild","undefined","params","onClose","children","portal","Fragment"],"mappings":"uBACgBA,EAAQC,IAAE,CAAA,uCAAmC,CAAAC,QAAAA,SAAAA,CAAAA,EAAAC,EAAAA,CAAA,CAAA,EAAA,GAA7DH,EAAOI,MAAK,CAAE,CAAAC,cAAY,WAAa,OAAQA,CAAa,EAACC,aAAAA,WAAA,OAAAA,CAAA,CAAA,GAAAN,EAAAA,IAAAA,CAAAA,QAAAA,CAAA,QAAA,SAAAO,CAAA,EAAAC,EAAAA,CAAA,EAAAC,SAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,cAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,KAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAX,EAAAA,IAAAA,CAAAA,YAAAA,CAAAY,aAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAZ,EAAAA,IAAAA,CAAAA,+BAAAA,CAAAa,qBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAb,EAAAA,IAAAA,CAAAA,qDAAAA,CAAAc,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAd,EAAAA,IAAAA,CAAAA,8CAAAA,CAAAe,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAO7D,IAPAZ,EAA6DK,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAWzDC,EAqCAC,EACAC,EA1CEC,EAAWR,EAAK,WAAA,OAAMX,EAAAoB,aAAA,CAAO,yCAAyC,GAMtEC,EAAc,IAAIC,IAElBC,EAAc,SAACC,CAAgC,EACpDR,EAAKb,EAAAA,EAAA,CAAA,EAAQa,GAAUQ,GACvBH,EAAYI,OAAO,CAAC,SAACC,CAAU,EAAA,OAAKA,GAAY,EACjD,EAEMC,EAAW,WAAA,OAAMX,CAAK,EAEtBY,EAAmB,SAACC,CAAoB,EAG7C,OAFAR,EAAYS,GAAG,CAACD,GAET,WACNR,EAAYU,MAAM,CAACF,EACpB,CACD,EAEMG,EAAoB,WACzB,IAAMhB,EAAQH,EAAqBe,EAAkBD,GAErD,OACCnB,EAAAE,aAAA,CAACD,EAAQ,CAACwB,SAAU,IAAK,EACxBzB,EAAAE,aAAA,CAACS,EAAaH,GAGjB,EAEMkB,EAAkB,WACvB,IAAMjB,EAAYkB,SAASzB,aAAa,CAAC,OAIzC,OAHAO,EAAUmB,EAAE,CAAG,kBACfD,SAASE,IAAI,CAACC,WAAW,CAACrB,GAEnBA,CACR,EAKaZ,EAAgB,WAC5BU,EAAe,WACVG,IACHA,IACAA,EAAmBqB,KAAAA,EAErB,EACD,EAEajC,EAAe,SAACkC,CAAsC,EAOlE,GANAjB,EAAWpB,EAAAA,EAAA,CAAA,EAAMqC,GAAM,CAAA,EAAA,CAAEC,QAASpC,CAAa,IAE1CY,GACJA,CAAAA,EAAYiB,GAAe,EAGxB,CAAChB,EAAkB,CACtB,IAAMwB,EAAWhC,EAAcsB,GACzBW,EAASnC,EAAAE,aAAA,CAAAF,EAAAoC,QAAA,CAAA,KAAGhC,EAAa8B,EAAUzB,IACzCC,EAAmBJ,EAAeG,EAAW0B,GAG9C,OAAOtC,CACR"}