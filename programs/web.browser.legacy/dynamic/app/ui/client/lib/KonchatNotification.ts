function module(e,n,t){t.link("@babel/runtime/regenerator",{default:function(e){i=e}},0),t.link("@babel/runtime/helpers/toConsumableArray",{default:function(e){a=e}},1),t.link("@babel/runtime/helpers/objectSpread2",{default:function(e){o=e}},2),t.export({KonchatNotification:function(){return h}}),t.link("@rocket.chat/random",{Random:function(e){r=e}},0),t.link("meteor/meteor",{Meteor:function(e){u=e}},1),t.link("meteor/reactive-var",{ReactiveVar:function(e){s=e}},2),t.link("../../../../client/lib/RoomManager",{RoomManager:function(e){c=e}},3),t.link("../../../../client/lib/onClientMessageReceived",{onClientMessageReceived:function(e){l=e}},4),t.link("../../../../client/lib/utils/getAvatarAsPng",{getAvatarAsPng:function(e){d=e}},5),t.link("../../../../client/providers/RouterProvider",{router:function(e){f=e}},6),t.link("../../../../lib/utils/stringUtils",{stripTags:function(e){p=e}},7),t.link("../../../custom-sounds/client/lib/CustomSounds",{CustomSounds:function(e){m=e}},8),t.link("../../../e2e/client",{e2e:function(e){v=e}},9),t.link("../../../models/client",{ChatSubscription:function(e){b=e}},10),t.link("../../../utils/client",{getUserPreference:function(e){y=e}},11),t.link("../../../utils/client/getUserAvatarURL",{getUserAvatarURL:function(e){g=e}},12),t.link("../../../utils/client/lib/SDKClient",{sdk:function(e){k=e}},13);var i,a,o,r,u,s,c,l,d,f,p,m,v,b,y,g,k,h=new(function(){function e(){this.notificationStatus=new s(void 0)}var n=e.prototype;return n.getDesktopPermission=function(){var e=this;if(window.Notification&&"granted"!==Notification.permission)return Notification.requestPermission(function(n){e.notificationStatus.set(n)})},n.notify=function(e){var n,t,a,s,c,d,m;return i.async(function(v){for(;;)switch(v.prev=v.next){case 0:if(!(void 0===window.Notification||"granted"!==Notification.permission)){v.next=2;break}return v.abrupt("return");case 2:if(e.payload){v.next=4;break}return v.abrupt("return");case 4:if(a=e.payload.rid){v.next=7;break}return v.abrupt("return");case 7:return v.next=9,i.awrap(l({rid:a,msg:e.text,notification:!0}));case 9:s=v.sent,c=y(u.userId(),"desktopNotificationRequireInteraction"),d=new Notification(e.title,{icon:e.icon||g(null===(n=e.payload.sender)||void 0===n?void 0:n.username),body:p(s.msg),tag:e.payload._id,canReply:!0,silent:!0,requireInteraction:c}),(m=c?-1:(null!==(t=e.duration)&&void 0!==t?t:0)-0||10)>0&&setTimeout(function(){return d.close()},1e3*m),d.addEventListener&&d.addEventListener("reply",function(e){var n=e.response;k.call("sendMessage",{_id:r.id(),rid:a,msg:n})}),d.onclick=function(){var n;if(this.close(),window.focus(),e.payload._id&&e.payload.rid&&e.payload.name)switch(null===(n=e.payload)||void 0===n?void 0:n.type){case"d":return f.navigate({pattern:"/direct/:rid/:tab?/:context?",params:o({rid:e.payload.rid},e.payload.tmid&&{tab:"thread",context:e.payload.tmid}),search:o(o({},f.getSearchParameters()),{},{jump:e.payload._id})});case"c":return f.navigate({pattern:"/channel/:name/:tab?/:context?",params:o({name:e.payload.name},e.payload.tmid&&{tab:"thread",context:e.payload.tmid}),search:o(o({},f.getSearchParameters()),{},{jump:e.payload._id})});case"p":return f.navigate({pattern:"/group/:name/:tab?/:context?",params:o({name:e.payload.name},e.payload.tmid&&{tab:"thread",context:e.payload.tmid}),search:o(o({},f.getSearchParameters()),{},{jump:e.payload._id})});case"l":return f.navigate({pattern:"/live/:id/:tab?/:context?",params:{id:e.payload.rid,tab:"room-info"},search:o(o({},f.getSearchParameters()),{},{jump:e.payload._id})})}};case 16:case"end":return v.stop()}},null,null,null,Promise)},n.showDesktop=function(e){var n,t,a,o,r,s,l,f=this;return i.async(function(p){for(;;)switch(p.prev=p.next){case 0:if(e.payload.rid){p.next=2;break}return p.abrupt("return");case 2:if(!((null===(t=e.payload)||void 0===t?void 0:t.rid)===c.opened&&("function"==typeof window.document.hasFocus?window.document.hasFocus():void 0))){p.next=4;break}return p.abrupt("return");case 4:if((null===(a=u.user())||void 0===a?void 0:a.status)!=="busy"){p.next=6;break}return p.abrupt("return");case 6:if((null===(o=e.payload)||void 0===o?void 0:null===(r=o.message)||void 0===r?void 0:r.t)!=="e2e"){p.next=14;break}return p.next=9,i.awrap(v.getInstanceByRoomId(e.payload.rid));case 9:if(!(n=p.sent)){p.next=14;break}return p.next=13,i.awrap(n.decrypt(e.payload.message.msg));case 13:e.text=p.sent.text;case 14:return p.abrupt("return",d(null===(s=e.payload)||void 0===s?void 0:null===(l=s.sender)||void 0===l?void 0:l.username,function(n){return e.icon=n,f.notify(e)}));case 15:case"end":return p.stop()}},null,null,null,Promise)},n.newMessage=function(e){var n,t,a,o,r;return i.async(function(i){for(;;)switch(i.prev=i.next){case 0:if((null===(n=u.user())||void 0===n?void 0:n.status)!=="busy"){i.next=2;break}return i.abrupt("return");case 2:if(a=y(t=u.userId(),"newMessageNotification"),o=y(t,"notificationsSoundVolume",100),e){i.next=7;break}return i.abrupt("return");case 7:if(!(!(r=b.findOne({rid:e},{fields:{audioNotificationValue:1}}))||"none"===r.audioNotificationValue)){i.next=10;break}return i.abrupt("return");case 10:if(i.prev=10,!(r.audioNotificationValue&&"0"!==r.audioNotificationValue)){i.next=14;break}return m.play(r.audioNotificationValue,{volume:Number((o/100).toPrecision(2))}),i.abrupt("return");case 14:a&&"none"!==a&&m.play(a,{volume:Number((o/100).toPrecision(2))}),i.next=19;break;case 17:i.prev=17,i.t0=i.catch(10);case 19:case"end":return i.stop()}},null,null,[[10,17]],Promise)},n.newRoom=function(e){Tracker.nonreactive(function(){var n=Session.get("newRoomSound");return n=n?[].concat(a(n),[e]):[e],Session.set("newRoomSound",n)})},n.removeRoomNotification=function(e){var n,t=null!==(n=Session.get("newRoomSound"))&&void 0!==n?n:[];t=t.filter(function(n){return n!==e}),Tracker.nonreactive(function(){return Session.set("newRoomSound",t)});var i=document.querySelector(".link-room-"+e);null==i||i.classList.remove("new-room-highlight")},e}())}
//# sourceMappingURL=/dynamic/app/ui/client/lib/61a8b1f185b55c1239fcc47cdbc29680eff6d04f.map
