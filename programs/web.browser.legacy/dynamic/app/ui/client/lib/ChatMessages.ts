function module(e,t,n){n.link("@babel/runtime/regenerator",{default:function(e){r=e}},0),n.link("@babel/runtime/helpers/createClass",{default:function(e){s=e}},1),n.export({ChatMessages:function(){return M}}),n.link("@rocket.chat/core-typings",{isVideoConfMessage:function(e){a=e}},0),n.link("../../../../client/lib/chats/data",{createDataAPI:function(e){i=e}},1),n.link("../../../../client/lib/chats/flows/processMessageEditing",{processMessageEditing:function(e){c=e}},2),n.link("../../../../client/lib/chats/flows/processSetReaction",{processSetReaction:function(e){o=e}},3),n.link("../../../../client/lib/chats/flows/processSlashCommand",{processSlashCommand:function(e){u=e}},4),n.link("../../../../client/lib/chats/flows/processTooLongMessage",{processTooLongMessage:function(e){l=e}},5),n.link("../../../../client/lib/chats/flows/replyBroadcast",{replyBroadcast:function(e){d=e}},6),n.link("../../../../client/lib/chats/flows/requestMessageDeletion",{requestMessageDeletion:function(e){p=e}},7),n.link("../../../../client/lib/chats/flows/sendMessage",{sendMessage:function(e){f=e}},8),n.link("../../../../client/lib/chats/flows/uploadFiles",{uploadFiles:function(e){g=e}},9),n.link("../../../../client/lib/chats/readStateManager",{ReadStateManager:function(e){h=e}},10),n.link("../../../../client/lib/chats/uploads",{createUploadsAPI:function(e){x=e}},11),n.link("../../../../client/views/room/MessageList/providers/messageHighlightSubscription",{setHighlightMessage:function(e){m=e},clearHighlightMessage:function(e){b=e}},12),n.link("./UserAction",{UserAction:function(e){v=e}},13);var r,s,a,i,c,o,u,l,d,p,f,g,h,x,m,b,v,M=function(){function e(e){var t=this;this.params=void 0,this.uid=void 0,this.composer=void 0,this.setComposerAPI=function(e){var n;null===(n=t.composer)||void 0===n||n.release(),t.composer=e},this.data=void 0,this.readStateManager=void 0,this.uploads=void 0,this.ActionManager=void 0,this.userCard=void 0,this.emojiPicker=void 0,this.action=void 0,this.currentEditingMID=void 0,this.messageEditing={toPreviousMessage:function(){var e,n,s;return r.async(function(i){for(;;)switch(i.prev=i.next){case 0:if(t.composer){i.next=2;break}return i.abrupt("return");case 2:if(t.currentEditing){i.next=16;break}return i.next=5,r.awrap(t.data.findLastOwnMessage());case 5:if(!((e=i.sent)&&a(e))){i.next=10;break}return i.next=9,r.awrap(t.data.findPreviousOwnMessage(e));case 9:e=i.sent;case 10:if(!e){i.next=15;break}return i.next=13,r.awrap(t.data.saveDraft(void 0,t.composer.text));case 13:return i.next=15,r.awrap(t.messageEditing.editMessage(e));case 15:return i.abrupt("return");case 16:return i.next=18,r.awrap(t.data.findMessageByID(t.currentEditing.mid));case 18:if(!(n=i.sent)){i.next=25;break}return i.next=22,r.awrap(t.data.findPreviousOwnMessage(n));case 22:i.t0=i.sent,i.next=26;break;case 25:i.t0=void 0;case 26:if(!((s=i.t0)&&a(s))){i.next=31;break}return i.next=30,r.awrap(t.data.findPreviousOwnMessage(s));case 30:s=i.sent;case 31:if(!s){i.next=35;break}return i.next=34,r.awrap(t.messageEditing.editMessage(s));case 34:return i.abrupt("return");case 35:return i.next=37,r.awrap(t.currentEditing.cancel());case 37:case"end":return i.stop()}},null,null,null,Promise)},toNextMessage:function(){var e,n;return r.async(function(s){for(;;)switch(s.prev=s.next){case 0:if(!(!t.composer||!t.currentEditing)){s.next=2;break}return s.abrupt("return");case 2:return s.next=4,r.awrap(t.data.findMessageByID(t.currentEditing.mid));case 4:if(!(e=s.sent)){s.next=11;break}return s.next=8,r.awrap(t.data.findNextOwnMessage(e));case 8:s.t0=s.sent,s.next=12;break;case 11:s.t0=void 0;case 12:if(!((n=s.t0)&&a(n))){s.next=17;break}return s.next=16,r.awrap(t.data.findNextOwnMessage(n));case 16:n=s.sent;case 17:if(!n){s.next=21;break}return s.next=20,r.awrap(t.messageEditing.editMessage(n,{cursorAtStart:!0}));case 20:return s.abrupt("return");case 21:return s.next=23,r.awrap(t.currentEditing.cancel());case 23:case"end":return s.stop()}},null,null,null,Promise)},editMessage:function(e){var n,s,a,i,c,o,u=arguments;return r.async(function(l){for(;;)switch(l.prev=l.next){case 0:return c=void 0!==(i=(u.length>1&&void 0!==u[1]?u[1]:{}).cursorAtStart)&&i,l.next=3,r.awrap(t.data.getDraft(e._id));case 3:if(l.t1=l.sent,l.t1){l.next=6;break}l.t1=null===(n=e.attachments)||void 0===n?void 0:null===(s=n[0])||void 0===s?void 0:s.description;case 6:if(l.t0=l.t1,l.t0){l.next=9;break}l.t0=e.msg;case 9:return o=l.t0,l.next=12,r.awrap(null===(a=t.currentEditing)||void 0===a?void 0:a.stop());case 12:if(l.t2=!t.composer,l.t2){l.next=17;break}return l.next=16,r.awrap(t.data.canUpdateMessage(e));case 16:l.t2=!l.sent;case 17:if(!l.t2){l.next=19;break}return l.abrupt("return");case 19:t.currentEditingMID=e._id,m(e._id),t.composer.setEditingMode(!0),t.composer.setText(o),c&&t.composer.setCursorToStart(),c||t.composer.setCursorToEnd(),t.composer.focus();case 26:case"end":return l.stop()}},null,null,null,Promise)}},this.flows=void 0,this.params=e;var n=e.rid,s=e.tmid;this.uid=e.uid,this.data=i({rid:n,tmid:s}),this.uploads=x({rid:n,tmid:s}),this.ActionManager=e.actionManager;var b=function(){throw Error("Flow is not implemented")};this.readStateManager=new h(n),this.userCard={open:b,close:b},this.emojiPicker={open:b,close:b},this.action={start:function(t){return r.async(function(n){for(;;)switch(n.prev=n.next){case 0:v.start(e.rid,"user-"+t,{tmid:e.tmid});case 1:case"end":return n.stop()}},null,null,null,Promise)},performContinuously:function(t){return r.async(function(n){for(;;)switch(n.prev=n.next){case 0:v.performContinuously(e.rid,"user-"+t,{tmid:e.tmid});case 1:case"end":return n.stop()}},null,null,null,Promise)},stop:function(t){return r.async(function(n){for(;;)switch(n.prev=n.next){case 0:v.stop(e.rid,"user-"+t,{tmid:e.tmid});case 1:case"end":return n.stop()}},null,null,null,Promise)}},this.flows={uploadFiles:g.bind(null,this),sendMessage:f.bind(this,this),processSlashCommand:u.bind(null,this),processTooLongMessage:l.bind(null,this),processMessageEditing:c.bind(null,this),processSetReaction:o.bind(null,this),requestMessageDeletion:p.bind(this,this),replyBroadcast:d.bind(null,this)}}return e.prototype.release=function(){var e;return r.async(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.currentEditing){t.next=5;break}if(this.params.tmid){t.next=4;break}return t.next=4,r.awrap(this.currentEditing.cancel());case 4:null===(e=this.composer)||void 0===e||e.clear();case 5:case"end":return t.stop()}},null,this,null,Promise)},s(e,[{key:"currentEditing",get:function(){var e=this;if(this.composer&&this.currentEditingMID)return{mid:this.currentEditingMID,reset:function(){var t,n;return r.async(function(s){for(;;)switch(s.prev=s.next){case 0:if(!(!e.composer||!e.currentEditingMID)){s.next=2;break}return s.abrupt("return",!1);case 2:return s.next=4,r.awrap(e.data.findMessageByID(e.currentEditingMID));case 4:if(t=s.sent,!(e.composer.text!==(null==t?void 0:t.msg))){s.next=8;break}return e.composer.setText(null!==(n=null==t?void 0:t.msg)&&void 0!==n?n:""),s.abrupt("return",!0);case 8:return s.abrupt("return",!1);case 9:case"end":return s.stop()}},null,null,null,Promise)},stop:function(){var t,n;return r.async(function(s){for(;;)switch(s.prev=s.next){case 0:if(!(!e.composer||!e.currentEditingMID)){s.next=2;break}return s.abrupt("return");case 2:return s.next=4,r.awrap(e.data.findMessageByID(e.currentEditingMID));case 4:if(t=s.sent,(n=e.composer.text)!==(null==t?void 0:t.msg)){s.next=11;break}return s.next=9,r.awrap(e.data.discardDraft(e.currentEditingMID));case 9:s.next=23;break;case 11:return s.t0=r,s.t1=e.data,s.t2=e.currentEditingMID,s.next=16,r.awrap(e.data.getDraft(e.currentEditingMID));case 16:if(s.t3=s.sent,s.t3){s.next=19;break}s.t3=n;case 19:return s.t4=s.t3,s.t5=s.t1.saveDraft.call(s.t1,s.t2,s.t4),s.next=23,s.t0.awrap.call(s.t0,s.t5);case 23:e.composer.setEditingMode(!1),e.currentEditingMID=void 0,b();case 26:case"end":return s.stop()}},null,null,null,Promise)},cancel:function(){var t,n,s;return r.async(function(a){for(;;)switch(a.prev=a.next){case 0:if(e.currentEditingMID){a.next=2;break}return a.abrupt("return");case 2:return a.next=4,r.awrap(e.data.discardDraft(e.currentEditingMID));case 4:return a.next=6,r.awrap(null===(t=e.currentEditing)||void 0===t?void 0:t.stop());case 6:if(!(null===(n=e.composer)||void 0===n)){a.next=10;break}a.next=24;break;case 10:return a.t0=n,a.next=13,r.awrap(e.data.getDraft(void 0));case 13:if(a.t2=s=a.sent,a.t1=null!==a.t2,!a.t1){a.next=17;break}a.t1=void 0!==s;case 17:if(!a.t1){a.next=21;break}a.t3=s,a.next=22;break;case 21:a.t3="";case 22:a.t4=a.t3,a.t0.setText.call(a.t0,a.t4);case 24:case"end":return a.stop()}},null,null,null,Promise)}}}}]),e}()}
//# sourceMappingURL=/dynamic/app/ui/client/lib/267422b950572b92f8c91ffa89c9cbf4169f559f.map
