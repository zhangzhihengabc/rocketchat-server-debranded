function module(e,n,t){var r,i,a,s,u,l,c,o,d,f;t.link("@babel/runtime/regenerator",{default:function(e){r=e}},0),t.link("meteor/meteor",{Meteor:function(e){i=e}},0),t.link("../../../../client/lib/onClientMessageReceived",{onClientMessageReceived:function(e){a=e}},1),t.link("../../../../client/lib/toast",{dispatchToastMessage:function(e){s=e}},2),t.link("../../../../lib/callbacks",{callbacks:function(e){u=e}},3),t.link("../../../../lib/utils/stringUtils",{trim:function(e){l=e}},4),t.link("../../../models/client",{ChatMessage:function(e){c=e},ChatRoom:function(e){o=e}},5),t.link("../../../settings/client",{settings:function(e){d=e}},6),t.link("../../../utils/lib/i18n",{t:function(e){f=e}},7),i.methods({sendMessage:function(e){var n,t,m;return r.async(function(b){for(;;)switch(b.prev=b.next){case 0:if(!(!(n=i.userId())||""===l(e.msg))){b.next=3;break}return b.abrupt("return",!1);case 3:if(!(e._id&&c.findOne({_id:e._id}))){b.next=6;break}return b.abrupt("return",s({type:"error",message:f("Message_Already_Sent")}));case 6:if(null!=(t=i.user())&&t.username){b.next=9;break}throw new i.Error("error-invalid-user","Invalid user",{method:"sendMessage"});case 9:if(e.ts=new Date,e.u={_id:n,username:t.username,name:t.name||""},e.temp=!0,d.get("Message_Read_Receipt_Enabled")&&(e.unread=!0),!(null!=(m=o.findOne({_id:e.rid},{fields:{federated:1,name:1}}))&&m.federated)){b.next=16;break}return b.abrupt("return");case 16:return b.next=18,r.awrap(u.run("beforeSaveMessage",e));case 18:return e=b.sent,b.next=21,r.awrap(a(e).then(function(e){return c.insert(e),u.run("afterSaveMessage",e,m)}));case 21:case"end":return b.stop()}},null,null,null,Promise)}})}
//# sourceMappingURL=/dynamic/app/lib/client/methods/58bdeb6b4990d709be7cefdef139c3b5ffd82255.map
