)]}'
{"version":3,"sources":["meteor://ðŸ’»app/app/lib/client/lib/LoginPresence.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Meteor } from 'meteor/meteor';\n\nimport { settings } from '../../../settings/client';\n\nclass LoginPresence {\n\tprivate awayTime = 600_000; // 10 minutes\n\n\tprivate started = false;\n\n\tprivate timer: ReturnType<typeof setTimeout>;\n\n\tprivate startTimer(): void {\n\t\tthis.stopTimer();\n\t\tif (!this.awayTime) {\n\t\t\treturn;\n\t\t}\n\t\tthis.timer = setTimeout(() => this.disconnect(), this.awayTime);\n\t}\n\n\tprivate stopTimer(): void {\n\t\tclearTimeout(this.timer);\n\t}\n\n\tprivate disconnect(): void {\n\t\tconst status = Meteor.status();\n\t\tif (status && status.status !== 'offline') {\n\t\t\tif (!Meteor.userId() && settings.get('Accounts_AllowAnonymousRead') !== true) {\n\t\t\t\tMeteor.disconnect();\n\t\t\t}\n\t\t}\n\t\tthis.stopTimer();\n\t}\n\n\tprivate connect(): void {\n\t\tconst status = Meteor.status();\n\t\tif (status && status.status === 'offline') {\n\t\t\tMeteor.reconnect();\n\t\t}\n\t}\n\n\tpublic start(): void {\n\t\tif (this.started) {\n\t\t\treturn;\n\t\t}\n\n\t\twindow.addEventListener('focus', () => {\n\t\t\tthis.stopTimer();\n\t\t\tthis.connect();\n\t\t});\n\n\t\twindow.addEventListener('blur', () => {\n\t\t\tthis.startTimer();\n\t\t});\n\n\t\tif (!window.document.hasFocus()) {\n\t\t\tthis.startTimer();\n\t\t}\n\n\t\tthis.started = true;\n\t}\n}\n\nconst instance = new LoginPresence();\n\ninstance.start();\n\nexport { instance as LoginPresence };\n",null],"names":["module","export","LoginPresence","instance","Meteor","settings","awayTime","started","timer","_proto","prototype","startTimer","_this","stopTimer","setTimeout","disconnect","clearTimeout","status","userId","get","connect","reconnect","start","_this2","window","addEventListener","document","hasFocus"],"mappings":"uBAAAA,EAAOC,MAAE,CAAA,CAAMC,cAAQ,WAAgB,OAAAC,CAAA,CAAA,GAAAH,EAAAA,IAAAA,CAAAA,gBAAAA,CAAAI,OAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAJ,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAK,SAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GA8DvC,IA9DuCD,EAAAC,EA8DjCF,EAAW,GA1DE,CAAA,WAAA,SAAAD,IAAA,IAAA,CACVI,QAAQ,CAAG,IAAO,IAAA,CAElBC,OAAO,CAAG,CAAA,EAAK,IAAA,CAEfC,KAAK,CAAA,KAAA,CAAA,CAAA,IAAAC,EAAAP,EAAAQ,SAAA,CAkDZ,OAlDYD,EAELE,UAAU,CAAV,WAAU,IAAAC,EAAA,IAAA,CACjB,IAAI,CAACC,SAAS,GACT,IAAI,CAACP,QAAQ,EAGlB,CAAA,IAAI,CAACE,KAAK,CAAGM,WAAW,WAAA,OAAMF,EAAKG,UAAU,EAAE,EAAE,IAAI,CAACT,QAAQ,CAAA,CAC/D,EAACG,EAEOI,SAAS,CAAT,WACPG,aAAa,IAAI,CAACR,KAAK,CACxB,EAACC,EAEOM,UAAU,CAAV,WACP,IAAME,EAASb,EAAOa,MAAM,GACxBA,GAAUA,AAAkB,YAAlBA,EAAOA,MAAM,EACtB,CAACb,EAAOc,MAAM,IAAMb,AAAgD,CAAA,IAAhDA,EAASc,GAAG,CAAC,gCACpCf,EAAOW,UAAU,GAGnB,IAAI,CAACF,SAAS,EACf,EAACJ,EAEOW,OAAO,CAAP,WACP,IAAMH,EAASb,EAAOa,MAAM,GACxBA,GAAUA,AAAkB,YAAlBA,EAAOA,MAAM,EAC1Bb,EAAOiB,SAAS,EAElB,EAACZ,EAEMa,KAAK,CAAL,WAAK,IAAAC,EAAA,IAAA,AACP,CAAA,IAAI,CAAChB,OAAO,GAIhBiB,OAAOC,gBAAgB,CAAC,QAAS,WAChCF,EAAKV,SAAS,GACdU,EAAKH,OAAO,EACb,GAEAI,OAAOC,gBAAgB,CAAC,OAAQ,WAC/BF,EAAKZ,UAAU,EAChB,GAEKa,OAAOE,QAAQ,CAACC,QAAQ,IAC5B,IAAI,CAAChB,UAAU,GAGhB,IAAI,CAACJ,OAAO,CAAG,CAAA,EAChB,EAACL,CAAA,GAAA,EAKFC,EAASmB,KAAK"}