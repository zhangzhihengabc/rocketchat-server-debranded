)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/providers/VideoConfProvider.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IRoom } from '@rocket.chat/core-typings';\nimport type { ReactElement, ReactNode } from 'react';\nimport React, { useState, useMemo, useEffect } from 'react';\nimport type { Unsubscribe } from 'use-subscription';\n\nimport type { VideoConfPopupPayload } from '../contexts/VideoConfContext';\nimport { VideoConfContext } from '../contexts/VideoConfContext';\nimport type { DirectCallData, ProviderCapabilities, CallPreferences } from '../lib/VideoConfManager';\nimport { VideoConfManager } from '../lib/VideoConfManager';\nimport VideoConfPopups from '../views/room/contextualBar/VideoConference/VideoConfPopups';\nimport { useVideoConfOpenCall } from '../views/room/contextualBar/VideoConference/hooks/useVideoConfOpenCall';\n\nconst VideoConfContextProvider = ({ children }: { children: ReactNode }): ReactElement => {\n\tconst [outgoing, setOutgoing] = useState<VideoConfPopupPayload | undefined>();\n\tconst handleOpenCall = useVideoConfOpenCall();\n\n\tuseEffect(\n\t\t() =>\n\t\t\tVideoConfManager.on('call/join', (props) => {\n\t\t\t\thandleOpenCall(props.url, props.providerName);\n\t\t\t}),\n\t\t[handleOpenCall],\n\t);\n\n\tuseEffect(() => {\n\t\tVideoConfManager.on('direct/stopped', () => setOutgoing(undefined));\n\t\tVideoConfManager.on('calling/ended', () => setOutgoing(undefined));\n\t}, []);\n\n\tconst contextValue = useMemo(\n\t\t() => ({\n\t\t\tmanager: VideoConfManager,\n\t\t\tdispatchOutgoing: (option: Omit<VideoConfPopupPayload, 'id'>): void => setOutgoing({ ...option, id: option.rid }),\n\t\t\tdismissOutgoing: (): void => setOutgoing(undefined),\n\t\t\tstartCall: (rid: IRoom['_id'], confTitle?: string): Promise<void> => VideoConfManager.startCall(rid, confTitle),\n\t\t\tacceptCall: (callId: string): void => VideoConfManager.acceptIncomingCall(callId),\n\t\t\tjoinCall: (callId: string): Promise<void> => VideoConfManager.joinCall(callId),\n\t\t\tdismissCall: (callId: string): void => {\n\t\t\t\tVideoConfManager.dismissIncomingCall(callId);\n\t\t\t},\n\t\t\trejectIncomingCall: (callId: string): void => VideoConfManager.rejectIncomingCall(callId),\n\t\t\tabortCall: (): void => VideoConfManager.abortCall(),\n\t\t\tsetPreferences: (prefs: Partial<(typeof VideoConfManager)['preferences']>): void => VideoConfManager.setPreferences(prefs),\n\t\t\tqueryIncomingCalls: {\n\t\t\t\tgetCurrentValue: (): DirectCallData[] => VideoConfManager.getIncomingDirectCalls(),\n\t\t\t\tsubscribe: (cb: () => void): Unsubscribe => VideoConfManager.on('incoming/changed', cb),\n\t\t\t},\n\t\t\tqueryRinging: {\n\t\t\t\tgetCurrentValue: (): boolean => VideoConfManager.isRinging(),\n\t\t\t\tsubscribe: (cb: () => void): Unsubscribe => VideoConfManager.on('ringing/changed', cb),\n\t\t\t},\n\t\t\tqueryCalling: {\n\t\t\t\tgetCurrentValue: (): boolean => VideoConfManager.isCalling(),\n\t\t\t\tsubscribe: (cb: () => void): Unsubscribe => VideoConfManager.on('calling/changed', cb),\n\t\t\t},\n\t\t\tqueryCapabilities: {\n\t\t\t\tgetCurrentValue: (): ProviderCapabilities => VideoConfManager.capabilities,\n\t\t\t\tsubscribe: (cb: () => void): Unsubscribe => VideoConfManager.on('capabilities/changed', cb),\n\t\t\t},\n\t\t\tqueryPreferences: {\n\t\t\t\tgetCurrentValue: (): CallPreferences => VideoConfManager.preferences,\n\t\t\t\tsubscribe: (cb: () => void): Unsubscribe => VideoConfManager.on('preference/changed', cb),\n\t\t\t},\n\t\t}),\n\t\t[],\n\t);\n\n\treturn (\n\t\t<VideoConfContext.Provider value={contextValue}>\n\t\t\t{children}\n\t\t\t<VideoConfPopups>{outgoing}</VideoConfPopups>\n\t\t</VideoConfContext.Provider>\n\t);\n};\n\nexport default VideoConfContextProvider;\n",null],"names":["_objectSpread","_slicedToArray","React","useState","useMemo","useEffect","VideoConfContext","VideoConfManager","VideoConfPopups","useVideoConfOpenCall","module","link","default","v","exportDefault","_ref","children","_useState2","outgoing","setOutgoing","handleOpenCall","on","props","url","providerName","undefined","contextValue","manager","dispatchOutgoing","option","id","rid","dismissOutgoing","startCall","confTitle","acceptCall","callId","acceptIncomingCall","joinCall","dismissCall","dismissIncomingCall","rejectIncomingCall","abortCall","setPreferences","prefs","queryIncomingCalls","getCurrentValue","getIncomingDirectCalls","subscribe","cb","queryRinging","isRinging","queryCalling","isCalling","queryCapabilities","capabilities","queryPreferences","preferences","createElement","Provider","value"],"mappings":"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"}