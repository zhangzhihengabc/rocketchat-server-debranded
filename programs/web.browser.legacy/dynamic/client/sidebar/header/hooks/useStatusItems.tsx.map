)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/sidebar/header/hooks/useStatusItems.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IUser, ValueOf } from '@rocket.chat/core-typings';\nimport { UserStatus as UserStatusEnum } from '@rocket.chat/core-typings';\nimport { Box } from '@rocket.chat/fuselage';\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\nimport { useEndpoint, useSetting, useTranslation } from '@rocket.chat/ui-contexts';\nimport React from 'react';\n\nimport { userStatus } from '../../../../app/user-status/client';\nimport { callbacks } from '../../../../lib/callbacks';\nimport type { GenericMenuItemProps } from '../../../components/GenericMenu/GenericMenuItem';\nimport MarkdownText from '../../../components/MarkdownText';\nimport { UserStatus } from '../../../components/UserStatus';\nimport { useStatusDisabledModal } from '../../../views/admin/customUserStatus/hooks/useStatusDisabledModal';\nimport { useCustomStatusModalHandler } from './useCustomStatusModalHandler';\n\nconst isDefaultStatus = (id: string): boolean => (Object.values(UserStatusEnum) as string[]).includes(id);\nconst isDefaultStatusName = (_name: string, id: string): _name is UserStatusEnum => isDefaultStatus(id);\nconst translateStatusName = (t: ReturnType<typeof useTranslation>, status: (typeof userStatus.list)['']): string => {\n\tif (isDefaultStatusName(status.name, status.id)) {\n\t\treturn t(status.name as TranslationKey);\n\t}\n\n\treturn status.name;\n};\n\nexport const useStatusItems = (user: IUser): GenericMenuItemProps[] => {\n\tconst t = useTranslation();\n\tconst presenceDisabled = useSetting<boolean>('Presence_broadcast_disabled');\n\tconst setStatus = useEndpoint('POST', '/v1/users.setStatus');\n\n\tconst setStatusAction = (status: (typeof userStatus.list)['']): void => {\n\t\tsetStatus({ status: status.statusType, message: !isDefaultStatus(status.id) ? status.name : '' });\n\t\tvoid callbacks.run('userStatusManuallySet', status);\n\t};\n\n\tconst filterInvisibleStatus = !useSetting('Accounts_AllowInvisibleStatusOption')\n\t\t? (status: ValueOf<(typeof userStatus)['list']>): boolean => status.name !== 'invisible'\n\t\t: (): boolean => true;\n\n\tconst handleCustomStatus = useCustomStatusModalHandler();\n\n\tconst handleStatusDisabledModal = useStatusDisabledModal();\n\n\tconst presenceDisabledItem = {\n\t\tid: 'presence-disabled',\n\t\tcontent: (\n\t\t\t<Box fontScale='p2'>\n\t\t\t\t<Box mbe={4} wordBreak='break-word' style={{ whiteSpace: 'normal' }}>\n\t\t\t\t\t{t('User_status_disabled')}\n\t\t\t\t</Box>\n\t\t\t\t<Box is='a' color='info' onClick={handleStatusDisabledModal}>\n\t\t\t\t\t{t('Learn_more')}\n\t\t\t\t</Box>\n\t\t\t</Box>\n\t\t),\n\t};\n\n\tconst statusItems = Object.values(userStatus.list)\n\t\t.filter(filterInvisibleStatus)\n\t\t.map((status) => {\n\t\t\tconst name = status.localizeName ? translateStatusName(t, status) : status.name;\n\t\t\tconst modifier = status.statusType || user?.status;\n\t\t\treturn {\n\t\t\t\tid: status.id,\n\t\t\t\tstatus: <UserStatus status={modifier} />,\n\t\t\t\tcontent: <MarkdownText content={name} parseEmoji={true} variant='inline' />,\n\t\t\t\tonClick: () => setStatusAction(status),\n\t\t\t\tdisabled: presenceDisabled,\n\t\t\t};\n\t\t});\n\n\treturn [\n\t\t...(presenceDisabled ? [presenceDisabledItem] : []),\n\t\t...statusItems,\n\t\t{ id: 'custom-status', icon: 'emoji', content: t('Custom_Status'), onClick: handleCustomStatus, disabled: presenceDisabled },\n\t];\n};\n",null],"names":["module","default","_toConsumableArray","export","useStatusItems","UserStatus","UserStatusEnum","Box","useEndpoint","useSetting","useTranslation","v","React","userStatus","callbacks","MarkdownText","useStatusDisabledModal","useCustomStatusModalHandler","isDefaultStatus","id","Object","values","includes","user","t","presenceDisabled","setStatus","setStatusAction","status","statusType","message","name","run","filterInvisibleStatus","handleCustomStatus","handleStatusDisabledModal","presenceDisabledItem","content","createElement","fontScale","mbe","wordBreak","style","whiteSpace","is","color","onClick","statusItems","list","filter","map","localizeName","modifier","parseEmoji","variant","disabled","concat","icon"],"mappings":"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"}