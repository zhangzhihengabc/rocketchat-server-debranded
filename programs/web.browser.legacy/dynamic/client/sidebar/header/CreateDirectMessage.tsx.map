)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/sidebar/header/CreateDirectMessage.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IUser } from '@rocket.chat/core-typings';\nimport { Box, Modal, Button, FieldGroup, Field, FieldRow, FieldLabel, FieldError } from '@rocket.chat/fuselage';\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation, useEndpoint, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\nimport { useMutation } from '@tanstack/react-query';\nimport React, { memo } from 'react';\nimport { useForm, Controller } from 'react-hook-form';\n\nimport UserAutoCompleteMultipleFederated from '../../components/UserAutoCompleteMultiple/UserAutoCompleteMultipleFederated';\nimport { goToRoomById } from '../../lib/utils/goToRoomById';\n\nconst CreateDirectMessage = ({ onClose }: { onClose: () => void }) => {\n\tconst t = useTranslation();\n\tconst membersFieldId = useUniqueId();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst createDirectAction = useEndpoint('POST', '/v1/dm.create');\n\n\tconst {\n\t\tcontrol,\n\t\thandleSubmit,\n\t\tformState: { isDirty, isSubmitting, isValidating, errors },\n\t} = useForm({ mode: 'onBlur', defaultValues: { users: [] } });\n\n\tconst mutateDirectMessage = useMutation({\n\t\tmutationFn: createDirectAction,\n\t\tonSuccess: ({ room: { rid } }) => {\n\t\t\tgoToRoomById(rid);\n\t\t},\n\t\tonError: (error) => {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t},\n\t\tonSettled: () => {\n\t\t\tonClose();\n\t\t},\n\t});\n\n\tconst handleCreate = async ({ users }: { users: IUser['username'][] }) => {\n\t\treturn mutateDirectMessage.mutateAsync({ usernames: users.join(',') });\n\t};\n\n\treturn (\n\t\t<Modal data-qa='create-direct-modal' wrapperFunction={(props) => <Box is='form' onSubmit={handleSubmit(handleCreate)} {...props} />}>\n\t\t\t<Modal.Header>\n\t\t\t\t<Modal.Title>{t('Create_direct_message')}</Modal.Title>\n\t\t\t\t<Modal.Close tabIndex={-1} onClick={onClose} />\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Content mbe={2}>\n\t\t\t\t<Box mbe={24}>{t('Direct_message_creation_description')}</Box>\n\t\t\t\t<FieldGroup>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<FieldLabel htmlFor={membersFieldId} required>\n\t\t\t\t\t\t\t{t('Members')}\n\t\t\t\t\t\t</FieldLabel>\n\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t<Controller\n\t\t\t\t\t\t\t\tname='users'\n\t\t\t\t\t\t\t\trules={{ required: t('error-the-field-is-required', { field: t('Members') }) }}\n\t\t\t\t\t\t\t\tcontrol={control}\n\t\t\t\t\t\t\t\trender={({ field: { name, onChange, value, onBlur } }) => (\n\t\t\t\t\t\t\t\t\t<UserAutoCompleteMultipleFederated\n\t\t\t\t\t\t\t\t\t\tname={name}\n\t\t\t\t\t\t\t\t\t\tonChange={onChange}\n\t\t\t\t\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\t\t\t\t\tonBlur={onBlur}\n\t\t\t\t\t\t\t\t\t\tid={membersFieldId}\n\t\t\t\t\t\t\t\t\t\taria-describedby={`${membersFieldId}-error`}\n\t\t\t\t\t\t\t\t\t\taria-required='true'\n\t\t\t\t\t\t\t\t\t\taria-invalid={Boolean(errors.users)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t{errors.users && (\n\t\t\t\t\t\t\t<FieldError aria-live='assertive' id={`${membersFieldId}-error`}>\n\t\t\t\t\t\t\t\t{errors.users.message}\n\t\t\t\t\t\t\t</FieldError>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Field>\n\t\t\t\t</FieldGroup>\n\t\t\t</Modal.Content>\n\t\t\t<Modal.Footer>\n\t\t\t\t<Modal.FooterControllers>\n\t\t\t\t\t<Button onClick={onClose}>{t('Cancel')}</Button>\n\t\t\t\t\t<Button disabled={!isDirty} loading={isSubmitting || isValidating} type='submit' primary>\n\t\t\t\t\t\t{t('Create')}\n\t\t\t\t\t</Button>\n\t\t\t\t</Modal.FooterControllers>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n};\n\nexport default memo(CreateDirectMessage);\n",null],"names":["_extends","_regeneratorRuntime","Box","Modal","Button","FieldGroup","Field","FieldRow","FieldLabel","FieldError","useUniqueId","useTranslation","useEndpoint","useToastMessageDispatch","useMutation","React","memo","useForm","Controller","UserAutoCompleteMultipleFederated","goToRoomById","module","link","default","v","exportDefault","_ref","onClose","t","membersFieldId","dispatchToastMessage","createDirectAction","_useForm","mode","defaultValues","users","control","handleSubmit","_useForm$formState","formState","isDirty","isSubmitting","isValidating","errors","mutateDirectMessage","mutationFn","onSuccess","_ref2","room","rid","onError","error","type","message","onSettled","handleCreate","_ref3","async","_context","prev","next","abrupt","mutateAsync","usernames","join","stop","Promise","createElement","wrapperFunction","props","is","onSubmit","Header","Title","Close","tabIndex","onClick","Content","mbe","htmlFor","required","name","rules","field","render","_ref4","_ref4$field","onChange","value","onBlur","id","Boolean","Footer","FooterControllers","disabled","loading","primary"],"mappings":"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"}