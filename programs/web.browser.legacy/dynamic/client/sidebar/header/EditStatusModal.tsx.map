)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/sidebar/header/EditStatusModal.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IUser } from '@rocket.chat/core-typings';\nimport { Field, TextInput, FieldGroup, Modal, Button, Box, FieldLabel, FieldRow, FieldError, FieldHint } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useToastMessageDispatch, useSetting, useTranslation, useEndpoint } from '@rocket.chat/ui-contexts';\nimport type { ReactElement, ChangeEvent, ComponentProps, FormEvent } from 'react';\nimport React, { useState, useCallback } from 'react';\n\nimport UserStatusMenu from '../../components/UserStatusMenu';\nimport { USER_STATUS_TEXT_MAX_LENGTH } from '../../lib/constants';\n\ntype EditStatusModalProps = {\n\tonClose: () => void;\n\tuserStatus: IUser['status'];\n\tuserStatusText: IUser['statusText'];\n};\n\nconst EditStatusModal = ({ onClose, userStatus, userStatusText }: EditStatusModalProps): ReactElement => {\n\tconst allowUserStatusMessageChange = useSetting('Accounts_AllowUserStatusMessageChange');\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst t = useTranslation();\n\tconst [statusText, setStatusText] = useState(userStatusText);\n\tconst [statusType, setStatusType] = useState(userStatus);\n\tconst [statusTextError, setStatusTextError] = useState<string | undefined>();\n\n\tconst setUserStatus = useEndpoint('POST', '/v1/users.setStatus');\n\n\tconst handleStatusText = useMutableCallback((e: ChangeEvent<HTMLInputElement>): void => {\n\t\tsetStatusText(e.currentTarget.value);\n\n\t\tif (statusText && statusText.length > USER_STATUS_TEXT_MAX_LENGTH) {\n\t\t\treturn setStatusTextError(t('Max_length_is', USER_STATUS_TEXT_MAX_LENGTH));\n\t\t}\n\n\t\treturn setStatusTextError(undefined);\n\t});\n\n\tconst handleStatusType = (type: IUser['status']): void => setStatusType(type);\n\n\tconst handleSaveStatus = useCallback(async () => {\n\t\ttry {\n\t\t\tawait setUserStatus({ message: statusText, status: statusType });\n\t\t\tdispatchToastMessage({ type: 'success', message: t('StatusMessage_Changed_Successfully') });\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\n\t\tonClose();\n\t}, [dispatchToastMessage, setUserStatus, statusText, statusType, onClose, t]);\n\n\treturn (\n\t\t<Modal\n\t\t\twrapperFunction={(props: ComponentProps<typeof Box>) => (\n\t\t\t\t<Box\n\t\t\t\t\tis='form'\n\t\t\t\t\tonSubmit={(e: FormEvent) => {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\thandleSaveStatus();\n\t\t\t\t\t}}\n\t\t\t\t\t{...props}\n\t\t\t\t/>\n\t\t\t)}\n\t\t>\n\t\t\t<Modal.Header>\n\t\t\t\t<Modal.Icon name='info' />\n\t\t\t\t<Modal.Title>{t('Edit_Status')}</Modal.Title>\n\t\t\t\t<Modal.Close onClick={onClose} />\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Content fontScale='p2'>\n\t\t\t\t<FieldGroup>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<FieldLabel>{t('StatusMessage')}</FieldLabel>\n\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\t\terror={statusTextError}\n\t\t\t\t\t\t\t\tdisabled={!allowUserStatusMessageChange}\n\t\t\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t\t\tvalue={statusText}\n\t\t\t\t\t\t\t\tonChange={handleStatusText}\n\t\t\t\t\t\t\t\tplaceholder={t('StatusMessage_Placeholder')}\n\t\t\t\t\t\t\t\taddon={<UserStatusMenu margin='neg-x2' onChange={handleStatusType} initialStatus={statusType} />}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t{!allowUserStatusMessageChange && <FieldHint>{t('StatusMessage_Change_Disabled')}</FieldHint>}\n\t\t\t\t\t\t<FieldError>{statusTextError}</FieldError>\n\t\t\t\t\t</Field>\n\t\t\t\t</FieldGroup>\n\t\t\t</Modal.Content>\n\t\t\t<Modal.Footer>\n\t\t\t\t<Modal.FooterControllers>\n\t\t\t\t\t<Button secondary onClick={onClose}>\n\t\t\t\t\t\t{t('Cancel')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button primary type='submit' disabled={!!statusTextError}>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</Modal.FooterControllers>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n};\n\nexport default EditStatusModal;\n",null],"names":["_regeneratorRuntime","_extends","_slicedToArray","Field","TextInput","FieldGroup","Modal","Button","Box","FieldLabel","FieldRow","FieldHint","useMutableCallback","useToastMessageDispatch","useSetting","useTranslation","useEndpoint","React","useState","useCallback","UserStatusMenu","USER_STATUS_TEXT_MAX_LENGTH","module","link","default","v","FieldError","exportDefault","_ref","onClose","userStatus","userStatusText","allowUserStatusMessageChange","dispatchToastMessage","t","_useState2","statusText","setStatusText","_useState4","statusType","setStatusType","_useState6","statusTextError","setStatusTextError","setUserStatus","handleStatusText","e","currentTarget","value","length","undefined","handleSaveStatus","async","_context","prev","next","awrap","message","status","type","t0","stop","Promise","createElement","wrapperFunction","props","is","onSubmit","preventDefault","Header","Icon","name","Title","Close","onClick","Content","fontScale","error","disabled","flexGrow","onChange","placeholder","addon","margin","initialStatus","Footer","FooterControllers","secondary","primary"],"mappings":"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"}