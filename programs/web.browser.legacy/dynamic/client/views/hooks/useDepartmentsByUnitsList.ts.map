)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/hooks/useDepartmentsByUnitsList.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { ILivechatDepartment, IOmnichannelBusinessUnit } from '@rocket.chat/core-typings';\nimport { useTranslation, useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useCallback, useState } from 'react';\n\nimport { useScrollableRecordList } from '../../hooks/lists/useScrollableRecordList';\nimport { useComponentDidUpdate } from '../../hooks/useComponentDidUpdate';\nimport { RecordList } from '../../lib/lists/RecordList';\n\ntype DepartmentsListOptions = {\n\tunitId?: IOmnichannelBusinessUnit['_id'];\n\tfilter: string;\n};\n\nexport const useDepartmentsByUnitsList = (\n\toptions: DepartmentsListOptions,\n): {\n\titemsList: RecordList<ILivechatDepartment>;\n\tinitialItemCount: number;\n\treload: () => void;\n\tloadMoreItems: (start: number, end: number) => void;\n} => {\n\tconst t = useTranslation();\n\tconst [itemsList, setItemsList] = useState(() => new RecordList<ILivechatDepartment>());\n\tconst reload = useCallback(() => setItemsList(new RecordList<ILivechatDepartment>()), []);\n\n\tconst getDepartments = useEndpoint('GET', '/v1/livechat/units/:unitId/departments/available', { unitId: options.unitId || 'none' });\n\n\tuseComponentDidUpdate(() => {\n\t\toptions && reload();\n\t}, [options, reload]);\n\n\tconst fetchData = useCallback(\n\t\tasync (start, end) => {\n\t\t\tconst { departments, total } = await getDepartments({\n\t\t\t\ttext: options.filter,\n\t\t\t\toffset: start,\n\t\t\t\tcount: end + start,\n\t\t\t});\n\n\t\t\treturn {\n\t\t\t\titems: departments.map(({ _id, name, _updatedAt, ...department }) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...department,\n\t\t\t\t\t\t_id,\n\t\t\t\t\t\tname: department.archived ? `${name} [${t('Archived')}]` : name,\n\t\t\t\t\t\tlabel: name,\n\t\t\t\t\t\tvalue: _id,\n\t\t\t\t\t};\n\t\t\t\t}),\n\t\t\t\titemCount: total,\n\t\t\t};\n\t\t},\n\t\t[getDepartments, options.filter, t],\n\t);\n\n\tconst { loadMoreItems, initialItemCount } = useScrollableRecordList(itemsList, fetchData, 25);\n\n\treturn {\n\t\treload,\n\t\titemsList,\n\t\tloadMoreItems,\n\t\tinitialItemCount,\n\t};\n};\n",null],"names":["_regeneratorRuntime","_objectSpread","_objectWithoutProperties","_slicedToArray","useTranslation","useEndpoint","useCallback","useState","useScrollableRecordList","useComponentDidUpdate","RecordList","module","link","default","v","export","useDepartmentsByUnitsList","options","t","_useState2","itemsList","setItemsList","reload","getDepartments","unitId","_useScrollableRecordL","start","end","_await$getDepartments","departments","total","async","_context","prev","next","awrap","text","filter","offset","count","sent","abrupt","items","map","_ref","_id","name","department","_updatedAt","_excluded","archived","label","value","itemCount","stop","Promise","loadMoreItems","initialItemCount"],"mappings":"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"}