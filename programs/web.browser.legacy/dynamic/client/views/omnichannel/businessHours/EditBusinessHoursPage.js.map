)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/businessHours/EditBusinessHoursPage.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Button, ButtonGroup, Callout } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useToastMessageDispatch, useRoute, useMethod, useTranslation } from '@rocket.chat/ui-contexts';\nimport React, { useRef, useMemo, useState } from 'react';\n\nimport Page from '../../../components/Page';\nimport PageSkeleton from '../../../components/PageSkeleton';\nimport { AsyncStatePhase } from '../../../hooks/useAsyncState';\nimport { useEndpointData } from '../../../hooks/useEndpointData';\nimport BusinessHoursFormContainer from './BusinessHoursFormContainer';\nimport { useIsSingleBusinessHours } from './BusinessHoursRouter';\nimport { mapBusinessHoursForm } from './mapBusinessHoursForm';\n\nconst EditBusinessHoursPage = ({ id, type }) => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst isSingleBH = useIsSingleBusinessHours();\n\n\tconst { value: data, phase: state } = useEndpointData('/v1/livechat/business-hour', {\n\t\tparams: useMemo(() => ({ _id: id, type }), [id, type]),\n\t});\n\n\tconst saveData = useRef({ form: {} });\n\n\tconst [hasChanges, setHasChanges] = useState(false);\n\n\tconst save = useMethod('livechat:saveBusinessHour');\n\tconst deleteBH = useMethod('livechat:removeBusinessHour');\n\n\tconst router = useRoute('omnichannel-businessHours');\n\n\tconst handleSave = useMutableCallback(async () => {\n\t\tif (state !== AsyncStatePhase.RESOLVED || !data.success) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst {\n\t\t\tcurrent: { form, multiple: { departments, ...multiple } = {}, timezone: { name: timezoneName } = {} },\n\t\t} = saveData;\n\n\t\tif (data.businessHour.type !== 'default' && multiple.name === '') {\n\t\t\treturn dispatchToastMessage({\n\t\t\t\ttype: 'error',\n\t\t\t\tmessage: t('error-the-field-is-required', { field: t('Name') }),\n\t\t\t});\n\t\t}\n\n\t\tconst mappedForm = mapBusinessHoursForm(form, data.businessHour);\n\n\t\tconst departmentsToApplyBusinessHour = departments?.map((dep) => dep.value).join(',') || '';\n\n\t\ttry {\n\t\t\tconst payload = {\n\t\t\t\t...data.businessHour,\n\t\t\t\t...multiple,\n\t\t\t\tdepartmentsToApplyBusinessHour: departmentsToApplyBusinessHour ?? '',\n\t\t\t\ttimezoneName: timezoneName || data.businessHour.timezone.name,\n\t\t\t\tworkHours: mappedForm,\n\t\t\t};\n\n\t\t\tawait save(payload);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Business_hours_updated') });\n\t\t\trouter.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst handleDelete = useMutableCallback(async () => {\n\t\tif (type !== 'custom') {\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tawait deleteBH(id, type);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Business_Hour_Removed') });\n\t\t\trouter.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst handleReturn = useMutableCallback(() => {\n\t\trouter.push({});\n\t});\n\n\tif (state === AsyncStatePhase.LOADING) {\n\t\treturn <PageSkeleton />;\n\t}\n\n\tif (state === AsyncStatePhase.REJECTED || (AsyncStatePhase.RESOLVED && !data.businessHour)) {\n\t\treturn (\n\t\t\t<Page>\n\t\t\t\t<Page.Header title={t('Business_Hours')}>\n\t\t\t\t\t<Button onClick={handleReturn}>{t('Back')}</Button>\n\t\t\t\t</Page.Header>\n\t\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t\t<Callout type='danger'>{t('Error')}</Callout>\n\t\t\t\t</Page.ScrollableContentWithShadow>\n\t\t\t</Page>\n\t\t);\n\t}\n\n\treturn (\n\t\t<Page>\n\t\t\t<Page.Header title={t('Business_Hours')}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t{!isSingleBH && <Button onClick={handleReturn}>{t('Back')}</Button>}\n\t\t\t\t\t{type === 'custom' && (\n\t\t\t\t\t\t<Button danger onClick={handleDelete}>\n\t\t\t\t\t\t\t{t('Delete')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t<Button primary onClick={handleSave} disabled={!hasChanges}>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Header>\n\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t<BusinessHoursFormContainer data={data.businessHour} saveRef={saveData} onChange={setHasChanges} />\n\t\t\t</Page.ScrollableContentWithShadow>\n\t\t</Page>\n\t);\n};\n\nexport default EditBusinessHoursPage;\n",null],"names":["_regeneratorRuntime","_objectSpread","_objectWithoutProperties","_slicedToArray","Button","ButtonGroup","Callout","useMutableCallback","useToastMessageDispatch","useRoute","useMethod","useTranslation","React","useRef","useMemo","useState","Page","PageSkeleton","AsyncStatePhase","useEndpointData","BusinessHoursFormContainer","useIsSingleBusinessHours","mapBusinessHoursForm","module","link","default","v","exportDefault","_ref","id","type","t","dispatchToastMessage","isSingleBH","_useEndpointData","params","_id","data","value","state","phase","saveData","form","_useState2","hasChanges","setHasChanges","save","deleteBH","router","handleSave","_saveData$current","_saveData$current$mul","departments","multiple","_saveData$current$tim","timezoneName","mappedForm","departmentsToApplyBusinessHour","payload","async","_context","prev","next","RESOLVED","success","abrupt","current","_excluded","timezone","name","businessHour","message","field","map","dep","join","workHours","awrap","push","t0","stop","Promise","handleDelete","_context2","handleReturn","LOADING","createElement","REJECTED","Header","title","onClick","ScrollableContentWithShadow","danger","primary","disabled","saveRef","onChange"],"mappings":"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"}