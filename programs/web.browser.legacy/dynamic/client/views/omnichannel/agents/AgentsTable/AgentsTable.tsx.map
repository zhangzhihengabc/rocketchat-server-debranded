)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/agents/AgentsTable/AgentsTable.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Pagination } from '@rocket.chat/fuselage';\nimport { useDebouncedValue, useMediaQuery, useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation } from '@rocket.chat/ui-contexts';\nimport { hashQueryKey } from '@tanstack/react-query';\nimport type { MutableRefObject } from 'react';\nimport React, { useMemo, useState, useEffect } from 'react';\n\nimport FilterByText from '../../../../components/FilterByText';\nimport GenericNoResults from '../../../../components/GenericNoResults/GenericNoResults';\nimport {\n\tGenericTable,\n\tGenericTableBody,\n\tGenericTableHeader,\n\tGenericTableHeaderCell,\n\tGenericTableLoadingTable,\n} from '../../../../components/GenericTable';\nimport { usePagination } from '../../../../components/GenericTable/hooks/usePagination';\nimport { useSort } from '../../../../components/GenericTable/hooks/useSort';\nimport { useAgentsQuery } from '../hooks/useAgentsQuery';\nimport { useQuery } from '../hooks/useQuery';\nimport AddAgent from './AddAgent';\nimport AgentsTableRow from './AgentsTableRow';\n\n// TODO: missing error state\nconst AgentsTable = ({ reload }: { reload: MutableRefObject<() => void> }) => {\n\tconst t = useTranslation();\n\tconst [filter, setFilter] = useState('');\n\n\tconst { sortBy, sortDirection, setSort } = useSort<'name' | 'username' | 'emails.address' | 'statusLivechat'>('name');\n\tconst debouncedFilter = useDebouncedValue(filter, 500);\n\tconst debouncedSort = useDebouncedValue(\n\t\tuseMemo(() => [sortBy, sortDirection], [sortBy, sortDirection]),\n\t\t500,\n\t) as ['name' | 'username' | 'emails.address' | 'statusLivechat', 'asc' | 'desc'];\n\n\tconst { current, itemsPerPage, setItemsPerPage, setCurrent, ...paginationProps } = usePagination();\n\n\tconst query = useQuery({ text: debouncedFilter, current, itemsPerPage }, debouncedSort);\n\tconst { data, isSuccess, isLoading, refetch } = useAgentsQuery(query);\n\n\tconst [defaultQuery] = useState(hashQueryKey([query]));\n\tconst queryHasChanged = defaultQuery !== hashQueryKey([query]);\n\n\tuseEffect(() => {\n\t\treload.current = refetch;\n\t}, [reload, refetch]);\n\treload.current = refetch;\n\n\tconst onHeaderClick = useMutableCallback((id) => {\n\t\tif (sortBy === id) {\n\t\t\tsetSort(id, sortDirection === 'asc' ? 'desc' : 'asc');\n\t\t\treturn;\n\t\t}\n\t\tsetSort(id, 'asc');\n\t});\n\n\tconst mediaQuery = useMediaQuery('(min-width: 1024px)');\n\n\tconst headers = (\n\t\t<>\n\t\t\t<GenericTableHeaderCell direction={sortDirection} sort='name' active={sortBy === 'name'} onClick={onHeaderClick}>\n\t\t\t\t{t('Name')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t{mediaQuery && (\n\t\t\t\t<GenericTableHeaderCell direction={sortDirection} sort='username' active={sortBy === 'username'} onClick={onHeaderClick}>\n\t\t\t\t\t{t('Username')}\n\t\t\t\t</GenericTableHeaderCell>\n\t\t\t)}\n\t\t\t<GenericTableHeaderCell direction={sortDirection} sort='emails.address' active={sortBy === 'emails.address'} onClick={onHeaderClick}>\n\t\t\t\t{t('Email')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell direction={sortDirection} sort='statusLivechat' active={sortBy === 'statusLivechat'} onClick={onHeaderClick}>\n\t\t\t\t{t('Livechat_status')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell w='x60'>{t('Remove')}</GenericTableHeaderCell>\n\t\t</>\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t<AddAgent reload={refetch} />\n\t\t\t{((isSuccess && data?.users.length > 0) || queryHasChanged) && <FilterByText onChange={({ text }) => setFilter(text)} />}\n\t\t\t{isLoading && (\n\t\t\t\t<GenericTable>\n\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t<GenericTableLoadingTable headerCells={mediaQuery ? 4 : 3} />\n\t\t\t\t\t</GenericTableBody>\n\t\t\t\t</GenericTable>\n\t\t\t)}\n\t\t\t{isSuccess && data?.users.length === 0 && queryHasChanged && <GenericNoResults />}\n\t\t\t{isSuccess && data.users.length === 0 && !queryHasChanged && (\n\t\t\t\t<GenericNoResults\n\t\t\t\t\ticon='headset'\n\t\t\t\t\ttitle={t('No_agents_yet')}\n\t\t\t\t\tdescription={t('No_agents_yet_description')}\n\t\t\t\t\tlinkHref='https://go.rocket.chat/omnichannel-docs'\n\t\t\t\t\tlinkText={t('Learn_more_about_agents')}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t{isSuccess && data?.users.length > 0 && (\n\t\t\t\t<>\n\t\t\t\t\t<GenericTable aria-busy={filter !== debouncedFilter} aria-live='assertive'>\n\t\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t\t<GenericTableBody data-qa='GenericTableAgentInfoBody'>\n\t\t\t\t\t\t\t{data?.users.map((user) => (\n\t\t\t\t\t\t\t\t<AgentsTableRow key={user._id} user={user} mediaQuery={mediaQuery} reload={refetch} />\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</GenericTableBody>\n\t\t\t\t\t</GenericTable>\n\t\t\t\t\t<Pagination\n\t\t\t\t\t\tdivider\n\t\t\t\t\t\tcurrent={current}\n\t\t\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\t\t\tcount={data?.total || 0}\n\t\t\t\t\t\tonSetItemsPerPage={setItemsPerPage}\n\t\t\t\t\t\tonSetCurrent={setCurrent}\n\t\t\t\t\t\t{...paginationProps}\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default AgentsTable;\n",null],"names":["_extends","_objectWithoutProperties","_slicedToArray","Pagination","useDebouncedValue","useMediaQuery","useMutableCallback","useTranslation","hashQueryKey","React","useMemo","useState","useEffect","FilterByText","GenericNoResults","GenericTable","GenericTableBody","GenericTableHeader","GenericTableHeaderCell","GenericTableLoadingTable","usePagination","useSort","useAgentsQuery","useQuery","AddAgent","AgentsTableRow","module","link","default","v","exportDefault","_ref","reload","t","_useState2","filter","setFilter","_useSort","sortBy","sortDirection","setSort","debouncedFilter","debouncedSort","_usePagination","current","itemsPerPage","setItemsPerPage","setCurrent","paginationProps","_excluded","query","text","_useAgentsQuery","data","isSuccess","isLoading","refetch","queryHasChanged","defaultQuery","_useState4","onHeaderClick","id","mediaQuery","headers","createElement","Fragment","direction","sort","active","onClick","w","users","length","onChange","_ref2","headerCells","icon","title","description","linkHref","linkText","map","user","key","_id","divider","count","total","onSetItemsPerPage","onSetCurrent"],"mappings":"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"}