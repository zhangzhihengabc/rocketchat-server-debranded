)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/queueList/QueueListTable.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { UserStatus } from '@rocket.chat/core-typings';\nimport { Box, Pagination } from '@rocket.chat/fuselage';\nimport { useMediaQuery } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation, useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useQuery } from '@tanstack/react-query';\nimport type { ReactElement } from 'react';\nimport React, { useMemo, useState } from 'react';\n\nimport GenericNoResults from '../../../components/GenericNoResults';\nimport {\n\tGenericTable,\n\tGenericTableHeader,\n\tGenericTableHeaderCell,\n\tGenericTableBody,\n\tGenericTableRow,\n\tGenericTableCell,\n\tGenericTableLoadingRow,\n} from '../../../components/GenericTable';\nimport { usePagination } from '../../../components/GenericTable/hooks/usePagination';\nimport { useSort } from '../../../components/GenericTable/hooks/useSort';\nimport UserAvatar from '../../../components/avatar/UserAvatar';\nimport { QueueListFilter } from './QueueListFilter';\n\nconst QueueListTable = (): ReactElement => {\n\tconst t = useTranslation();\n\tconst { current, itemsPerPage, setItemsPerPage: onSetItemsPerPage, setCurrent: onSetCurrent, ...paginationProps } = usePagination();\n\tconst { sortBy, sortDirection, setSort } = useSort<'servedBy' | 'department' | 'total' | 'status'>('servedBy');\n\n\tconst [filters, setFilters] = useState<{\n\t\tservedBy: string;\n\t\tstatus: string;\n\t\tdepartmentId: string;\n\t}>({\n\t\tservedBy: '',\n\t\tstatus: '',\n\t\tdepartmentId: '',\n\t});\n\n\tconst mediaQuery = useMediaQuery('(min-width: 1024px)');\n\n\tconst headers = (\n\t\t<>\n\t\t\t{mediaQuery && (\n\t\t\t\t<GenericTableHeaderCell key='servedBy' direction={sortDirection} active={sortBy === 'servedBy'} onClick={setSort} sort='servedBy'>\n\t\t\t\t\t{t('Served_By')}\n\t\t\t\t</GenericTableHeaderCell>\n\t\t\t)}\n\t\t\t<GenericTableHeaderCell\n\t\t\t\tkey='department'\n\t\t\t\tdirection={sortDirection}\n\t\t\t\tactive={sortBy === 'department'}\n\t\t\t\tonClick={setSort}\n\t\t\t\tsort='department'\n\t\t\t>\n\t\t\t\t{t('Department')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell key='total' direction={sortDirection} active={sortBy === 'total'} onClick={setSort} sort='total'>\n\t\t\t\t{t('Total')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell key='status' direction={sortDirection} active={sortBy === 'status'} onClick={setSort} sort='status'>\n\t\t\t\t{t('Status')}\n\t\t\t</GenericTableHeaderCell>\n\t\t</>\n\t);\n\n\tconst query = useMemo(() => {\n\t\tconst query: {\n\t\t\tagentId?: string;\n\t\t\tincludeOfflineAgents?: 'true' | 'false';\n\t\t\tdepartmentId?: string;\n\t\t\tsort: string;\n\t\t\tcount: number;\n\t\t} = {\n\t\t\tsort: `{ \"${sortBy}\": ${sortDirection === 'asc' ? 1 : -1} }`,\n\t\t\t...(itemsPerPage && { count: itemsPerPage }),\n\t\t\t...(current && { offset: current }),\n\t\t};\n\n\t\tif (filters.status !== 'online') {\n\t\t\tquery.includeOfflineAgents = 'true';\n\t\t}\n\t\tif (filters.servedBy) {\n\t\t\tquery.agentId = filters.servedBy;\n\t\t}\n\t\tif (filters.departmentId) {\n\t\t\tquery.departmentId = filters.departmentId;\n\t\t}\n\n\t\treturn query;\n\t}, [sortBy, sortDirection, itemsPerPage, current, filters.status, filters.departmentId, filters.servedBy]);\n\n\tconst getUserStatus = (status?: string) => {\n\t\tif (!status) {\n\t\t\treturn t('Offline');\n\t\t}\n\n\t\tswitch (status) {\n\t\t\tcase UserStatus.ONLINE:\n\t\t\t\treturn t('Online');\n\t\t\tcase UserStatus.AWAY:\n\t\t\t\treturn t('Away');\n\t\t\tcase UserStatus.BUSY:\n\t\t\t\treturn t('Busy');\n\t\t\tcase UserStatus.OFFLINE:\n\t\t\t\treturn t('Offline');\n\t\t\tdefault:\n\t\t\t\treturn status;\n\t\t}\n\t};\n\n\tconst getLivechatQueue = useEndpoint('GET', '/v1/livechat/queue');\n\tconst { data, isSuccess, isLoading } = useQuery(['livechat-queue', query], async () => getLivechatQueue(query));\n\n\treturn (\n\t\t<>\n\t\t\t<QueueListFilter setFilter={setFilters} />\n\t\t\t{isLoading && (\n\t\t\t\t<GenericTable>\n\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t<GenericTableLoadingRow cols={4} />\n\t\t\t\t\t</GenericTableBody>\n\t\t\t\t</GenericTable>\n\t\t\t)}\n\t\t\t{isSuccess && data?.queue.length === 0 && <GenericNoResults />}\n\t\t\t{isSuccess && data?.queue.length > 0 && (\n\t\t\t\t<>\n\t\t\t\t\t<GenericTable>\n\t\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t\t{data?.queue.map(({ user, department, chats }) => (\n\t\t\t\t\t\t\t\t<GenericTableRow key={user._id} tabIndex={0}>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>\n\t\t\t\t\t\t\t\t\t\t<Box display='flex' alignItems='center' mb='5px'>\n\t\t\t\t\t\t\t\t\t\t\t<UserAvatar size={mediaQuery ? 'x28' : 'x40'} username={user.username} />\n\t\t\t\t\t\t\t\t\t\t\t<Box display='flex' mi={8}>\n\t\t\t\t\t\t\t\t\t\t\t\t{user.username}\n\t\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t</GenericTableCell>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>{department ? department.name : ''}</GenericTableCell>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>{chats}</GenericTableCell>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>{getUserStatus(user?.status)}</GenericTableCell>\n\t\t\t\t\t\t\t\t</GenericTableRow>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</GenericTableBody>\n\t\t\t\t\t</GenericTable>\n\t\t\t\t\t<Pagination\n\t\t\t\t\t\tdivider\n\t\t\t\t\t\tcurrent={current}\n\t\t\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\t\t\tcount={data?.total || 0}\n\t\t\t\t\t\tonSetItemsPerPage={onSetItemsPerPage}\n\t\t\t\t\t\tonSetCurrent={onSetCurrent}\n\t\t\t\t\t\t{...paginationProps}\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default QueueListTable;\n",null],"names":["_regeneratorRuntime","_extends","_objectSpread","_slicedToArray","_objectWithoutProperties","UserStatus","Box","Pagination","useMediaQuery","useTranslation","useEndpoint","useQuery","React","useMemo","useState","GenericNoResults","GenericTable","GenericTableHeader","GenericTableHeaderCell","GenericTableBody","GenericTableRow","GenericTableCell","GenericTableLoadingRow","usePagination","useSort","UserAvatar","QueueListFilter","module","link","default","v","exportDefault","t","_usePagination","current","itemsPerPage","onSetItemsPerPage","setItemsPerPage","onSetCurrent","setCurrent","paginationProps","_excluded","_useSort","sortBy","sortDirection","setSort","_useState2","servedBy","status","departmentId","filters","setFilters","mediaQuery","headers","createElement","Fragment","key","direction","active","onClick","sort","query","count","offset","includeOfflineAgents","agentId","getUserStatus","ONLINE","AWAY","BUSY","OFFLINE","getLivechatQueue","_useQuery","async","_context","prev","next","abrupt","stop","Promise","data","isSuccess","isLoading","setFilter","cols","queue","length","map","_ref","user","department","chats","_id","tabIndex","withTruncatedText","display","alignItems","mb","size","username","mi","name","divider","total"],"mappings":"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"}