)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/customFields/NewCustomFieldsPage.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Box, Button, FieldGroup, ButtonGroup } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useToastMessageDispatch, useRoute, useMethod, useTranslation } from '@rocket.chat/ui-contexts';\nimport React, { useCallback, useState } from 'react';\n\nimport Page from '../../../components/Page';\nimport { useForm } from '../../../hooks/useForm';\nimport { CustomFieldsAdditionalFormContainer } from '../additionalForms';\nimport NewCustomFieldsForm from './NewCustomFieldsForm';\n\nconst initialValues = {\n\tfield: '',\n\tlabel: '',\n\tscope: 'visitor',\n\tvisibility: true,\n\tregexp: '',\n\tsearchable: true,\n};\n\nconst NewCustomFieldsPage = ({ reload }) => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst [additionalValues, setAdditionalValues] = useState({});\n\n\tconst router = useRoute('omnichannel-customfields');\n\n\tconst handleReturn = useCallback(() => {\n\t\trouter.push({});\n\t}, [router]);\n\n\tconst { values, handlers, hasUnsavedChanges } = useForm(initialValues);\n\n\tconst save = useMethod('livechat:saveCustomField');\n\n\tconst { hasError, data: additionalData, hasUnsavedChanges: additionalFormChanged } = additionalValues;\n\n\tconst { label, field } = values;\n\n\tconst canSave = !hasError && label && field && (additionalFormChanged || hasUnsavedChanges);\n\n\tconst handleSave = useMutableCallback(async () => {\n\t\ttry {\n\t\t\tawait save(undefined, {\n\t\t\t\t...values,\n\t\t\t\tvisibility: values.visibility ? 'visible' : 'hidden',\n\t\t\t\t...additionalData,\n\t\t\t});\n\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\treload();\n\t\t\trouter.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst handleAdditionalForm = useMutableCallback((val) => {\n\t\tsetAdditionalValues({ ...additionalValues, ...val });\n\t});\n\n\treturn (\n\t\t<Page>\n\t\t\t<Page.Header title={t('New_Custom_Field')}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t<Button icon='back' onClick={handleReturn}>\n\t\t\t\t\t\t{t('Back')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button data-qa-id='NewCustomFieldsPageButtonSave' primary onClick={handleSave} disabled={!canSave}>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Header>\n\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t<Box maxWidth='x600' w='full' alignSelf='center'>\n\t\t\t\t\t<FieldGroup>\n\t\t\t\t\t\t<NewCustomFieldsForm values={values} handlers={handlers} />\n\t\t\t\t\t\t<CustomFieldsAdditionalFormContainer onChange={handleAdditionalForm} state={values} />\n\t\t\t\t\t</FieldGroup>\n\t\t\t\t</Box>\n\t\t\t</Page.ScrollableContentWithShadow>\n\t\t</Page>\n\t);\n};\n\nexport default NewCustomFieldsPage;\n",null],"names":["module","link","default","v","_regeneratorRuntime","_objectSpread","_slicedToArray","Box","Button","FieldGroup","ButtonGroup","useMutableCallback","useToastMessageDispatch","useRoute","useMethod","useTranslation","React","useCallback","useState","Page","useForm","CustomFieldsAdditionalFormContainer","NewCustomFieldsForm","initialValues","field","label","scope","visibility","regexp","searchable","exportDefault","_ref","reload","t","dispatchToastMessage","_useState2","additionalValues","setAdditionalValues","router","handleReturn","push","_useForm","values","handlers","hasUnsavedChanges","save","hasError","additionalData","data","additionalFormChanged","handleSave","async","_context","prev","next","awrap","undefined","type","message","t0","stop","Promise","handleAdditionalForm","val","createElement","Header","title","icon","onClick","primary","disabled","ScrollableContentWithShadow","maxWidth","w","alignSelf","onChange","state"],"mappings":"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"}