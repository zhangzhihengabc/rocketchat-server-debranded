)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/customFields/EditCustomFieldsPage.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Box, Button, ButtonGroup, FieldGroup } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useToastMessageDispatch, useRoute, useMethod, useTranslation } from '@rocket.chat/ui-contexts';\nimport React, { useCallback, useState } from 'react';\n\nimport Page from '../../../components/Page';\nimport { useForm } from '../../../hooks/useForm';\nimport { CustomFieldsAdditionalFormContainer } from '../additionalForms';\nimport NewCustomFieldsForm from './NewCustomFieldsForm';\n\nconst getInitialValues = (cf) => ({\n\tid: cf._id,\n\tfield: cf._id,\n\tlabel: cf.label,\n\tscope: cf.scope,\n\tvisibility: cf.visibility === 'visible',\n\tsearchable: !!cf.searchable,\n\tregexp: cf.regexp,\n});\n\nconst EditCustomFieldsPage = ({ customField, id, reload }) => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst [additionalValues, setAdditionalValues] = useState({});\n\n\tconst router = useRoute('omnichannel-customfields');\n\n\tconst handleReturn = useCallback(() => {\n\t\trouter.push({});\n\t}, [router]);\n\n\tconst { values, handlers, hasUnsavedChanges } = useForm(getInitialValues(customField));\n\n\tconst save = useMethod('livechat:saveCustomField');\n\n\tconst { hasError, data: additionalData, hasUnsavedChanges: additionalFormChanged } = additionalValues;\n\n\tconst { label, field } = values;\n\n\tconst canSave = !hasError && label && field && (additionalFormChanged || hasUnsavedChanges);\n\n\tconst handleSave = useMutableCallback(async () => {\n\t\ttry {\n\t\t\tawait save(id, {\n\t\t\t\t...additionalData,\n\t\t\t\t...values,\n\t\t\t\tvisibility: values.visibility ? 'visible' : 'hidden',\n\t\t\t});\n\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\treload();\n\t\t\trouter.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst handleAdditionalForm = useMutableCallback((val) => {\n\t\tsetAdditionalValues({ ...additionalValues, ...val });\n\t});\n\n\treturn (\n\t\t<Page>\n\t\t\t<Page.Header title={t('Edit_Custom_Field')}>\n\t\t\t\t<ButtonGroup align='end'>\n\t\t\t\t\t<Button icon='back' onClick={handleReturn}>\n\t\t\t\t\t\t{t('Back')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button data-qa-id='BtnSaveEditCustomFieldsPage' primary onClick={handleSave} disabled={!canSave}>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Header>\n\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t<Box maxWidth='x600' w='full' alignSelf='center'>\n\t\t\t\t\t<FieldGroup>\n\t\t\t\t\t\t<NewCustomFieldsForm values={values} handlers={handlers} />\n\t\t\t\t\t\t<CustomFieldsAdditionalFormContainer onChange={handleAdditionalForm} state={values} data={customField} />\n\t\t\t\t\t</FieldGroup>\n\t\t\t\t</Box>\n\t\t\t</Page.ScrollableContentWithShadow>\n\t\t</Page>\n\t);\n};\n\nexport default EditCustomFieldsPage;\n",null],"names":["_regeneratorRuntime","_objectSpread","_slicedToArray","Box","Button","ButtonGroup","FieldGroup","useMutableCallback","useToastMessageDispatch","useRoute","useMethod","useTranslation","React","useCallback","useState","Page","useForm","CustomFieldsAdditionalFormContainer","NewCustomFieldsForm","module","link","default","v","exportDefault","_ref","customField","id","reload","t","dispatchToastMessage","_useState2","additionalValues","setAdditionalValues","router","handleReturn","push","_useForm","cf","_id","field","label","scope","visibility","searchable","regexp","values","handlers","hasUnsavedChanges","save","hasError","additionalData","data","additionalFormChanged","handleSave","async","_context","prev","next","awrap","type","message","t0","stop","Promise","handleAdditionalForm","val","createElement","Header","title","align","icon","onClick","primary","disabled","ScrollableContentWithShadow","maxWidth","w","alignSelf","onChange","state"],"mappings":"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"}