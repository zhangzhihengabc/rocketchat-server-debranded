)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/departments/EditDepartment.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { ILivechatDepartment, ILivechatDepartmentAgents, Serialized } from '@rocket.chat/core-typings';\nimport {\n\tFieldGroup,\n\tField,\n\tFieldLabel,\n\tFieldRow,\n\tFieldError,\n\tTextInput,\n\tBox,\n\tIcon,\n\tDivider,\n\tToggleSwitch,\n\tTextAreaInput,\n\tButtonGroup,\n\tButton,\n\tPaginatedSelectFiltered,\n} from '@rocket.chat/fuselage';\nimport { useDebouncedValue, useMutableCallback, useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport { useToastMessageDispatch, useRoute, useMethod, useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useQueryClient } from '@tanstack/react-query';\nimport React, { useMemo, useState } from 'react';\nimport { Controller, useForm } from 'react-hook-form';\n\nimport { useHasLicenseModule } from '../../../../ee/client/hooks/useHasLicenseModule';\nimport { validateEmail } from '../../../../lib/emailValidator';\nimport AutoCompleteDepartment from '../../../components/AutoCompleteDepartment';\nimport Page from '../../../components/Page';\nimport { useRecordList } from '../../../hooks/lists/useRecordList';\nimport { useRoomsList } from '../../../hooks/useRoomsList';\nimport { AsyncStatePhase } from '../../../lib/asyncState';\nimport { EeTextInput, EeTextAreaInput, EeNumberInput, DepartmentForwarding, DepartmentBusinessHours } from '../additionalForms';\nimport DepartmentsAgentsTable from './DepartmentAgentsTable/DepartmentAgentsTable';\nimport { DepartmentTags } from './DepartmentTags';\n\nexport type EditDepartmentProps = {\n\tid?: string;\n\ttitle: string;\n\tdata?: Serialized<{\n\t\tdepartment: ILivechatDepartment | null;\n\t\tagents?: ILivechatDepartmentAgents[];\n\t}>;\n\tallowedToForwardData?: Serialized<{\n\t\tdepartments: ILivechatDepartment[];\n\t}>;\n};\n\ntype InitialValueParams = {\n\tdepartment?: Serialized<ILivechatDepartment> | null;\n\tagents?: Serialized<ILivechatDepartmentAgents>[];\n\tallowedToForwardData?: EditDepartmentProps['allowedToForwardData'];\n};\n\nexport type IDepartmentAgent = Pick<ILivechatDepartmentAgents, 'agentId' | 'username' | 'count' | 'order'> & {\n\t_id?: string;\n\tname?: string;\n};\n\nexport type FormValues = {\n\tname: string;\n\temail: string;\n\tdescription: string;\n\tenabled: boolean;\n\tmaxNumberSimultaneousChat: number;\n\tshowOnRegistration: boolean;\n\tshowOnOfflineForm: boolean;\n\tabandonedRoomsCloseCustomMessage: string;\n\trequestTagBeforeClosingChat: boolean;\n\tofflineMessageChannelName: string;\n\tvisitorInactivityTimeoutInSeconds: number;\n\twaitingQueueMessage: string;\n\tdepartmentsAllowedToForward: { label: string; value: string }[];\n\tfallbackForwardDepartment: string;\n\tagentList: IDepartmentAgent[];\n\tchatClosingTags: string[];\n};\n\nfunction withDefault<T>(key: T | undefined | null, defaultValue: T) {\n\treturn key || defaultValue;\n}\n\nconst getInitialValues = ({ department, agents, allowedToForwardData }: InitialValueParams) => ({\n\tname: withDefault(department?.name, ''),\n\temail: withDefault(department?.email, ''),\n\tdescription: withDefault(department?.description, ''),\n\tenabled: !!department?.enabled,\n\tmaxNumberSimultaneousChat: department?.maxNumberSimultaneousChat,\n\tshowOnRegistration: !!department?.showOnRegistration,\n\tshowOnOfflineForm: !!department?.showOnOfflineForm,\n\tabandonedRoomsCloseCustomMessage: withDefault(department?.abandonedRoomsCloseCustomMessage, ''),\n\trequestTagBeforeClosingChat: !!department?.requestTagBeforeClosingChat,\n\tofflineMessageChannelName: withDefault(department?.offlineMessageChannelName, ''),\n\tvisitorInactivityTimeoutInSeconds: department?.visitorInactivityTimeoutInSeconds,\n\twaitingQueueMessage: withDefault(department?.waitingQueueMessage, ''),\n\tdepartmentsAllowedToForward: allowedToForwardData?.departments?.map((dep) => ({ label: dep.name, value: dep._id })) || [],\n\tfallbackForwardDepartment: withDefault(department?.fallbackForwardDepartment, ''),\n\tchatClosingTags: department?.chatClosingTags ?? [],\n\tagentList: agents || [],\n});\n\nfunction EditDepartment({ data, id, title, allowedToForwardData }: EditDepartmentProps) {\n\tconst t = useTranslation();\n\tconst departmentsRoute = useRoute('omnichannel-departments');\n\tconst queryClient = useQueryClient();\n\n\tconst { department, agents = [] } = data || {};\n\n\tconst hasLicense = useHasLicenseModule('livechat-enterprise');\n\n\tconst initialValues = getInitialValues({ department, agents, allowedToForwardData });\n\n\tconst {\n\t\tregister,\n\t\tcontrol,\n\t\thandleSubmit,\n\t\twatch,\n\t\tformState: { errors, isValid, isDirty, isSubmitting },\n\t} = useForm<FormValues>({ mode: 'onChange', defaultValues: initialValues });\n\n\tconst requestTagBeforeClosingChat = watch('requestTagBeforeClosingChat');\n\n\tconst [fallbackFilter, setFallbackFilter] = useState<string>('');\n\n\tconst debouncedFallbackFilter = useDebouncedValue(fallbackFilter, 500);\n\n\tconst { itemsList: RoomsList, loadMoreItems: loadMoreRooms } = useRoomsList(\n\t\tuseMemo(() => ({ text: debouncedFallbackFilter }), [debouncedFallbackFilter]),\n\t);\n\n\tconst { phase: roomsPhase, items: roomsItems, itemCount: roomsTotal } = useRecordList(RoomsList);\n\n\tconst saveDepartmentInfo = useMethod('livechat:saveDepartment');\n\tconst saveDepartmentAgentsInfoOnEdit = useEndpoint('POST', `/v1/livechat/department/:_id/agents`, { _id: id || '' });\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst handleSave = useMutableCallback(async (data: FormValues) => {\n\t\tconst {\n\t\t\tagentList,\n\t\t\tenabled,\n\t\t\tname,\n\t\t\tdescription,\n\t\t\tshowOnRegistration,\n\t\t\tshowOnOfflineForm,\n\t\t\temail,\n\t\t\tchatClosingTags,\n\t\t\tofflineMessageChannelName,\n\t\t\tmaxNumberSimultaneousChat,\n\t\t\tvisitorInactivityTimeoutInSeconds,\n\t\t\tabandonedRoomsCloseCustomMessage,\n\t\t\twaitingQueueMessage,\n\t\t\tdepartmentsAllowedToForward,\n\t\t\tfallbackForwardDepartment,\n\t\t} = data;\n\n\t\tconst payload = {\n\t\t\tenabled,\n\t\t\tname,\n\t\t\tdescription,\n\t\t\tshowOnRegistration,\n\t\t\tshowOnOfflineForm,\n\t\t\trequestTagBeforeClosingChat,\n\t\t\temail,\n\t\t\tchatClosingTags,\n\t\t\tofflineMessageChannelName,\n\t\t\tmaxNumberSimultaneousChat,\n\t\t\tvisitorInactivityTimeoutInSeconds,\n\t\t\tabandonedRoomsCloseCustomMessage,\n\t\t\twaitingQueueMessage,\n\t\t\tdepartmentsAllowedToForward: departmentsAllowedToForward?.map((dep) => dep.value),\n\t\t\tfallbackForwardDepartment,\n\t\t};\n\n\t\ttry {\n\t\t\tif (id) {\n\t\t\t\tconst { agentList: initialAgentList } = initialValues;\n\n\t\t\t\tconst agentListPayload = {\n\t\t\t\t\tupsert: agentList.filter(\n\t\t\t\t\t\t(agent) =>\n\t\t\t\t\t\t\t!initialAgentList.some(\n\t\t\t\t\t\t\t\t(initialAgent) =>\n\t\t\t\t\t\t\t\t\tinitialAgent._id === agent._id && agent.count === initialAgent.count && agent.order === initialAgent.order,\n\t\t\t\t\t\t\t),\n\t\t\t\t\t),\n\t\t\t\t\tremove: initialAgentList.filter((initialAgent) => !agentList.some((agent) => initialAgent._id === agent._id)),\n\t\t\t\t};\n\n\t\t\t\tawait saveDepartmentInfo(id, payload, []);\n\t\t\t\tif (agentListPayload.upsert.length > 0 || agentListPayload.remove.length > 0) {\n\t\t\t\t\tawait saveDepartmentAgentsInfoOnEdit(agentListPayload);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tawait saveDepartmentInfo(id ?? null, payload, agentList);\n\t\t\t}\n\t\t\tqueryClient.invalidateQueries(['/v1/livechat/department/:_id', id]);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\tdepartmentsRoute.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst handleReturn = useMutableCallback(() => {\n\t\tdepartmentsRoute.push({});\n\t});\n\n\tconst isFormValid = isValid && isDirty;\n\n\tconst formId = useUniqueId();\n\n\treturn (\n\t\t<Page flexDirection='row'>\n\t\t\t<Page>\n\t\t\t\t<Page.Header title={title}>\n\t\t\t\t\t<ButtonGroup>\n\t\t\t\t\t\t<Button icon='back' onClick={handleReturn}>\n\t\t\t\t\t\t\t{t('Back')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button type='submit' form={formId} primary disabled={!isFormValid} loading={isSubmitting}>\n\t\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</ButtonGroup>\n\t\t\t\t</Page.Header>\n\t\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t\t<FieldGroup\n\t\t\t\t\t\tw='full'\n\t\t\t\t\t\talignSelf='center'\n\t\t\t\t\t\tmaxWidth='x600'\n\t\t\t\t\t\tid={formId}\n\t\t\t\t\t\tis='form'\n\t\t\t\t\t\tautoComplete='off'\n\t\t\t\t\t\tonSubmit={handleSubmit(handleSave)}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Box display='flex' data-qa='DepartmentEditToggle-Enabled' flexDirection='row'>\n\t\t\t\t\t\t\t\t<FieldLabel>{t('Enabled')}</FieldLabel>\n\t\t\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t\t\t<ToggleSwitch flexGrow={1} {...register('enabled')} />\n\t\t\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Field>\n\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<FieldLabel>{t('Name')}*</FieldLabel>\n\t\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\t\t\tdata-qa='DepartmentEditTextInput-Name'\n\t\t\t\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t\t\t\terror={errors.name?.message as string}\n\t\t\t\t\t\t\t\t\tplaceholder={t('Name')}\n\t\t\t\t\t\t\t\t\t{...register('name', { required: t('The_field_is_required', 'name') })}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t\t{errors.name && <FieldError>{errors.name?.message}</FieldError>}\n\t\t\t\t\t\t</Field>\n\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<FieldLabel>{t('Description')}</FieldLabel>\n\t\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t\t<TextAreaInput\n\t\t\t\t\t\t\t\t\tdata-qa='DepartmentEditTextInput-Description'\n\t\t\t\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t\t\t\tplaceholder={t('Description')}\n\t\t\t\t\t\t\t\t\t{...register('description')}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t</Field>\n\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Box data-qa='DepartmentEditToggle-ShowOnRegistrationPage' display='flex' flexDirection='row'>\n\t\t\t\t\t\t\t\t<FieldLabel>{t('Show_on_registration_page')}</FieldLabel>\n\t\t\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t\t\t<ToggleSwitch flexGrow={1} {...register('showOnRegistration')} />\n\t\t\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Field>\n\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<FieldLabel>{t('Email')}*</FieldLabel>\n\t\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\t\t\tdata-qa='DepartmentEditTextInput-Email'\n\t\t\t\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t\t\t\terror={errors.email?.message as string}\n\t\t\t\t\t\t\t\t\taddon={<Icon name='mail' size='x20' />}\n\t\t\t\t\t\t\t\t\tplaceholder={t('Email')}\n\t\t\t\t\t\t\t\t\t{...register('email', {\n\t\t\t\t\t\t\t\t\t\trequired: t('The_field_is_required', 'email'),\n\t\t\t\t\t\t\t\t\t\tvalidate: (email) => validateEmail(email) || t('error-invalid-email-address'),\n\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t\t{errors.email && <FieldError>{errors.email?.message}</FieldError>}\n\t\t\t\t\t\t</Field>\n\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Box display='flex' data-qa='DepartmentEditToggle-ShowOnOfflinePage' flexDirection='row'>\n\t\t\t\t\t\t\t\t<FieldLabel>{t('Show_on_offline_page')}</FieldLabel>\n\t\t\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t\t\t<ToggleSwitch flexGrow={1} {...register('showOnOfflineForm')} />\n\t\t\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Field>\n\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<FieldLabel>{t('Livechat_DepartmentOfflineMessageToChannel')}</FieldLabel>\n\t\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t\t<Controller\n\t\t\t\t\t\t\t\t\tcontrol={control}\n\t\t\t\t\t\t\t\t\tname='offlineMessageChannelName'\n\t\t\t\t\t\t\t\t\trender={({ field: { value, onChange } }) => (\n\t\t\t\t\t\t\t\t\t\t<PaginatedSelectFiltered\n\t\t\t\t\t\t\t\t\t\t\tdata-qa='DepartmentSelect-LivechatDepartmentOfflineMessageToChannel'\n\t\t\t\t\t\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\t\t\t\t\t\tonChange={onChange}\n\t\t\t\t\t\t\t\t\t\t\tflexShrink={0}\n\t\t\t\t\t\t\t\t\t\t\tfilter={fallbackFilter}\n\t\t\t\t\t\t\t\t\t\t\tsetFilter={setFallbackFilter as (value?: string | number) => void}\n\t\t\t\t\t\t\t\t\t\t\toptions={roomsItems}\n\t\t\t\t\t\t\t\t\t\t\tplaceholder={t('Channel_name')}\n\t\t\t\t\t\t\t\t\t\t\tendReached={\n\t\t\t\t\t\t\t\t\t\t\t\troomsPhase === AsyncStatePhase.LOADING ? () => undefined : (start) => loadMoreRooms(start, Math.min(50, roomsTotal))\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\taria-busy={fallbackFilter !== debouncedFallbackFilter}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t</Field>\n\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Controller\n\t\t\t\t\t\t\t\tcontrol={control}\n\t\t\t\t\t\t\t\tname='maxNumberSimultaneousChat'\n\t\t\t\t\t\t\t\trender={({ field: { value, onChange } }) => (\n\t\t\t\t\t\t\t\t\t<EeNumberInput\n\t\t\t\t\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\t\t\t\t\thandler={onChange}\n\t\t\t\t\t\t\t\t\t\tlabel='Max_number_of_chats_per_agent'\n\t\t\t\t\t\t\t\t\t\tplaceholder='Max_number_of_chats_per_agent_description'\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Field>\n\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Controller\n\t\t\t\t\t\t\t\tcontrol={control}\n\t\t\t\t\t\t\t\tname='visitorInactivityTimeoutInSeconds'\n\t\t\t\t\t\t\t\trender={({ field: { value, onChange } }) => (\n\t\t\t\t\t\t\t\t\t<EeNumberInput\n\t\t\t\t\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\t\t\t\t\thandler={onChange}\n\t\t\t\t\t\t\t\t\t\tlabel='How_long_to_wait_to_consider_visitor_abandonment_in_seconds'\n\t\t\t\t\t\t\t\t\t\tplaceholder='Number_in_seconds'\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Field>\n\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Controller\n\t\t\t\t\t\t\t\tcontrol={control}\n\t\t\t\t\t\t\t\tname='abandonedRoomsCloseCustomMessage'\n\t\t\t\t\t\t\t\trender={({ field: { value, onChange } }) => (\n\t\t\t\t\t\t\t\t\t<EeTextInput\n\t\t\t\t\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\t\t\t\t\thandler={onChange}\n\t\t\t\t\t\t\t\t\t\tlabel='Livechat_abandoned_rooms_closed_custom_message'\n\t\t\t\t\t\t\t\t\t\tplaceholder='Enter_a_custom_message'\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Field>\n\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Controller\n\t\t\t\t\t\t\t\tcontrol={control}\n\t\t\t\t\t\t\t\tname='waitingQueueMessage'\n\t\t\t\t\t\t\t\trender={({ field: { value, onChange } }) => (\n\t\t\t\t\t\t\t\t\t<EeTextAreaInput value={value} handler={onChange} label='Waiting_queue_message' placeholder='Waiting_queue_message' />\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Field>\n\n\t\t\t\t\t\t{DepartmentForwarding && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<Controller\n\t\t\t\t\t\t\t\t\tcontrol={control}\n\t\t\t\t\t\t\t\t\tname='departmentsAllowedToForward'\n\t\t\t\t\t\t\t\t\trender={({ field: { value, onChange } }) => (\n\t\t\t\t\t\t\t\t\t\t<DepartmentForwarding\n\t\t\t\t\t\t\t\t\t\t\tdepartmentId={id ?? ''}\n\t\t\t\t\t\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\t\t\t\t\t\thandler={onChange}\n\t\t\t\t\t\t\t\t\t\t\tlabel='List_of_departments_for_forward'\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t{hasLicense && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<FieldLabel>{t('Fallback_forward_department')}</FieldLabel>\n\t\t\t\t\t\t\t\t<Controller\n\t\t\t\t\t\t\t\t\tcontrol={control}\n\t\t\t\t\t\t\t\t\tname='fallbackForwardDepartment'\n\t\t\t\t\t\t\t\t\trender={({ field: { value, onChange } }) => (\n\t\t\t\t\t\t\t\t\t\t<AutoCompleteDepartment\n\t\t\t\t\t\t\t\t\t\t\thaveNone\n\t\t\t\t\t\t\t\t\t\t\texcludeDepartmentId={department?._id}\n\t\t\t\t\t\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\t\t\t\t\t\tonChange={onChange}\n\t\t\t\t\t\t\t\t\t\t\tonlyMyDepartments\n\t\t\t\t\t\t\t\t\t\t\tshowArchived\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<Box display='flex' data-qa='DiscussionToggle-RequestTagBeforeCLosingChat' flexDirection='row'>\n\t\t\t\t\t\t\t\t<FieldLabel>{t('Request_tag_before_closing_chat')}</FieldLabel>\n\t\t\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t\t\t<ToggleSwitch\n\t\t\t\t\t\t\t\t\t\tdata-qa='DiscussionToggle-RequestTagBeforeCLosingChat'\n\t\t\t\t\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t\t\t\t\t{...register('requestTagBeforeClosingChat')}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Field>\n\n\t\t\t\t\t\t{requestTagBeforeClosingChat && (\n\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t<FieldLabel alignSelf='stretch'>{t('Conversation_closing_tags')}*</FieldLabel>\n\t\t\t\t\t\t\t\t<Controller\n\t\t\t\t\t\t\t\t\tcontrol={control}\n\t\t\t\t\t\t\t\t\tname='chatClosingTags'\n\t\t\t\t\t\t\t\t\trules={{ required: t('The_field_is_required', 'tags') }}\n\t\t\t\t\t\t\t\t\trender={({ field: { value, onChange } }) => (\n\t\t\t\t\t\t\t\t\t\t<DepartmentTags value={value} onChange={onChange} error={errors.chatClosingTags?.message as string} />\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t{errors.chatClosingTags && <FieldError>{errors.chatClosingTags?.message}</FieldError>}\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<DepartmentBusinessHours bhId={department?.businessHourId} />\n\t\t\t\t\t\t</Field>\n\n\t\t\t\t\t\t<Divider mb={16} />\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<FieldLabel mb={4}>{t('Agents')}:</FieldLabel>\n\t\t\t\t\t\t\t<Box display='flex' flexDirection='column' height='50vh'>\n\t\t\t\t\t\t\t\t<DepartmentsAgentsTable control={control} register={register} />\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t</FieldGroup>\n\t\t\t\t</Page.ScrollableContentWithShadow>\n\t\t\t</Page>\n\t\t</Page>\n\t);\n}\n\nexport default EditDepartment;\n",null],"names":["withDefault","key","defaultValue","module","link","default","v","_regeneratorRuntime","_extends","_slicedToArray","FieldGroup","Field","FieldLabel","FieldRow","FieldError","TextInput","Box","Icon","Divider","ToggleSwitch","TextAreaInput","ButtonGroup","Button","PaginatedSelectFiltered","useDebouncedValue","useMutableCallback","useUniqueId","useToastMessageDispatch","useRoute","useMethod","useEndpoint","useTranslation","useQueryClient","React","useMemo","useState","Controller","useForm","useHasLicenseModule","validateEmail","AutoCompleteDepartment","Page","useRecordList","useRoomsList","AsyncStatePhase","EeTextInput","EeTextAreaInput","EeNumberInput","DepartmentForwarding","DepartmentBusinessHours","DepartmentsAgentsTable","DepartmentTags","getInitialValues","_ref","_allowedToForwardData","_department$chatClosi","department","agents","allowedToForwardData","name","email","description","enabled","maxNumberSimultaneousChat","showOnRegistration","showOnOfflineForm","abandonedRoomsCloseCustomMessage","requestTagBeforeClosingChat","offlineMessageChannelName","visitorInactivityTimeoutInSeconds","waitingQueueMessage","departmentsAllowedToForward","departments","map","dep","label","value","_id","fallbackForwardDepartment","chatClosingTags","agentList","exportDefault","_ref2","_errors$name","_errors$name2","_errors$email","_errors$email2","_errors$chatClosingTa2","data","id","title","t","departmentsRoute","queryClient","_ref3","_ref3$agents","hasLicense","initialValues","_useForm","mode","defaultValues","register","control","handleSubmit","watch","_useForm$formState","formState","errors","isValid","isDirty","isSubmitting","_useState2","fallbackFilter","setFallbackFilter","debouncedFallbackFilter","_useRoomsList","text","RoomsList","itemsList","loadMoreRooms","loadMoreItems","_useRecordList","roomsPhase","phase","roomsItems","items","roomsTotal","itemCount","saveDepartmentInfo","saveDepartmentAgentsInfoOnEdit","dispatchToastMessage","handleSave","payload","initialAgentList","agentListPayload","async","_context","prev","next","upsert","filter","agent","some","initialAgent","count","order","remove","awrap","length","invalidateQueries","type","message","push","t0","stop","Promise","handleReturn","formId","createElement","flexDirection","Header","icon","onClick","form","primary","disabled","loading","ScrollableContentWithShadow","w","alignSelf","maxWidth","is","autoComplete","onSubmit","display","flexGrow","error","placeholder","required","addon","size","validate","render","_ref4","_ref4$field","field","onChange","flexShrink","setFilter","options","endReached","LOADING","start","Math","min","_ref5","_ref5$field","handler","_ref6","_ref6$field","_ref7","_ref7$field","_ref8","_ref8$field","_ref9","_ref9$field","departmentId","_ref10","_ref10$field","haveNone","excludeDepartmentId","onlyMyDepartments","showArchived","rules","_ref11","_errors$chatClosingTa","_ref11$field","bhId","businessHourId","mb","height"],"mappings":"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"}