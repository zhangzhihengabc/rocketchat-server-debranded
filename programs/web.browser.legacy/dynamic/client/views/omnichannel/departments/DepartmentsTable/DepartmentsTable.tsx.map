)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/departments/DepartmentsTable/DepartmentsTable.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { ILivechatDepartment } from '@rocket.chat/core-typings';\nimport { Pagination } from '@rocket.chat/fuselage';\nimport { useDebouncedValue, useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation, useEndpoint, useRouter } from '@rocket.chat/ui-contexts';\nimport { useQuery, hashQueryKey } from '@tanstack/react-query';\nimport React, { useState, useMemo } from 'react';\n\nimport FilterByText from '../../../../components/FilterByText';\nimport GenericNoResults from '../../../../components/GenericNoResults/GenericNoResults';\nimport {\n\tGenericTable,\n\tGenericTableBody,\n\tGenericTableCell,\n\tGenericTableHeader,\n\tGenericTableHeaderCell,\n\tGenericTableLoadingTable,\n\tGenericTableRow,\n} from '../../../../components/GenericTable';\nimport { usePagination } from '../../../../components/GenericTable/hooks/usePagination';\nimport { useSort } from '../../../../components/GenericTable/hooks/useSort';\nimport DepartmentItemMenu from './DepartmentItemMenu';\n\nconst DEPARTMENTS_ENDPOINTS = {\n\tdepartment: '/v1/livechat/department',\n\tarchived: '/v1/livechat/departments/archived',\n} as const;\n\nconst DepartmentsTable = ({ archived }: { archived: boolean }) => {\n\tconst t = useTranslation();\n\tconst [text, setText] = useState('');\n\tconst router = useRouter();\n\tconst debouncedText = useDebouncedValue(text, 500);\n\n\tconst { current, itemsPerPage, setItemsPerPage: onSetItemsPerPage, setCurrent: onSetCurrent, ...paginationProps } = usePagination();\n\tconst { sortBy, sortDirection, setSort } = useSort<'name' | 'description' | 'numAgents' | 'enabled' | 'showOnRegistration'>('name');\n\n\tconst getDepartments = useEndpoint('GET', archived ? DEPARTMENTS_ENDPOINTS.archived : DEPARTMENTS_ENDPOINTS.department);\n\n\tconst handleAddNew = useMutableCallback(() => router.navigate('/omnichannel/departments/new'));\n\n\tconst query = useMemo(\n\t\t() => ({\n\t\t\tonlyMyDepartments: 'true' as const,\n\t\t\ttext: debouncedText,\n\t\t\tsort: JSON.stringify({ [sortBy]: sortDirection === 'asc' ? 1 : -1 }),\n\t\t\t...(current && { offset: current }),\n\t\t\t...(itemsPerPage && { count: itemsPerPage }),\n\t\t}),\n\t\t[current, itemsPerPage, sortBy, sortDirection, debouncedText],\n\t);\n\n\tconst { data, isSuccess, isLoading } = useQuery(['livechat-departments', query, archived], async () => getDepartments(query), {\n\t\tkeepPreviousData: true,\n\t});\n\n\tconst [defaultQuery] = useState(hashQueryKey([query]));\n\tconst queryHasChanged = defaultQuery !== hashQueryKey([query]);\n\n\tconst headers = (\n\t\t<>\n\t\t\t<GenericTableHeaderCell key='name' direction={sortDirection} active={sortBy === 'name'} onClick={setSort} sort='name'>\n\t\t\t\t{t('Name')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell\n\t\t\t\tkey='description'\n\t\t\t\tdirection={sortDirection}\n\t\t\t\tactive={sortBy === 'description'}\n\t\t\t\tonClick={setSort}\n\t\t\t\tsort='description'\n\t\t\t>\n\t\t\t\t{t('Description')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell key='numAgents' direction={sortDirection} active={sortBy === 'numAgents'} onClick={setSort} sort='numAgents'>\n\t\t\t\t{t('Num_Agents')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell key='enabled' direction={sortDirection} active={sortBy === 'enabled'} onClick={setSort} sort='enabled'>\n\t\t\t\t{t('Enabled')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell\n\t\t\t\tkey='showOnRegistration'\n\t\t\t\tdirection={sortDirection}\n\t\t\t\tactive={sortBy === 'showOnRegistration'}\n\t\t\t\tonClick={setSort}\n\t\t\t\tsort='showOnRegistration'\n\t\t\t>\n\t\t\t\t{t('Show_on_registration_page')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell key='spacer' w={40} />\n\t\t</>\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t{((isSuccess && data?.departments.length > 0) || queryHasChanged) && <FilterByText onChange={({ text }): void => setText(text)} />}\n\t\t\t{isLoading && (\n\t\t\t\t<GenericTable>\n\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t<GenericTableLoadingTable headerCells={6} />\n\t\t\t\t\t</GenericTableBody>\n\t\t\t\t</GenericTable>\n\t\t\t)}\n\t\t\t{isSuccess && data?.departments.length === 0 && (queryHasChanged || archived) && <GenericNoResults />}\n\t\t\t{isSuccess && data?.departments.length === 0 && !queryHasChanged && !archived && (\n\t\t\t\t<GenericNoResults\n\t\t\t\t\ticon='folder'\n\t\t\t\t\ttitle={t('No_departments_yet')}\n\t\t\t\t\tdescription={t('No_departments_yet_description')}\n\t\t\t\t\tbuttonAction={handleAddNew}\n\t\t\t\t\tbuttonTitle={t('Create_department')}\n\t\t\t\t\tlinkHref='https://go.rocket.chat/omnichannel-docs'\n\t\t\t\t\tlinkText={t('Learn_more_about_departments')}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t{isSuccess && data?.departments.length > 0 && (\n\t\t\t\t<>\n\t\t\t\t\t<GenericTable aria-busy={text !== debouncedText} aria-live='assertive'>\n\t\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t\t{data.departments.map((department: Omit<ILivechatDepartment, '_updatedAt'>) => (\n\t\t\t\t\t\t\t\t<GenericTableRow key={department._id} tabIndex={0} width='full'>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>{department.name}</GenericTableCell>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>{department.description}</GenericTableCell>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>{department.numAgents || '0'}</GenericTableCell>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>{department.enabled ? t('Yes') : t('No')}</GenericTableCell>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>{department.showOnRegistration ? t('Yes') : t('No')}</GenericTableCell>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>\n\t\t\t\t\t\t\t\t\t\t<DepartmentItemMenu department={department} archived={archived} />\n\t\t\t\t\t\t\t\t\t</GenericTableCell>\n\t\t\t\t\t\t\t\t</GenericTableRow>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</GenericTableBody>\n\t\t\t\t\t</GenericTable>\n\t\t\t\t\t<Pagination\n\t\t\t\t\t\tdivider\n\t\t\t\t\t\tcurrent={current}\n\t\t\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\t\t\tcount={data?.total || 0}\n\t\t\t\t\t\tonSetItemsPerPage={onSetItemsPerPage}\n\t\t\t\t\t\tonSetCurrent={onSetCurrent}\n\t\t\t\t\t\t{...paginationProps}\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default DepartmentsTable;\n",null],"names":["_regeneratorRuntime","_extends","_objectSpread","_objectWithoutProperties","_slicedToArray","Pagination","useDebouncedValue","useMutableCallback","useTranslation","useEndpoint","useRouter","useQuery","hashQueryKey","React","useState","useMemo","FilterByText","GenericNoResults","GenericTable","GenericTableBody","GenericTableCell","GenericTableHeader","GenericTableHeaderCell","GenericTableLoadingTable","GenericTableRow","usePagination","useSort","DepartmentItemMenu","module","link","default","v","DEPARTMENTS_ENDPOINTS","department","archived","exportDefault","_ref","t","_useState2","text","setText","router","debouncedText","_usePagination","current","itemsPerPage","onSetItemsPerPage","setItemsPerPage","onSetCurrent","setCurrent","paginationProps","_excluded","_useSort","sortBy","sortDirection","setSort","getDepartments","handleAddNew","navigate","query","_JSON$stringify","onlyMyDepartments","sort","JSON","stringify","offset","count","_useQuery","async","_context","prev","next","abrupt","stop","Promise","keepPreviousData","data","isSuccess","isLoading","queryHasChanged","defaultQuery","_useState4","headers","createElement","Fragment","key","direction","active","onClick","w","departments","length","onChange","_ref2","headerCells","icon","title","description","buttonAction","buttonTitle","linkHref","linkText","map","_id","tabIndex","width","withTruncatedText","name","numAgents","enabled","showOnRegistration","divider","total"],"mappings":"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"}