function module(e,n,t){var r,l,a,i,o,u,c,m,s,d,f,v,E,g,p,_,h,b,k,x,y,C,F,q,S,T,w,D,A,M,O,B,I,N,R=["value"],P=["value"];t.link("@babel/runtime/helpers/extends",{default:function(e){r=e}},0),t.link("@babel/runtime/helpers/objectWithoutProperties",{default:function(e){l=e}},1),t.link("@babel/runtime/regenerator",{default:function(e){a=e}},2),t.link("@babel/runtime/helpers/objectSpread2",{default:function(e){i=e}},3),t.link("@rocket.chat/fuselage",{FieldGroup:function(e){o=e},Button:function(e){u=e},ButtonGroup:function(e){c=e},Box:function(e){m=e},Field:function(e){s=e},FieldLabel:function(e){d=e},FieldRow:function(e){f=e},FieldError:function(e){v=e},TextInput:function(e){E=e},ToggleSwitch:function(e){g=e},Select:function(e){p=e},TextAreaInput:function(e){_=e}},0),t.link("@rocket.chat/fuselage-hooks",{useUniqueId:function(e){h=e}},1),t.link("@rocket.chat/ui-contexts",{useToastMessageDispatch:function(e){b=e},useRouter:function(e){k=e},useEndpoint:function(e){x=e},useTranslation:function(e){y=e}},2),t.link("@tanstack/react-query",{useMutation:function(e){C=e},useQueryClient:function(e){F=e}},3),t.link("react",{default:function(e){q=e},useMemo:function(e){S=e}},4),t.link("react-hook-form",{Controller:function(e){T=e},useFieldArray:function(e){w=e},useForm:function(e){D=e}},5),t.link("../../../components/Contextualbar",{ContextualbarScrollableContent:function(e){A=e},ContextualbarTitle:function(e){M=e},ContextualbarFooter:function(e){O=e},Contextualbar:function(e){B=e},ContextualbarHeader:function(e){I=e},ContextualbarClose:function(e){N=e}},6),t.exportDefault(function(e){var n=e.triggerData,t=y(),j=k(),G=F(),L=b(),Q=x("POST","/v1/livechat/triggers"),U=D({mode:"onBlur",values:{name:(null==n?void 0:n.name)||"",description:(null==n?void 0:n.description)||"",enabled:(null==n?void 0:n.enabled)||!0,runOnce:!!(null!=n&&n.runOnce),conditions:(null==n?void 0:n.conditions.map(function(e){return{name:e.name||"page-url",value:e.value||""}}))||[{name:"page-url",value:""}],actions:(null==n?void 0:n.actions.map(function(e){var n=e.name,t=e.params;return{name:n||"",params:{sender:(null==t?void 0:t.sender)||"queue",msg:(null==t?void 0:t.msg)||"",name:(null==t?void 0:t.name)||""}}}))||[{name:"send-message",params:{sender:"queue",msg:"",name:""}}]}}),V=U.control,H=U.handleSubmit,W=U.formState,z=W.isDirty,J=W.errors,K=U.watch,X=w({control:V,name:"conditions"}).fields,Y=w({control:V,name:"actions"}).fields,Z=K(),$=Z.description,ee=Z.conditions,en=Z.actions,et=S(function(){return[["page-url",t("Visitor_page_URL")],["time-on-site",t("Visitor_time_on_site")],["chat-opened-by-visitor",t("Chat_opened_by_visitor")],["after-guest-registration",t("After_guest_registration")]]},[t]),er=S(function(){return{"page-url":t("Enter_a_regex"),"time-on-site":t("Time_in_seconds")}},[t]),el=S(function(){return[["queue",t("Impersonate_next_agent_from_queue")],["custom",t("Custom_agent")]]},[t]),ea=C({mutationFn:Q,onSuccess:function(){L({type:"success",message:t("Saved")}),G.invalidateQueries(["livechat-triggers"]),j.navigate("/omnichannel/triggers")},onError:function(e){L({type:"error",message:e})}}),ei=h(),eo=h(),eu=h(),ec=h(),em=h(),es=h(),ed=h(),ef=h();return q.createElement(B,null,q.createElement(I,null,q.createElement(M,null,null!=n&&n._id?t("Edit_Trigger"):t("New_Trigger")),q.createElement(N,{onClick:function(){return j.navigate("/omnichannel/triggers")}})),q.createElement(A,null,q.createElement("form",{id:ei,onSubmit:H(function(e){return a.async(function(t){for(;;)switch(t.prev=t.next){case 0:ea.mutateAsync(i(i({},e),{},{_id:null==n?void 0:n._id}));case 1:case"end":return t.stop()}},null,null,null,Promise)})},q.createElement(o,null,q.createElement(s,null,q.createElement(m,{display:"flex",flexDirection:"row"},q.createElement(d,{htmlFor:eo},t("Enabled")),q.createElement(f,null,q.createElement(T,{name:"enabled",control:V,render:function(e){var n=e.field,t=n.value,a=l(n,R);return q.createElement(g,r({id:eo},a,{checked:t}))}})))),q.createElement(s,null,q.createElement(m,{display:"flex",flexDirection:"row"},q.createElement(d,{htmlFor:eu},t("Run_only_once_for_each_visitor")),q.createElement(f,null,q.createElement(T,{name:"runOnce",control:V,render:function(e){var n=e.field,t=n.value,a=l(n,P);return q.createElement(g,r({id:eu},a,{checked:t}))}})))),q.createElement(s,null,q.createElement(d,{htmlFor:ec,required:!0},t("Name")),q.createElement(f,null,q.createElement(T,{name:"name",control:V,rules:{required:t("The_field_is_required",t("Name"))},render:function(e){var n,t=e.field;return q.createElement(E,r({},t,{id:ec,error:null==J?void 0:null===(n=J.name)||void 0===n?void 0:n.message,"aria-required":!0,"aria-invalid":!!(null==J?void 0:J.name),"aria-describedby":ec+"-error"}))}})),(null==J?void 0:J.name)&&q.createElement(v,{"aria-live":"assertive",id:ec+"-error"},null==J?void 0:J.name.message)),q.createElement(s,null,q.createElement(d,{htmlFor:em},t("Description")),q.createElement(f,null,q.createElement(T,{name:"description",control:V,render:function(e){var n=e.field;return q.createElement(E,r({id:em},n,{value:$}))}}))),X.map(function(e,n){var l=er[ee[n].name];return q.createElement(s,{key:n},q.createElement(d,{htmlFor:es},t("Condition")),q.createElement(f,null,q.createElement(T,{name:"conditions."+n+".name",control:V,render:function(e){var n=e.field;return q.createElement(p,r({id:es},n,{options:et}))}})),l&&q.createElement(f,null,q.createElement(T,{name:"conditions."+n+".value",control:V,render:function(e){var n=e.field;return q.createElement(E,r({},n,{placeholder:l}))}})))}),Y.map(function(e,n){var l,a,i,o,u,c,m,g;return q.createElement(s,{key:n},q.createElement(d,{htmlFor:ed},t("Action")),q.createElement(f,null,q.createElement(E,{value:t("Send_a_message"),readOnly:!0})),q.createElement(f,null,q.createElement(T,{name:"actions."+n+".params.sender",control:V,render:function(e){var n=e.field;return q.createElement(p,r({id:ed},n,{options:el,placeholder:t("Select_an_option")}))}})),(null===(l=en[n].params)||void 0===l?void 0:l.sender)==="custom"&&q.createElement(f,null,q.createElement(T,{name:"actions."+n+".params.name",control:V,render:function(e){var n=e.field;return q.createElement(E,r({},n,{placeholder:t("Name_of_agent")}))}})),q.createElement(f,null,q.createElement(T,{name:"actions."+n+".params.msg",control:V,rules:{required:t("The_field_is_required",t("Message"))},render:function(e){var l,a,i,o,u,c,m,s=e.field;return q.createElement(_,r({error:null===(l=J.actions)||void 0===l?void 0:null===(a=l[n])||void 0===a?void 0:null===(i=a.params)||void 0===i?void 0:null===(o=i.msg)||void 0===o?void 0:o.message,"aria-invalid":!!(null===(u=J.actions)||void 0===u?void 0:null===(c=u[n])||void 0===c?void 0:null===(m=c.params)||void 0===m?void 0:m.msg),"aria-describedby":ef+"-error","aria-required":!0},s,{rows:3,placeholder:t("Message")+"*"}))}})),(null===(a=J.actions)||void 0===a?void 0:null===(i=a[n])||void 0===i?void 0:null===(o=i.params)||void 0===o?void 0:o.msg)&&q.createElement(v,{"aria-live":"assertive",id:ef+"-error"},null===(u=J.actions)||void 0===u?void 0:null===(c=u[n])||void 0===c?void 0:null===(m=c.params)||void 0===m?void 0:null===(g=m.msg)||void 0===g?void 0:g.message))})))),q.createElement(O,null,q.createElement(c,{stretch:!0},q.createElement(u,{onClick:function(){return j.navigate("/omnichannel/triggers")}},t("Cancel")),q.createElement(u,{form:ei,type:"submit",primary:!0,disabled:!z},t("Save")))))})}
//# sourceMappingURL=/dynamic/client/views/omnichannel/triggers/96eba760327874c65f9bf0bb714e37eed8d15ecb.map
