)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/contactHistory/MessageList/ContactHistoryMessagesList.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Box, Icon, Margins, States, StatesIcon, StatesSubtitle, StatesTitle, TextInput, Throbber } from '@rocket.chat/fuselage';\nimport { useSetting, useTranslation, useUserPreference } from '@rocket.chat/ui-contexts';\nimport type { ChangeEvent, Dispatch, ReactElement, SetStateAction } from 'react';\nimport React, { useMemo, useState } from 'react';\nimport { Virtuoso } from 'react-virtuoso';\n\nimport {\n\tContextualbarHeader,\n\tContextualbarAction,\n\tContextualbarIcon,\n\tContextualbarTitle,\n\tContextualbarClose,\n\tContextualbarContent,\n\tContextualbarEmptyContent,\n} from '../../../../components/Contextualbar';\nimport ScrollableContentWrapper from '../../../../components/ScrollableContentWrapper';\nimport { useRecordList } from '../../../../hooks/lists/useRecordList';\nimport { AsyncStatePhase } from '../../../../lib/asyncState';\nimport { isMessageNewDay } from '../../../room/MessageList/lib/isMessageNewDay';\nimport { isMessageSequential } from '../../../room/MessageList/lib/isMessageSequential';\nimport ContactHistoryMessage from './ContactHistoryMessage';\nimport { useHistoryMessageList } from './useHistoryMessageList';\n\nconst ContactHistoryMessagesList = ({\n\tchatId,\n\tsetChatId,\n\tclose,\n}: {\n\tchatId: string;\n\tsetChatId: Dispatch<SetStateAction<string>>;\n\tclose: () => void;\n}): ReactElement => {\n\tconst [text, setText] = useState('');\n\tconst t = useTranslation();\n\tconst showUserAvatar = !!useUserPreference<boolean>('displayAvatars');\n\tconst { itemsList: messageList, loadMoreItems } = useHistoryMessageList(\n\t\tuseMemo(() => ({ roomId: chatId, filter: text }), [chatId, text]),\n\t);\n\n\tconst handleSearchChange = (event: ChangeEvent<HTMLInputElement>): void => {\n\t\tsetText(event.currentTarget.value);\n\t};\n\n\tconst { phase, error, items: messages, itemCount: totalItemCount } = useRecordList(messageList);\n\tconst messageGroupingPeriod = Number(useSetting('Message_GroupingPeriod'));\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarHeader>\n\t\t\t\t<ContextualbarAction onClick={(): void => setChatId('')} title={t('Back')} name='arrow-back' />\n\t\t\t\t<ContextualbarIcon name='history' />\n\t\t\t\t<ContextualbarTitle>{t('Chat_History')}</ContextualbarTitle>\n\t\t\t\t<ContextualbarClose onClick={close} />\n\t\t\t</ContextualbarHeader>\n\n\t\t\t<ContextualbarContent paddingInline={0}>\n\t\t\t\t<Box\n\t\t\t\t\tdisplay='flex'\n\t\t\t\t\tflexDirection='row'\n\t\t\t\t\tp={24}\n\t\t\t\t\tborderBlockEndWidth='default'\n\t\t\t\t\tborderBlockEndStyle='solid'\n\t\t\t\t\tborderBlockEndColor='extra-light'\n\t\t\t\t\tflexShrink={0}\n\t\t\t\t>\n\t\t\t\t\t<Box display='flex' flexDirection='row' flexGrow={1} mi='neg-x4'>\n\t\t\t\t\t\t<Margins inline={4}>\n\t\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\t\tplaceholder={t('Search')}\n\t\t\t\t\t\t\t\tvalue={text}\n\t\t\t\t\t\t\t\tonChange={handleSearchChange}\n\t\t\t\t\t\t\t\taddon={<Icon name='magnifier' size='x20' />}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Margins>\n\t\t\t\t\t</Box>\n\t\t\t\t</Box>\n\t\t\t\t{phase === AsyncStatePhase.LOADING && (\n\t\t\t\t\t<Box pi={24} pb={12}>\n\t\t\t\t\t\t<Throbber size='x12' />\n\t\t\t\t\t</Box>\n\t\t\t\t)}\n\t\t\t\t{error && (\n\t\t\t\t\t<States>\n\t\t\t\t\t\t<StatesIcon name='warning' variation='danger' />\n\t\t\t\t\t\t<StatesTitle>{t('Something_went_wrong')}</StatesTitle>\n\t\t\t\t\t\t<StatesSubtitle>{error.toString()}</StatesSubtitle>\n\t\t\t\t\t</States>\n\t\t\t\t)}\n\t\t\t\t{phase !== AsyncStatePhase.LOADING && totalItemCount === 0 && <ContextualbarEmptyContent title={t('No_results_found')} />}\n\t\t\t\t<Box flexGrow={1} flexShrink={1} overflow='hidden' display='flex'>\n\t\t\t\t\t{!error && totalItemCount > 0 && history.length > 0 && (\n\t\t\t\t\t\t<Virtuoso\n\t\t\t\t\t\t\ttotalCount={totalItemCount}\n\t\t\t\t\t\t\tendReached={\n\t\t\t\t\t\t\t\tphase === AsyncStatePhase.LOADING\n\t\t\t\t\t\t\t\t\t? (): void => undefined\n\t\t\t\t\t\t\t\t\t: (start): unknown => loadMoreItems(start, Math.min(50, totalItemCount - start))\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\toverscan={25}\n\t\t\t\t\t\t\tdata={messages}\n\t\t\t\t\t\t\tcomponents={{ Scroller: ScrollableContentWrapper as any }}\n\t\t\t\t\t\t\titemContent={(index, data): ReactElement => {\n\t\t\t\t\t\t\t\tconst lastMessage = messages[index - 1];\n\t\t\t\t\t\t\t\tconst isSequential = isMessageSequential(data, lastMessage, messageGroupingPeriod);\n\t\t\t\t\t\t\t\tconst isNewDay = isMessageNewDay(data, lastMessage);\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<ContactHistoryMessage message={data} sequential={isSequential} isNewDay={isNewDay} showUserAvatar={showUserAvatar} />\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t</Box>\n\t\t\t</ContextualbarContent>\n\t\t</>\n\t);\n};\n\nexport default ContactHistoryMessagesList;\n",null],"names":["_slicedToArray","Box","Icon","Margins","States","StatesIcon","StatesSubtitle","StatesTitle","TextInput","Throbber","useSetting","useTranslation","useUserPreference","React","useMemo","useState","Virtuoso","ContextualbarHeader","ContextualbarAction","ContextualbarIcon","ContextualbarTitle","ContextualbarClose","ContextualbarContent","ContextualbarEmptyContent","ScrollableContentWrapper","useRecordList","AsyncStatePhase","isMessageNewDay","isMessageSequential","ContactHistoryMessage","useHistoryMessageList","module","link","default","v","exportDefault","_ref","chatId","setChatId","close","_useState2","text","setText","t","showUserAvatar","_useHistoryMessageLis","roomId","filter","messageList","itemsList","loadMoreItems","_useRecordList","phase","error","messages","items","totalItemCount","itemCount","messageGroupingPeriod","Number","createElement","Fragment","onClick","title","name","paddingInline","display","flexDirection","p","borderBlockEndWidth","borderBlockEndStyle","borderBlockEndColor","flexShrink","flexGrow","mi","inline","placeholder","value","onChange","event","currentTarget","addon","size","LOADING","pi","pb","variation","toString","overflow","history","length","totalCount","endReached","start","Math","min","overscan","data","components","Scroller","itemContent","index","lastMessage","isSequential","isNewDay","message","sequential"],"mappings":"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"}