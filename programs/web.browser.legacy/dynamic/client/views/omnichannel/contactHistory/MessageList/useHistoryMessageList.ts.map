)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/contactHistory/MessageList/useHistoryMessageList.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useCallback, useState } from 'react';\n\nimport { useScrollableMessageList } from '../../../../hooks/lists/useScrollableMessageList';\nimport { useComponentDidUpdate } from '../../../../hooks/useComponentDidUpdate';\nimport { MessageList } from '../../../../lib/lists/MessageList';\n\ntype HistoryMessageListOptions = {\n\tfilter: string;\n\troomId: string;\n};\n\nexport const useHistoryMessageList = (\n\toptions: HistoryMessageListOptions,\n): {\n\titemsList: MessageList;\n\tinitialItemCount: number;\n\tloadMoreItems: (start: number, end: number) => void;\n} => {\n\tconst [itemsList, setItemsList] = useState(() => new MessageList());\n\tconst reload = useCallback(() => setItemsList(new MessageList()), []);\n\n\tconst getMessages = useEndpoint('GET', '/v1/livechat/:rid/messages', { rid: options.roomId });\n\n\tuseComponentDidUpdate(() => {\n\t\toptions && reload();\n\t}, [options, reload]);\n\n\tconst fetchMessages = useCallback(\n\t\tasync (start, end) => {\n\t\t\tconst { messages, total } = await getMessages({\n\t\t\t\t...(options.filter && { searchTerm: options.filter }),\n\t\t\t\toffset: start,\n\t\t\t\tcount: end,\n\t\t\t\tsort: `{ \"ts\": 1 }`,\n\t\t\t});\n\t\t\treturn {\n\t\t\t\titems: messages,\n\t\t\t\titemCount: total,\n\t\t\t};\n\t\t},\n\t\t[getMessages, options.filter],\n\t);\n\n\tconst { loadMoreItems, initialItemCount } = useScrollableMessageList(itemsList, fetchMessages, 25);\n\n\treturn {\n\t\titemsList,\n\t\tloadMoreItems,\n\t\tinitialItemCount,\n\t};\n};\n",null],"names":["module","link","default","_regeneratorRuntime","_objectSpread","_slicedToArray","export","useHistoryMessageList","useEndpoint","useCallback","useState","useScrollableMessageList","useComponentDidUpdate","MessageList","options","_useState2","itemsList","setItemsList","reload","getMessages","rid","roomId","_useScrollableMessage","start","end","_await$getMessages","messages","total","async","_context","prev","next","awrap","filter","searchTerm","offset","count","sort","sent","abrupt","items","itemCount","stop","Promise","loadMoreItems","initialItemCount"],"mappings":"uBAAsBA,EAAMC,IAAA,CAAA,6BAA2B,CAAAC,QAAAA,SAAAA,CAAAA,EAAAC,EAAAA,CAAA,CAAA,EAAA,GAAAH,EAAAA,IAAAA,CAAAA,uCAAAA,CAAAE,QAAAA,SAAAA,CAAAA,EAAAE,EAAAA,CAAA,CAAA,EAAA,GAAAJ,EAAAA,IAAAA,CAAAA,uCAAAA,CAAAE,QAAAA,SAAAA,CAAAA,EAAAG,EAAAA,CAAA,CAAA,EAAA,GAAvDL,EAAOM,MAAE,CAAA,CAAAC,sBAAmB,WAAA,OAA2BA,CAAA,CAAA,GAAAP,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAQ,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAR,EAAAA,IAAAA,CAAAA,QAAAA,CAAAS,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,SAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAV,EAAAA,IAAAA,CAAAA,mDAAAA,CAAAW,yBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAX,EAAAA,IAAAA,CAAAA,0CAAAA,CAAAY,sBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAZ,EAAAA,IAAAA,CAAAA,oCAAAA,CAAAa,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAYhD,IAZPV,EAAuDC,EAAAC,EAAAG,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAY1CN,EAAwB,SACpCO,CAAkC,EAMlC,IAAmEC,EAAAV,EAAjCK,EAAS,WAAA,OAAM,IAAIG,CAAa,GAAC,GAA5DG,EAASD,CAAA,CAAA,EAAA,CAAEE,EAAYF,CAAA,CAAA,EAAA,CACxBG,EAAST,EAAY,WAAA,OAAMQ,EAAa,IAAIJ,EAAc,EAAE,EAAE,EAE9DM,EAAcX,EAAY,MAAO,6BAA8B,CAAEY,IAAKN,EAAQO,MAAAA,AAAM,GAE1FT,EAAsB,WACrBE,GAAWI,GACZ,EAAG,CAACJ,EAASI,EAAO,EAkBpB,IAAAI,EAA4CX,EAAyBK,EAhB/CP,EACrB,SAAOc,CAAK,CAAEC,CAAG,EAAA,IAAAC,EAAAC,EAAAC,EAAA,OAAAxB,EAAAyB,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAAA,OAAAF,EAAAE,IAAA,CAAA,EAAA5B,EAAA6B,KAAA,CACkBb,EAAWf,EAAAA,EAAA,CAAA,EACxCU,EAAQmB,MAAM,EAAI,CAAEC,WAAYpB,EAAQmB,MAAAA,AAAM,GAAE,CAAA,EAAA,CACpDE,OAAQZ,EACRa,MAAOZ,EACPa,KAAI,aAAe,IAClB,MAAA,EALqB,OAAfX,EAAQD,AAKdA,CAAAA,EAAAI,EAAAS,IAAA,EALMZ,QAAQ,CAAEC,EAAKF,EAALE,KAAK,CAAAE,EAAAU,MAAA,CAAA,SAMhB,CACNC,MAAOd,EACPe,UAAWd,GACX,MAAA,EAAA,IAAA,MAAA,OAAAE,EAAAa,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,EAEF,CAACxB,EAAaL,EAAQmB,MAAM,CAAC,EAGiE,IAAvFW,EAAatB,EAAbsB,aAAa,CAAEC,EAAgBvB,EAAhBuB,gBAAgB,CAEvC,MAAO,CACN7B,UAAAA,EACA4B,cAAAA,EACAC,iBAAAA,EAEF"}