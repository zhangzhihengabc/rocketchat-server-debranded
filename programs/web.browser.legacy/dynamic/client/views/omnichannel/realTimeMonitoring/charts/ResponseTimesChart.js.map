)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/realTimeMonitoring/charts/ResponseTimesChart.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useTranslation } from '@rocket.chat/ui-contexts';\nimport React, { useRef, useEffect } from 'react';\n\nimport { drawLineChart } from '../../../../../app/livechat/client/lib/chartHandler';\nimport { secondsToHHMMSS } from '../../../../../lib/utils/secondsToHHMMSS';\nimport { AsyncStatePhase } from '../../../../hooks/useAsyncState';\nimport { useEndpointData } from '../../../../hooks/useEndpointData';\nimport Chart from './Chart';\nimport { getMomentChartLabelsAndData } from './getMomentChartLabelsAndData';\nimport { getMomentCurrentLabel } from './getMomentCurrentLabel';\nimport { useUpdateChartData } from './useUpdateChartData';\n\nconst [labels, initialData] = getMomentChartLabelsAndData();\nconst tooltipCallbacks = {\n\tcallbacks: {\n\t\ttitle([ctx]) {\n\t\t\tconst { dataset } = ctx;\n\t\t\treturn dataset.label;\n\t\t},\n\t\tlabel(ctx) {\n\t\t\tconst { dataset, dataIndex } = ctx;\n\t\t\treturn `${dataset.label}: ${secondsToHHMMSS(dataset.data[dataIndex])}`;\n\t\t},\n\t},\n};\nconst init = (canvas, context, t) =>\n\tdrawLineChart(\n\t\tcanvas,\n\t\tcontext,\n\t\t[t('Avg_reaction_time'), t('Longest_reaction_time'), t('Avg_response_time'), t('Longest_response_time')],\n\t\tlabels,\n\t\t[initialData, initialData.slice(), initialData.slice(), initialData.slice()],\n\t\t{ legends: true, anim: true, smallTicks: true, displayColors: false, tooltipCallbacks },\n\t);\n\nconst ResponseTimesChart = ({ params, reloadRef, ...props }) => {\n\tconst t = useTranslation();\n\n\tconst canvas = useRef();\n\tconst context = useRef();\n\n\tconst updateChartData = useUpdateChartData({\n\t\tcontext,\n\t\tcanvas,\n\t\tt,\n\t\tinit,\n\t});\n\n\tconst { value: data, phase: state, reload } = useEndpointData('/v1/livechat/analytics/dashboards/charts/timings', { params });\n\n\treloadRef.current.responseTimesChart = reload;\n\n\tconst {\n\t\treaction: { avg: reactionAvg, longest: reactionLongest },\n\t\tresponse: { avg: responseAvg, longest: responseLongest },\n\t} = data ?? {\n\t\treaction: {\n\t\t\tavg: 0,\n\t\t\tlongest: 0,\n\t\t},\n\t\tresponse: {\n\t\t\tavg: 0,\n\t\t\tlongest: 0,\n\t\t},\n\t};\n\n\tuseEffect(() => {\n\t\tconst initChart = async () => {\n\t\t\tcontext.current = await init(canvas.current, context.current, t);\n\t\t};\n\t\tinitChart();\n\t}, [t]);\n\n\tuseEffect(() => {\n\t\tif (state === AsyncStatePhase.RESOLVED) {\n\t\t\tconst label = getMomentCurrentLabel();\n\t\t\tupdateChartData(label, [reactionAvg, reactionLongest, responseAvg, responseLongest]);\n\t\t}\n\t}, [reactionAvg, reactionLongest, responseAvg, responseLongest, state, t, updateChartData]);\n\n\treturn <Chart ref={canvas} {...props} />;\n};\n\nexport default ResponseTimesChart;\n",null],"names":["_regeneratorRuntime","_extends","_objectWithoutProperties","_slicedToArray","useTranslation","React","useRef","useEffect","drawLineChart","secondsToHHMMSS","AsyncStatePhase","useEndpointData","Chart","getMomentChartLabelsAndData","getMomentCurrentLabel","useUpdateChartData","module","link","default","v","_getMomentChartLabels2","labels","initialData","tooltipCallbacks","callbacks","title","_ref","dataset","ctx","_ref2","label","dataIndex","data","init","canvas","context","t","slice","legends","anim","smallTicks","displayColors","exportDefault","_ref3","params","reloadRef","props","_excluded","updateChartData","_useEndpointData","value","state","phase","reload","current","responseTimesChart","_ref4","reaction","avg","longest","response","_ref4$reaction","reactionAvg","reactionLongest","_ref4$response","responseAvg","responseLongest","async","_context","prev","next","awrap","sent","stop","Promise","RESOLVED","createElement","ref"],"mappings":"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"}