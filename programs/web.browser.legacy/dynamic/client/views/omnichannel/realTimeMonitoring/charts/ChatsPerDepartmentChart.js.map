)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/realTimeMonitoring/charts/ChatsPerDepartmentChart.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useTranslation } from '@rocket.chat/ui-contexts';\nimport React, { useRef, useEffect } from 'react';\n\nimport { drawLineChart } from '../../../../../app/livechat/client/lib/chartHandler';\nimport { AsyncStatePhase } from '../../../../hooks/useAsyncState';\nimport { useEndpointData } from '../../../../hooks/useEndpointData';\nimport Chart from './Chart';\nimport { useUpdateChartData } from './useUpdateChartData';\n\nconst initialData = {\n\tdepartments: {},\n};\n\nconst init = (canvas, context, t) =>\n\tdrawLineChart(canvas, context, [t('Open'), t('Closed')], [], [[], []], {\n\t\tlegends: true,\n\t\tanim: true,\n\t\tsmallTicks: true,\n\t});\n\nconst ChatsPerDepartmentChart = ({ params, reloadRef, ...props }) => {\n\tconst t = useTranslation();\n\n\tconst canvas = useRef();\n\tconst context = useRef();\n\n\tconst updateChartData = useUpdateChartData({\n\t\tcontext,\n\t\tcanvas,\n\t\tt,\n\t\tinit,\n\t});\n\n\tconst {\n\t\tvalue: data,\n\t\tphase: state,\n\t\treload,\n\t} = useEndpointData('/v1/livechat/analytics/dashboards/charts/chats-per-department', { params });\n\n\treloadRef.current.chatsPerDepartmentChart = reload;\n\n\tconst chartData = data ?? initialData;\n\n\tuseEffect(() => {\n\t\tconst initChart = async () => {\n\t\t\tcontext.current = await init(canvas.current, context.current, t);\n\t\t};\n\t\tinitChart();\n\t}, [t]);\n\n\tuseEffect(() => {\n\t\tif (state === AsyncStatePhase.RESOLVED) {\n\t\t\tif (chartData && chartData.success) {\n\t\t\t\tdelete chartData.success;\n\t\t\t\tObject.entries(chartData).forEach(([name, value]) => {\n\t\t\t\t\tupdateChartData(name, [value.open, value.closed]);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}, [chartData, state, t, updateChartData]);\n\n\treturn <Chart ref={canvas} {...props} />;\n};\n\nexport default ChatsPerDepartmentChart;\n",null],"names":["_regeneratorRuntime","_extends","_slicedToArray","_objectWithoutProperties","useTranslation","React","useRef","useEffect","drawLineChart","AsyncStatePhase","useEndpointData","Chart","useUpdateChartData","module","link","default","v","initialData","departments","init","canvas","context","t","legends","anim","smallTicks","exportDefault","_ref","params","reloadRef","props","_excluded","updateChartData","_useEndpointData","data","value","state","phase","reload","current","chatsPerDepartmentChart","chartData","async","_context","prev","next","awrap","sent","stop","Promise","RESOLVED","success","Object","entries","forEach","_ref2","_ref3","name","open","closed","createElement","ref"],"mappings":"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"}