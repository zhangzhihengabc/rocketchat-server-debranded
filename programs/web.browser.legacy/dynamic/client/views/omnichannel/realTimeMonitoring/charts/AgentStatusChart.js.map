)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/realTimeMonitoring/charts/AgentStatusChart.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useTranslation } from '@rocket.chat/ui-contexts';\nimport React, { useRef, useEffect } from 'react';\n\nimport { drawDoughnutChart } from '../../../../../app/livechat/client/lib/chartHandler';\nimport { AsyncStatePhase } from '../../../../hooks/useAsyncState';\nimport { useEndpointData } from '../../../../hooks/useEndpointData';\nimport Chart from './Chart';\nimport { useUpdateChartData } from './useUpdateChartData';\n\nconst labels = ['Available', 'Away', 'Busy', 'Offline'];\n\nconst initialData = {\n\tavailable: 0,\n\taway: 0,\n\tbusy: 0,\n\toffline: 0,\n};\n\nconst init = (canvas, context, t) =>\n\tdrawDoughnutChart(\n\t\tcanvas,\n\t\tt('Agents'),\n\t\tcontext,\n\t\tlabels.map((l) => t(l)),\n\t\tObject.values(initialData),\n\t);\n\nconst AgentStatusChart = ({ params, reloadRef, ...props }) => {\n\tconst t = useTranslation();\n\n\tconst canvas = useRef();\n\tconst context = useRef();\n\n\tconst updateChartData = useUpdateChartData({\n\t\tcontext,\n\t\tcanvas,\n\t\tt,\n\t\tinit,\n\t});\n\n\tconst { value: data, phase: state, reload } = useEndpointData('/v1/livechat/analytics/dashboards/charts/agents-status', { params });\n\n\treloadRef.current.agentStatusChart = reload;\n\n\tconst { offline = 0, available = 0, away = 0, busy = 0 } = data ?? initialData;\n\n\tuseEffect(() => {\n\t\tconst initChart = async () => {\n\t\t\tcontext.current = await init(canvas.current, context.current, t);\n\t\t};\n\t\tinitChart();\n\t}, [t]);\n\n\tuseEffect(() => {\n\t\tif (state === AsyncStatePhase.RESOLVED && context.current) {\n\t\t\tupdateChartData(t('Offline'), [offline]);\n\t\t\tupdateChartData(t('Available'), [available]);\n\t\t\tupdateChartData(t('Away'), [away]);\n\t\t\tupdateChartData(t('Busy'), [busy]);\n\t\t}\n\t}, [available, away, busy, offline, state, t, updateChartData]);\n\n\treturn <Chart ref={canvas} {...props} />;\n};\n\nexport default AgentStatusChart;\n",null],"names":["_regeneratorRuntime","_extends","_objectWithoutProperties","useTranslation","React","useRef","useEffect","drawDoughnutChart","AsyncStatePhase","useEndpointData","Chart","useUpdateChartData","module","link","default","v","labels","initialData","available","away","busy","offline","init","canvas","context","t","map","l","Object","values","exportDefault","_ref","params","reloadRef","props","_excluded","updateChartData","_useEndpointData","data","value","state","phase","reload","current","agentStatusChart","_ref2","_ref2$offline","_ref2$available","_ref2$away","_ref2$busy","async","_context","prev","next","awrap","sent","stop","Promise","RESOLVED","createElement","ref"],"mappings":"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"}