)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/oauth/components/AuthorizationFormPage.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IOAuthApps, IUser } from '@rocket.chat/core-typings';\nimport { Box, Button, ButtonGroup } from '@rocket.chat/fuselage';\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport { Form } from '@rocket.chat/layout';\nimport { useLogout, useRoute } from '@rocket.chat/ui-contexts';\nimport { Accounts } from 'meteor/accounts-base';\nimport { Meteor } from 'meteor/meteor';\nimport React, { useEffect, useMemo, useRef } from 'react';\nimport { Trans, useTranslation } from 'react-i18next';\n\nimport { queueMicrotask } from '../../../lib/utils/queueMicrotask';\nimport CurrentUserDisplay from './CurrentUserDisplay';\nimport Layout from './Layout';\n\ntype AuthorizationFormPageProps = {\n\toauthApp: IOAuthApps;\n\tredirectUri: string;\n\tuser: IUser;\n};\n\nconst AuthorizationFormPage = ({ oauthApp, redirectUri, user }: AuthorizationFormPageProps) => {\n\tconst token = useMemo(() => Meteor._localStorage.getItem(Accounts.LOGIN_TOKEN_KEY) ?? undefined, []);\n\n\tconst formLabelId = useUniqueId();\n\n\tconst { t } = useTranslation();\n\n\tconst homeRoute = useRoute('home');\n\n\tconst handleCancelButtonClick = () => {\n\t\tqueueMicrotask(() => {\n\t\t\thomeRoute.push();\n\t\t});\n\t\twindow.close();\n\t};\n\n\tconst logout = useLogout();\n\n\tconst handleLogoutButtonClick = () => {\n\t\tlogout();\n\t};\n\n\tconst submitRef = useRef<HTMLButtonElement>(null);\n\n\tconst hasAuthorized = user.oauth?.authorizedClients?.includes(oauthApp.clientId);\n\n\tuseEffect(() => {\n\t\tif (hasAuthorized) {\n\t\t\tsubmitRef.current?.click();\n\t\t}\n\t}, [oauthApp.clientId, hasAuthorized]);\n\n\treturn (\n\t\t<Layout>\n\t\t\t<Form method='post' action='' aria-labelledby={formLabelId}>\n\t\t\t\t<Form.Header>\n\t\t\t\t\t<Form.Title id={formLabelId}>{t('core.Authorize_access_to_your_account')}</Form.Title>\n\t\t\t\t</Form.Header>\n\t\t\t\t<Form.Container>\n\t\t\t\t\t<Box withRichContent>\n\t\t\t\t\t\t<CurrentUserDisplay user={user} />\n\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t<Trans i18nKey='core.The_application_will_be_able_to' t={t}>\n\t\t\t\t\t\t\t\tThe application <strong>{{ appName: oauthApp.name }}</strong> will be able to:\n\t\t\t\t\t\t\t</Trans>\n\t\t\t\t\t\t</p>\n\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t<li>{t('core.access_your_basic_information')}</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</Box>\n\t\t\t\t\t<input type='hidden' name='access_token' value={token} />\n\t\t\t\t\t<input type='hidden' name='client_id' value={oauthApp.clientId} />\n\t\t\t\t\t<input type='hidden' name='redirect_uri' value={redirectUri} />\n\t\t\t\t\t<input type='hidden' name='response_type' value='code' />\n\t\t\t\t</Form.Container>\n\t\t\t\t<Form.Footer>\n\t\t\t\t\t<ButtonGroup stretch flexGrow={1}>\n\t\t\t\t\t\t<Button ref={submitRef} type='submit' primary name='allow' value='yes'>\n\t\t\t\t\t\t\t{t('core.Authorize')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button onClick={handleCancelButtonClick}>{t('core.Cancel')}</Button>\n\t\t\t\t\t\t<Button danger onClick={handleLogoutButtonClick}>\n\t\t\t\t\t\t\t{t('core.Logout')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</ButtonGroup>\n\t\t\t\t</Form.Footer>\n\t\t\t</Form>\n\t\t</Layout>\n\t);\n};\n\nexport default AuthorizationFormPage;\n",null],"names":["Box","Button","ButtonGroup","useUniqueId","Form","useLogout","useRoute","Accounts","Meteor","React","useEffect","useMemo","useRef","Trans","useTranslation","queueMicrotask","CurrentUserDisplay","Layout","module","link","v","exportDefault","_ref","_user$oauth","_user$oauth$authorize","oauthApp","redirectUri","user","token","_Meteor$_localStorage","_localStorage","getItem","LOGIN_TOKEN_KEY","undefined","formLabelId","t","_useTranslation","homeRoute","logout","submitRef","hasAuthorized","oauth","authorizedClients","includes","clientId","_submitRef$current","current","click","createElement","method","action","Header","Title","id","Container","withRichContent","i18nKey","appName","name","type","value","Footer","stretch","flexGrow","ref","primary","onClick","push","window","close","danger"],"mappings":"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"}