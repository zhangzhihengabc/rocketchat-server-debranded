)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/marketplace/AppInstallPage.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Button, ButtonGroup, Icon, Field, FieldGroup, FieldLabel, FieldRow, TextInput } from '@rocket.chat/fuselage';\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport {\n\tuseSetModal,\n\tuseEndpoint,\n\tuseUpload,\n\tuseTranslation,\n\tuseRouteParameter,\n\tuseRouter,\n\tuseSearchParameter,\n} from '@rocket.chat/ui-contexts';\nimport React, { useCallback, useState } from 'react';\nimport { useForm, Controller } from 'react-hook-form';\n\nimport { AppClientOrchestratorInstance } from '../../../ee/client/apps/orchestrator';\nimport Page from '../../components/Page';\nimport { useAppsReload } from '../../contexts/hooks/useAppsReload';\nimport { useExternalLink } from '../../hooks/useExternalLink';\nimport { useFileInput } from '../../hooks/useFileInput';\nimport { useCheckoutUrl } from '../admin/subscription/hooks/useCheckoutUrl';\nimport AppPermissionsReviewModal from './AppPermissionsReviewModal';\nimport AppUpdateModal from './AppUpdateModal';\nimport AppInstallModal from './components/AppInstallModal/AppInstallModal';\nimport { handleAPIError } from './helpers/handleAPIError';\nimport { handleInstallError } from './helpers/handleInstallError';\nimport { useAppsCountQuery } from './hooks/useAppsCountQuery';\nimport { getManifestFromZippedApp } from './lib/getManifestFromZippedApp';\n\nconst placeholderUrl = 'https://rocket.chat/apps/package.zip';\n\nfunction AppInstallPage() {\n\tconst t = useTranslation();\n\n\tconst reload = useAppsReload();\n\n\tconst router = useRouter();\n\n\tconst context = useRouteParameter('context');\n\n\tconst setModal = useSetModal();\n\n\tconst appId = useSearchParameter('id');\n\tconst queryUrl = useSearchParameter('url');\n\n\tconst [installing, setInstalling] = useState(false);\n\n\tconst endpointAddress = appId ? `/apps/${appId}` : '/apps';\n\tconst downloadApp = useEndpoint('POST', endpointAddress);\n\tconst uploadAppEndpoint = useUpload(endpointAddress);\n\tconst uploadUpdateApp = useUpload(`${endpointAddress}/update`);\n\n\tconst appCountQuery = useAppsCountQuery('private');\n\n\tconst openExternalLink = useExternalLink();\n\tconst manageSubscriptionUrl = useCheckoutUrl()({ target: 'marketplace-app-install', action: 'Enable_unlimited_apps' });\n\n\tconst { control, setValue, watch } = useForm({ defaultValues: { url: queryUrl || '' } });\n\tconst { file, url } = watch();\n\n\tconst canSave = !!url || !!file?.name;\n\n\tconst [handleUploadButtonClick] = useFileInput((value) => setValue('file', value), 'app');\n\n\tconst sendFile = async (permissionsGranted, appFile, appId) => {\n\t\tlet app;\n\t\tconst fileData = new FormData();\n\t\tfileData.append('app', appFile, appFile.name);\n\t\tfileData.append('permissions', JSON.stringify(permissionsGranted));\n\n\t\ttry {\n\t\t\tif (appId) {\n\t\t\t\tawait uploadUpdateApp(fileData);\n\t\t\t} else {\n\t\t\t\tapp = await uploadAppEndpoint(fileData);\n\t\t\t}\n\n\t\t\trouter.navigate({\n\t\t\t\tname: 'marketplace',\n\t\t\t\tparams: {\n\t\t\t\t\tcontext: 'private',\n\t\t\t\t\tpage: 'info',\n\t\t\t\t\tid: appId || app.app.id,\n\t\t\t\t},\n\t\t\t});\n\n\t\t\treload();\n\t\t} catch (e) {\n\t\t\thandleAPIError(e);\n\t\t} finally {\n\t\t\tsetInstalling(false);\n\t\t\tsetModal(null);\n\t\t}\n\t};\n\n\tconst cancelAction = useCallback(() => {\n\t\tsetInstalling(false);\n\t\tsetModal(null);\n\t}, [setInstalling, setModal]);\n\n\tconst isAppInstalled = async (appId) => {\n\t\ttry {\n\t\t\tconst app = await AppClientOrchestratorInstance.getApp(appId);\n\t\t\treturn !!app || false;\n\t\t} catch (e) {\n\t\t\treturn false;\n\t\t}\n\t};\n\n\tconst handleAppPermissionsReview = async (permissions, appFile, appId) => {\n\t\tsetModal(\n\t\t\t<AppPermissionsReviewModal\n\t\t\t\tappPermissions={permissions}\n\t\t\t\tonCancel={cancelAction}\n\t\t\t\tonConfirm={(permissionsGranted) => sendFile(permissionsGranted, appFile, appId)}\n\t\t\t/>,\n\t\t);\n\t};\n\n\tconst uploadFile = async (appFile, { id, permissions }) => {\n\t\tconst isInstalled = await isAppInstalled(id);\n\n\t\tif (isInstalled) {\n\t\t\treturn setModal(<AppUpdateModal cancel={cancelAction} confirm={() => handleAppPermissionsReview(permissions, appFile, id)} />);\n\t\t}\n\n\t\tawait handleAppPermissionsReview(permissions, appFile);\n\t};\n\n\tconst getAppFileAndManifest = async () => {\n\t\ttry {\n\t\t\tlet manifest;\n\t\t\tlet appFile;\n\t\t\tif (url) {\n\t\t\t\tconst { buff } = await downloadApp({ url, downloadOnly: true });\n\t\t\t\tconst fileData = Uint8Array.from(buff.data);\n\t\t\t\tmanifest = await getManifestFromZippedApp(fileData);\n\t\t\t\tappFile = new File([fileData], 'app.zip', { type: 'application/zip' });\n\t\t\t} else {\n\t\t\t\tappFile = file;\n\t\t\t\tmanifest = await getManifestFromZippedApp(appFile);\n\t\t\t}\n\n\t\t\treturn { appFile, manifest };\n\t\t} catch (error) {\n\t\t\thandleInstallError(error);\n\n\t\t\treturn { appFile: null, manifest: null };\n\t\t}\n\t};\n\n\tconst install = async () => {\n\t\tsetInstalling(true);\n\n\t\tif (!appCountQuery.data) {\n\t\t\treturn cancelAction();\n\t\t}\n\n\t\tconst { appFile, manifest } = await getAppFileAndManifest();\n\n\t\tif (!appFile || !manifest) {\n\t\t\treturn cancelAction();\n\t\t}\n\n\t\tif (appCountQuery.data.hasUnlimitedApps) {\n\t\t\treturn uploadFile(appFile, manifest);\n\t\t}\n\n\t\tsetModal(\n\t\t\t<AppInstallModal\n\t\t\t\tcontext={context}\n\t\t\t\tenabled={appCountQuery.data.enabled}\n\t\t\t\tlimit={appCountQuery.data.limit}\n\t\t\t\tappName={manifest.name}\n\t\t\t\thandleClose={cancelAction}\n\t\t\t\thandleConfirm={() => uploadFile(appFile, manifest)}\n\t\t\t\thandleEnableUnlimitedApps={() => {\n\t\t\t\t\topenExternalLink(manageSubscriptionUrl);\n\t\t\t\t\tsetModal(null);\n\t\t\t\t}}\n\t\t\t/>,\n\t\t);\n\t};\n\n\tconst handleCancel = () => {\n\t\trouter.navigate({\n\t\t\tname: 'marketplace',\n\t\t\tparams: {\n\t\t\t\tcontext,\n\t\t\t\tpage: 'list',\n\t\t\t},\n\t\t});\n\t};\n\n\tconst urlField = useUniqueId();\n\tconst fileField = useUniqueId();\n\n\treturn (\n\t\t<Page flexDirection='column'>\n\t\t\t<Page.Header title={t('App_Installation')} />\n\t\t\t<Page.ScrollableContent>\n\t\t\t\t<FieldGroup display='flex' flexDirection='column' alignSelf='center' maxWidth='x600' w='full'>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<FieldLabel htmlFor={urlField}>{t('App_Url_to_Install_From')}</FieldLabel>\n\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t<Controller\n\t\t\t\t\t\t\t\tname='url'\n\t\t\t\t\t\t\t\tcontrol={control}\n\t\t\t\t\t\t\t\trender={({ field }) => (\n\t\t\t\t\t\t\t\t\t<TextInput id={urlField} placeholder={placeholderUrl} addon={<Icon name='permalink' size='x20' />} {...field} />\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<FieldLabel htmlFor={fileField}>{t('App_Url_to_Install_From_File')}</FieldLabel>\n\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t<Controller\n\t\t\t\t\t\t\t\tname='file'\n\t\t\t\t\t\t\t\tcontrol={control}\n\t\t\t\t\t\t\t\trender={({ field }) => (\n\t\t\t\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\t\t\t\tid={fileField}\n\t\t\t\t\t\t\t\t\t\treadOnly\n\t\t\t\t\t\t\t\t\t\t{...field}\n\t\t\t\t\t\t\t\t\t\tvalue={field.value?.name || ''}\n\t\t\t\t\t\t\t\t\t\taddon={\n\t\t\t\t\t\t\t\t\t\t\t<Button icon='upload' small primary onClick={handleUploadButtonClick} mb='neg-x4' mie='neg-x8'>\n\t\t\t\t\t\t\t\t\t\t\t\t{t('Browse_Files')}\n\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<ButtonGroup>\n\t\t\t\t\t\t\t<Button disabled={!canSave} loading={installing} onClick={install}>\n\t\t\t\t\t\t\t\t{t('Install')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t<Button onClick={handleCancel}>{t('Cancel')}</Button>\n\t\t\t\t\t\t</ButtonGroup>\n\t\t\t\t\t</Field>\n\t\t\t\t</FieldGroup>\n\t\t\t</Page.ScrollableContent>\n\t\t</Page>\n\t);\n}\n\nexport default AppInstallPage;\n",null],"names":["_regeneratorRuntime","_extends","_slicedToArray","Button","ButtonGroup","Icon","Field","FieldGroup","FieldLabel","FieldRow","TextInput","useUniqueId","useSetModal","useEndpoint","useUpload","useTranslation","useRouteParameter","useRouter","useSearchParameter","React","useCallback","useState","useForm","Controller","AppClientOrchestratorInstance","Page","useAppsReload","useExternalLink","useFileInput","useCheckoutUrl","AppPermissionsReviewModal","AppUpdateModal","AppInstallModal","handleAPIError","handleInstallError","useAppsCountQuery","getManifestFromZippedApp","module","link","default","v","exportDefault","t","reload","router","context","setModal","appId","queryUrl","_useState2","installing","setInstalling","endpointAddress","downloadApp","uploadAppEndpoint","uploadUpdateApp","appCountQuery","openExternalLink","manageSubscriptionUrl","target","action","_useForm","defaultValues","url","control","setValue","_watch","watch","file","canSave","name","handleUploadButtonClick","_useFileInput2","value","sendFile","permissionsGranted","appFile","app","fileData","async","_context","prev","next","FormData","append","JSON","stringify","awrap","sent","navigate","params","page","id","t0","finish","stop","Promise","cancelAction","isAppInstalled","_context2","getApp","abrupt","handleAppPermissionsReview","permissions","_context3","createElement","appPermissions","onCancel","onConfirm","uploadFile","_ref","_context4","cancel","confirm","getAppFileAndManifest","manifest","buff","_context5","downloadOnly","_await$downloadApp","Uint8Array","from","data","File","type","urlField","fileField","flexDirection","Header","title","ScrollableContent","display","alignSelf","maxWidth","w","htmlFor","render","_ref2","field","placeholder","addon","size","_ref3","_field$value","readOnly","icon","small","primary","onClick","mb","mie","disabled","loading","_await$getAppFileAndM","_context6","hasUnlimitedApps","enabled","limit","appName","handleClose","handleConfirm","handleEnableUnlimitedApps"],"mappings":"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"}