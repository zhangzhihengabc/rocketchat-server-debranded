)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/marketplace/hooks/useAppsCountQuery.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useQueryClient, useQuery } from '@tanstack/react-query';\nimport { useCallback } from 'react';\n\ntype Variant = 'success' | 'warning' | 'danger';\n\nconst getProgressBarValues = (numberOfEnabledApps: number, enabledAppsLimit: number): { variant: Variant; percentage: number } => ({\n\tvariant: 'success',\n\t...(numberOfEnabledApps + 1 === enabledAppsLimit && { variant: 'warning' }),\n\t...(numberOfEnabledApps >= enabledAppsLimit && { variant: 'danger' }),\n\tpercentage: Math.round((numberOfEnabledApps / enabledAppsLimit) * 100),\n});\n\nexport type MarketplaceRouteContext = 'private' | 'explore' | 'installed' | 'premium' | 'requested';\n\nexport function isMarketplaceRouteContext(context: string): context is MarketplaceRouteContext {\n\treturn ['private', 'explore', 'installed', 'premium', 'requested'].includes(context);\n}\n\nexport const useAppsCountQuery = (context: MarketplaceRouteContext) => {\n\tconst getAppsCount = useEndpoint('GET', '/apps/count');\n\n\treturn useQuery(\n\t\t['apps/count', context],\n\t\tasync () => {\n\t\t\tconst data = await getAppsCount();\n\n\t\t\tconst numberOfEnabledApps = context === 'private' ? data.totalPrivateEnabled : data.totalMarketplaceEnabled;\n\t\t\tconst enabledAppsLimit = context === 'private' ? data.maxPrivateApps : data.maxMarketplaceApps;\n\t\t\tconst hasUnlimitedApps = enabledAppsLimit === -1;\n\t\t\treturn {\n\t\t\t\thasUnlimitedApps,\n\t\t\t\tenabled: numberOfEnabledApps,\n\t\t\t\tlimit: enabledAppsLimit,\n\t\t\t\t...getProgressBarValues(numberOfEnabledApps, enabledAppsLimit),\n\t\t\t};\n\t\t},\n\t\t{ staleTime: 10_000 },\n\t);\n};\n\nexport const useInvalidateAppsCountQueryCallback = () => {\n\tconst queryClient = useQueryClient();\n\treturn useCallback(() => {\n\t\tqueryClient.invalidateQueries(['apps/count']);\n\t}, [queryClient]);\n};\n",null],"names":["isMarketplaceRouteContext","context","includes","module","link","default","_regeneratorRuntime","_objectSpread","export","useAppsCountQuery","useInvalidateAppsCountQueryCallback","useEndpoint","useQueryClient","useQuery","useCallback","getAppsCount","data","numberOfEnabledApps","enabledAppsLimit","hasUnlimitedApps","async","_context","prev","next","awrap","sent","totalPrivateEnabled","totalMarketplaceEnabled","maxPrivateApps","maxMarketplaceApps","abrupt","enabled","limit","variant","percentage","Math","round","stop","Promise","staleTime","queryClient","invalidateQueries"],"mappings":"uBAeM,SAAUA,EAA0BC,CAAe,EACxD,MAAO,CAAC,UAAW,UAAW,YAAa,UAAW,YAAY,CAACC,QAAQ,CAACD,EAC7E,CAjBsBE,EAAMC,IAAA,CAAA,6BAA2B,CAAAC,QAAAA,SAAAA,CAAAA,EAAAC,EAAAA,CAAA,CAAA,EAAA,GAAAH,EAAAA,IAAAA,CAAAA,uCAAAA,CAAAE,QAAAA,SAAAA,CAAAA,EAAAE,EAAAA,CAAA,CAAA,EAAA,GAAvDJ,EAAOK,MAAE,CAAA,CAAAR,0BAAmB,WAAA,OAA2BA,CAAA,EAAAS,kBAAAA,WAAA,OAAAA,CAAA,EAAAC,oCAAAA,WAAA,OAAAA,CAAA,CAAA,GAAAP,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAQ,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAR,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAS,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,SAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAV,EAAAA,IAAAA,CAAAA,QAAAA,CAAAW,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAmBhD,IAnBPR,EAAuDC,EAAAI,EAAAC,EAAAC,EAAAC,EAmB1CL,EAAoB,SAACR,CAAgC,EACjE,IAAMc,EAAeJ,EAAY,MAAO,eAExC,OAAOE,EACN,CAAC,aAAcZ,EAAQ,CACvB,WAAA,IAAAe,EAAAC,EAAAC,EAAAC,EAAA,OAAAb,EAAAc,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAAA,OAAAF,EAAAE,IAAA,CAAA,EAAAjB,EAAAkB,KAAA,CACoBT,IAAc,MAAA,EAIe,OAJ1CC,EAAIK,EAAAI,IAAA,CAEJR,EAAsBhB,AAAY,YAAZA,EAAwBe,EAAKU,mBAAmB,CAAGV,EAAKW,uBAAuB,CAErGR,EAAmBD,AAAqB,KADxCA,CAAAA,EAAmBjB,AAAY,YAAZA,EAAwBe,EAAKY,cAAc,CAAGZ,EAAKa,kBAAkB,AAAlBA,EAC5BR,EAAAS,MAAA,CAAA,SAAAvB,EAAA,CAE/CY,iBAAAA,EACAY,QAASd,EACTe,MAAOd,CAAgB,EA3BwDX,EAAAA,EAAAA,EAAA,CAClF0B,QAAS,SAAS,EACdhB,AA0BuBA,EA1BD,IA0BsBC,GA1BI,CAAEe,QAAS,SAAS,GACpEhB,AAyBuBA,GAAqBC,GAzBD,CAAEe,QAAS,QAAQ,GAAE,CAAA,EAAA,CACpEC,WAAYC,KAAKC,KAAK,CAAEnB,AAwBGA,EAAqBC,EAxBkB,IAAI,IAwBL,MAAA,EAAA,IAAA,MAAA,OAAAG,EAAAgB,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,EAGhE,CAAEC,UAAW,GAAM,EAErB,EAEa7B,EAAsC,WAClD,IAAM8B,EAAc5B,IACpB,OAAOE,EAAY,WAClB0B,EAAYC,iBAAiB,CAAC,CAAC,aAAa,CAC7C,EAAG,CAACD,EAAY,CACjB"}