function module(e,n,t){var a,r,u,s,i,c,l,o,p,f,d,m,k,b,h,x,A;function v(e){var n=e.app,t=e.action,v=e.isAppPurchased,g=e.onDismiss,C=e.onSuccess,E=i(),I=s(),y=String(u("context")),M=b(y)?y:"explore",P=h(M),w=r("POST","/apps/notify-admins"),O=A(),R=p(),U=f()({target:"user-page",action:"buy_more"}),S=l(function(){I(null),g()},[g,I]),T=l(function(e){I(null),C(t,e)},[t,C,I]),q=x({app:n,onCancel:S,onConfirm:T}),D=l(function(){var e;return a.async(function(r){for(;;)switch(r.prev=r.next){case 0:if(!("purchase"===t&&!v)){r.next=12;break}return r.prev=1,r.next=4,a.awrap(o.buildExternalUrl(n.id,n.purchaseType,!1));case 4:e=r.sent,I(c.createElement(d,{url:e.url,cancel:g,confirm:q})),r.next=11;break;case 8:r.prev=8,r.t0=r.catch(1),k(r.t0);case 11:return r.abrupt("return");case 12:q();case 13:case"end":return r.stop()}},null,null,[[1,8]],Promise)},[t,v,q,n.id,n.purchaseType,I,g]);return l(function(){var e,r;return a.async(function(u){for(;;)switch(u.prev=u.next){case 0:if(!(null!=n&&n.versionIncompatible)){u.next=3;break}return O(n,t,S),u.abrupt("return");case 3:if("request"!==t){u.next=16;break}return e=function(e){I(null),E({type:"success",message:"App request submitted"}),w({appId:n.id,appName:n.name,appVersion:n.marketplaceVersion,message:"string"==typeof e.message?e.message:""}),T()},u.prev=5,u.next=8,a.awrap(o.buildExternalAppRequest(n.id));case 8:r=u.sent,I(c.createElement(d,{url:r.url,wrapperHeight:"x460",cancel:g,confirm:e})),u.next=15;break;case 12:u.prev=12,u.t0=u.catch(5),k(u.t0);case 15:return u.abrupt("return");case 16:if(P.data){u.next=18;break}return u.abrupt("return");case 18:if(!P.data.hasUnlimitedApps){u.next=20;break}return u.abrupt("return",D());case 20:I(c.createElement(m,{context:M,enabled:P.data.enabled,limit:P.data.limit,appName:n.name,handleClose:S,handleConfirm:D,handleEnableUnlimitedApps:function(){R(U),I(null)}}));case 21:case"end":return u.stop()}},null,null,[[5,12]],Promise)},[n,t,P.data,I,M,S,D,O,E,w,T,g,R,U])}t.link("@babel/runtime/regenerator",{default:function(e){a=e}},0),t.export({useAppInstallationHandler:function(){return v}}),t.link("@rocket.chat/ui-contexts",{useEndpoint:function(e){r=e},useRouteParameter:function(e){u=e},useSetModal:function(e){s=e},useToastMessageDispatch:function(e){i=e}},0),t.link("react",{default:function(e){c=e},useCallback:function(e){l=e}},1),t.link("../../../../ee/client/apps/orchestrator",{AppClientOrchestratorInstance:function(e){o=e}},2),t.link("../../../hooks/useExternalLink",{useExternalLink:function(e){p=e}},3),t.link("../../admin/subscription/hooks/useCheckoutUrl",{useCheckoutUrl:function(e){f=e}},4),t.link("../IframeModal",{default:function(e){d=e}},5),t.link("../components/AppInstallModal/AppInstallModal",{default:function(e){m=e}},6),t.link("../helpers/handleAPIError",{handleAPIError:function(e){k=e}},7),t.link("./useAppsCountQuery",{isMarketplaceRouteContext:function(e){b=e},useAppsCountQuery:function(e){h=e}},8),t.link("./useOpenAppPermissionsReviewModal",{useOpenAppPermissionsReviewModal:function(e){x=e}},9),t.link("./useOpenIncompatibleModal",{useOpenIncompatibleModal:function(e){A=e}},10)}
//# sourceMappingURL=/dynamic/client/views/marketplace/hooks/251fb9835fa495be6ee54d39d014c9a81275f2cc.map
