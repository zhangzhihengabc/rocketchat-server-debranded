)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/marketplace/lib/getManifestFromZippedApp.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { unzipSync, strFromU8 } from 'fflate';\n\ntype Uint8ArrayObject = { [fileName: string]: Uint8Array };\ntype AppManifestSchema = { [key: string]: string };\n\nasync function fileToUint8Array(file: File): Promise<Uint8Array> {\n\treturn new Promise((resolve, reject) => {\n\t\tconst fileReader = new FileReader();\n\t\tfileReader.onload = (e): void => resolve(new Uint8Array((e.target as any).result as Uint8Array));\n\t\tfileReader.onerror = (e): void => reject(e);\n\t\tfileReader.readAsArrayBuffer(file);\n\t});\n}\n\nfunction unzipAppBuffer(zippedAppBuffer: Uint8Array): Uint8ArrayObject {\n\treturn unzipSync(zippedAppBuffer);\n}\n\nfunction getAppManifest(unzippedAppBuffer: Uint8ArrayObject): AppManifestSchema {\n\tif (!unzippedAppBuffer['app.json']) {\n\t\tthrow new Error('No app.json file found in the zip');\n\t}\n\n\ttry {\n\t\treturn JSON.parse(strFromU8(unzippedAppBuffer['app.json']));\n\t} catch (e) {\n\t\tthrow new Error(`Failed to parse app.json: ${e instanceof Error ? e.message : String(e)}`);\n\t}\n}\n\nasync function unzipZippedApp(zippedApp: File | Uint8Array): Promise<Uint8ArrayObject> {\n\ttry {\n\t\tif (zippedApp instanceof File) {\n\t\t\tzippedApp = await fileToUint8Array(zippedApp);\n\t\t}\n\n\t\treturn unzipAppBuffer(zippedApp);\n\t} catch (e) {\n\t\tconsole.error(e);\n\t\tthrow e;\n\t}\n}\n\nexport async function getManifestFromZippedApp(zippedApp: File): Promise<AppManifestSchema> {\n\tconst unzippedBuffer = await unzipZippedApp(zippedApp);\n\treturn getAppManifest(unzippedBuffer);\n}\n",null],"names":["_regeneratorRuntime","unzipSync","strFromU8","getManifestFromZippedApp","zippedApp","unzippedBuffer","async","_context3","prev","next","awrap","unzipZippedApp","_context2","File","fileToUint8Array","file","_context","abrupt","Promise","resolve","reject","fileReader","FileReader","onload","e","Uint8Array","target","result","onerror","readAsArrayBuffer","stop","sent","t0","console","error","getAppManifest","unzippedAppBuffer","Error","JSON","parse","message","String","module","link","default","export"],"mappings":"2BAAAA,EAA8CC,EAAAC,EA2CvC,SAAeC,EAAyBC,CAAe,EAAA,IAAAC,EAAA,OAAAL,EAAAM,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAAA,OAAAF,EAAAE,IAAA,CAAA,EAAAT,EAAAU,KAAA,CAChCC,AAd9B,SAA8BP,CAA4B,EAAA,OAAAJ,EAAAM,KAAA,CAAA,SAAAM,CAAA,EAAA,OAAA,OAAAA,EAAAJ,IAAA,CAAAI,EAAAH,IAAA,EAAA,KAAA,EAAA,GAAAG,EAAAJ,IAAA,CAAA,EAAA,CAEpDJ,CAAAA,aAAqBS,IAAAA,EAAI,CAAAD,EAAAH,IAAA,CAAA,EAAA,KAAA,CAAA,OAAAG,EAAAH,IAAA,CAAA,EAAAT,EAAAU,KAAA,CACVI,AA5BrB,SAAgCC,CAAU,EAAA,OAAAf,EAAAM,KAAA,CAAA,SAAAU,CAAA,EAAA,OAAA,OAAAA,EAAAR,IAAA,CAAAQ,EAAAP,IAAA,EAAA,KAAA,EAAA,OAAAO,EAAAC,MAAA,CAAA,SAClC,IAAIC,QAAQ,SAACC,CAAO,CAAEC,CAAM,EAClC,IAAMC,EAAa,IAAIC,UACvBD,CAAAA,EAAWE,MAAM,CAAG,SAACC,CAAC,EAAA,OAAWL,EAAQ,IAAIM,WAAYD,EAAEE,MAAc,CAACC,MAAoB,EAAE,EAChGN,EAAWO,OAAO,CAAG,SAACJ,CAAC,EAAA,OAAWJ,EAAOI,EAAE,EAC3CH,EAAWQ,iBAAiB,CAACd,EAC9B,GAAE,MAAA,EAAA,IAAA,MAAA,OAAAC,EAAAc,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAZ,QAAA,EAsBmCd,GAAU,MAAA,EAA7CA,EAASQ,EAAAmB,IAAA,MAAA,EAAA,OAAAnB,EAAAK,MAAA,CAAA,SAlBJhB,EAqBgBG,GAAU,MAAA,EAEf,MAFeQ,EAAAJ,IAAA,CAAA,EAAAI,EAAAoB,EAAA,CAAApB,EAAA,KAAA,CAAA,GAEhCqB,QAAQC,KAAK,CAAAtB,EAAAoB,EAAA,EAAIpB,EAAAoB,EAAA,MAAA,GAAA,IAAA,MAAA,OAAApB,EAAAkB,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAAZ,QAAA,EAM0Bd,GAAU,MAAA,EAAlC,OAAdC,EAAcE,EAAAwB,IAAA,CAAAxB,EAAAU,MAAA,CAAA,SACbkB,AA3BR,SAAwBC,CAAmC,EAC1D,GAAI,CAACA,CAAiB,CAAC,WAAW,CACjC,MAAM,AAAIC,MAAM,qCAGjB,GAAI,CACH,OAAOC,KAAKC,KAAK,CAACrC,EAAUkC,CAAiB,CAAC,WAAW,GACxD,MAAOZ,EAAG,CACX,MAAM,AAAIa,MAAK,6BAA8Bb,CAAAA,aAAaa,MAAQb,EAAEgB,OAAO,CAAGC,OAAOjB,EAAC,GAExF,EAiBuBnB,GAAe,MAAA,EAAA,IAAA,MAAA,OAAAE,EAAAuB,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAZ,QAAA,CA7ClBwB,EAAWC,IAAAA,CAAAA,6BAAe,CAAAC,QAAAA,SAAAA,CAAAA,EAAA5C,EAAAA,CAAA,CAAA,EAAA,GAA9C0C,EAAOG,MAAE,CAAA,CAAA1C,yBAA4B,WAAS,OAAAA,CAAA,CAAA,GAAAuC,EAAAA,IAAAA,CAAAA,SAAAA,CAAAzC,UAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,UAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA"}