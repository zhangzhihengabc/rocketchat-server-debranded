function module(e,n,t){var a,i,l,r,s,c,u,o,p,d,m,f,b,v,k,h,x,E,A,g,_,P,w,y,M,I,T,U,S,D,O,z,C,F,R=["app","isAppDetailsPage"];t.link("@babel/runtime/regenerator",{default:function(e){a=e}},0),t.link("@babel/runtime/helpers/extends",{default:function(e){i=e}},1),t.link("@babel/runtime/helpers/objectSpread2",{default:function(e){l=e}},2),t.link("@babel/runtime/helpers/slicedToArray",{default:function(e){r=e}},3),t.link("@babel/runtime/helpers/objectWithoutProperties",{default:function(e){s=e}},4),t.link("@rocket.chat/fuselage",{Box:function(e){c=e},Icon:function(e){u=e},Menu:function(e){o=e},Skeleton:function(e){p=e}},0),t.link("@rocket.chat/ui-contexts",{useSetModal:function(e){d=e},useEndpoint:function(e){m=e},useTranslation:function(e){f=e},useRouteParameter:function(e){b=e},useToastMessageDispatch:function(e){v=e},usePermission:function(e){k=e},useRouter:function(e){h=e}},1),t.link("react",{default:function(e){x=e},useMemo:function(e){E=e},useCallback:function(e){A=e},useState:function(e){g=e}},2),t.link("semver",{default:function(e){_=e}},3),t.link("../../components/WarningModal",{default:function(e){P=e}},4),t.link("../../hooks/useIsEnterprise",{useIsEnterprise:function(e){w=e}},5),t.link("./IframeModal",{default:function(e){y=e}},6),t.link("./components/UninstallGrandfatheredAppModal/UninstallGrandfatheredAppModal",{default:function(e){M=e}},7),t.link("./helpers",{appEnabledStatuses:function(e){I=e},appButtonProps:function(e){T=e}},8),t.link("./helpers/handleAPIError",{handleAPIError:function(e){U=e}},9),t.link("./helpers/marketplaceActions",{marketplaceActions:function(e){S=e}},10),t.link("./helpers/warnEnableDisableApp",{warnEnableDisableApp:function(e){D=e}},11),t.link("./hooks/useAppInstallationHandler",{useAppInstallationHandler:function(e){O=e}},12),t.link("./hooks/useAppsCountQuery",{useAppsCountQuery:function(e){z=e}},13),t.link("./hooks/useOpenAppPermissionsReviewModal",{useOpenAppPermissionsReviewModal:function(e){C=e}},14),t.link("./hooks/useOpenIncompatibleModal",{useOpenIncompatibleModal:function(e){F=e}},15),t.exportDefault(function(e){var n,t,G,q=e.app,H=e.isAppDetailsPage,L=s(e,R),V=f(),j=v(),B=d(),Q=h(),W=b("context"),Y=b("tab"),N=m("POST","/apps/"+q.id+"/status"),J=m("GET","/apps"),K=m("POST","/apps/"+q.id+"/sync"),X=m("DELETE","/apps/"+q.id),Z=w().data,$=!!(null!=Z&&Z.isEnterprise),ee=r(g(!1),2),en=ee[0],et=ee[1],ea=r(g(q.requestedEndUser),2),ei=ea[0],el=ea[1],er="subscription"===q.purchaseType,es=q.subscriptionInfo&&["active","trialing"].includes(q.subscriptionInfo.status),ec=I.includes(q.status),eu=r(g(null==q?void 0:q.isPurchased),2),eo=eu[0],ep=eu[1],ed=k("manage-apps"),em=z(W),ef=F(),eb=T(l(l({},q),{},{isAdminUser:ed})),ev=(null==eb?void 0:eb.action)||"",ek=A(function(){B(null),et(!1)},[B,et]),eh=A(function(e,n){return a.async(function(t){for(;;)switch(t.prev=t.next){case 0:if("purchase"===e&&ep(!0),"request"!==e){t.next=5;break}el(!0),t.next=7;break;case 5:return t.next=7,a.awrap(S[e](l(l({},q),{},{permissionsGranted:n})));case 7:et(!1);case 8:case"end":return t.stop()}},null,null,null,Promise)},[q,et]),ex=C({app:q,onCancel:ek,onConfirm:function(e){return eh(ev,e)}}),eE=O({app:q,isAppPurchased:eo,action:ev,onDismiss:ek,onSuccess:eh}),eA=A(function(){et(!0),eE()},[eE,et]),eg=A(function(){var e,n;return a.async(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(null!=q&&q.versionIncompatible&&!es)){t.next=3;break}return ef(q,"subscribe",ek),t.abrupt("return");case 3:return t.prev=3,t.next=6,a.awrap(J({buildExternalUrl:"true",appId:q.id,purchaseType:q.purchaseType,details:!0}));case 6:e=t.sent,t.next=13;break;case 9:return t.prev=9,t.t0=t.catch(3),U(t.t0),t.abrupt("return");case 13:n=function e(){return a.async(function e(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.awrap(K());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),U(e.t0);case 8:case"end":return e.stop()}},null,null,[[0,5]],Promise)},B(x.createElement(y,{url:e.url,confirm:n,cancel:ek}));case 15:case"end":return t.stop()}},null,null,[[3,9]],Promise)},[q,es,B,ek,ef,J,K]),e_=A(function(){Q.navigate({name:"marketplace",params:{context:W,page:"info",id:q.id,version:q.version,tab:"logs"}})},[q.id,q.version,W,Q]),eP=A(function(){B(x.createElement(P,{close:ek,confirm:function(){var e;return a.async(function(n){for(;;)switch(n.prev=n.next){case 0:return ek(),n.prev=1,n.next=4,a.awrap(N({status:"manually_disabled"}));case 4:e=n.sent.status,D(q.name,e,"disable"),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(1),U(n.t0);case 12:case"end":return n.stop()}},null,null,[[1,9]],Promise)},text:V("Apps_Marketplace_Deactivate_App_Prompt"),confirmText:V("Yes")}))},[q.name,ek,N,B,V]),ew=A(function(){var e;return a.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,a.awrap(N({status:"manually_enabled"}));case 3:e=n.sent.status,D(q.name,e,"enable"),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),U(n.t0);case 11:case"end":return n.stop()}},null,null,[[0,8]],Promise)},[q.name,N]),ey=A(function(){var e=function(){return a.async(function(e){for(;;)switch(e.prev=e.next){case 0:return ek(),e.prev=1,e.next=4,a.awrap(X());case 4:e.sent.success&&(j({type:"success",message:q.name+" uninstalled"}),"details"===W&&"details"!==Y&&Q.navigate({name:"marketplace",params:l(l({},Q.getRouteParameters()),{},{tab:"details"})},{replace:!0})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),U(e.t0);case 12:case"end":return e.stop()}},null,null,[[1,9]],Promise)};if(es&&B(x.createElement(P,{close:ek,cancel:e,confirm:function(){return a.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.awrap(eg());case 2:case"end":return e.stop()}},null,null,null,Promise)},text:V("Apps_Marketplace_Uninstall_Subscribed_App_Prompt"),confirmText:V("Apps_Marketplace_Modify_App_Subscription"),cancelText:V("Apps_Marketplace_Uninstall_Subscribed_App_Anyway")})),em.data){if(q.migrated){B(x.createElement(M,{context:W,appName:q.name,limit:em.data.limit,handleUninstall:e,handleClose:ek}));return}B(x.createElement(P,{close:ek,confirm:e,text:V("Apps_Marketplace_Uninstall_App_Prompt"),confirmText:V("Yes")}))}},[es,em.data,q.migrated,q.name,B,ek,V,X,j,W,Y,Q,eg]),eM=A(function(e,n){return e.versionIncompatible?("subscribe"!==n||es)&&"install"!==n&&"update"!==n?"card":"warning":"update"===n?"refresh":"card"},[es]),eI=A(function(){return a.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(et(!0),!(null!=q&&q.versionIncompatible)){e.next=4;break}return ef(q,"update",ek),e.abrupt("return");case 4:ex();case 5:case"end":return e.stop()}},null,null,null,Promise)},[q,ex,ef,ek]),eT=q.installed&&q.version&&q.marketplaceVersion&&_.lt(q.version,q.marketplaceVersion),eU=E(function(){var e,n,t,a=l({},er&&es&&ed&&{subscribe:{label:x.createElement(x.Fragment,null,x.createElement(u,{name:eM(q,"subscribe"),size:"x16",mie:4}),V("Subscription")),action:eg}}),i=l({},!q.installed&&eb&&{acquire:{label:x.createElement(x.Fragment,null,ed&&x.createElement(u,{name:eM(q,"install"),size:"x16",mie:4}),V(eb.label.replace(" ","_"))),action:eA,disabled:ei}}),r=q.isEnterpriseOnly&&$||!q.isEnterpriseOnly,s=q.installed&&ed&&!ec&&r,o=!q.migrated&&!(null!=em&&null!==(e=em.data)&&void 0!==e&&e.hasUnlimitedApps)&&(null==em?void 0:null===(n=em.data)||void 0===n?void 0:n.enabled)>=(null==em?void 0:null===(t=em.data)||void 0===t?void 0:t.limit),p=l(l(l(l(l(l({},"details"!==W&&ed&&q.installed&&{viewLogs:{label:x.createElement(x.Fragment,null,x.createElement(u,{name:"desktop-text",size:"x16",mie:4}),V("View_Logs")),action:e_}}),ed&&eT&&!H&&{update:{label:x.createElement(x.Fragment,null,x.createElement(u,{name:eM(q,"update"),size:"x16",mie:4}),V("Update")),action:eI}}),q.installed&&ed&&ec&&{disable:{label:x.createElement(c,{color:"status-font-on-warning"},x.createElement(u,{name:"ban",size:"x16",mie:4}),V("Disable")),action:eP}}),s&&{enable:{label:x.createElement(x.Fragment,null,x.createElement(u,{name:"check",size:"x16",marginInlineEnd:"x4"}),V("Enable")),disabled:o,action:ew}}),q.installed&&ed&&{divider:{type:"divider"}}),q.installed&&ed&&{uninstall:{label:x.createElement(c,{color:"status-font-on-danger"},x.createElement(u,{name:"trash",size:"x16",mie:4}),V("Uninstall")),action:ey}});return l(l(l({},a),i),p)},[er,es,ed,eM,q,V,eg,eb,eA,ei,$,ec,null==em?void 0:null===(n=em.data)||void 0===n?void 0:n.hasUnlimitedApps,null==em?void 0:null===(t=em.data)||void 0===t?void 0:t.enabled,null==em?void 0:null===(G=em.data)||void 0===G?void 0:G.limit,W,e_,eT,H,eI,eP,ew,ey]);return en?x.createElement(p,{variant:"rect",height:"x28",width:"x28"}):!ed&&null!=q&&q.installed?null:x.createElement(o,i({title:V("More_options"),options:eU,placement:"bottom-start",maxHeight:"initial"},L))})}
//# sourceMappingURL=/dynamic/client/views/marketplace/32a27f2a3887445e9c45e1b16734ad4335645073.map
