function module(e,n,t){var r,a,l,u,i,c,o,s,p,f,m,d,k,h,x,b,E,v,w,A,F,g,y,C,I,P,_,U,M,S,R,O,z,D,T,B,L;t.link("@babel/runtime/regenerator",{default:function(e){r=e}},0),t.link("@babel/runtime/helpers/extends",{default:function(e){a=e}},1),t.link("@babel/runtime/helpers/slicedToArray",{default:function(e){l=e}},2),t.link("@rocket.chat/fuselage",{Button:function(e){u=e},ButtonGroup:function(e){i=e},Icon:function(e){c=e},Field:function(e){o=e},FieldGroup:function(e){s=e},FieldLabel:function(e){p=e},FieldRow:function(e){f=e},TextInput:function(e){m=e}},0),t.link("@rocket.chat/fuselage-hooks",{useUniqueId:function(e){d=e}},1),t.link("@rocket.chat/ui-contexts",{useSetModal:function(e){k=e},useEndpoint:function(e){h=e},useUpload:function(e){x=e},useTranslation:function(e){b=e},useRouteParameter:function(e){E=e},useRouter:function(e){v=e},useSearchParameter:function(e){w=e}},2),t.link("react",{default:function(e){A=e},useCallback:function(e){F=e},useState:function(e){g=e}},3),t.link("react-hook-form",{useForm:function(e){y=e},Controller:function(e){C=e}},4),t.link("../../../ee/client/apps/orchestrator",{AppClientOrchestratorInstance:function(e){I=e}},5),t.link("../../components/Page",{default:function(e){P=e}},6),t.link("../../contexts/hooks/useAppsReload",{useAppsReload:function(e){_=e}},7),t.link("../../hooks/useExternalLink",{useExternalLink:function(e){U=e}},8),t.link("../../hooks/useFileInput",{useFileInput:function(e){M=e}},9),t.link("../admin/subscription/hooks/useCheckoutUrl",{useCheckoutUrl:function(e){S=e}},10),t.link("./AppPermissionsReviewModal",{default:function(e){R=e}},11),t.link("./AppUpdateModal",{default:function(e){O=e}},12),t.link("./components/AppInstallModal/AppInstallModal",{default:function(e){z=e}},13),t.link("./helpers/handleAPIError",{handleAPIError:function(e){D=e}},14),t.link("./helpers/handleInstallError",{handleInstallError:function(e){T=e}},15),t.link("./hooks/useAppsCountQuery",{useAppsCountQuery:function(e){B=e}},16),t.link("./lib/getManifestFromZippedApp",{getManifestFromZippedApp:function(e){L=e}},17),t.exportDefault(function(){var e=b(),n=_(),t=v(),G=E("context"),N=k(),Q=w("id"),V=w("url"),Z=l(g(!1),2),q=Z[0],H=Z[1],J=Q?"/apps/"+Q:"/apps",W=h("POST",J),j=x(J),K=x(J+"/update"),X=B("private"),Y=U(),$=S()({target:"marketplace-app-install",action:"Enable_unlimited_apps"}),ee=y({defaultValues:{url:V||""}}),en=ee.control,et=ee.setValue,er=(0,ee.watch)(),ea=er.file,el=er.url,eu=!!el||!!(null!=ea&&ea.name),ei=l(M(function(e){return et("file",e)},"app"),1)[0],ec=function(e,a,l){var u,i;return r.async(function(c){for(;;)switch(c.prev=c.next){case 0:if((i=new FormData).append("app",a,a.name),i.append("permissions",JSON.stringify(e)),c.prev=3,!l){c.next=9;break}return c.next=7,r.awrap(K(i));case 7:c.next=12;break;case 9:return c.next=11,r.awrap(j(i));case 11:u=c.sent;case 12:t.navigate({name:"marketplace",params:{context:"private",page:"info",id:l||u.app.id}}),n(),c.next=19;break;case 16:c.prev=16,c.t0=c.catch(3),D(c.t0);case 19:return c.prev=19,H(!1),N(null),c.finish(19);case 23:case"end":return c.stop()}},null,null,[[3,16,19,23]],Promise)},eo=F(function(){H(!1),N(null)},[H,N]),es=function(e){var n;return r.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.awrap(I.getApp(e));case 3:return n=t.sent,t.abrupt("return",!!n);case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",!1);case 10:case"end":return t.stop()}},null,null,[[0,7]],Promise)},ep=function(e,n,t){return r.async(function(r){for(;;)switch(r.prev=r.next){case 0:N(A.createElement(R,{appPermissions:e,onCancel:eo,onConfirm:function(e){return ec(e,n,t)}}));case 1:case"end":return r.stop()}},null,null,null,Promise)},ef=function(e,n){var t,a;return r.async(function(l){for(;;)switch(l.prev=l.next){case 0:return t=n.id,a=n.permissions,l.next=3,r.awrap(es(t));case 3:if(!l.sent){l.next=6;break}return l.abrupt("return",N(A.createElement(O,{cancel:eo,confirm:function(){return ep(a,e,t)}})));case 6:return l.next=8,r.awrap(ep(a,e));case 8:case"end":return l.stop()}},null,null,null,Promise)},em=function(){var e,n,t,a;return r.async(function(l){for(;;)switch(l.prev=l.next){case 0:if(l.prev=0,!el){l.next=13;break}return l.next=4,r.awrap(W({url:el,downloadOnly:!0}));case 4:return t=l.sent.buff,a=Uint8Array.from(t.data),l.next=9,r.awrap(L(a));case 9:e=l.sent,n=new File([a],"app.zip",{type:"application/zip"}),l.next=17;break;case 13:return n=ea,l.next=16,r.awrap(L(n));case 16:e=l.sent;case 17:return l.abrupt("return",{appFile:n,manifest:e});case 20:return l.prev=20,l.t0=l.catch(0),T(l.t0),l.abrupt("return",{appFile:null,manifest:null});case 24:case"end":return l.stop()}},null,null,[[0,20]],Promise)},ed=d(),ek=d();return A.createElement(P,{flexDirection:"column"},A.createElement(P.Header,{title:e("App_Installation")}),A.createElement(P.ScrollableContent,null,A.createElement(s,{display:"flex",flexDirection:"column",alignSelf:"center",maxWidth:"x600",w:"full"},A.createElement(o,null,A.createElement(p,{htmlFor:ed},e("App_Url_to_Install_From")),A.createElement(f,null,A.createElement(C,{name:"url",control:en,render:function(e){var n=e.field;return A.createElement(m,a({id:ed,placeholder:"https://rocket.chat/apps/package.zip",addon:A.createElement(c,{name:"permalink",size:"x20"})},n))}}))),A.createElement(o,null,A.createElement(p,{htmlFor:ek},e("App_Url_to_Install_From_File")),A.createElement(f,null,A.createElement(C,{name:"file",control:en,render:function(n){var t,r=n.field;return A.createElement(m,a({id:ek,readOnly:!0},r,{value:(null===(t=r.value)||void 0===t?void 0:t.name)||"",addon:A.createElement(u,{icon:"upload",small:!0,primary:!0,onClick:ei,mb:"neg-x4",mie:"neg-x8"},e("Browse_Files"))}))}}))),A.createElement(o,null,A.createElement(i,null,A.createElement(u,{disabled:!eu,loading:q,onClick:function(){var e,n,t;return r.async(function(a){for(;;)switch(a.prev=a.next){case 0:if(H(!0),X.data){a.next=3;break}return a.abrupt("return",eo());case 3:return a.next=5,r.awrap(em());case 5:if(n=(e=a.sent).appFile,t=e.manifest,!(!n||!t)){a.next=10;break}return a.abrupt("return",eo());case 10:if(!X.data.hasUnlimitedApps){a.next=12;break}return a.abrupt("return",ef(n,t));case 12:N(A.createElement(z,{context:G,enabled:X.data.enabled,limit:X.data.limit,appName:t.name,handleClose:eo,handleConfirm:function(){return ef(n,t)},handleEnableUnlimitedApps:function(){Y($),N(null)}}));case 13:case"end":return a.stop()}},null,null,null,Promise)}},e("Install")),A.createElement(u,{onClick:function(){t.navigate({name:"marketplace",params:{context:G,page:"list"}})}},e("Cancel")))))))})}
//# sourceMappingURL=/dynamic/client/views/marketplace/db8b1ee362af78671915a2045ce7665e090c14ce.map
