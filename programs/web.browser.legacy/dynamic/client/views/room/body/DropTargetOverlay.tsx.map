)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/body/DropTargetOverlay.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { css } from '@rocket.chat/css-in-js';\nimport { Box } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation } from '@rocket.chat/ui-contexts';\nimport type { DragEvent, ReactElement, ReactNode } from 'react';\nimport React, { memo } from 'react';\n\nimport { useFormatDateAndTime } from '../../../hooks/useFormatDateAndTime';\n\ntype DropTargetOverlayProps = {\n\tenabled: boolean;\n\treason?: ReactNode;\n\tonFileDrop?: (files: File[]) => void;\n\tvisible?: boolean;\n\tonDismiss?: () => void;\n};\n\nfunction DropTargetOverlay({ enabled, reason, onFileDrop, visible = true, onDismiss }: DropTargetOverlayProps): ReactElement | null {\n\tconst t = useTranslation();\n\n\tconst handleDragLeave = useMutableCallback((event: DragEvent) => {\n\t\tevent.stopPropagation();\n\t\tonDismiss?.();\n\t});\n\n\tconst handleDragOver = useMutableCallback((event: DragEvent) => {\n\t\tevent.stopPropagation();\n\n\t\tevent.preventDefault();\n\t\tevent.dataTransfer.dropEffect = ['move', 'linkMove'].includes(event.dataTransfer.effectAllowed) ? 'move' : 'copy';\n\t});\n\n\tconst formatDateAndTime = useFormatDateAndTime();\n\n\tconst handleDrop = useMutableCallback(async (event: DragEvent) => {\n\t\tevent.stopPropagation();\n\t\tonDismiss?.();\n\n\t\tevent.preventDefault();\n\n\t\tconst files = Array.from(event.dataTransfer.files);\n\n\t\tif (event.dataTransfer.types.includes('text/uri-list') && event.dataTransfer.types.includes('text/html')) {\n\t\t\tconst fragment = document.createRange().createContextualFragment(event.dataTransfer.getData('text/html'));\n\t\t\tfor await (const { src } of Array.from(fragment.querySelectorAll('img'))) {\n\t\t\t\ttry {\n\t\t\t\t\tconst response = await fetch(src);\n\t\t\t\t\tconst data = await response.blob();\n\t\t\t\t\tconst extension = (await import('../../../../app/utils/lib/mimeTypes')).mime.extension(data.type);\n\t\t\t\t\tconst filename = `File - ${formatDateAndTime(new Date())}.${extension}`;\n\t\t\t\t\tconst file = new File([data], filename, { type: data.type });\n\t\t\t\t\tfiles.push(file);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.warn(error);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tonFileDrop?.(files);\n\t});\n\n\tif (!visible) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<Box\n\t\t\trole='dialog'\n\t\t\tdata-qa='DropTargetOverlay'\n\t\t\tposition='absolute'\n\t\t\tzIndex={1_000_000}\n\t\t\tinset={0}\n\t\t\tdisplay='flex'\n\t\t\talignItems='center'\n\t\t\tjustifyContent='center'\n\t\t\tfontScale='hero'\n\t\t\ttextAlign='center'\n\t\t\tbackgroundColor='rgba(255, 255, 255, 0.8)'\n\t\t\tborderWidth={4}\n\t\t\tborderStyle='dashed'\n\t\t\tborderColor='currentColor'\n\t\t\tcolor={enabled ? 'primary' : 'danger'}\n\t\t\tclassName={css`\n\t\t\t\tanimation-name: zoomIn;\n\t\t\t\tanimation-duration: 0.1s;\n\t\t\t`}\n\t\t\tonDragLeave={handleDragLeave}\n\t\t\tonDragOver={handleDragOver}\n\t\t\tonDrop={handleDrop}\n\t\t>\n\t\t\t{enabled ? t('Drop_to_upload_file') : reason}\n\t\t</Box>\n\t);\n}\n\nexport default memo(DropTargetOverlay);\n",null],"names":["_taggedTemplateLiteralLoose","_regeneratorRuntime","_asyncIterator","css","Box","useMutableCallback","useTranslation","React","memo","useFormatDateAndTime","module","default","link","v","exportDefault","_ref","enabled","reason","onFileDrop","_ref$visible","visible","onDismiss","t","handleDragLeave","event","stopPropagation","handleDragOver","preventDefault","dataTransfer","dropEffect","includes","effectAllowed","formatDateAndTime","handleDrop","files","fragment","_iteratorAbruptCompletion","_didIteratorError","_iteratorError","_iterator","_step","src","response","data","extension","filename","file","async","_context","prev","next","Array","from","types","document","createRange","createContextualFragment","getData","querySelectorAll","awrap","sent","done","value","fetch","blob","dynamicImport","mime","type","Date","File","push","t0","console","warn","t1","return","finish","stop","Promise","createElement","role","position","zIndex","inset","display","alignItems","justifyContent","fontScale","textAlign","backgroundColor","borderWidth","borderStyle","borderColor","color","className","_templateObject","onDragLeave","onDragOver","onDrop"],"mappings":"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"}