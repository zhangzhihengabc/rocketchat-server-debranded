)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/modals/FileUploadModal/MediaPreview.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { AudioPlayer, Box, Icon } from '@rocket.chat/fuselage';\nimport { useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useEffect, useState, memo } from 'react';\n\nimport { userAgentMIMETypeFallback } from '../../../../lib/utils/userAgentMIMETypeFallback';\nimport { FilePreviewType } from './FilePreview';\nimport ImagePreview from './ImagePreview';\nimport PreviewSkeleton from './PreviewSkeleton';\n\ntype ReaderOnloadCallback = (url: FileReader['result']) => void;\n\nconst readFileAsDataURL = (file: File, callback: ReaderOnloadCallback): void => {\n\tconst reader = new FileReader();\n\treader.onload = (e): void => callback(e?.target?.result || null);\n\n\treturn reader.readAsDataURL(file);\n};\n\nconst useFileAsDataURL = (file: File): [loaded: boolean, url: null | FileReader['result']] => {\n\tconst [loaded, setLoaded] = useState(false);\n\tconst [url, setUrl] = useState<FileReader['result']>(null);\n\n\tuseEffect(() => {\n\t\tsetLoaded(false);\n\t\treadFileAsDataURL(file, (url) => {\n\t\t\tsetUrl(url);\n\t\t\tsetLoaded(true);\n\t\t});\n\t}, [file]);\n\treturn [loaded, url];\n};\n\ntype MediaPreviewProps = {\n\tfile: File;\n\tfileType: FilePreviewType;\n};\n\nconst MediaPreview = ({ file, fileType }: MediaPreviewProps): ReactElement => {\n\tconst [loaded, url] = useFileAsDataURL(file);\n\tconst t = useTranslation();\n\n\tif (!loaded) {\n\t\treturn <PreviewSkeleton />;\n\t}\n\n\tif (typeof url !== 'string') {\n\t\treturn (\n\t\t\t<Box display='flex' alignItems='center' w='full'>\n\t\t\t\t<Icon name='image' size='x24' mie={4} />\n\t\t\t\t{t('FileUpload_Cannot_preview_file')}\n\t\t\t</Box>\n\t\t);\n\t}\n\n\tif (fileType === FilePreviewType.IMAGE) {\n\t\treturn <ImagePreview url={url} file={file} />;\n\t}\n\n\tif (fileType === FilePreviewType.VIDEO) {\n\t\treturn (\n\t\t\t<Box is='video' w='full' controls>\n\t\t\t\t<source src={url} type={userAgentMIMETypeFallback(file.type)} />\n\t\t\t\t{t('Browser_does_not_support_video_element')}\n\t\t\t</Box>\n\t\t);\n\t}\n\n\tif (fileType === FilePreviewType.AUDIO) {\n\t\treturn <AudioPlayer src={url} />;\n\t}\n\n\tthrow new Error('Wrong props provided for MediaPreview');\n};\n\nexport default memo(MediaPreview);\n",null],"names":["module","link","default","_slicedToArray","AudioPlayer","v","Box","Icon","useTranslation","React","useEffect","useState","memo","userAgentMIMETypeFallback","FilePreviewType","ImagePreview","PreviewSkeleton","readFileAsDataURL","file","callback","reader","FileReader","onload","e","_e$target","target","result","readAsDataURL","useFileAsDataURL","_useState2","loaded","setLoaded","_useState4","url","setUrl","exportDefault","_ref","fileType","_useFileAsDataURL","_useFileAsDataURL2","t","createElement","display","alignItems","w","name","size","mie","IMAGE","VIDEO","is","controls","src","type","AUDIO","Error"],"mappings":"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"}