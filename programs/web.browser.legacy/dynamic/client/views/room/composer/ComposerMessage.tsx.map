)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/composer/ComposerMessage.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IMessage, ISubscription } from '@rocket.chat/core-typings';\nimport { useToastMessageDispatch } from '@rocket.chat/ui-contexts';\nimport type { ReactElement, ReactNode } from 'react';\nimport React, { memo, useCallback, useMemo } from 'react';\n\nimport { LegacyRoomManager } from '../../../../app/ui-utils/client';\nimport { useReactiveValue } from '../../../hooks/useReactiveValue';\nimport { useChat } from '../contexts/ChatContext';\nimport { useRoom } from '../contexts/RoomContext';\nimport ComposerSkeleton from './ComposerSkeleton';\nimport MessageBox from './messageBox/MessageBox';\n\nexport type ComposerMessageProps = {\n\ttmid?: IMessage['_id'];\n\tchildren?: ReactNode;\n\tsubscription?: ISubscription;\n\treadOnly?: boolean;\n\ttshow?: boolean;\n\tpreviewUrls?: string[];\n\tonResize?: () => void;\n\tonEscape?: () => void;\n\tonSend?: () => void;\n\tonNavigateToNextMessage?: () => void;\n\tonNavigateToPreviousMessage?: () => void;\n\tonUploadFiles?: (files: readonly File[]) => void;\n};\n\nconst ComposerMessage = ({ tmid, readOnly, onSend, ...props }: ComposerMessageProps): ReactElement => {\n\tconst chat = useChat();\n\tconst room = useRoom();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst composerProps = useMemo(\n\t\t() => ({\n\t\t\tonJoin: async (): Promise<void> => {\n\t\t\t\ttry {\n\t\t\t\t\tawait chat?.data?.joinRoom();\n\t\t\t\t} catch (error) {\n\t\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t\t\tthrow error;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tonSend: async ({ value: text, tshow, previewUrls }: { value: string; tshow?: boolean; previewUrls?: string[] }): Promise<void> => {\n\t\t\t\ttry {\n\t\t\t\t\tawait chat?.action.stop('typing');\n\t\t\t\t\tconst newMessageSent = await chat?.flows.sendMessage({\n\t\t\t\t\t\ttext,\n\t\t\t\t\t\ttshow,\n\t\t\t\t\t\tpreviewUrls,\n\t\t\t\t\t});\n\t\t\t\t\tif (newMessageSent) onSend?.();\n\t\t\t\t} catch (error) {\n\t\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t\t}\n\t\t\t},\n\t\t\tonTyping: async (): Promise<void> => {\n\t\t\t\tif (chat?.composer?.text?.trim() === '') {\n\t\t\t\t\tawait chat?.action.stop('typing');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tawait chat?.action.start('typing');\n\t\t\t},\n\t\t\tonNavigateToPreviousMessage: () => chat?.messageEditing.toPreviousMessage(),\n\t\t\tonNavigateToNextMessage: () => chat?.messageEditing.toNextMessage(),\n\t\t\tonUploadFiles: (files: readonly File[]) => {\n\t\t\t\treturn chat?.flows.uploadFiles(files);\n\t\t\t},\n\t\t}),\n\t\t[chat?.data, chat?.flows, chat?.action, chat?.composer?.text, chat?.messageEditing, dispatchToastMessage, onSend],\n\t);\n\n\tconst publicationReady = useReactiveValue(\n\t\tuseCallback(() => LegacyRoomManager.getOpenedRoomByRid(room._id)?.streamActive ?? false, [room._id]),\n\t);\n\n\tif (!publicationReady) {\n\t\treturn <ComposerSkeleton />;\n\t}\n\n\treturn <MessageBox readOnly={readOnly ?? false} key={room._id} tmid={tmid} {...composerProps} showFormattingTips={true} {...props} />;\n};\n\nexport default memo(ComposerMessage);\n",null],"names":["_regeneratorRuntime","_extends","_objectWithoutProperties","useToastMessageDispatch","React","memo","useCallback","useMemo","LegacyRoomManager","useReactiveValue","useChat","useRoom","ComposerSkeleton","MessageBox","module","default","v","link","exportDefault","_ref","_chat$composer2","tmid","readOnly","onSend","props","_excluded","chat","room","dispatchToastMessage","composerProps","onJoin","_chat$data","async","_context","prev","next","awrap","data","joinRoom","t0","type","message","stop","Promise","_ref2","text","tshow","previewUrls","_context2","value","action","flows","sendMessage","sent","onTyping","_chat$composer","_chat$composer$text","_context3","composer","trim","abrupt","start","onNavigateToPreviousMessage","messageEditing","toPreviousMessage","onNavigateToNextMessage","toNextMessage","onUploadFiles","files","uploadFiles","_LegacyRoomManager$ge","_LegacyRoomManager$ge2","getOpenedRoomByRid","_id","streamActive","createElement","key","showFormattingTips"],"mappings":"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"}