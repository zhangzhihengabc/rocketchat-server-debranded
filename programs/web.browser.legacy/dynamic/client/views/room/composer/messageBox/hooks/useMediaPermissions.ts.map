)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/composer/messageBox/hooks/useMediaPermissions.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useEffect, useState } from 'react';\n\ntype MediaDevices = 'camera' | 'microphone';\n\nconst getDeviceKind = (name: MediaDevices): MediaDeviceKind => {\n\tswitch (name) {\n\t\tcase 'camera':\n\t\t\treturn 'videoinput';\n\t\tcase 'microphone':\n\t\t\treturn 'audioinput';\n\t}\n};\n\nexport const useMediaPermissions = (name: MediaDevices): [isPermissionDenied: boolean, setIsPermissionDenied: (state: boolean) => void] => {\n\tconst [isPermissionDenied, setIsPermissionDenied] = useState(false);\n\n\tconst handleMount = useMutableCallback(async (): Promise<void> => {\n\t\tif (navigator.permissions) {\n\t\t\ttry {\n\t\t\t\tconst permissionStatus = await navigator.permissions.query({ name: name as PermissionName });\n\t\t\t\tsetIsPermissionDenied(permissionStatus.state === 'denied');\n\t\t\t\tpermissionStatus.onchange = (): void => {\n\t\t\t\t\tsetIsPermissionDenied(permissionStatus.state === 'denied');\n\t\t\t\t};\n\t\t\t\treturn;\n\t\t\t} catch (error) {\n\t\t\t\tconsole.warn(error);\n\t\t\t}\n\t\t}\n\n\t\tif (!navigator.mediaDevices?.enumerateDevices) {\n\t\t\tsetIsPermissionDenied(true);\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tif (!(await navigator.mediaDevices.enumerateDevices()).some(({ kind }) => kind === getDeviceKind(name))) {\n\t\t\t\tsetIsPermissionDenied(true);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.warn(error);\n\t\t}\n\t});\n\n\tuseEffect(() => {\n\t\thandleMount();\n\t}, [handleMount]);\n\n\treturn [isPermissionDenied, setIsPermissionDenied];\n};\n",null],"names":["module","link","default","_regeneratorRuntime","_slicedToArray","export","useMediaPermissions","useMutableCallback","useEffect","useState","getDeviceKind","name","_useState2","isPermissionDenied","setIsPermissionDenied","handleMount","_navigator$mediaDevic","permissionStatus","async","_context","prev","next","navigator","permissions","awrap","query","sent","state","onchange","abrupt","t0","console","warn","mediaDevices","enumerateDevices","some","_ref","kind","t1","stop","Promise"],"mappings":"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"}