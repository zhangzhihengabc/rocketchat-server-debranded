)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/UserCard/UserCardWithData.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IRoom } from '@rocket.chat/core-typings';\nimport { PositionAnimated, AnimatedVisibility } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useSetting, useRolesDescription, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement, UIEvent } from 'react';\nimport React, { useMemo, useRef } from 'react';\n\nimport { getUserDisplayName } from '../../../../lib/getUserDisplayName';\nimport { Backdrop } from '../../../components/Backdrop';\nimport GenericMenu from '../../../components/GenericMenu/GenericMenu';\nimport LocalTime from '../../../components/LocalTime';\nimport UserCard from '../../../components/UserCard';\nimport { ReactiveUserStatus } from '../../../components/UserStatus';\nimport { useUserInfoQuery } from '../../../hooks/useUserInfoQuery';\nimport { useUserInfoActions } from '../hooks/useUserInfoActions';\n\ntype UserCardWithDataProps = {\n\tusername: string;\n\ttarget: Element;\n\trid: IRoom['_id'];\n\topen: (e: UIEvent) => void;\n\tonClose: () => void;\n};\n\nconst UserCardWithData = ({ username, target, rid, open, onClose }: UserCardWithDataProps): ReactElement => {\n\tconst t = useTranslation();\n\tconst ref = useRef(target);\n\tconst getRoles = useRolesDescription();\n\tconst showRealNames = Boolean(useSetting('UI_Use_Real_Name'));\n\n\tconst { data, isLoading } = useUserInfoQuery({ username });\n\n\tref.current = target;\n\n\tconst user = useMemo(() => {\n\t\tconst defaultValue = isLoading ? undefined : null;\n\n\t\tconst {\n\t\t\t_id,\n\t\t\tname,\n\t\t\troles = defaultValue,\n\t\t\tstatusText = defaultValue,\n\t\t\tbio = defaultValue,\n\t\t\tutcOffset = defaultValue,\n\t\t\tnickname,\n\t\t\tavatarETag,\n\t\t} = data?.user || {};\n\n\t\treturn {\n\t\t\t_id,\n\t\t\tname: getUserDisplayName(name, username, showRealNames),\n\t\t\tusername,\n\t\t\troles: roles && getRoles(roles).map((role, index) => <UserCard.Role key={index}>{role}</UserCard.Role>),\n\t\t\tbio,\n\t\t\tetag: avatarETag,\n\t\t\tlocalTime: utcOffset && Number.isInteger(utcOffset) && <LocalTime utcOffset={utcOffset} />,\n\t\t\tstatus: _id && <ReactiveUserStatus uid={_id} />,\n\t\t\tcustomStatus: statusText,\n\t\t\tnickname,\n\t\t};\n\t}, [data, username, showRealNames, isLoading, getRoles]);\n\n\tconst handleOpen = useMutableCallback((e: UIEvent) => {\n\t\topen?.(e);\n\t\tonClose?.();\n\t});\n\n\tconst { actions: actionsDefinition, menuActions: menuOptions } = useUserInfoActions(\n\t\t{ _id: user._id ?? '', username: user.username, name: user.name },\n\t\trid,\n\t);\n\n\tconst menu = useMemo(() => {\n\t\tif (!menuOptions?.length) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn <GenericMenu title={t('More')} key='menu' data-qa-id='menu' sections={menuOptions} placement='bottom-start' />;\n\t}, [menuOptions, t]);\n\n\tconst actions = useMemo(() => {\n\t\tconst mapAction = ([key, { content, icon, onClick }]: any): ReactElement => (\n\t\t\t<UserCard.Action key={key} label={content} aria-label={content} onClick={onClick} icon={icon} />\n\t\t);\n\n\t\treturn [...actionsDefinition.map(mapAction), menu].filter(Boolean);\n\t}, [actionsDefinition, menu]);\n\n\treturn (\n\t\t<>\n\t\t\t<Backdrop bg='transparent' onClick={onClose} />\n\t\t\t<PositionAnimated anchor={ref} placement='top-start' margin={8} visible={AnimatedVisibility.UNHIDING}>\n\t\t\t\t<UserCard {...user} onClose={onClose} open={handleOpen} actions={actions} isLoading={isLoading} />\n\t\t\t</PositionAnimated>\n\t\t</>\n\t);\n};\n\nexport default UserCardWithData;\n",null],"names":["_extends","_toConsumableArray","_slicedToArray","PositionAnimated","AnimatedVisibility","useMutableCallback","useSetting","useRolesDescription","useTranslation","React","useMemo","useRef","getUserDisplayName","Backdrop","GenericMenu","LocalTime","UserCard","ReactiveUserStatus","useUserInfoQuery","useUserInfoActions","module","default","v","link","exportDefault","_ref","_user$_id","username","target","rid","open","onClose","t","ref","getRoles","showRealNames","Boolean","_useUserInfoQuery","data","isLoading","current","user","defaultValue","undefined","_ref2","_id","name","_ref2$roles","roles","_ref2$statusText","statusText","_ref2$bio","bio","_ref2$utcOffset","utcOffset","nickname","avatarETag","map","role","index","createElement","Role","key","etag","localTime","Number","isInteger","status","uid","customStatus","handleOpen","e","_useUserInfoActions","actionsDefinition","actions","menuOptions","menuActions","menu","length","title","sections","placement","concat","_ref3","_ref4","_ref4$","content","icon","onClick","Action","label","filter","Fragment","bg","anchor","margin","visible","UNHIDING"],"mappings":"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"}