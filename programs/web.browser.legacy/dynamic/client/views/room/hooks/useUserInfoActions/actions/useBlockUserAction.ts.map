)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/hooks/useUserInfoActions/actions/useBlockUserAction.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IRoom, IUser } from '@rocket.chat/core-typings';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation, useMethod, useToastMessageDispatch, useUserId, useUserSubscription, useUserRoom } from '@rocket.chat/ui-contexts';\nimport { useMemo } from 'react';\n\nimport { getRoomDirectives } from '../../../lib/getRoomDirectives';\nimport type { UserInfoAction } from '../useUserInfoActions';\n\nexport const useBlockUserAction = (user: Pick<IUser, '_id' | 'username'>, rid: IRoom['_id']): UserInfoAction | undefined => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst currentSubscription = useUserSubscription(rid);\n\tconst ownUserId = useUserId();\n\tconst { _id: uid } = user;\n\tconst room = useUserRoom(rid);\n\n\tif (!room) {\n\t\tthrow Error('Room not provided');\n\t}\n\n\tconst { roomCanBlock } = getRoomDirectives({ room, showingUserId: uid, userSubscription: currentSubscription });\n\n\tconst isUserBlocked = currentSubscription?.blocker;\n\tconst toggleBlock = useMethod(isUserBlocked ? 'unblockUser' : 'blockUser');\n\n\tconst toggleBlockUserAction = useMutableCallback(async () => {\n\t\ttry {\n\t\t\tawait toggleBlock({ rid, blocked: uid });\n\t\t\tdispatchToastMessage({\n\t\t\t\ttype: 'success',\n\t\t\t\tmessage: t(isUserBlocked ? 'User_is_unblocked' : 'User_is_blocked'),\n\t\t\t});\n\t\t} catch (error: unknown) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst toggleBlockUserOption = useMemo(\n\t\t() =>\n\t\t\troomCanBlock && uid !== ownUserId\n\t\t\t\t? {\n\t\t\t\t\t\tcontent: t(isUserBlocked ? 'Unblock' : 'Block'),\n\t\t\t\t\t\ticon: 'ban' as const,\n\t\t\t\t\t\tonClick: toggleBlockUserAction,\n\t\t\t\t  }\n\t\t\t\t: undefined,\n\t\t[isUserBlocked, ownUserId, roomCanBlock, t, toggleBlockUserAction, uid],\n\t);\n\n\treturn toggleBlockUserOption;\n};\n",null],"names":["module","link","default","_regeneratorRuntime","export","useBlockUserAction","useMutableCallback","useTranslation","useMethod","useToastMessageDispatch","useUserId","useUserSubscription","useUserRoom","useMemo","getRoomDirectives","user","rid","t","dispatchToastMessage","currentSubscription","ownUserId","uid","_id","room","Error","roomCanBlock","_getRoomDirectives","showingUserId","userSubscription","isUserBlocked","blocker","toggleBlock","toggleBlockUserAction","async","_context","prev","next","awrap","blocked","type","message","t0","stop","Promise","content","icon","onClick","undefined"],"mappings":"uBACSA,EAAoBC,IAAM,CAAA,6BAA8B,CAAAC,QAAAA,SAAAA,CAAAA,EAAAC,EAAAA,CAAA,CAAA,EAAA,GAAjEH,EAAOI,MAAE,CAAA,CAAAC,mBAAoB,WAAM,OAAAA,CAA8B,CAAA,GAAAL,EAAAA,IAAAA,CAAAA,8BAAAA,CAAAM,mBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAN,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAO,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,UAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,wBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,UAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,oBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAZ,EAAAA,IAAAA,CAAAA,QAAAA,CAAAa,QAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAb,EAAAA,IAAAA,CAAAA,iCAAAA,CAAAc,kBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAO1D,IAPPX,EAAiEG,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAOpDT,EAAqB,SAACU,CAAqC,CAAEC,CAAiB,EAC1F,IAAMC,EAAIV,IACJW,EAAuBT,IACvBU,EAAsBR,EAAoBK,GAC1CI,EAAYV,IACLW,EAAQN,EAAbO,GAAG,CACLC,EAAOX,EAAYI,GAEzB,GAAI,CAACO,EACJ,MAAMC,MAAM,qBAGb,IAAQC,EAAYC,AAAKZ,EAAkB,CAAES,KAAAA,EAAMI,cAAeN,EAAKO,iBAAkBT,CAAmB,GAApGM,YAAY,CAEdI,EAAgBV,MAAAA,EAAmB,KAAA,EAAnBA,EAAqBW,OAAO,CAC5CC,EAAcvB,EAAUqB,EAAgB,cAAgB,aAExDG,EAAwB1B,EAAmB,WAAA,OAAAH,EAAA8B,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAAA,OAAAF,EAAAC,IAAA,CAAA,EAAAD,EAAAE,IAAA,CAAA,EAAAjC,EAAAkC,KAAA,CAEzCN,EAAY,CAAEf,IAAAA,EAAKsB,QAASjB,CAAG,GAAG,MAAA,EACxCH,EAAqB,CACpBqB,KAAM,UACNC,QAASvB,EAAEY,EAAgB,oBAAsB,qBAC/CK,EAAAE,IAAA,CAAA,EAAA,KAAA,MAAA,EAAAF,EAAAC,IAAA,CAAA,EAAAD,EAAAO,EAAA,CAAAP,EAAA,KAAA,CAAA,GAEHhB,EAAqB,CAAEqB,KAAM,QAASC,QAAON,EAAAO,EAAA,AAAO,EAAI,MAAA,EAAA,IAAA,MAAA,OAAAP,EAAAQ,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAAC,QAAA,GAgB1D,OAZ8B9B,EAC7B,WAAA,OACCY,GAAgBJ,IAAQD,EACrB,CACAwB,QAAS3B,EAAEY,EAAgB,UAAY,SACvCgB,KAAM,MACNC,QAASd,GAETe,KAAAA,CAAS,EACb,CAAClB,EAAeT,EAAWK,EAAcR,EAAGe,EAAuBX,EAAI,CAIzE"}