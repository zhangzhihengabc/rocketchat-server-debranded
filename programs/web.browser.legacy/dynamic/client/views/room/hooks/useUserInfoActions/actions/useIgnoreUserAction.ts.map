)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/hooks/useUserInfoActions/actions/useIgnoreUserAction.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IRoom, IUser } from '@rocket.chat/core-typings';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport {\n\tuseTranslation,\n\tuseUserSubscription,\n\tuseUserRoom,\n\tuseUserId,\n\tuseToastMessageDispatch,\n\tuseEndpoint,\n} from '@rocket.chat/ui-contexts';\nimport { useMemo } from 'react';\n\nimport { getRoomDirectives } from '../../../lib/getRoomDirectives';\nimport type { UserInfoAction, UserInfoActionType } from '../useUserInfoActions';\n\nexport const useIgnoreUserAction = (user: Pick<IUser, '_id' | 'username'>, rid: IRoom['_id']): UserInfoAction | undefined => {\n\tconst t = useTranslation();\n\tconst room = useUserRoom(rid);\n\tconst { _id: uid } = user;\n\tconst ownUserId = useUserId();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst currentSubscription = useUserSubscription(rid);\n\tconst ignoreUser = useEndpoint('GET', '/v1/chat.ignoreUser');\n\n\tconst isIgnored = currentSubscription?.ignored && currentSubscription.ignored.indexOf(uid) > -1;\n\n\tif (!room) {\n\t\tthrow Error('Room not provided');\n\t}\n\n\tconst { roomCanIgnore } = getRoomDirectives({ room, showingUserId: uid, userSubscription: currentSubscription });\n\n\tconst ignoreUserAction = useMutableCallback(async () => {\n\t\ttry {\n\t\t\tawait ignoreUser({ rid, userId: uid, ignore: String(!isIgnored) });\n\t\t\tif (isIgnored) {\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('User_has_been_unignored') });\n\t\t\t} else {\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('User_has_been_ignored') });\n\t\t\t}\n\t\t} catch (error: unknown) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst ignoreUserOption = useMemo(\n\t\t() =>\n\t\t\troomCanIgnore && uid !== ownUserId\n\t\t\t\t? {\n\t\t\t\t\t\tcontent: t(isIgnored ? 'Unignore' : 'Ignore'),\n\t\t\t\t\t\ticon: 'ban' as const,\n\t\t\t\t\t\tonClick: ignoreUserAction,\n\t\t\t\t\t\ttype: 'management' as UserInfoActionType,\n\t\t\t\t  }\n\t\t\t\t: undefined,\n\t\t[ignoreUserAction, isIgnored, ownUserId, roomCanIgnore, t, uid],\n\t);\n\n\treturn ignoreUserOption;\n};\n",null],"names":["module","link","default","_regeneratorRuntime","export","useIgnoreUserAction","useMutableCallback","useTranslation","useUserSubscription","useUserRoom","useUserId","useToastMessageDispatch","useEndpoint","useMemo","getRoomDirectives","user","rid","t","room","uid","_id","ownUserId","dispatchToastMessage","currentSubscription","ignoreUser","isIgnored","ignored","indexOf","Error","roomCanIgnore","_getRoomDirectives","showingUserId","userSubscription","ignoreUserAction","async","_context","prev","next","awrap","userId","ignore","String","type","message","t0","stop","Promise","content","icon","onClick","undefined"],"mappings":"uBACSA,EAAoBC,IAAM,CAAA,6BAA8B,CAAAC,QAAAA,SAAAA,CAAAA,EAAAC,EAAAA,CAAA,CAAA,EAAA,GAAjEH,EAAOI,MAAE,CAAA,CAAAC,oBAA0B,WAAA,OAAAA,CAA8B,CAAA,GAAAL,EAAAA,IAAAA,CAAAA,8BAAAA,CAAAM,mBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAN,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAO,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,oBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,UAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,wBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAZ,EAAAA,IAAAA,CAAAA,QAAAA,CAAAa,QAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAb,EAAAA,IAAAA,CAAAA,iCAAAA,CAAAc,kBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAc1D,IAdPX,EAAiEG,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAcpDT,EAAsB,SAACU,CAAqC,CAAEC,CAAiB,EAC3F,IAAMC,EAAIV,IACJW,EAAOT,EAAYO,GACZG,EAAQJ,EAAbK,GAAG,CACLC,EAAYX,IACZY,EAAuBX,IACvBY,EAAsBf,EAAoBQ,GAC1CQ,EAAaZ,EAAY,MAAO,uBAEhCa,EAAY,AAAAF,CAAAA,MAAAA,EAAmB,KAAA,EAAnBA,EAAqBG,OAAO,AAAPA,GAAWH,EAAoBG,OAAO,CAACC,OAAO,CAACR,GAAO,GAE7F,GAAI,CAACD,EACJ,MAAMU,MAAM,qBAGb,IAAQC,EAAaC,AAAKhB,EAAkB,CAAEI,KAAAA,EAAMa,cAAeZ,EAAKa,iBAAkBT,CAAmB,GAArGM,aAAa,CAEfI,EAAmB3B,EAAmB,WAAA,OAAAH,EAAA+B,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAAA,OAAAF,EAAAC,IAAA,CAAA,EAAAD,EAAAE,IAAA,CAAA,EAAAlC,EAAAmC,KAAA,CAEpCd,EAAW,CAAER,IAAAA,EAAKuB,OAAQpB,EAAKqB,OAAQC,OAAO,CAAChB,EAAU,GAAG,MAAA,EAC9DA,EACHH,EAAqB,CAAEoB,KAAM,UAAWC,QAAS1B,EAAE,0BAA0B,GAE7EK,EAAqB,CAAEoB,KAAM,UAAWC,QAAS1B,EAAE,wBAAwB,GAC3EkB,EAAAE,IAAA,CAAA,EAAA,KAAA,MAAA,EAAAF,EAAAC,IAAA,CAAA,EAAAD,EAAAS,EAAA,CAAAT,EAAA,KAAA,CAAA,GAEDb,EAAqB,CAAEoB,KAAM,QAASC,QAAOR,EAAAS,EAAA,AAAO,EAAI,MAAA,EAAA,IAAA,MAAA,OAAAT,EAAAU,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAAC,QAAA,GAiB1D,OAbyBjC,EACxB,WAAA,OACCgB,GAAiBV,IAAQE,EACtB,CACA0B,QAAS9B,EAAEQ,EAAY,WAAa,UACpCuB,KAAM,MACNC,QAAShB,EACTS,KAAM,cAENQ,KAAAA,CAAS,EACb,CAACjB,EAAkBR,EAAWJ,EAAWQ,EAAeZ,EAAGE,EAAI,CAIjE"}