)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/hooks/useUserInfoActions/actions/useChangeLeaderAction.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IRoom, IUser } from '@rocket.chat/core-typings';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation, usePermission, useUserRoom, useUserSubscription } from '@rocket.chat/ui-contexts';\nimport { useMemo } from 'react';\n\nimport { useEndpointAction } from '../../../../../hooks/useEndpointAction';\nimport { getRoomDirectives } from '../../../lib/getRoomDirectives';\nimport { useUserHasRoomRole } from '../../useUserHasRoomRole';\nimport type { UserInfoAction, UserInfoActionType } from '../useUserInfoActions';\n\n// TODO: Remove endpoint concatenation\nexport const useChangeLeaderAction = (user: Pick<IUser, '_id' | 'username'>, rid: IRoom['_id']): UserInfoAction | undefined => {\n\tconst t = useTranslation();\n\tconst room = useUserRoom(rid);\n\tconst { _id: uid } = user;\n\tconst userCanSetLeader = usePermission('set-leader', rid);\n\tconst userSubscription = useUserSubscription(rid);\n\n\tif (!room) {\n\t\tthrow Error('Room not provided');\n\t}\n\n\tconst endpointPrefix = room.t === 'p' ? '/v1/groups' : '/v1/channels';\n\tconst { roomCanSetLeader } = getRoomDirectives({ room, showingUserId: uid, userSubscription });\n\tconst isLeader = useUserHasRoomRole(uid, rid, 'leader');\n\n\tconst changeLeaderEndpoint = isLeader ? 'removeLeader' : 'addLeader';\n\tconst changeLeaderMessage = isLeader ? 'removed__username__as__role_' : 'set__username__as__role_';\n\tconst changeLeader = useEndpointAction('POST', `${endpointPrefix}.${changeLeaderEndpoint}`, {\n\t\tsuccessMessage: t(changeLeaderMessage, { username: user.username, role: 'leader' }),\n\t});\n\tconst changeLeaderAction = useMutableCallback(() => changeLeader({ roomId: rid, userId: uid }));\n\tconst changeLeaderOption = useMemo(\n\t\t() =>\n\t\t\troomCanSetLeader && userCanSetLeader\n\t\t\t\t? {\n\t\t\t\t\t\tcontent: t(isLeader ? 'Remove_as_leader' : 'Set_as_leader'),\n\t\t\t\t\t\ticon: 'shield-alt' as const,\n\t\t\t\t\t\tonClick: changeLeaderAction,\n\t\t\t\t\t\ttype: 'privileges' as UserInfoActionType,\n\t\t\t\t  }\n\t\t\t\t: undefined,\n\t\t[isLeader, roomCanSetLeader, t, userCanSetLeader, changeLeaderAction],\n\t);\n\n\treturn changeLeaderOption;\n};\n",null],"names":["module","export","useChangeLeaderAction","useMutableCallback","useTranslation","usePermission","useUserRoom","useUserSubscription","useMemo","useEndpointAction","getRoomDirectives","useUserHasRoomRole","user","rid","t","room","uid","_id","userCanSetLeader","userSubscription","Error","endpointPrefix","roomCanSetLeader","_getRoomDirectives","showingUserId","isLeader","changeLeader","successMessage","username","role","changeLeaderAction","roomId","userId","content","icon","onClick","type","undefined"],"mappings":"uBACAA,EAAOC,MAAE,CAAA,CAAAC,sBAA0B,WAAA,OAAAA,CAA8B,CAAA,GAAAF,EAAAA,IAAAA,CAAAA,8BAAAA,CAAAG,mBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAH,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAI,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,cAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,oBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAP,EAAAA,IAAAA,CAAAA,QAAAA,CAAAQ,QAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAR,EAAAA,IAAAA,CAAAA,yCAAAA,CAAAS,kBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAT,EAAAA,IAAAA,CAAAA,iCAAAA,CAAAU,kBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAV,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAW,mBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAU1D,IAV0DR,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAUpDT,EAAwB,SAACU,CAAqC,CAAEC,CAAiB,EAC7F,IAAMC,EAAIV,IACJW,EAAOT,EAAYO,GACZG,EAAQJ,EAAbK,GAAG,CACLC,EAAmBb,EAAc,aAAcQ,GAC/CM,EAAmBZ,EAAoBM,GAE7C,GAAI,CAACE,EACJ,MAAMK,MAAM,qBAGb,IAAMC,EAAiBN,AAAW,MAAXA,EAAKD,CAAC,CAAW,aAAe,eAC/CQ,EAAgBC,AAAKb,EAAkB,CAAEK,KAAAA,EAAMS,cAAeR,EAAKG,iBAAAA,CAAgB,GAAnFG,gBAAgB,CAClBG,EAAWd,EAAmBK,EAAKH,EAAK,UAIxCa,EAAejB,EAAkB,OAAWY,EAAc,IAFnCI,CAAAA,EAAW,eAAiB,WAAA,EAEmC,CAC3FE,eAAgBb,EAFWW,EAAW,+BAAiC,2BAEhC,CAAEG,SAAUhB,EAAKgB,QAAQ,CAAEC,KAAM,QAAQ,KAE3EC,EAAqB3B,EAAmB,WAAA,OAAMuB,EAAa,CAAEK,OAAQlB,EAAKmB,OAAQhB,CAAG,EAAG,GAc9F,OAb2BR,EAC1B,WAAA,OACCc,GAAoBJ,EACjB,CACAe,QAASnB,EAAEW,EAAW,mBAAqB,iBAC3CS,KAAM,aACNC,QAASL,EACTM,KAAM,cAENC,KAAAA,CAAS,EACb,CAACZ,EAAUH,EAAkBR,EAAGI,EAAkBY,EAAmB,CAIvE"}