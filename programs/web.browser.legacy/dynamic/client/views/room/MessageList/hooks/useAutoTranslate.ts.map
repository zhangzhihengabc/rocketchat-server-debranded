)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/MessageList/hooks/useAutoTranslate.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IMessage, ISubscription, ITranslatedMessage } from '@rocket.chat/core-typings';\nimport { useSetting } from '@rocket.chat/ui-contexts';\nimport { useCallback, useMemo } from 'react';\n\nimport { AutoTranslate } from '../../../../../app/autotranslate/client';\nimport { roomCoordinator } from '../../../../lib/rooms/roomCoordinator';\nimport { hasTranslationLanguageInAttachments, hasTranslationLanguageInMessage } from '../lib/autoTranslate';\nimport { isOwnUserMessage } from '../lib/isOwnUserMessage';\n\nexport type AutoTranslateOptions = {\n\tautoTranslateEnabled: boolean;\n\tautoTranslateLanguage?: string;\n\tshowAutoTranslate: (message: IMessage & Partial<ITranslatedMessage>) => boolean;\n};\n\nexport const useAutoTranslate = (subscription?: ISubscription): AutoTranslateOptions => {\n\tconst autoTranslateSettingEnabled = Boolean(useSetting('AutoTranslate_Enabled'));\n\tconst isSubscriptionEnabled = autoTranslateSettingEnabled && subscription?.autoTranslateLanguage && subscription?.autoTranslate;\n\tconst isLivechatRoom = useMemo(() => subscription && roomCoordinator.isLivechatRoom(subscription?.t), [subscription]);\n\tconst autoTranslateEnabled = Boolean(isSubscriptionEnabled || isLivechatRoom);\n\tconst autoTranslateLanguage = autoTranslateEnabled && subscription ? AutoTranslate.getLanguage(subscription.rid) : undefined;\n\n\tconst showAutoTranslate = useCallback(\n\t\t(message: IMessage): boolean => {\n\t\t\tif (!autoTranslateEnabled || !autoTranslateLanguage) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn (\n\t\t\t\t!isOwnUserMessage(message, subscription) &&\n\t\t\t\t!(message as { autoTranslateShowInverse?: boolean }).autoTranslateShowInverse &&\n\t\t\t\t(hasTranslationLanguageInMessage(message, autoTranslateLanguage) ||\n\t\t\t\t\thasTranslationLanguageInAttachments(message.attachments, autoTranslateLanguage))\n\t\t\t);\n\t\t},\n\t\t[subscription, autoTranslateEnabled, autoTranslateLanguage],\n\t);\n\n\treturn useMemo(() => {\n\t\treturn { autoTranslateEnabled, autoTranslateLanguage, showAutoTranslate };\n\t}, [autoTranslateEnabled, autoTranslateLanguage, showAutoTranslate]);\n};\n",null],"names":["module","export","useAutoTranslate","useSetting","useCallback","useMemo","AutoTranslate","roomCoordinator","hasTranslationLanguageInAttachments","hasTranslationLanguageInMessage","isOwnUserMessage","subscription","isSubscriptionEnabled","autoTranslateSettingEnabled","Boolean","autoTranslateLanguage","autoTranslate","isLivechatRoom","t","autoTranslateEnabled","getLanguage","rid","undefined","showAutoTranslate","message","autoTranslateShowInverse","attachments"],"mappings":"uBACAA,EAAOC,MAAE,CAAA,CAAAC,iBAAkB,WAAA,OAAAA,CAA2B,CAAA,GAAAF,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAG,WAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAH,EAAAA,IAAAA,CAAAA,QAAAA,CAAAI,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,QAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAL,EAAAA,IAAAA,CAAAA,0CAAAA,CAAAM,cAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAN,EAAAA,IAAAA,CAAAA,wCAAAA,CAAAO,gBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAP,EAAAA,IAAAA,CAAAA,uBAAAA,CAAAQ,oCAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,gCAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAT,EAAAA,IAAAA,CAAAA,0BAAAA,CAAAU,iBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAc/C,IAd+CP,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAczCR,EAAmB,SAACS,CAA4B,EAE5D,IAAMC,EAAwBC,AADMC,CAAAA,CAAQX,EAAW,0BACMQ,CAAAA,MAAAA,EAAY,KAAA,EAAZA,EAAcI,qBAAqB,AAArBA,GAAyBJ,CAAAA,MAAAA,EAAY,KAAA,EAAZA,EAAcK,aAAa,AAAbA,EAC5GC,EAAiBZ,EAAQ,WAAA,OAAMM,GAAgBJ,EAAgBU,cAAc,CAACN,MAAAA,EAAY,KAAA,EAAZA,EAAcO,CAAC,CAAC,EAAE,CAACP,EAAa,EAC9GQ,EAAuBL,CAAAA,CAAQF,CAAAA,GAAyBK,CAAAA,EACxDF,EAAwBI,GAAwBR,EAAeL,EAAcc,WAAW,CAACT,EAAaU,GAAG,EAAIC,KAAAA,EAE7GC,EAAoBnB,EACzB,SAACoB,CAAiB,QACjB,EAAKL,KAAyBJ,GAK7B,CAACL,EAAiBc,EAASb,IAC3B,CAAEa,EAAmDC,wBAAwB,EAC5EhB,CAAAA,EAAgCe,EAAST,IACzCP,EAAoCgB,EAAQE,WAAW,CAAEX,EAAqB,CAEjF,EACA,CAACJ,EAAcQ,EAAsBJ,EAAsB,EAG5D,OAAOV,EAAQ,WACd,MAAO,CAAEc,qBAAAA,EAAsBJ,sBAAAA,EAAuBQ,kBAAAA,CAAiB,CACxE,EAAG,CAACJ,EAAsBJ,EAAuBQ,EAAkB,CACpE"}