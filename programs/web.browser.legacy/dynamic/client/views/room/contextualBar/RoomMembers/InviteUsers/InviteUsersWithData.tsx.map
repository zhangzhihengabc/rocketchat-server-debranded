)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/RoomMembers/InviteUsers/InviteUsersWithData.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IRoom } from '@rocket.chat/core-typings';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useEndpoint, useTranslation, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useState, useEffect } from 'react';\n\nimport { useFormatDateAndTime } from '../../../../../hooks/useFormatDateAndTime';\nimport { useRoomToolbox } from '../../../contexts/RoomToolboxContext';\nimport InviteUsers from './InviteUsers';\n\ntype InviteUsersWithDataProps = {\n\trid: IRoom['_id'];\n\tonClickBack: () => void;\n};\n\nconst InviteUsersWithData = ({ rid, onClickBack }: InviteUsersWithDataProps): ReactElement => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst [\n\t\t{\n\t\t\tisEditing,\n\t\t\turl,\n\t\t\tcaption,\n\t\t\terror,\n\t\t\tdaysAndMaxUses: { days, maxUses },\n\t\t},\n\t\tsetInviteState,\n\t] = useState({\n\t\tisEditing: false,\n\t\tdaysAndMaxUses: { days: '1', maxUses: '0' },\n\t\turl: '',\n\t\tcaption: '',\n\t\terror: undefined as Error | undefined,\n\t});\n\n\tconst { closeTab } = useRoomToolbox();\n\tconst format = useFormatDateAndTime();\n\tconst findOrCreateInvite = useEndpoint('POST', '/v1/findOrCreateInvite');\n\n\tconst handleEdit = useMutableCallback(() => setInviteState((prevState) => ({ ...prevState, isEditing: true })));\n\tconst handleBackToLink = useMutableCallback(() => setInviteState((prevState) => ({ ...prevState, isEditing: false })));\n\n\tconst linkExpirationText = useMutableCallback((data) => {\n\t\tif (!data) {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (data.expires) {\n\t\t\tconst expiration = new Date(data.expires);\n\t\t\tif (data.maxUses) {\n\t\t\t\tconst usesLeft = data.maxUses - data.uses;\n\t\t\t\treturn t('Your_invite_link_will_expire_on__date__or_after__usesLeft__uses', {\n\t\t\t\t\tdate: format(expiration),\n\t\t\t\t\tusesLeft,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn t('Your_invite_link_will_expire_on__date__', { date: format(expiration) });\n\t\t}\n\n\t\tif (data.maxUses) {\n\t\t\tconst usesLeft = data.maxUses - data.uses;\n\t\t\treturn t('Your_invite_link_will_expire_after__usesLeft__uses', { usesLeft });\n\t\t}\n\n\t\treturn t('Your_invite_link_will_never_expire');\n\t});\n\n\tuseEffect(() => {\n\t\t(async (): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tconst data = await findOrCreateInvite({ rid, days: Number(days), maxUses: Number(maxUses) });\n\t\t\t\tsetInviteState((prevState) => ({ ...prevState, url: data?.url, caption: linkExpirationText(data) }));\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Invite_link_generated') });\n\t\t\t} catch (error) {\n\t\t\t\tsetInviteState((prevState) => ({ ...prevState, error: error as Error }));\n\t\t\t}\n\t\t})();\n\t}, [dispatchToastMessage, t, findOrCreateInvite, linkExpirationText, rid, days, maxUses]);\n\n\tconst handleGenerateLink = useMutableCallback((daysAndMaxUses) => {\n\t\tsetInviteState((prevState) => ({ ...prevState, daysAndMaxUses, isEditing: false }));\n\t});\n\n\treturn (\n\t\t<InviteUsers\n\t\t\tisEditing={isEditing}\n\t\t\terror={error}\n\t\t\tlinkText={url}\n\t\t\tcaptionText={caption}\n\t\t\tdaysAndMaxUses={{ days, maxUses }}\n\t\t\tonClose={closeTab}\n\t\t\tonClickBackMembers={onClickBack}\n\t\t\tonClickBackLink={handleBackToLink}\n\t\t\tonClickEdit={handleEdit}\n\t\t\tonClickNewLink={handleGenerateLink}\n\t\t/>\n\t);\n};\n\nexport default InviteUsersWithData;\n",null],"names":["_regeneratorRuntime","_objectSpread","_slicedToArray","useMutableCallback","useEndpoint","useTranslation","useToastMessageDispatch","React","useState","useEffect","useFormatDateAndTime","useRoomToolbox","InviteUsers","module","link","default","v","exportDefault","_ref","rid","onClickBack","t","dispatchToastMessage","_useState2","isEditing","daysAndMaxUses","days","maxUses","url","caption","error","undefined","_useState2$","_useState2$$daysAndMa","setInviteState","closeTab","_useRoomToolbox","format","findOrCreateInvite","handleEdit","prevState","handleBackToLink","linkExpirationText","data","expires","expiration","Date","usesLeft","uses","date","async","_context","prev","next","awrap","Number","sent","type","message","t0","stop","Promise","handleGenerateLink","createElement","linkText","captionText","onClose","onClickBackMembers","onClickBackLink","onClickEdit","onClickNewLink"],"mappings":"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"}