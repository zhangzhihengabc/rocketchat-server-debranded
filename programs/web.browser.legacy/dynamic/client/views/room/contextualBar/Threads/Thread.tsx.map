)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/Threads/Thread.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IMessage } from '@rocket.chat/core-typings';\nimport { css } from '@rocket.chat/css-in-js';\nimport { Box, Modal, Skeleton } from '@rocket.chat/fuselage';\nimport { useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport { useLayoutContextualBarExpanded, useToastMessageDispatch, useTranslation, useUserId } from '@rocket.chat/ui-contexts';\nimport type { VFC } from 'react';\nimport React from 'react';\n\nimport {\n\tContextualbar,\n\tContextualbarHeader,\n\tContextualbarAction,\n\tContextualbarActions,\n\tContextualbarClose,\n\tContextualbarBack,\n\tContextualbarInnerContent,\n} from '../../../../components/Contextualbar';\nimport { useRoomToolbox } from '../../contexts/RoomToolboxContext';\nimport { useGoToThreadList } from '../../hooks/useGoToThreadList';\nimport ChatProvider from '../../providers/ChatProvider';\nimport ThreadChat from './components/ThreadChat';\nimport ThreadSkeleton from './components/ThreadSkeleton';\nimport ThreadTitle from './components/ThreadTitle';\nimport { useThreadMainMessageQuery } from './hooks/useThreadMainMessageQuery';\nimport { useToggleFollowingThreadMutation } from './hooks/useToggleFollowingThreadMutation';\n\ntype ThreadProps = {\n\ttmid: IMessage['_id'];\n};\n\nconst Thread: VFC<ThreadProps> = ({ tmid }) => {\n\tconst goToThreadList = useGoToThreadList({ replace: true });\n\tconst { closeTab } = useRoomToolbox();\n\n\tconst mainMessageQueryResult = useThreadMainMessageQuery(tmid, {\n\t\tonDelete: () => {\n\t\t\tcloseTab();\n\t\t},\n\t});\n\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst canExpand = useLayoutContextualBarExpanded();\n\tconst [expanded, setExpanded] = useLocalStorage('expand-threads', false);\n\n\tconst uid = useUserId();\n\tconst following = uid ? mainMessageQueryResult.data?.replies?.includes(uid) ?? false : false;\n\tconst toggleFollowingMutation = useToggleFollowingThreadMutation({\n\t\tonError: (error) => {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t},\n\t});\n\n\tconst handleBackdropClick = () => {\n\t\tcloseTab();\n\t};\n\n\tconst handleGoBack = () => {\n\t\tgoToThreadList();\n\t};\n\n\tconst handleToggleExpand = () => {\n\t\tsetExpanded((expanded) => !expanded);\n\t};\n\n\tconst handleToggleFollowing = () => {\n\t\tconst rid = mainMessageQueryResult.data?.rid;\n\n\t\tif (!rid) {\n\t\t\treturn;\n\t\t}\n\n\t\ttoggleFollowingMutation.mutate({ rid, tmid, follow: !following });\n\t};\n\n\tconst handleClose = () => {\n\t\tcloseTab();\n\t};\n\n\treturn (\n\t\t<ContextualbarInnerContent>\n\t\t\t{canExpand && expanded && <Modal.Backdrop onClick={handleBackdropClick} />}\n\t\t\t<Box flexGrow={1} position={expanded ? 'static' : 'relative'}>\n\t\t\t\t<Contextualbar\n\t\t\t\t\trcx-thread-view\n\t\t\t\t\tclassName={\n\t\t\t\t\t\tcanExpand && expanded\n\t\t\t\t\t\t\t? css`\n\t\t\t\t\t\t\t\t\tmax-width: 855px !important;\n\t\t\t\t\t\t\t\t\t@media (min-width: 780px) and (max-width: 1135px) {\n\t\t\t\t\t\t\t\t\t\tmax-width: calc(100% - var(--sidebar-width)) !important;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t  `\n\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t}\n\t\t\t\t\tposition={expanded ? 'fixed' : 'absolute'}\n\t\t\t\t\tdisplay='flex'\n\t\t\t\t\tflexDirection='column'\n\t\t\t\t\twidth='full'\n\t\t\t\t\toverflow='hidden'\n\t\t\t\t\tzIndex={100}\n\t\t\t\t\tinsetBlock={0}\n\t\t\t\t\tborder='none'\n\t\t\t\t>\n\t\t\t\t\t<ContextualbarHeader expanded={expanded}>\n\t\t\t\t\t\t<ContextualbarBack onClick={handleGoBack} />\n\t\t\t\t\t\t{(mainMessageQueryResult.isLoading && <Skeleton width='100%' />) ||\n\t\t\t\t\t\t\t(mainMessageQueryResult.isSuccess && <ThreadTitle mainMessage={mainMessageQueryResult.data} />) ||\n\t\t\t\t\t\t\tnull}\n\t\t\t\t\t\t<ContextualbarActions>\n\t\t\t\t\t\t\t{canExpand && (\n\t\t\t\t\t\t\t\t<ContextualbarAction\n\t\t\t\t\t\t\t\t\tname={expanded ? 'arrow-collapse' : 'arrow-expand'}\n\t\t\t\t\t\t\t\t\ttitle={expanded ? t('Collapse') : t('Expand')}\n\t\t\t\t\t\t\t\t\tonClick={handleToggleExpand}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<ContextualbarAction\n\t\t\t\t\t\t\t\tname={following ? 'bell' : 'bell-off'}\n\t\t\t\t\t\t\t\ttitle={following ? t('Following') : t('Not_Following')}\n\t\t\t\t\t\t\t\tdisabled={!mainMessageQueryResult.isSuccess || toggleFollowingMutation.isLoading}\n\t\t\t\t\t\t\t\tonClick={handleToggleFollowing}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<ContextualbarClose onClick={handleClose} />\n\t\t\t\t\t\t</ContextualbarActions>\n\t\t\t\t\t</ContextualbarHeader>\n\n\t\t\t\t\t{(mainMessageQueryResult.isLoading && <ThreadSkeleton />) ||\n\t\t\t\t\t\t(mainMessageQueryResult.isSuccess && (\n\t\t\t\t\t\t\t<ChatProvider tmid={tmid}>\n\t\t\t\t\t\t\t\t<ThreadChat mainMessage={mainMessageQueryResult.data} />\n\t\t\t\t\t\t\t</ChatProvider>\n\t\t\t\t\t\t)) ||\n\t\t\t\t\t\tnull}\n\t\t\t\t</Contextualbar>\n\t\t\t</Box>\n\t\t</ContextualbarInnerContent>\n\t);\n};\n\nexport default Thread;\n",null],"names":["_taggedTemplateLiteralLoose","_slicedToArray","css","Box","Modal","Skeleton","useLocalStorage","useLayoutContextualBarExpanded","useToastMessageDispatch","useTranslation","useUserId","React","Contextualbar","ContextualbarHeader","ContextualbarAction","ContextualbarActions","ContextualbarClose","ContextualbarBack","ContextualbarInnerContent","useRoomToolbox","useGoToThreadList","ChatProvider","ThreadChat","ThreadSkeleton","ThreadTitle","useThreadMainMessageQuery","useToggleFollowingThreadMutation","module","default","link","v","exportDefault","_ref","_mainMessageQueryResu","_mainMessageQueryResu2","_mainMessageQueryResu3","tmid","goToThreadList","replace","closeTab","_useRoomToolbox","mainMessageQueryResult","onDelete","t","dispatchToastMessage","canExpand","_useLocalStorage2","expanded","setExpanded","uid","following","data","replies","includes","toggleFollowingMutation","onError","error","type","message","createElement","Backdrop","onClick","flexGrow","position","className","_templateObject","undefined","display","flexDirection","width","overflow","zIndex","insetBlock","border","isLoading","isSuccess","mainMessage","name","title","disabled","_mainMessageQueryResu4","rid","mutate","follow"],"mappings":"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"}