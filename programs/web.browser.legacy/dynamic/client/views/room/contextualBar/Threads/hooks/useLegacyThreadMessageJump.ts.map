)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/Threads/hooks/useLegacyThreadMessageJump.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useRouter, useSearchParameter } from '@rocket.chat/ui-contexts';\nimport { useRef, useEffect } from 'react';\n\nimport { waitForElement } from '../../../../../lib/utils/waitForElement';\nimport { clearHighlightMessage, setHighlightMessage } from '../../../MessageList/providers/messageHighlightSubscription';\n\nexport const useLegacyThreadMessageJump = ({ enabled = true }: { enabled?: boolean }) => {\n\tconst router = useRouter();\n\tconst mid = useSearchParameter('msg');\n\n\tconst clearQueryStringParameter = () => {\n\t\tconst name = router.getRouteName();\n\n\t\tif (!name) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { msg: _, ...search } = router.getSearchParameters();\n\n\t\trouter.navigate(\n\t\t\t{\n\t\t\t\tname,\n\t\t\t\tparams: router.getRouteParameters(),\n\t\t\t\tsearch,\n\t\t\t},\n\t\t\t{ replace: true },\n\t\t);\n\t};\n\n\tconst parentRef = useRef<HTMLElement>(null);\n\tconst clearQueryStringParameterRef = useRef(clearQueryStringParameter);\n\tclearQueryStringParameterRef.current = clearQueryStringParameter;\n\n\tuseEffect(() => {\n\t\tconst parent = parentRef.current;\n\n\t\tif (!enabled || !mid || !parent) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst abortController = new AbortController();\n\n\t\twaitForElement<HTMLElement>(`[data-id='${mid}']`, { parent, signal: abortController.signal }).then((messageElement) => {\n\t\t\tif (abortController.signal.aborted) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsetHighlightMessage(mid);\n\t\t\tclearQueryStringParameterRef.current?.();\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tclearHighlightMessage();\n\t\t\t}, 1000);\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (abortController.signal.aborted) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tmessageElement.scrollIntoView({\n\t\t\t\t\tbehavior: 'smooth',\n\t\t\t\t\tblock: 'nearest',\n\t\t\t\t});\n\t\t\t}, 300);\n\t\t});\n\n\t\treturn () => {\n\t\t\tabortController.abort();\n\t\t};\n\t}, [enabled, mid]);\n\n\treturn { parentRef };\n};\n",null],"names":["_objectWithoutProperties","useRouter","useSearchParameter","useRef","useEffect","waitForElement","clearHighlightMessage","setHighlightMessage","module","default","export","useLegacyThreadMessageJump","_ref","_ref$enabled","enabled","router","mid","clearQueryStringParameter","name","getRouteName","_router$getSearchPara","getSearchParameters","search","msg","_excluded","navigate","params","getRouteParameters","replace","parentRef","clearQueryStringParameterRef","current","parent","abortController","AbortController","signal","then","messageElement","_clearQueryStringPara","aborted","call","setTimeout","scrollIntoView","behavior","block","abort"],"mappings":"2BAAAA,EAAyEC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,YAArDC,EAAAA,IAAoB,CAAA,iDAAiC,CAAAC,QAAAA,SAAAA,CAAAA,EAAAT,EAAAA,CAAA,CAAA,EAAA,GAAzEQ,EAAOE,MAAE,CAAA,CAAAC,2BAA+B,WAAM,OAAAA,CAA2B,CAAA,GAAAH,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAP,UAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,mBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,QAAAA,CAAAL,OAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,UAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,0CAAAA,CAAAH,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,8DAAAA,CAAAF,sBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,oBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAMlE,IAAMI,EAA6B,SAAAC,CAAA,EAA8C,IAAAC,EAAAD,EAA3CE,OAAO,CAAPA,EAAOD,AAAA,KAAA,IAAAA,GAAOA,EACpDE,EAASd,IACTe,EAAMd,EAAmB,OAEzBe,EAA4B,WACjC,IAAMC,EAAOH,EAAOI,YAAY,GAEhC,GAAKD,GAIL,IAAAE,EAA8BL,EAAOM,mBAAmB,GAArCC,GAALF,EAANG,GAAG,CAAcvB,EAAAoB,EAAAI,IAEzBT,EAAOU,QAAQ,CACd,CACCP,KAAAA,EACAQ,OAAQX,EAAOY,kBAAkB,GACjCL,OAAAA,GAED,CAAEM,QAAS,CAAA,CAAI,GAEjB,EAEMC,EAAY1B,EAAoB,MAChC2B,EAA+B3B,EAAOc,GAyC5C,OAxCAa,EAA6BC,OAAO,CAAGd,EAEvCb,EAAU,WACT,IAAM4B,EAASH,EAAUE,OAAO,CAEhC,GAAI,AAACjB,GAAYE,GAAQgB,GAIzB,IAAMC,EAAkB,IAAIC,gBA0B5B,OAxBA7B,EAAc,aAA2BW,EAAG,KAAM,CAAEgB,OAAAA,EAAQG,OAAQF,EAAgBE,MAAAA,AAAM,GAAIC,IAAI,CAAC,SAACC,CAAc,EAAI,IAAAC,CACjHL,CAAAA,EAAgBE,MAAM,CAACI,OAAO,GAIlChC,EAAoBS,GACpB,AAAoC,OAApCsB,CAAAA,EAAAR,EAA6BC,OAAO,AAAPA,GAAOO,AAAA,KAAA,IAAAA,GAApCA,EAAAE,IAAA,CAAAV,GAEAW,WAAW,WACVnC,GACD,EAAG,KAEHmC,WAAW,WACNR,EAAgBE,MAAM,CAACI,OAAO,EAIlCF,EAAeK,cAAc,CAAC,CAC7BC,SAAU,SACVC,MAAO,WAET,EAAG,KACJ,GAEO,WACNX,EAAgBY,KAAK,EACtB,EACD,EAAG,CAAC/B,EAASE,EAAI,EAEV,CAAEa,UAAAA,CAAS,CACnB"}