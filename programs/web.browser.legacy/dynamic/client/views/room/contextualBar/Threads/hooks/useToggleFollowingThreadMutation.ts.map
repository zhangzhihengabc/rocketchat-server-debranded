)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/Threads/hooks/useToggleFollowingThreadMutation.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IMessage } from '@rocket.chat/core-typings';\nimport { useEndpoint } from '@rocket.chat/ui-contexts';\nimport type { UseMutationOptions, UseMutationResult } from '@tanstack/react-query';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\n\n// TODO: its core should be moved to the ChatContext\n\ntype UseToggleFollowingThreadMutationVariables = {\n\trid: IMessage['rid'];\n\ttmid: IMessage['_id'];\n\tfollow: boolean;\n};\n\nexport const useToggleFollowingThreadMutation = (\n\toptions?: Omit<UseMutationOptions<void, Error, UseToggleFollowingThreadMutationVariables>, 'mutationFn'>,\n): UseMutationResult<void, Error, UseToggleFollowingThreadMutationVariables> => {\n\tconst followMessage = useEndpoint('POST', '/v1/chat.followMessage');\n\tconst unfollowMessage = useEndpoint('POST', '/v1/chat.unfollowMessage');\n\n\tconst queryClient = useQueryClient();\n\n\treturn useMutation(\n\t\tasync ({ tmid, follow }) => {\n\t\t\tif (follow) {\n\t\t\t\tawait followMessage({ mid: tmid });\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait unfollowMessage({ mid: tmid });\n\t\t},\n\t\t{\n\t\t\t...options,\n\t\t\tonSuccess: async (data, variables, context) => {\n\t\t\t\tawait queryClient.invalidateQueries(['rooms', variables.rid, 'threads']);\n\t\t\t\treturn options?.onSuccess?.(data, variables, context);\n\t\t\t},\n\t\t},\n\t);\n};\n",null],"names":["module","link","default","_objectSpread","_regeneratorRuntime","export","useToggleFollowingThreadMutation","useEndpoint","useMutation","useQueryClient","options","followMessage","unfollowMessage","queryClient","_ref","tmid","async","_context","prev","next","follow","awrap","mid","abrupt","stop","Promise","onSuccess","data","variables","context","_options$onSuccess","_context2","invalidateQueries","rid","call"],"mappings":"uBACSA,EAAaC,IAAM,CAAA,uCAA2B,CAAAC,QAAAA,SAAAA,CAAAA,EAAAC,EAAAA,CAAA,CAAA,EAAA,GAAAH,EAAAA,IAAAA,CAAAA,6BAAAA,CAAAE,QAAAA,SAAAA,CAAAA,EAAAE,EAAAA,CAAA,CAAA,EAAA,GAAvDJ,EAAOK,MAAE,CAAA,CAAAC,iCAAmB,WAA2B,OAAAA,CAAA,CAAA,GAAAN,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAO,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAP,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAQ,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAYhD,IAZPN,EAAuDC,EAAAG,EAAAC,EAAAC,EAY1CH,EAAmC,SAC/CI,CAAwG,EAExG,IAAMC,EAAgBJ,EAAY,OAAQ,0BACpCK,EAAkBL,EAAY,OAAQ,4BAEtCM,EAAcJ,IAEpB,OAAOD,EACN,SAAAM,CAAA,EAAA,IAAAC,EAAA,OAAAX,EAAAY,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAAqB,GAAZJ,EAAID,EAAJC,IAAI,CAAQ,CAAAD,EAANM,MAAM,CACV,CAAAH,EAAAE,IAAA,CAAA,EAAA,KAAA,CAAA,OAAAF,EAAAE,IAAA,CAAA,EAAAf,EAAAiB,KAAA,CACHV,EAAc,CAAEW,IAAKP,CAAI,GAAG,MAAA,EAAA,OAAAE,EAAAM,MAAA,CAAA,SAAA,MAAA,EAAA,OAAAN,EAAAE,IAAA,CAAA,EAAAf,EAAAiB,KAAA,CAI7BT,EAAgB,CAAEU,IAAKP,CAAI,GAAG,MAAA,EAAA,IAAA,MAAA,OAAAE,EAAAO,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,EACpCtB,EAAAA,EAAA,CAAA,EAEGO,GAAO,CAAA,EAAA,CACVgB,UAAW,SAAOC,CAAI,CAAEC,CAAS,CAAEC,CAAO,EAAA,IAAAC,EAAA,OAAA1B,EAAAY,KAAA,CAAA,SAAAe,CAAA,EAAA,OAAA,OAAAA,EAAAb,IAAA,CAAAa,EAAAZ,IAAA,EAAA,KAAA,EAAA,OAAAY,EAAAZ,IAAA,CAAA,EAAAf,EAAAiB,KAAA,CACnCR,EAAYmB,iBAAiB,CAAC,CAAC,QAASJ,EAAUK,GAAG,CAAE,UAAU,EAAC,MAAA,EAAA,OAAAF,EAAAR,MAAA,CAAA,SACjEb,MAAAA,EAAO,KAAA,EAAA,AAAW,OAAXoB,CAAAA,EAAPpB,EAASgB,SAAS,AAATA,GAASI,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAlBA,EAAAI,IAAA,CAAAxB,EAAqBiB,EAAMC,EAAWC,GAAQ,MAAA,EAAA,IAAA,MAAA,OAAAE,EAAAP,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,CACrD,GAGJ"}