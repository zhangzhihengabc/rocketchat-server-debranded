)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/AutoTranslate/AutoTranslateWithData.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useLanguage } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useMemo, useEffect, useState, memo } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport { useEndpointAction } from '../../../../hooks/useEndpointAction';\nimport { useEndpointData } from '../../../../hooks/useEndpointData';\nimport { dispatchToastMessage } from '../../../../lib/toast';\nimport { useRoom, useRoomSubscription } from '../../contexts/RoomContext';\nimport { useRoomToolbox } from '../../contexts/RoomToolboxContext';\nimport AutoTranslate from './AutoTranslate';\n\nconst AutoTranslateWithData = (): ReactElement => {\n\tconst room = useRoom();\n\tconst subscription = useRoomSubscription();\n\tconst { closeTab } = useRoomToolbox();\n\tconst userLanguage = useLanguage();\n\tconst [currentLanguage, setCurrentLanguage] = useState(subscription?.autoTranslateLanguage ?? '');\n\tconst saveSettings = useEndpointAction('POST', '/v1/autotranslate.saveSettings');\n\tconst { t } = useTranslation();\n\n\tconst { value: translateData } = useEndpointData('/v1/autotranslate.getSupportedLanguages', {\n\t\tparams: useMemo(() => ({ targetLanguage: userLanguage }), [userLanguage]),\n\t});\n\tconst languagesDict = translateData ? Object.fromEntries(translateData.languages.map((lang) => [lang.language, lang.name])) : {};\n\n\tconst handleChangeLanguage = useMutableCallback((value) => {\n\t\tsetCurrentLanguage(value);\n\n\t\tsaveSettings({\n\t\t\troomId: room._id,\n\t\t\tfield: 'autoTranslateLanguage',\n\t\t\tvalue,\n\t\t});\n\t\tdispatchToastMessage({\n\t\t\ttype: 'success',\n\t\t\tmessage: t('AutoTranslate_language_set_to', { language: languagesDict[value] }),\n\t\t});\n\t});\n\n\tconst handleSwitch = useMutableCallback((event) => {\n\t\tsaveSettings({\n\t\t\troomId: room._id,\n\t\t\tfield: 'autoTranslate',\n\t\t\tvalue: event.target.checked,\n\t\t});\n\t\tdispatchToastMessage({\n\t\t\ttype: 'success',\n\t\t\tmessage: event.target.checked\n\t\t\t\t? t('AutoTranslate_Enabled_for_room', { roomName: room.name })\n\t\t\t\t: t('AutoTranslate_Disabled_for_room', { roomName: room.name }),\n\t\t});\n\t\tif (event.target.checked && currentLanguage) {\n\t\t\tdispatchToastMessage({\n\t\t\t\ttype: 'success',\n\t\t\t\tmessage: t('AutoTranslate_language_set_to', { language: languagesDict[currentLanguage] }),\n\t\t\t});\n\t\t}\n\t});\n\n\tuseEffect(() => {\n\t\tif (!subscription?.autoTranslate) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!subscription?.autoTranslateLanguage) {\n\t\t\thandleChangeLanguage(userLanguage);\n\t\t}\n\t}, [subscription?.autoTranslate, subscription?.autoTranslateLanguage, handleChangeLanguage, userLanguage]);\n\n\treturn (\n\t\t<AutoTranslate\n\t\t\tlanguage={currentLanguage}\n\t\t\tlanguages={translateData ? translateData.languages.map((language) => [language.language, language.name]) : []}\n\t\t\thandleSwitch={handleSwitch}\n\t\t\thandleChangeLanguage={handleChangeLanguage}\n\t\t\ttranslateEnable={!!subscription?.autoTranslate}\n\t\t\thandleClose={closeTab}\n\t\t/>\n\t);\n};\n\nexport default memo(AutoTranslateWithData);\n",null],"names":["_slicedToArray","useMutableCallback","useLanguage","React","useMemo","useEffect","useState","memo","useTranslation","useEndpointAction","useEndpointData","dispatchToastMessage","useRoom","useRoomSubscription","useRoomToolbox","AutoTranslate","module","default","link","v","exportDefault","_subscription$autoTra","room","subscription","closeTab","_useRoomToolbox","userLanguage","_useState2","autoTranslateLanguage","currentLanguage","setCurrentLanguage","saveSettings","t","_useTranslation","translateData","_useEndpointData","params","targetLanguage","value","languagesDict","Object","fromEntries","languages","map","lang","language","name","handleChangeLanguage","roomId","_id","field","type","message","handleSwitch","event","target","checked","roomName","autoTranslate","createElement","translateEnable","handleClose"],"mappings":"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"}