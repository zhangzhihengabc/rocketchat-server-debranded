)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/NotificationPreferences/NotificationPreferencesWithData.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { SelectOption } from '@rocket.chat/fuselage';\nimport { useTranslation, useCustomSound } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { memo } from 'react';\nimport { useForm, FormProvider } from 'react-hook-form';\n\nimport { useEndpointAction } from '../../../../hooks/useEndpointAction';\nimport { useRoom, useRoomSubscription } from '../../contexts/RoomContext';\nimport { useRoomToolbox } from '../../contexts/RoomToolboxContext';\nimport NotificationPreferences from './NotificationPreferences';\n\nexport type NotificationFormValues = {\n\tturnOn: boolean;\n\tmuteGroupMentions: boolean;\n\tshowCounter: boolean;\n\tshowMentions: boolean;\n\tdesktopAlert: string;\n\tdesktopSound: string;\n\tmobileAlert: string;\n\temailAlert: string;\n};\n\nconst NotificationPreferencesWithData = (): ReactElement => {\n\tconst t = useTranslation();\n\tconst room = useRoom();\n\tconst subscription = useRoomSubscription();\n\tconst { closeTab } = useRoomToolbox();\n\tconst customSound = useCustomSound();\n\n\tconst saveSettings = useEndpointAction('POST', '/v1/rooms.saveNotification', {\n\t\tsuccessMessage: t('Room_updated_successfully'),\n\t});\n\n\tconst customSoundAsset: SelectOption[] | undefined = customSound?.getList()?.map((value) => [value._id, value.name]);\n\n\tconst defaultOption: SelectOption[] = [\n\t\t['default', t('Default')],\n\t\t['all', t('All_messages')],\n\t\t['mentions', t('Mentions')],\n\t\t['nothing', t('Nothing')],\n\t];\n\n\tconst defaultSoundOption: SelectOption[] = [\n\t\t['none', t('None')],\n\t\t['default', t('Default')],\n\t];\n\n\tconst notificationOptions = {\n\t\talerts: defaultOption,\n\t\tsounds: customSoundAsset ? [...defaultSoundOption, ...customSoundAsset] : defaultSoundOption,\n\t};\n\n\tconst methods = useForm({\n\t\tdefaultValues: {\n\t\t\tturnOn: !subscription?.disableNotifications,\n\t\t\tmuteGroupMentions: !!subscription?.muteGroupMentions,\n\t\t\tshowCounter: !subscription?.hideUnreadStatus,\n\t\t\tshowMentions: !subscription?.hideMentionStatus,\n\t\t\tdesktopAlert: (subscription?.desktopPrefOrigin === 'subscription' && subscription.desktopNotifications) || 'default',\n\t\t\tdesktopSound: subscription?.audioNotificationValue || 'default',\n\t\t\tmobileAlert: (subscription?.mobilePrefOrigin === 'subscription' && subscription.mobilePushNotifications) || 'default',\n\t\t\temailAlert: (subscription?.emailPrefOrigin === 'subscription' && subscription.emailNotifications) || 'default',\n\t\t},\n\t});\n\n\tconst { desktopSound } = methods.watch();\n\n\tconst handlePlaySound = (): void => {\n\t\tcustomSound.play(desktopSound);\n\t};\n\n\tconst handleSave = methods.handleSubmit(\n\t\t({ turnOn, muteGroupMentions, showCounter, showMentions, desktopAlert, desktopSound, mobileAlert, emailAlert }) => {\n\t\t\tconst notifications = {\n\t\t\t\tdisableNotifications: turnOn ? '0' : '1',\n\t\t\t\tmuteGroupMentions: muteGroupMentions ? '1' : '0',\n\t\t\t\thideUnreadStatus: showCounter ? '0' : '1',\n\t\t\t\thideMentionStatus: showMentions ? '0' : '1',\n\t\t\t\tdesktopNotifications: desktopAlert,\n\t\t\t\taudioNotificationValue: desktopSound,\n\t\t\t\tmobilePushNotifications: mobileAlert,\n\t\t\t\temailNotifications: emailAlert,\n\t\t\t};\n\n\t\t\tsaveSettings({\n\t\t\t\troomId: room._id,\n\t\t\t\tnotifications,\n\t\t\t});\n\t\t},\n\t);\n\n\treturn (\n\t\t<FormProvider {...methods}>\n\t\t\t<NotificationPreferences\n\t\t\t\thandleClose={closeTab}\n\t\t\t\thandleSave={handleSave}\n\t\t\t\thandlePlaySound={handlePlaySound}\n\t\t\t\tnotificationOptions={notificationOptions}\n\t\t\t/>\n\t\t</FormProvider>\n\t);\n};\n\nexport default memo(NotificationPreferencesWithData);\n",null],"names":["_toConsumableArray","useTranslation","useCustomSound","React","memo","useForm","FormProvider","useEndpointAction","useRoom","useRoomSubscription","useRoomToolbox","NotificationPreferences","module","link","default","v","exportDefault","_customSound$getList","t","room","subscription","closeTab","_useRoomToolbox","customSound","saveSettings","successMessage","customSoundAsset","getList","map","value","_id","name","defaultOption","defaultSoundOption","notificationOptions","alerts","sounds","concat","methods","defaultValues","turnOn","disableNotifications","muteGroupMentions","showCounter","hideUnreadStatus","showMentions","hideMentionStatus","desktopAlert","desktopPrefOrigin","desktopNotifications","desktopSound","audioNotificationValue","mobileAlert","mobilePrefOrigin","mobilePushNotifications","emailAlert","emailPrefOrigin","emailNotifications","_methods$watch","watch","handleSave","handleSubmit","_ref","roomId","notifications","createElement","handleClose","handlePlaySound","play"],"mappings":"uBAsBA,IArBAA,EAAAC,EAASC,EAAiEC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAnDC,EAAEC,IAAA,CAAA,2CAAiD,CAAAC,QAAAA,SAAAA,CAAAA,EAAAd,EAAAA,CAAA,CAAA,EAAA,GAAjDY,EAAgBC,IAAAA,CAAAA,2BAAgC,CAACZ,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAU,EAAAA,IAAAA,CAAAA,QAAAA,CAAA,QAAA,SAAAG,CAAA,EAAAZ,EAAAA,CAAA,EAAAC,KAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAQ,EAAAA,IAAAA,CAAAA,kBAAAA,CAAAP,QAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,aAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,sCAAAA,CAAAL,kBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAK,EAAAA,IAAAA,CAAAA,6BAAAA,CAAAJ,QAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,oBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,oCAAAA,CAAAF,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,4BAAAA,CAAA,QAAA,SAAAG,CAAA,EAAAJ,EAAAA,CAAA,CAAA,EAAA,GAA1EC,EAAOI,aAAE,CAsGMZ,EAjFyB,WACvC,IAD0Da,EACpDC,EAAIjB,IACJkB,EAAOX,IACPY,EAAeX,IACbY,EAAQC,AAAKZ,IAAbW,QAAQ,CACVE,EAAcrB,IAEdsB,EAAejB,EAAkB,OAAQ,6BAA8B,CAC5EkB,eAAgBP,EAAE,+BAGbQ,EAA+CH,MAAAA,EAAW,KAAA,EAAA,AAAW,OAAXN,CAAAA,EAAXM,EAAaI,OAAO,EAAA,GAAEV,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAtBA,EAAwBW,GAAG,CAAC,SAACC,CAAK,EAAA,MAAK,CAACA,EAAMC,GAAG,CAAED,EAAME,IAAI,CAAC,GAE7GC,EAAgC,CACrC,CAAC,UAAWd,EAAE,WAAW,CACzB,CAAC,MAAOA,EAAE,gBAAgB,CAC1B,CAAC,WAAYA,EAAE,YAAY,CAC3B,CAAC,UAAWA,EAAE,WAAW,CACzB,CAEKe,EAAqC,CAC1C,CAAC,OAAQf,EAAE,QAAQ,CACnB,CAAC,UAAWA,EAAE,WAAW,CACzB,CAEKgB,EAAsB,CAC3BC,OAAQH,EACRI,OAAQV,EAAgB,EAAA,CAAAW,MAAA,CAAOJ,EAAkBjC,EAAK0B,IAAoBO,GAGrEK,EAAUjC,EAAQ,CACvBkC,cAAe,CACdC,OAAQ,CAACpB,CAAAA,MAAAA,GAAAA,EAAcqB,oBAAoB,AAApBA,EACvBC,kBAAmB,CAAC,CAACtB,CAAAA,MAAAA,GAAAA,EAAcsB,iBAAiB,AAAjBA,EACnCC,YAAa,CAACvB,CAAAA,MAAAA,GAAAA,EAAcwB,gBAAgB,AAAhBA,EAC5BC,aAAc,CAACzB,CAAAA,MAAAA,GAAAA,EAAc0B,iBAAiB,AAAjBA,EAC7BC,aAAe,AAAA3B,CAAAA,MAAAA,EAAY,KAAA,EAAZA,EAAc4B,iBAAiB,AAAjBA,IAAsB,gBAAkB5B,EAAa6B,oBAAoB,EAAK,UAC3GC,aAAc,AAAA9B,CAAAA,MAAAA,EAAY,KAAA,EAAZA,EAAc+B,sBAAsB,AAAtBA,GAA0B,UACtDC,YAAc,AAAAhC,CAAAA,MAAAA,EAAY,KAAA,EAAZA,EAAciC,gBAAgB,AAAhBA,IAAqB,gBAAkBjC,EAAakC,uBAAuB,EAAK,UAC5GC,WAAa,AAAAnC,CAAAA,MAAAA,EAAY,KAAA,EAAZA,EAAcoC,eAAe,AAAfA,IAAoB,gBAAkBpC,EAAaqC,kBAAkB,EAAK,aAI/FP,EAAYQ,AAAKpB,EAAQqB,KAAK,GAA9BT,YAAY,CAMdU,EAAatB,EAAQuB,YAAY,CACtC,SAAAC,CAAA,EAAkH,IAA/GtB,EAAMsB,EAANtB,MAAM,CAAEE,EAAiBoB,EAAjBpB,iBAAiB,CAAEC,EAAWmB,EAAXnB,WAAW,CAAEE,EAAYiB,EAAZjB,YAAY,CAAEE,EAAYe,EAAZf,YAAY,CAAEG,EAAYY,EAAZZ,YAAY,CAAEE,EAAWU,EAAXV,WAAW,CAAEG,EAAUO,EAAVP,UAAU,CAY3G/B,EAAa,CACZuC,OAAQ5C,EAAKW,GAAG,CAChBkC,cAbqB,CACrBvB,qBAAsBD,EAAS,IAAM,IACrCE,kBAAmBA,EAAoB,IAAM,IAC7CE,iBAAkBD,EAAc,IAAM,IACtCG,kBAAmBD,EAAe,IAAM,IACxCI,qBAAsBF,EACtBI,uBAAwBD,EACxBI,wBAAyBF,EACzBK,mBAAoBF,IAOtB,GAGD,OACCpD,EAAA8D,aAAA,CAAC3D,EAAiBgC,EACjBnC,EAAA8D,aAAA,CAACtD,EAAuB,CACvBuD,YAAa7C,EACbuC,WAAYA,EACZO,gBA7BqB,WACvB5C,EAAY6C,IAAI,CAAClB,EAClB,EA4BGhB,oBAAqBA,CAAoB,GAI7C"}