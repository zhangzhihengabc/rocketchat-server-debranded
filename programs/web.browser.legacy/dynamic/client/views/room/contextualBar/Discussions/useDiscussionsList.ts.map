)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/Discussions/useDiscussionsList.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IUser } from '@rocket.chat/core-typings';\nimport { useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useCallback, useMemo } from 'react';\n\nimport { useScrollableMessageList } from '../../../../hooks/lists/useScrollableMessageList';\nimport { useStreamUpdatesForMessageList } from '../../../../hooks/lists/useStreamUpdatesForMessageList';\nimport type { DiscussionsListOptions } from '../../../../lib/lists/DiscussionsList';\nimport { DiscussionsList } from '../../../../lib/lists/DiscussionsList';\nimport { getConfig } from '../../../../lib/utils/getConfig';\n\nexport const useDiscussionsList = (\n\toptions: DiscussionsListOptions,\n\tuid: IUser['_id'] | null,\n): {\n\tdiscussionsList: DiscussionsList;\n\tinitialItemCount: number;\n\tloadMoreItems: (start: number, end: number) => void;\n} => {\n\tif (!uid) {\n\t\tthrow new Error('User ID is undefined. Cannot load discussions list');\n\t}\n\n\tconst discussionsList = useMemo(() => new DiscussionsList(options), [options]);\n\n\tconst getDiscussions = useEndpoint('GET', '/v1/chat.getDiscussions');\n\n\tconst fetchMessages = useCallback(\n\t\tasync (start, end) => {\n\t\t\tconst { messages, total } = await getDiscussions({\n\t\t\t\troomId: options.rid,\n\t\t\t\ttext: options.text,\n\t\t\t\toffset: start,\n\t\t\t\tcount: end,\n\t\t\t});\n\n\t\t\treturn {\n\t\t\t\titems: messages,\n\t\t\t\titemCount: total,\n\t\t\t};\n\t\t},\n\t\t[getDiscussions, options.rid, options.text],\n\t);\n\n\tconst { loadMoreItems, initialItemCount } = useScrollableMessageList(\n\t\tdiscussionsList,\n\t\tfetchMessages,\n\t\tuseMemo(() => parseInt(`${getConfig('discussionListSize', 10)}`), []),\n\t);\n\tuseStreamUpdatesForMessageList(discussionsList, uid, options.rid);\n\n\treturn {\n\t\tdiscussionsList,\n\t\tloadMoreItems,\n\t\tinitialItemCount,\n\t};\n};\n",null],"names":["module","link","default","_regeneratorRuntime","export","useDiscussionsList","useEndpoint","useCallback","useMemo","useScrollableMessageList","useStreamUpdatesForMessageList","DiscussionsList","getConfig","options","uid","Error","discussionsList","getDiscussions","_useScrollableMessage","start","end","_await$getDiscussions","messages","total","async","_context","prev","next","awrap","roomId","rid","text","offset","count","sent","abrupt","items","itemCount","stop","Promise","parseInt","loadMoreItems","initialItemCount"],"mappings":"uBACsBA,EAAMC,IAAA,CAAA,6BAA2B,CAAAC,QAAAA,SAAAA,CAAAA,EAAAC,EAAAA,CAAA,CAAA,EAAA,GAAvDH,EAAOI,MAAE,CAAA,CAAAC,mBAAmB,WAAA,OAAAA,CAA2B,CAAA,GAAAL,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAM,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAN,EAAAA,IAAAA,CAAAA,QAAAA,CAAAO,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,QAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAR,EAAAA,IAAAA,CAAAA,mDAAAA,CAAAS,yBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAT,EAAAA,IAAAA,CAAAA,yDAAAA,CAAAU,+BAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAV,EAAAA,IAAAA,CAAAA,wCAAAA,CAAAW,gBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAX,EAAAA,IAAAA,CAAAA,kCAAAA,CAAAY,UAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAShD,IATPT,EAAuDG,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAS1CP,EAAqB,SACjCQ,CAA+B,CAC/BC,CAAwB,EAMxB,GAAI,CAACA,EACJ,MAAM,AAAIC,MAAM,sDAGjB,IAAMC,EAAkBR,EAAQ,WAAA,OAAM,IAAIG,EAAgBE,EAAQ,EAAE,CAACA,EAAQ,EAEvEI,EAAiBX,EAAY,MAAO,2BAmB1CY,EAA4CT,EAC3CO,EAlBqBT,EACrB,SAAOY,CAAK,CAAEC,CAAG,EAAA,IAAAC,EAAAC,EAAAC,EAAA,OAAApB,EAAAqB,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAAA,OAAAF,EAAAE,IAAA,CAAA,EAAAxB,EAAAyB,KAAA,CACkBX,EAAe,CAChDY,OAAQhB,EAAQiB,GAAG,CACnBC,KAAMlB,EAAQkB,IAAI,CAClBC,OAAQb,EACRc,MAAOb,IACN,MAAA,EALqB,OAAfE,EAAQD,AAKdA,CAAAA,EAAAI,EAAAS,IAAA,EALMZ,QAAQ,CAAEC,EAAKF,EAALE,KAAK,CAAAE,EAAAU,MAAA,CAAA,SAOhB,CACNC,MAAOd,EACPe,UAAWd,GACX,MAAA,EAAA,IAAA,MAAA,OAAAE,EAAAa,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,EAEF,CAACtB,EAAgBJ,EAAQiB,GAAG,CAAEjB,EAAQkB,IAAI,CAAC,EAM3CvB,EAAQ,WAAA,OAAMgC,SAAQ,GAAI5B,EAAU,qBAAsB,IAAM,EAAE,EAAE,GAH7D6B,EAAavB,EAAbuB,aAAa,CAAEC,EAAgBxB,EAAhBwB,gBAAgB,CAOvC,OAFAhC,EAA+BM,EAAiBF,EAAKD,EAAQiB,GAAG,EAEzD,CACNd,gBAAAA,EACAyB,cAAAA,EACAC,iBAAAA,EAEF"}