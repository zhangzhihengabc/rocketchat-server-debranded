)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/uikit/UiKitContextualBar.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { UiKit } from '@rocket.chat/core-typings';\nimport { Avatar, Box, Button, ButtonGroup, ContextualbarFooter, ContextualbarHeader, ContextualbarTitle } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport {\n\tUiKitComponent,\n\tUiKitContextualBar as UiKitContextualBarSurfaceRender,\n\tcontextualBarParser,\n\tUiKitContext,\n} from '@rocket.chat/fuselage-ui-kit';\nimport { BlockContext } from '@rocket.chat/ui-kit';\nimport type { FormEvent, UIEvent } from 'react';\nimport React, { memo } from 'react';\n\nimport { getURL } from '../../../../../app/utils/client';\nimport { ContextualbarClose, ContextualbarScrollableContent } from '../../../../components/Contextualbar';\nimport { preventSyntheticEvent } from '../../../../lib/utils/preventSyntheticEvent';\nimport { useContextualBarContextValue } from '../../../../uikit/hooks/useContextualBarContextValue';\nimport { useUiKitActionManager } from '../../../../uikit/hooks/useUiKitActionManager';\nimport { useUiKitView } from '../../../../uikit/hooks/useUiKitView';\nimport { getButtonStyle } from '../../../modal/uikit/getButtonStyle';\nimport { useRoomToolbox } from '../../contexts/RoomToolboxContext';\n\ntype UiKitContextualBarProps = {\n\tkey: UiKit.ContextualBarView['id']; // force re-mount when viewId changes\n\tinitialView: UiKit.ContextualBarView;\n};\n\nconst UiKitContextualBar = ({ initialView }: UiKitContextualBarProps): JSX.Element => {\n\tconst actionManager = useUiKitActionManager();\n\tconst { view, values, updateValues, state } = useUiKitView(initialView);\n\tconst contextValue = useContextualBarContextValue({ view, values, updateValues });\n\n\tconst { closeTab } = useRoomToolbox();\n\n\tconst handleSubmit = useMutableCallback((e: FormEvent) => {\n\t\tpreventSyntheticEvent(e);\n\t\tcloseTab();\n\t\tvoid actionManager\n\t\t\t.emitInteraction(view.appId, {\n\t\t\t\ttype: 'viewSubmit',\n\t\t\t\tpayload: {\n\t\t\t\t\tview: {\n\t\t\t\t\t\t...view,\n\t\t\t\t\t\tstate,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tviewId: view.id,\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tactionManager.disposeView(view.id);\n\t\t\t});\n\t});\n\n\tconst handleCancel = useMutableCallback((e: UIEvent) => {\n\t\tpreventSyntheticEvent(e);\n\t\tcloseTab();\n\t\tvoid actionManager\n\t\t\t.emitInteraction(view.appId, {\n\t\t\t\ttype: 'viewClosed',\n\t\t\t\tpayload: {\n\t\t\t\t\tviewId: view.id,\n\t\t\t\t\tview: {\n\t\t\t\t\t\t...view,\n\t\t\t\t\t\tstate,\n\t\t\t\t\t},\n\t\t\t\t\tisCleared: false,\n\t\t\t\t},\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tactionManager.disposeView(view.id);\n\t\t\t});\n\t});\n\n\tconst handleClose = useMutableCallback((e: UIEvent) => {\n\t\tpreventSyntheticEvent(e);\n\t\tcloseTab();\n\t\tvoid actionManager\n\t\t\t.emitInteraction(view.appId, {\n\t\t\t\ttype: 'viewClosed',\n\t\t\t\tpayload: {\n\t\t\t\t\tviewId: view.id,\n\t\t\t\t\tview: {\n\t\t\t\t\t\t...view,\n\t\t\t\t\t\tstate,\n\t\t\t\t\t},\n\t\t\t\t\tisCleared: true,\n\t\t\t\t},\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tactionManager.disposeView(view.id);\n\t\t\t});\n\t});\n\n\treturn (\n\t\t<UiKitContext.Provider value={contextValue}>\n\t\t\t<ContextualbarHeader>\n\t\t\t\t<Avatar url={getURL(`/api/apps/${view.appId}/icon`)} />\n\t\t\t\t<ContextualbarTitle>{contextualBarParser.text(view.title, BlockContext.NONE, 0)}</ContextualbarTitle>\n\t\t\t\t{handleClose && <ContextualbarClose onClick={handleClose} />}\n\t\t\t</ContextualbarHeader>\n\t\t\t<ContextualbarScrollableContent>\n\t\t\t\t<Box is='form' method='post' action='#' onSubmit={handleSubmit}>\n\t\t\t\t\t<UiKitComponent render={UiKitContextualBarSurfaceRender} blocks={view.blocks} />\n\t\t\t\t</Box>\n\t\t\t</ContextualbarScrollableContent>\n\t\t\t<ContextualbarFooter>\n\t\t\t\t<ButtonGroup stretch>\n\t\t\t\t\t{view.close && (\n\t\t\t\t\t\t<Button danger={view.close.style === 'danger'} onClick={handleCancel}>\n\t\t\t\t\t\t\t{contextualBarParser.text(view.close.text, BlockContext.NONE, 0)}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\n\t\t\t\t\t{view.submit && (\n\t\t\t\t\t\t<Button {...getButtonStyle(view.submit)} onClick={handleSubmit}>\n\t\t\t\t\t\t\t{contextualBarParser.text(view.submit.text, BlockContext.NONE, 1)}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t</ButtonGroup>\n\t\t\t</ContextualbarFooter>\n\t\t</UiKitContext.Provider>\n\t);\n};\n\nexport default memo(UiKitContextualBar);\n",null],"names":["_extends","_objectSpread","Avatar","Box","Button","ButtonGroup","ContextualbarFooter","ContextualbarHeader","ContextualbarTitle","useMutableCallback","UiKitComponent","UiKitContextualBarSurfaceRender","contextualBarParser","UiKitContext","BlockContext","React","memo","getURL","ContextualbarClose","ContextualbarScrollableContent","preventSyntheticEvent","useContextualBarContextValue","useUiKitActionManager","useUiKitView","getButtonStyle","useRoomToolbox","module","link","default","v","UiKitContextualBar","exportDefault","_ref","initialView","actionManager","_useUiKitView","view","values","updateValues","state","contextValue","closeTab","_useRoomToolbox","handleSubmit","e","emitInteraction","appId","type","payload","viewId","id","finally","disposeView","handleCancel","isCleared","handleClose","createElement","Provider","value","url","text","title","NONE","onClick","is","method","action","onSubmit","render","blocks","stretch","close","danger","style","submit"],"mappings":"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"}