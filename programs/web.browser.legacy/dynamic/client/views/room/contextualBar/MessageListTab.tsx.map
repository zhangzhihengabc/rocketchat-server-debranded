)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/MessageListTab.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IMessage } from '@rocket.chat/core-typings';\nimport { Box, MessageDivider, Throbber } from '@rocket.chat/fuselage';\nimport type { Keys as IconName } from '@rocket.chat/icons';\nimport { useUserPreference } from '@rocket.chat/ui-contexts';\nimport type { UseQueryResult } from '@tanstack/react-query';\nimport type { ReactElement, ReactNode } from 'react';\nimport React, { useCallback } from 'react';\nimport { Virtuoso } from 'react-virtuoso';\n\nimport { MessageTypes } from '../../../../app/ui-utils/client';\nimport type { MessageActionContext } from '../../../../app/ui-utils/client/lib/MessageAction';\nimport {\n\tContextualbarContent,\n\tContextualbarHeader,\n\tContextualbarIcon,\n\tContextualbarTitle,\n\tContextualbarClose,\n\tContextualbarEmptyContent,\n} from '../../../components/Contextualbar';\nimport ScrollableContentWrapper from '../../../components/ScrollableContentWrapper';\nimport RoomMessage from '../../../components/message/variants/RoomMessage';\nimport SystemMessage from '../../../components/message/variants/SystemMessage';\nimport { useFormatDate } from '../../../hooks/useFormatDate';\nimport MessageListErrorBoundary from '../MessageList/MessageListErrorBoundary';\nimport { isMessageNewDay } from '../MessageList/lib/isMessageNewDay';\nimport MessageListProvider from '../MessageList/providers/MessageListProvider';\nimport { useRoomSubscription } from '../contexts/RoomContext';\nimport { useRoomToolbox } from '../contexts/RoomToolboxContext';\n\ntype MessageListTabProps = {\n\ticonName: IconName;\n\ttitle: ReactNode;\n\temptyResultMessage: string;\n\tcontext: MessageActionContext;\n\tqueryResult: UseQueryResult<IMessage[]>;\n};\n\nconst MessageListTab = ({ iconName, title, emptyResultMessage, context, queryResult }: MessageListTabProps): ReactElement => {\n\tconst formatDate = useFormatDate();\n\tconst showUserAvatar = !!useUserPreference<boolean>('displayAvatars');\n\n\tconst { closeTab } = useRoomToolbox();\n\tconst handleTabBarCloseButtonClick = useCallback(() => {\n\t\tcloseTab();\n\t}, [closeTab]);\n\n\tconst subscription = useRoomSubscription();\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarHeader>\n\t\t\t\t<ContextualbarIcon name={iconName} />\n\t\t\t\t<ContextualbarTitle>{title}</ContextualbarTitle>\n\t\t\t\t<ContextualbarClose onClick={handleTabBarCloseButtonClick} />\n\t\t\t</ContextualbarHeader>\n\t\t\t<ContextualbarContent flexShrink={1} flexGrow={1} paddingInline={0}>\n\t\t\t\t{queryResult.isLoading && (\n\t\t\t\t\t<Box paddingInline={24} paddingBlock={12}>\n\t\t\t\t\t\t<Throbber size='x12' />\n\t\t\t\t\t</Box>\n\t\t\t\t)}\n\t\t\t\t{queryResult.isSuccess && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t{queryResult.data.length === 0 && <ContextualbarEmptyContent title={emptyResultMessage} />}\n\n\t\t\t\t\t\t{queryResult.data.length > 0 && (\n\t\t\t\t\t\t\t<MessageListErrorBoundary>\n\t\t\t\t\t\t\t\t<MessageListProvider>\n\t\t\t\t\t\t\t\t\t<Box is='section' display='flex' flexDirection='column' flexGrow={1} flexShrink={1} flexBasis='auto' height='full'>\n\t\t\t\t\t\t\t\t\t\t<Virtuoso\n\t\t\t\t\t\t\t\t\t\t\ttotalCount={queryResult.data.length}\n\t\t\t\t\t\t\t\t\t\t\toverscan={25}\n\t\t\t\t\t\t\t\t\t\t\tdata={queryResult.data}\n\t\t\t\t\t\t\t\t\t\t\tcomponents={{ Scroller: ScrollableContentWrapper }}\n\t\t\t\t\t\t\t\t\t\t\titemContent={(index, message) => {\n\t\t\t\t\t\t\t\t\t\t\t\tconst previous = queryResult.data[index - 1];\n\n\t\t\t\t\t\t\t\t\t\t\t\tconst newDay = isMessageNewDay(message, previous);\n\n\t\t\t\t\t\t\t\t\t\t\t\tconst system = MessageTypes.isSystemMessage(message);\n\n\t\t\t\t\t\t\t\t\t\t\t\tconst unread = subscription?.tunread?.includes(message._id) ?? false;\n\t\t\t\t\t\t\t\t\t\t\t\tconst mention = subscription?.tunreadUser?.includes(message._id) ?? false;\n\t\t\t\t\t\t\t\t\t\t\t\tconst all = subscription?.tunreadGroup?.includes(message._id) ?? false;\n\n\t\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{newDay && <MessageDivider>{formatDate(message.ts)}</MessageDivider>}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{system ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<SystemMessage message={message} showUserAvatar={showUserAvatar} />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<RoomMessage\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmessage={message}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsequential={false}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tunread={unread}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmention={mention}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tall={all}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontext={context}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowUserAvatar={showUserAvatar}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t</MessageListProvider>\n\t\t\t\t\t\t\t</MessageListErrorBoundary>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</ContextualbarContent>\n\t\t</>\n\t);\n};\n\nexport default MessageListTab;\n",null],"names":["Box","MessageDivider","Throbber","useUserPreference","React","useCallback","Virtuoso","MessageTypes","ContextualbarContent","ContextualbarHeader","ContextualbarIcon","ContextualbarTitle","ContextualbarClose","ContextualbarEmptyContent","ScrollableContentWrapper","RoomMessage","SystemMessage","useFormatDate","MessageListErrorBoundary","isMessageNewDay","MessageListProvider","useRoomSubscription","useRoomToolbox","module","link","v","exportDefault","_ref","iconName","title","emptyResultMessage","context","queryResult","formatDate","showUserAvatar","closeTab","_useRoomToolbox","handleTabBarCloseButtonClick","subscription","createElement","Fragment","name","onClick","flexShrink","flexGrow","paddingInline","isLoading","paddingBlock","size","isSuccess","data","length","is","display","flexDirection","flexBasis","height","totalCount","overscan","components","Scroller","itemContent","index","message","_subscription$tunread","_subscription$tunread2","_subscription$tunread3","_subscription$tunread4","_subscription$tunread5","_subscription$tunread6","newDay","system","isSystemMessage","unread","tunread","includes","_id","mention","tunreadUser","all","tunreadGroup","ts","sequential"],"mappings":"uBAqCA,IApCAA,EAAOC,EAAOC,EAAwDC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAxCC,EAAQC,IAAE,CAAA,wBAAM,CAAuBxB,IAAC,SAAAyB,CAAA,EAAAzB,EAAAA,CAAA,EAAAC,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,SAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAqB,EAAAA,IAAAA,CAAAA,2BAAAA,CAAApB,kBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAoB,EAAAA,IAAAA,CAAAA,QAAAA,CAAA,QAAA,SAAAE,CAAA,EAAArB,EAAAA,CAAA,EAAAC,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAkB,EAAAA,IAAAA,CAAAA,iBAAAA,CAAAjB,SAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAiB,EAAAA,IAAAA,CAAAA,kCAAAA,CAAAhB,aAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAgB,EAAAA,IAAAA,CAAAA,oCAAAA,CAAAf,qBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,oBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,kBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,mBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,mBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,0BAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAU,EAAAA,IAAAA,CAAAA,+CAAAA,CAAA,QAAA,SAAAE,CAAA,EAAAX,EAAAA,CAAA,CAAA,EAAA,GAAAS,EAAAA,IAAAA,CAAAA,mDAAAA,CAAA,QAAA,SAAAE,CAAA,EAAAV,EAAAA,CAAA,CAAA,EAAA,GAAAQ,EAAAA,IAAAA,CAAAA,qDAAAA,CAAA,QAAA,SAAAE,CAAA,EAAAT,EAAAA,CAAA,CAAA,EAAA,GAAAO,EAAAA,IAAAA,CAAAA,+BAAAA,CAAAN,cAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,0CAAAA,CAAA,QAAA,SAAAE,CAAA,EAAAP,EAAAA,CAAA,CAAA,EAAA,IAAAK,EAAAA,IAAAA,CAAAA,qCAAAA,CAAAJ,gBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,IAAAI,EAAAA,IAAAA,CAAAA,+CAAAA,CAAA,QAAA,SAAAE,CAAA,EAAAL,EAAAA,CAAA,CAAA,EAAA,IAAAG,EAAAA,IAAAA,CAAAA,0BAAAA,CAAAF,oBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,IAAAE,EAAAA,IAAAA,CAAAA,iCAAAA,CAAAD,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,IAAtEC,EAAOG,aAAO,CAoCS,SAAAC,CAAA,EAAqG,IAAlGC,EAAQD,EAARC,QAAQ,CAAEC,EAAKF,EAALE,KAAK,CAAEC,EAAkBH,EAAlBG,kBAAkB,CAAEC,EAAOJ,EAAPI,OAAO,CAAEC,EAAWL,EAAXK,WAAW,CAC5EC,EAAahB,IACbiB,EAAiB,CAAC,CAAC/B,EAA2B,kBAE5CgC,EAAQC,AAAKd,IAAba,QAAQ,CACVE,EAA+BhC,EAAY,WAChD8B,GACD,EAAG,CAACA,EAAS,EAEPG,EAAejB,IAErB,OACCjB,EAAAmC,aAAA,CAAAnC,EAAAoC,QAAA,CAAA,KACCpC,EAAAmC,aAAA,CAAC9B,EAAmB,KACnBL,EAAAmC,aAAA,CAAC7B,EAAiB,CAAC+B,KAAMb,CAAS,GAClCxB,EAAAmC,aAAA,CAAC5B,EAAkB,KAAEkB,GACrBzB,EAAAmC,aAAA,CAAC3B,EAAkB,CAAC8B,QAASL,CAA6B,IAE3DjC,EAAAmC,aAAA,CAAC/B,EAAoB,CAACmC,WAAY,EAAGC,SAAU,EAAGC,cAAe,CAAE,EACjEb,EAAYc,SAAS,EACrB1C,EAAAmC,aAAA,CAACvC,EAAG,CAAC6C,cAAe,GAAIE,aAAc,EAAG,EACxC3C,EAAAmC,aAAA,CAACrC,EAAQ,CAAC8C,KAAK,KAAK,IAGrBhB,EAAYiB,SAAS,EACrB7C,EAAAmC,aAAA,CAAAnC,EAAAoC,QAAA,CAAA,KACER,AAA4B,IAA5BA,EAAYkB,IAAI,CAACC,MAAM,EAAU/C,EAAAmC,aAAA,CAAC1B,EAAyB,CAACgB,MAAOC,CAAmB,GAEtFE,EAAYkB,IAAI,CAACC,MAAM,CAAG,GAC1B/C,EAAAmC,aAAA,CAACrB,EAAwB,KACxBd,EAAAmC,aAAA,CAACnB,EAAmB,KACnBhB,EAAAmC,aAAA,CAACvC,EAAG,CAACoD,GAAG,UAAUC,QAAQ,OAAOC,cAAc,SAASV,SAAU,EAAGD,WAAY,EAAGY,UAAU,OAAOC,OAAO,MAAM,EACjHpD,EAAAmC,aAAA,CAACjC,EAAQ,CACRmD,WAAYzB,EAAYkB,IAAI,CAACC,MAAO,CACpCO,SAAU,GACVR,KAAMlB,EAAYkB,IAAK,CACvBS,WAAY,CAAEC,SAAU9C,CAAwB,EAChD+C,YAAa,SAACC,CAAK,CAAEC,CAAO,EAG3B,IAH+BC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAGzBC,EAASnD,EAAgB4C,EAFd/B,EAAYkB,IAAI,CAACY,EAAQ,EAAE,EAItCS,EAAShE,EAAaiE,eAAe,CAACT,GAEtCU,EAAM,AAA+C,OAA/CT,CAAAA,EAAG1B,MAAAA,EAAY,KAAA,EAAA,AAAS,OAAT2B,CAAAA,EAAZ3B,EAAcoC,OAAO,AAAPA,GAAOT,AAAA,KAAA,IAAAA,EAAA,KAAA,EAArBA,EAAuBU,QAAQ,CAACZ,EAAQa,GAAG,CAAA,GAACZ,AAAA,KAAA,IAAAA,GAAAA,EACrDa,EAAO,AAAmD,OAAnDX,CAAAA,EAAG5B,MAAAA,EAAY,KAAA,EAAA,AAAa,OAAb6B,CAAAA,EAAZ7B,EAAcwC,WAAW,AAAXA,GAAWX,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAzBA,EAA2BQ,QAAQ,CAACZ,EAAQa,GAAG,CAAA,GAACV,AAAA,KAAA,IAAAA,GAAAA,EAC1Da,EAAG,AAAoD,OAApDX,CAAAA,EAAG9B,MAAAA,EAAY,KAAA,EAAA,AAAc,OAAd+B,CAAAA,EAAZ/B,EAAc0C,YAAY,AAAZA,GAAYX,AAAA,KAAA,IAAAA,EAAA,KAAA,EAA1BA,EAA4BM,QAAQ,CAACZ,EAAQa,GAAG,CAAA,GAACR,AAAA,KAAA,IAAAA,GAAAA,EAE7D,OACChE,EAAAmC,aAAA,CAAAnC,EAAAoC,QAAA,CAAA,KACE8B,GAAUlE,EAAAmC,aAAA,CAACtC,EAAc,KAAEgC,EAAW8B,EAAQkB,EAAE,GAEhDV,EACAnE,EAAAmC,aAAA,CAACvB,EAAa,CAAC+C,QAASA,EAAS7B,eAAgBA,CAAe,GAEhE9B,EAAAmC,aAAA,CAACxB,EAAW,CACXgD,QAASA,EACTmB,WAAY,CAAA,EACZT,OAAQA,EACRI,QAASA,EACTE,IAAKA,EACLhD,QAASA,EACTG,eAAgBA,CAAe,GAKpC,CAAE,QAWb"}