)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/RoomFiles/RoomFilesWithData.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useMutableCallback, useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport { useSetModal, useToastMessageDispatch, useUserId, useMethod, useTranslation } from '@rocket.chat/ui-contexts';\nimport React, { useState, useCallback, useMemo } from 'react';\n\nimport GenericModal from '../../../../components/GenericModal';\nimport { useRecordList } from '../../../../hooks/lists/useRecordList';\nimport { AsyncStatePhase } from '../../../../hooks/useAsyncState';\nimport { useRoom } from '../../contexts/RoomContext';\nimport { useRoomToolbox } from '../../contexts/RoomToolboxContext';\nimport RoomFiles from './RoomFiles';\nimport { useFilesList } from './hooks/useFilesList';\nimport { useMessageDeletionIsAllowed } from './hooks/useMessageDeletionIsAllowed';\n\nconst RoomFilesWithData = () => {\n\tconst uid = useUserId();\n\tconst room = useRoom();\n\tconst { closeTab } = useRoomToolbox();\n\tconst t = useTranslation();\n\tconst setModal = useSetModal();\n\tconst closeModal = useMutableCallback(() => setModal());\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst deleteFile = useMethod('deleteFileMessage');\n\n\tconst [type, setType] = useLocalStorage('file-list-type', 'all');\n\tconst [text, setText] = useState('');\n\n\tconst handleTextChange = useCallback((event) => {\n\t\tsetText(event.currentTarget.value);\n\t}, []);\n\n\tconst { filesList, loadMoreItems, reload } = useFilesList(useMemo(() => ({ rid: room._id, type, text }), [room._id, type, text]));\n\tconst { phase, items: filesItems, itemCount: totalItemCount } = useRecordList(filesList);\n\n\tconst handleDelete = useMutableCallback((_id) => {\n\t\tconst onConfirm = async () => {\n\t\t\ttry {\n\t\t\t\tawait deleteFile(_id);\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Deleted') });\n\t\t\t\treload();\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t\tcloseModal();\n\t\t};\n\n\t\tsetModal(\n\t\t\t<GenericModal variant='danger' onConfirm={onConfirm} onCancel={closeModal} confirmText={t('Delete')}>\n\t\t\t\t{t('Delete_File_Warning')}\n\t\t\t</GenericModal>,\n\t\t);\n\t}, []);\n\n\tconst isDeletionAllowed = useMessageDeletionIsAllowed(room._id, uid);\n\n\treturn (\n\t\t<RoomFiles\n\t\t\trid={room._id}\n\t\t\tloading={phase === AsyncStatePhase.LOADING}\n\t\t\ttype={type}\n\t\t\ttext={text}\n\t\t\tloadMoreItems={loadMoreItems}\n\t\t\tsetType={setType}\n\t\t\tsetText={handleTextChange}\n\t\t\tfilesItems={filesItems}\n\t\t\ttotal={totalItemCount}\n\t\t\tonClickClose={closeTab}\n\t\t\tonClickDelete={handleDelete}\n\t\t\tisDeletionAllowed={isDeletionAllowed}\n\t\t/>\n\t);\n};\n\nexport default RoomFilesWithData;\n",null],"names":["_regeneratorRuntime","_slicedToArray","useMutableCallback","useLocalStorage","useSetModal","useToastMessageDispatch","useUserId","useMethod","useTranslation","React","useState","useCallback","useMemo","GenericModal","useRecordList","AsyncStatePhase","useRoom","useRoomToolbox","RoomFiles","useFilesList","useMessageDeletionIsAllowed","module","link","default","v","exportDefault","uid","room","closeTab","_useRoomToolbox","t","setModal","closeModal","dispatchToastMessage","deleteFile","_useLocalStorage2","type","setType","_useState2","text","setText","handleTextChange","event","currentTarget","value","_useFilesList","rid","_id","filesList","loadMoreItems","reload","_useRecordList","phase","filesItems","items","totalItemCount","itemCount","handleDelete","createElement","variant","onConfirm","async","_context","prev","next","awrap","message","t0","stop","Promise","onCancel","confirmText","isDeletionAllowed","loading","LOADING","total","onClickClose","onClickDelete"],"mappings":"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"}