)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/Info/EditRoomInfo/useEditRoomPermissions.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IRoom, IRoomWithRetentionPolicy } from '@rocket.chat/core-typings';\nimport { usePermission, useAtLeastOnePermission, useRole } from '@rocket.chat/ui-contexts';\nimport { useMemo } from 'react';\n\nimport { e2e } from '../../../../../../app/e2e/client/rocketchat.e2e';\nimport { RoomSettingsEnum } from '../../../../../../definition/IRoomTypeConfig';\nimport { roomCoordinator } from '../../../../../lib/rooms/roomCoordinator';\n\nconst getCanChangeType = (room: IRoom | IRoomWithRetentionPolicy, canCreateChannel: boolean, canCreateGroup: boolean, isAdmin: boolean) =>\n\t(!room.default || isAdmin) && ((room.t === 'p' && canCreateChannel) || (room.t === 'c' && canCreateGroup));\n\nexport const useEditRoomPermissions = (room: IRoom | IRoomWithRetentionPolicy) => {\n\tconst isAdmin = useRole('admin');\n\tconst canCreateChannel = usePermission('create-c');\n\tconst canCreateGroup = usePermission('create-p');\n\n\tconst canChangeType = getCanChangeType(room, canCreateChannel, canCreateGroup, isAdmin);\n\tconst canSetReadOnly = usePermission('set-readonly', room._id);\n\tconst canSetReactWhenReadOnly = usePermission('set-react-when-readonly', room._id);\n\tconst canEditRoomRetentionPolicy = usePermission('edit-room-retention-policy', room._id);\n\tconst canArchiveOrUnarchive = useAtLeastOnePermission(\n\t\tuseMemo(() => ['archive-room', 'unarchive-room'], []),\n\t\troom._id,\n\t);\n\tconst canToggleEncryption = usePermission('toggle-room-e2e-encryption', room._id) && (room.encrypted || e2e.isReady());\n\n\tconst [\n\t\tcanViewName,\n\t\tcanViewTopic,\n\t\tcanViewAnnouncement,\n\t\tcanViewArchived,\n\t\tcanViewDescription,\n\t\tcanViewType,\n\t\tcanViewReadOnly,\n\t\tcanViewHideSysMes,\n\t\tcanViewJoinCode,\n\t\tcanViewEncrypted,\n\t] = useMemo(() => {\n\t\tconst isAllowed =\n\t\t\troomCoordinator.getRoomDirectives(room.t)?.allowRoomSettingChange ||\n\t\t\t(() => {\n\t\t\t\tundefined;\n\t\t\t});\n\t\treturn [\n\t\t\tisAllowed(room, RoomSettingsEnum.NAME),\n\t\t\tisAllowed(room, RoomSettingsEnum.TOPIC),\n\t\t\tisAllowed(room, RoomSettingsEnum.ANNOUNCEMENT),\n\t\t\tisAllowed(room, RoomSettingsEnum.ARCHIVE_OR_UNARCHIVE),\n\t\t\tisAllowed(room, RoomSettingsEnum.DESCRIPTION),\n\t\t\tisAllowed(room, RoomSettingsEnum.TYPE),\n\t\t\tisAllowed(room, RoomSettingsEnum.READ_ONLY),\n\t\t\tisAllowed(room, RoomSettingsEnum.SYSTEM_MESSAGES),\n\t\t\tisAllowed(room, RoomSettingsEnum.JOIN_CODE),\n\t\t\tisAllowed(room, RoomSettingsEnum.REACT_WHEN_READ_ONLY),\n\t\t\tisAllowed(room, RoomSettingsEnum.E2E),\n\t\t];\n\t}, [room]);\n\n\treturn {\n\t\tcanChangeType,\n\t\tcanSetReadOnly,\n\t\tcanSetReactWhenReadOnly,\n\t\tcanEditRoomRetentionPolicy,\n\t\tcanArchiveOrUnarchive,\n\t\tcanToggleEncryption,\n\t\tcanViewName,\n\t\tcanViewTopic,\n\t\tcanViewAnnouncement,\n\t\tcanViewArchived,\n\t\tcanViewDescription,\n\t\tcanViewType,\n\t\tcanViewReadOnly,\n\t\tcanViewHideSysMes,\n\t\tcanViewJoinCode,\n\t\tcanViewEncrypted,\n\t};\n};\n",null],"names":["module","link","default","_slicedToArray","export","useEditRoomPermissions","usePermission","useAtLeastOnePermission","useRole","useMemo","e2e","RoomSettingsEnum","roomCoordinator","room","isAdmin","canCreateChannel","canCreateGroup","canChangeType","t","canSetReadOnly","_id","canSetReactWhenReadOnly","canEditRoomRetentionPolicy","canArchiveOrUnarchive","canToggleEncryption","encrypted","isReady","_useMemo2","_roomCoordinator$getR","isAllowed","getRoomDirectives","allowRoomSettingChange","NAME","TOPIC","ANNOUNCEMENT","ARCHIVE_OR_UNARCHIVE","DESCRIPTION","TYPE","READ_ONLY","SYSTEM_MESSAGES","JOIN_CODE","REACT_WHEN_READ_ONLY","E2E","canViewName","canViewTopic","canViewAnnouncement","canViewArchived","canViewDescription","canViewType","canViewReadOnly","canViewHideSysMes","canViewJoinCode","canViewEncrypted"],"mappings":"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"}