)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/Info/hooks/actions/useRoomLeave.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IRoom } from '@rocket.chat/core-typings';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\nimport { useRouter, useSetModal, useToastMessageDispatch, useMethod, useTranslation, usePermission } from '@rocket.chat/ui-contexts';\nimport React from 'react';\n\nimport { LegacyRoomManager } from '../../../../../../../app/ui-utils/client';\nimport { UiTextContext } from '../../../../../../../definition/IRoomTypeConfig';\nimport WarningModal from '../../../../../../components/WarningModal';\nimport { roomCoordinator } from '../../../../../../lib/rooms/roomCoordinator';\n\n// TODO implement joined\nexport const useRoomLeave = (room: IRoom, joined = true) => {\n\tconst t = useTranslation();\n\tconst setModal = useSetModal();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst leaveRoom = useMethod('leaveRoom');\n\tconst router = useRouter();\n\n\tconst canLeave = usePermission(room.t === 'c' ? 'leave-c' : 'leave-p') && room.cl !== false && joined;\n\n\tconst handleLeave = useMutableCallback(() => {\n\t\tconst leaveAction = async () => {\n\t\t\ttry {\n\t\t\t\tawait leaveRoom(room._id);\n\t\t\t\trouter.navigate('/home');\n\t\t\t\tLegacyRoomManager.close(room._id);\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t\tsetModal(null);\n\t\t};\n\n\t\tconst warnText = roomCoordinator.getRoomDirectives(room.t).getUiText(UiTextContext.LEAVE_WARNING);\n\n\t\tsetModal(\n\t\t\t<WarningModal\n\t\t\t\ttext={t(warnText as TranslationKey, room.fname || room.name)}\n\t\t\t\tconfirmText={t('Leave_room')}\n\t\t\t\tclose={() => setModal(null)}\n\t\t\t\tcancel={() => setModal(null)}\n\t\t\t\tcancelText={t('Cancel')}\n\t\t\t\tconfirm={leaveAction}\n\t\t\t/>,\n\t\t);\n\t});\n\n\treturn canLeave ? handleLeave : null;\n};\n",null],"names":["module","link","default","_regeneratorRuntime","export","useRoomLeave","useMutableCallback","useRouter","useSetModal","useToastMessageDispatch","useMethod","useTranslation","usePermission","v","React","LegacyRoomManager","UiTextContext","WarningModal","roomCoordinator","room","joined","arguments","length","undefined","t","setModal","dispatchToastMessage","leaveRoom","router","canLeave","cl","handleLeave","warnText","getRoomDirectives","getUiText","LEAVE_WARNING","createElement","text","fname","name","confirmText","close","cancel","cancelText","confirm","async","_context","prev","next","awrap","_id","navigate","t0","type","message","stop","Promise"],"mappings":"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"}