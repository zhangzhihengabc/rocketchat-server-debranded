function module(e,n,t){var o,i,r,a,s,c,l,u,d,f,m;t.link("@babel/runtime/regenerator",{default:function(e){o=e}},0),t.link("@rocket.chat/ui-contexts",{useEndpoint:function(e){i=e},useTranslation:function(e){r=e},useToastMessageDispatch:function(e){a=e}},0),t.link("@tanstack/react-query",{useQuery:function(e){s=e},useQueryClient:function(e){c=e}},1),t.link("react",{default:function(e){l=e}},2),t.link("../../../components/GenericModal",{default:function(e){u=e}},3),t.link("../../../components/message/content/location/MapView",{default:function(e){d=e}},4),t.link("./getGeolocationPermission",{getGeolocationPermission:function(e){f=e}},5),t.link("./getGeolocationPosition",{getGeolocationPosition:function(e){m=e}},6),t.exportDefault(function(e){var n=e.rid,t=e.tmid,p=e.onClose,g=r(),_=a(),k=s(["geolocationPermission"],f),y=k.data,h=k.isLoading,P=s(["geolocationPosition",y],function(){return o.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(h||"prompt"===y||"denied"===y)){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",m());case 3:case"end":return e.stop()}},null,null,null,Promise)}).data,C=c(),x=i("POST","/v1/chat.sendMessage");return h||"prompt"===y?l.createElement(u,{title:g("You_will_be_asked_for_permissions"),confirmText:g("Continue"),onConfirm:function(){var e;return o.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,o.awrap(m());case 3:e=n.sent,C.setQueryData(["geolocationPosition","granted"],e),C.setQueryData(["geolocationPermission"],"granted"),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),C.setQueryData(["geolocationPermission"],function(){return f});case 11:case"end":return n.stop()}},null,null,[[0,8]],Promise)},onClose:p,onCancel:p}):"denied"!==y&&P?l.createElement(u,{title:g("Share_Location_Title"),confirmText:g("Share"),onConfirm:function(){if(!P)throw Error("Failed to load position");try{x({message:{rid:n,tmid:t,location:{type:"Point",coordinates:[P.coords.longitude,P.coords.latitude]}}})}catch(e){_({type:"error",message:e})}finally{p()}},onClose:p,onCancel:p},l.createElement(d,{latitude:P.coords.latitude,longitude:P.coords.longitude})):l.createElement(u,{title:g("Cannot_share_your_location"),confirmText:g("Ok"),onConfirm:p,onClose:p},g("The_necessary_browser_permissions_for_location_sharing_are_not_granted"))})}
//# sourceMappingURL=/dynamic/client/views/room/ShareLocation/739e2cf0ba8979504c6f951126bfb1f6fc484eed.map
