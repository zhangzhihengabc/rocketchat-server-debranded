)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/setupWizard/steps/CloudAccountConfirmation.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { AwaitingConfirmationPage } from '@rocket.chat/onboarding-ui';\nimport { useToastMessageDispatch, useSettingSetValue, useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useEffect, useCallback } from 'react';\n\nimport { useSetupWizardContext } from '../contexts/SetupWizardContext';\n\nconst setIntervalTime = (interval?: number): number => (interval ? interval * 1000 : 0);\n\nconst CloudAccountConfirmation = (): ReactElement => {\n\tconst {\n\t\tregisterServer,\n\t\tcurrentStep,\n\t\tmaxSteps,\n\t\tgoToStep,\n\t\tsetupWizardData: { registrationData },\n\t\tsaveWorkspaceData,\n\t} = useSetupWizardContext();\n\tconst setShowSetupWizard = useSettingSetValue('Show_Setup_Wizard');\n\tconst cloudConfirmationPoll = useEndpoint('GET', '/v1/cloud.confirmationPoll');\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst t = useTranslation();\n\n\tconst getConfirmation = useCallback(async () => {\n\t\ttry {\n\t\t\tif (registrationData.device_code) {\n\t\t\t\tconst { pollData } = await cloudConfirmationPoll({\n\t\t\t\t\tdeviceCode: registrationData.device_code,\n\t\t\t\t});\n\n\t\t\t\tif ('successful' in pollData && pollData.successful) {\n\t\t\t\t\tawait saveWorkspaceData();\n\t\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Your_workspace_is_ready') });\n\t\t\t\t\treturn setShowSetupWizard('completed');\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (error: unknown) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t}, [cloudConfirmationPoll, registrationData.device_code, setShowSetupWizard, saveWorkspaceData, dispatchToastMessage, t]);\n\n\tuseEffect(() => {\n\t\tconst pollInterval = setInterval(() => getConfirmation(), setIntervalTime(registrationData.interval));\n\n\t\treturn (): void => clearInterval(pollInterval);\n\t}, [getConfirmation, registrationData.interval]);\n\n\treturn (\n\t\t<AwaitingConfirmationPage\n\t\t\tcurrentStep={currentStep}\n\t\t\tstepCount={maxSteps}\n\t\t\temailAddress={registrationData.cloudEmail}\n\t\t\tsecurityCode={registrationData.user_code}\n\t\t\tonResendEmailRequest={(): Promise<void> => registerServer({ email: registrationData.cloudEmail, resend: true })}\n\t\t\tonChangeEmailRequest={(): void => goToStep(3)}\n\t\t/>\n\t);\n};\n\nexport default CloudAccountConfirmation;\n",null],"names":["_regeneratorRuntime","AwaitingConfirmationPage","useToastMessageDispatch","useSettingSetValue","useEndpoint","useTranslation","React","useEffect","useCallback","useSetupWizardContext","module","default","v","link","exportDefault","_useSetupWizardContex","registerServer","currentStep","maxSteps","goToStep","registrationData","setupWizardData","saveWorkspaceData","setShowSetupWizard","cloudConfirmationPoll","dispatchToastMessage","t","getConfirmation","pollData","async","_context","prev","next","device_code","awrap","deviceCode","_await$cloudConfirmat","sent","successful","type","message","abrupt","t0","stop","Promise","interval","pollInterval","setInterval","clearInterval","createElement","stepCount","emailAddress","cloudEmail","securityCode","user_code","onResendEmailRequest","email","resend","onChangeEmailRequest"],"mappings":"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"}