)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/directory/tabs/users/UsersTable/UsersTable.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IUser, Serialized } from '@rocket.chat/core-typings';\nimport { Pagination, States, StatesIcon, StatesTitle, StatesActions, StatesAction } from '@rocket.chat/fuselage';\nimport { useDebouncedValue, useMediaQuery } from '@rocket.chat/fuselage-hooks';\nimport { usePermission, useRoute, useTranslation, useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useQuery } from '@tanstack/react-query';\nimport type { ReactElement } from 'react';\nimport React, { useCallback, useMemo, useState } from 'react';\n\nimport FilterByText from '../../../../../components/FilterByText';\nimport GenericNoResults from '../../../../../components/GenericNoResults';\nimport {\n\tGenericTable,\n\tGenericTableHeader,\n\tGenericTableHeaderCell,\n\tGenericTableBody,\n\tGenericTableLoadingTable,\n} from '../../../../../components/GenericTable';\nimport { usePagination } from '../../../../../components/GenericTable/hooks/usePagination';\nimport { useSort } from '../../../../../components/GenericTable/hooks/useSort';\nimport { useDirectoryQuery } from '../../../hooks/useDirectoryQuery';\nimport UsersTableRow from './UsersTableRow';\n\nconst UsersTable = ({ workspace = 'local' }): ReactElement => {\n\tconst t = useTranslation();\n\tconst mediaQuery = useMediaQuery('(min-width: 1024px)');\n\n\tconst [text, setText] = useState('');\n\tconst directRoute = useRoute('direct');\n\tconst federation = workspace === 'external';\n\tconst debouncedText = useDebouncedValue(text, 500);\n\tconst canViewFullOtherUserInfo = usePermission('view-full-other-user-info');\n\n\tconst { current, itemsPerPage, setItemsPerPage: onSetItemsPerPage, setCurrent: onSetCurrent, ...paginationProps } = usePagination();\n\tconst { sortBy, sortDirection, setSort } = useSort<'name' | 'email' | 'origin' | 'createdAt'>('name');\n\n\tconst headers = useMemo(\n\t\t() =>\n\t\t\t[\n\t\t\t\t<GenericTableHeaderCell key='name' direction={sortDirection} active={sortBy === 'name'} onClick={setSort} sort='name'>\n\t\t\t\t\t{t('Name')}\n\t\t\t\t</GenericTableHeaderCell>,\n\t\t\t\tmediaQuery && canViewFullOtherUserInfo && (\n\t\t\t\t\t<GenericTableHeaderCell\n\t\t\t\t\t\tkey='email'\n\t\t\t\t\t\tdirection={sortDirection}\n\t\t\t\t\t\tactive={sortBy === 'email'}\n\t\t\t\t\t\tonClick={setSort}\n\t\t\t\t\t\tsort='email'\n\t\t\t\t\t\twidth='x200'\n\t\t\t\t\t>\n\t\t\t\t\t\t{t('Email')}\n\t\t\t\t\t</GenericTableHeaderCell>\n\t\t\t\t),\n\t\t\t\tfederation && (\n\t\t\t\t\t<GenericTableHeaderCell\n\t\t\t\t\t\tkey='origin'\n\t\t\t\t\t\tdirection={sortDirection}\n\t\t\t\t\t\tactive={sortBy === 'origin'}\n\t\t\t\t\t\tonClick={setSort}\n\t\t\t\t\t\tsort='origin'\n\t\t\t\t\t\twidth='x200'\n\t\t\t\t\t>\n\t\t\t\t\t\t{t('Domain')}\n\t\t\t\t\t</GenericTableHeaderCell>\n\t\t\t\t),\n\t\t\t\tmediaQuery && (\n\t\t\t\t\t<GenericTableHeaderCell\n\t\t\t\t\t\tkey='createdAt'\n\t\t\t\t\t\tdirection={sortDirection}\n\t\t\t\t\t\tactive={sortBy === 'createdAt'}\n\t\t\t\t\t\tonClick={setSort}\n\t\t\t\t\t\tsort='createdAt'\n\t\t\t\t\t\twidth='x200'\n\t\t\t\t\t>\n\t\t\t\t\t\t{t('Joined_at')}\n\t\t\t\t\t</GenericTableHeaderCell>\n\t\t\t\t),\n\t\t\t].filter(Boolean),\n\t\t[setSort, sortBy, sortDirection, t, mediaQuery, canViewFullOtherUserInfo, federation],\n\t);\n\n\tconst query = useDirectoryQuery({ text: debouncedText, current, itemsPerPage }, [sortBy, sortDirection], 'users', workspace);\n\tconst getDirectoryData = useEndpoint('GET', '/v1/directory');\n\n\tconst { data, isFetched, isLoading, isError, refetch } = useQuery(['getDirectoryData', query], () => getDirectoryData(query));\n\n\tconst handleClick = useCallback(\n\t\t(username) => (e: React.KeyboardEvent | React.MouseEvent) => {\n\t\t\tif (e.type === 'click' || (e as React.KeyboardEvent).key === 'Enter') {\n\t\t\t\tdirectRoute.push({ rid: username });\n\t\t\t}\n\t\t},\n\t\t[directRoute],\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t<FilterByText autoFocus placeholder={t('Search_Users')} onChange={({ text }): void => setText(text)} />\n\t\t\t{isLoading && (\n\t\t\t\t<GenericTable>\n\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t<GenericTableLoadingTable headerCells={5} />\n\t\t\t\t\t</GenericTableBody>\n\t\t\t\t</GenericTable>\n\t\t\t)}\n\t\t\t{data?.result && data.result.length > 0 && isFetched && (\n\t\t\t\t<>\n\t\t\t\t\t<GenericTable>\n\t\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t\t{data?.result.map((user) => (\n\t\t\t\t\t\t\t\t<UsersTableRow\n\t\t\t\t\t\t\t\t\tkey={user._id}\n\t\t\t\t\t\t\t\t\tonClick={handleClick}\n\t\t\t\t\t\t\t\t\tmediaQuery={mediaQuery}\n\t\t\t\t\t\t\t\t\tuser={user as unknown as Serialized<IUser>}\n\t\t\t\t\t\t\t\t\tfederation={federation}\n\t\t\t\t\t\t\t\t\tcanViewFullOtherUserInfo={canViewFullOtherUserInfo}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</GenericTableBody>\n\t\t\t\t\t</GenericTable>\n\t\t\t\t\t<Pagination\n\t\t\t\t\t\tdivider\n\t\t\t\t\t\tcurrent={current}\n\t\t\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\t\t\tcount={data?.total || 0}\n\t\t\t\t\t\tonSetItemsPerPage={onSetItemsPerPage}\n\t\t\t\t\t\tonSetCurrent={onSetCurrent}\n\t\t\t\t\t\t{...paginationProps}\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t)}\n\t\t\t{isFetched && data?.result.length === 0 && <GenericNoResults />}\n\t\t\t{isError && (\n\t\t\t\t<States>\n\t\t\t\t\t<StatesIcon name='warning' variation='danger' />\n\t\t\t\t\t<StatesTitle>{t('Something_went_wrong')}</StatesTitle>\n\t\t\t\t\t<StatesActions>\n\t\t\t\t\t\t<StatesAction onClick={() => refetch()}>{t('Reload_page')}</StatesAction>\n\t\t\t\t\t</StatesActions>\n\t\t\t\t</States>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default UsersTable;\n",null],"names":["_extends","_objectWithoutProperties","_slicedToArray","Pagination","States","StatesIcon","StatesTitle","StatesActions","StatesAction","useDebouncedValue","useMediaQuery","usePermission","useRoute","useTranslation","useEndpoint","useQuery","React","useCallback","useMemo","useState","FilterByText","GenericNoResults","GenericTable","GenericTableHeader","GenericTableHeaderCell","GenericTableBody","GenericTableLoadingTable","usePagination","useSort","useDirectoryQuery","UsersTableRow","module","link","default","v","exportDefault","_ref","_ref$workspace","workspace","t","mediaQuery","_useState2","text","setText","directRoute","federation","debouncedText","canViewFullOtherUserInfo","_usePagination","current","itemsPerPage","onSetItemsPerPage","setItemsPerPage","onSetCurrent","setCurrent","paginationProps","_excluded","_useSort","sortBy","sortDirection","setSort","headers","createElement","key","direction","active","onClick","sort","width","filter","Boolean","query","getDirectoryData","_useQuery","data","isFetched","isLoading","isError","refetch","handleClick","username","e","type","push","rid","Fragment","autoFocus","placeholder","onChange","_ref2","headerCells","result","length","map","user","_id","divider","count","total","name","variation"],"mappings":"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"}