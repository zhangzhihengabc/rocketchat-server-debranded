)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/teams/contextualBar/channels/RoomActions.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Box, CheckBox, Menu, Option } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useSetModal, useToastMessageDispatch, usePermission, useTranslation } from '@rocket.chat/ui-contexts';\nimport React, { useMemo } from 'react';\n\nimport { useEndpointAction } from '../../../../hooks/useEndpointAction';\nimport { roomCoordinator } from '../../../../lib/rooms/roomCoordinator';\nimport ConfirmationModal from './ConfirmationModal';\n\nconst useReactModal = (Component, props) => {\n\tconst setModal = useSetModal();\n\n\treturn useMutableCallback(() => {\n\t\tconst handleClose = () => {\n\t\t\tsetModal(null);\n\t\t};\n\n\t\tsetModal(() => <Component onClose={handleClose} {...props} />);\n\t});\n};\n\nconst RoomActions = ({ room, reload }) => {\n\tconst t = useTranslation();\n\tconst rid = room._id;\n\tconst type = room.t;\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst canDeleteTeamChannel = usePermission(type === 'c' ? 'delete-c' : 'delete-p', rid);\n\tconst canEditTeamChannel = usePermission('edit-team-channel', rid);\n\tconst canRemoveTeamChannel = usePermission('remove-team-channel', rid);\n\n\tconst updateRoomEndpoint = useEndpointAction('POST', '/v1/teams.updateRoom');\n\tconst removeRoomEndpoint = useEndpointAction('POST', '/v1/teams.removeRoom', { successMessage: t('Room_has_been_removed') });\n\tconst deleteRoomEndpoint = useEndpointAction('POST', room.t === 'c' ? '/v1/channels.delete' : '/v1/groups.delete', {\n\t\tsuccessMessage: t('Room_has_been_deleted'),\n\t});\n\n\tconst RemoveFromTeamAction = useReactModal(ConfirmationModal, {\n\t\tonConfirmAction: async () => {\n\t\t\ttry {\n\t\t\t\tawait removeRoomEndpoint({ teamId: room.teamId, roomId: room._id });\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t\treload();\n\t\t},\n\t\tlabelButton: t('Remove'),\n\t\tcontent: (\n\t\t\t<Box is='span' size='14px'>\n\t\t\t\t{t('Team_Remove_from_team_modal_content', {\n\t\t\t\t\tteamName: roomCoordinator.getRoomName(room.t, room),\n\t\t\t\t})}\n\t\t\t</Box>\n\t\t),\n\t});\n\n\tconst DeleteChannelAction = useReactModal(ConfirmationModal, {\n\t\tonConfirmAction: async () => {\n\t\t\ttry {\n\t\t\t\tawait deleteRoomEndpoint({ roomId: room._id });\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t\treload();\n\t\t},\n\t\tlabelButton: t('Delete'),\n\t\tcontent: (\n\t\t\t<>\n\t\t\t\t<Box is='span' size='14px' color='status-font-on-danger' fontWeight='600'>\n\t\t\t\t\t{t('Team_Delete_Channel_modal_content_danger')}\n\t\t\t\t</Box>\n\t\t\t\t<Box is='span' size='14px'>\n\t\t\t\t\t{' '}\n\t\t\t\t\t{t('Team_Delete_Channel_modal_content')}\n\t\t\t\t</Box>\n\t\t\t</>\n\t\t),\n\t});\n\n\tconst menuOptions = useMemo(() => {\n\t\tconst AutoJoinAction = async () => {\n\t\t\ttry {\n\t\t\t\tawait updateRoomEndpoint({\n\t\t\t\t\troomId: rid,\n\t\t\t\t\tisDefault: !room.teamDefault,\n\t\t\t\t});\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\n\t\t\treload();\n\t\t};\n\n\t\treturn [\n\t\t\tcanEditTeamChannel && {\n\t\t\t\tlabel: {\n\t\t\t\t\tlabel: t('Team_Auto-join'),\n\t\t\t\t\ticon: type === 'c' ? 'hash' : 'hashtag-lock',\n\t\t\t\t},\n\t\t\t\taction: AutoJoinAction,\n\t\t\t},\n\t\t\tcanRemoveTeamChannel && {\n\t\t\t\tlabel: {\n\t\t\t\t\tlabel: t('Team_Remove_from_team'),\n\t\t\t\t\ticon: 'cross',\n\t\t\t\t},\n\t\t\t\taction: RemoveFromTeamAction,\n\t\t\t},\n\t\t\tcanDeleteTeamChannel && {\n\t\t\t\tlabel: {\n\t\t\t\t\tlabel: t('Delete'),\n\t\t\t\t\ticon: 'trash',\n\t\t\t\t},\n\t\t\t\taction: DeleteChannelAction,\n\t\t\t},\n\t\t].filter(Boolean);\n\t}, [\n\t\tDeleteChannelAction,\n\t\tRemoveFromTeamAction,\n\t\trid,\n\t\ttype,\n\t\troom.teamDefault,\n\t\tt,\n\t\tupdateRoomEndpoint,\n\t\treload,\n\t\tdispatchToastMessage,\n\t\tcanDeleteTeamChannel,\n\t\tcanRemoveTeamChannel,\n\t\tcanEditTeamChannel,\n\t]);\n\n\treturn (\n\t\t<Menu\n\t\t\tflexShrink={0}\n\t\t\tkey='menu'\n\t\t\ttiny\n\t\t\trenderItem={({ label: { label, icon }, ...props }) =>\n\t\t\t\ticon.match(/hash/) ? (\n\t\t\t\t\t<Option {...props} label={label} icon={icon}>\n\t\t\t\t\t\t<CheckBox checked={room.teamDefault} />\n\t\t\t\t\t</Option>\n\t\t\t\t) : (\n\t\t\t\t\t<Box color='status-font-on-danger'>\n\t\t\t\t\t\t<Option {...props} label={label} icon={icon} />\n\t\t\t\t\t</Box>\n\t\t\t\t)\n\t\t\t}\n\t\t\toptions={(canEditTeamChannel || canRemoveTeamChannel || canDeleteTeamChannel) && menuOptions}\n\t\t/>\n\t);\n};\n\nexport default RoomActions;\n",null],"names":["_objectWithoutProperties","_regeneratorRuntime","_extends","Box","CheckBox","Menu","Option","useMutableCallback","useSetModal","useToastMessageDispatch","usePermission","useTranslation","React","useMemo","useEndpointAction","roomCoordinator","ConfirmationModal","module","link","default","v","useReactModal","Component","props","setModal","handleClose","createElement","onClose","exportDefault","_ref","room","reload","t","rid","_id","type","dispatchToastMessage","canDeleteTeamChannel","canEditTeamChannel","canRemoveTeamChannel","updateRoomEndpoint","removeRoomEndpoint","successMessage","deleteRoomEndpoint","RemoveFromTeamAction","onConfirmAction","async","_context","prev","next","awrap","teamId","roomId","t0","message","stop","Promise","labelButton","content","is","size","teamName","getRoomName","DeleteChannelAction","_context2","Fragment","color","fontWeight","menuOptions","label","icon","action","_context3","isDefault","teamDefault","filter","Boolean","flexShrink","key","tiny","renderItem","_ref2","_ref2$label","_excluded","match","checked","options"],"mappings":"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"}