)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/teams/contextualBar/info/TeamsInfoWithData.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport {\n\tuseSetModal,\n\tuseToastMessageDispatch,\n\tuseUserId,\n\tuseSetting,\n\tusePermission,\n\tuseMethod,\n\tuseTranslation,\n\tuseRouter,\n} from '@rocket.chat/ui-contexts';\nimport React, { useCallback } from 'react';\n\nimport { UiTextContext } from '../../../../../definition/IRoomTypeConfig';\nimport { GenericModalDoNotAskAgain } from '../../../../components/GenericModal';\nimport { useDontAskAgain } from '../../../../hooks/useDontAskAgain';\nimport { useEndpointAction } from '../../../../hooks/useEndpointAction';\nimport { roomCoordinator } from '../../../../lib/rooms/roomCoordinator';\nimport { useDeleteRoom } from '../../../hooks/roomActions/useDeleteRoom';\nimport { useRoom } from '../../../room/contexts/RoomContext';\nimport { useRoomToolbox } from '../../../room/contexts/RoomToolboxContext';\nimport ConvertToChannelModal from '../../ConvertToChannelModal';\nimport LeaveTeam from './LeaveTeam';\nimport TeamsInfo from './TeamsInfo';\n\nconst retentionPolicyMaxAge = {\n\tc: 'RetentionPolicy_MaxAge_Channels',\n\tp: 'RetentionPolicy_MaxAge_Groups',\n\td: 'RetentionPolicy_MaxAge_DMs',\n};\n\nconst retentionPolicyAppliesTo = {\n\tc: 'RetentionPolicy_AppliesToChannels',\n\tp: 'RetentionPolicy_AppliesToGroups',\n\td: 'RetentionPolicy_AppliesToDMs',\n};\n\nconst TeamsInfoWithLogic = ({ openEditing }) => {\n\tconst room = useRoom();\n\tconst { openTab, closeTab } = useRoomToolbox();\n\tconst t = useTranslation();\n\tconst userId = useUserId();\n\n\tconst retentionPolicyEnabled = useSetting('RetentionPolicy_Enabled');\n\tconst retentionPolicy = {\n\t\tretentionPolicyEnabled,\n\t\tmaxAgeDefault: useSetting(retentionPolicyMaxAge[room.t]) || 30,\n\t\tretentionEnabledDefault: useSetting(retentionPolicyAppliesTo[room.t]),\n\t\texcludePinnedDefault: useSetting('RetentionPolicy_DoNotPrunePinned'),\n\t\tfilesOnlyDefault: useSetting('RetentionPolicy_FilesOnly'),\n\t};\n\n\tconst dontAskHideRoom = useDontAskAgain('hideRoom');\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst setModal = useSetModal();\n\tconst closeModal = useMutableCallback(() => setModal());\n\n\tconst leaveTeam = useEndpointAction('POST', '/v1/teams.leave');\n\tconst convertTeamToChannel = useEndpointAction('POST', '/v1/teams.convertToChannel');\n\n\tconst hideTeam = useMethod('hideRoom');\n\n\tconst router = useRouter();\n\n\tconst canEdit = usePermission('edit-team-channel', room._id);\n\n\t// const canLeave = usePermission('leave-team'); /* && room.cl !== false && joined */\n\n\tconst { handleDelete, canDeleteRoom } = useDeleteRoom(room);\n\n\tconst onClickLeave = useMutableCallback(() => {\n\t\tconst onConfirm = async (roomsLeft) => {\n\t\t\troomsLeft = Object.keys(roomsLeft);\n\t\t\tconst roomsToLeave = Array.isArray(roomsLeft) && roomsLeft.length > 0 ? roomsLeft : [];\n\n\t\t\ttry {\n\t\t\t\tawait leaveTeam({\n\t\t\t\t\tteamId: room.teamId,\n\t\t\t\t\t...(roomsToLeave.length && { rooms: roomsToLeave }),\n\t\t\t\t});\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Teams_left_team_successfully') });\n\t\t\t\trouter.navigate('/home');\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t} finally {\n\t\t\t\tcloseModal();\n\t\t\t}\n\t\t};\n\n\t\tsetModal(<LeaveTeam onConfirm={onConfirm} onCancel={closeModal} teamId={room.teamId} />);\n\t});\n\n\tconst handleHide = useMutableCallback(async () => {\n\t\tconst hide = async () => {\n\t\t\ttry {\n\t\t\t\tawait hideTeam(room._id);\n\t\t\t\trouter.navigate('/home');\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t} finally {\n\t\t\t\tcloseModal();\n\t\t\t}\n\t\t};\n\n\t\tconst warnText = roomCoordinator.getRoomDirectives(room.t).getUiText(UiTextContext.HIDE_WARNING);\n\n\t\tif (dontAskHideRoom) {\n\t\t\treturn hide();\n\t\t}\n\n\t\tsetModal(\n\t\t\t<GenericModalDoNotAskAgain\n\t\t\t\tvariant='danger'\n\t\t\t\tconfirmText={t('Yes_hide_it')}\n\t\t\t\tcancelText={t('Cancel')}\n\t\t\t\tonClose={closeModal}\n\t\t\t\tonCancel={closeModal}\n\t\t\t\tonConfirm={hide}\n\t\t\t\tdontAskAgain={{\n\t\t\t\t\taction: 'hideRoom',\n\t\t\t\t\tlabel: t('Hide_room'),\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{t(warnText, room.fname)}\n\t\t\t</GenericModalDoNotAskAgain>,\n\t\t);\n\t});\n\n\tconst onClickViewChannels = useCallback(() => openTab('team-channels'), [openTab]);\n\n\tconst onClickConvertToChannel = useMutableCallback(() => {\n\t\tconst onConfirm = async (roomsToRemove) => {\n\t\t\ttry {\n\t\t\t\tawait convertTeamToChannel({\n\t\t\t\t\tteamId: room.teamId,\n\t\t\t\t\troomsToRemove: Object.keys(roomsToRemove),\n\t\t\t\t});\n\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Success') });\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t} finally {\n\t\t\t\tcloseModal();\n\t\t\t}\n\t\t};\n\n\t\tsetModal(\n\t\t\t<ConvertToChannelModal onClose={closeModal} onCancel={closeModal} onConfirm={onConfirm} teamId={room.teamId} userId={userId} />,\n\t\t);\n\t});\n\n\treturn (\n\t\t<TeamsInfo\n\t\t\troom={room}\n\t\t\tretentionPolicy={retentionPolicyEnabled && retentionPolicy}\n\t\t\tonClickEdit={canEdit && openEditing}\n\t\t\tonClickClose={closeTab}\n\t\t\tonClickDelete={canDeleteRoom && handleDelete}\n\t\t\tonClickLeave={/* canLeave && */ onClickLeave}\n\t\t\tonClickHide={/* joined && */ handleHide}\n\t\t\tonClickViewChannels={onClickViewChannels}\n\t\t\tonClickConvertToChannel={canEdit && onClickConvertToChannel}\n\t\t/>\n\t);\n};\n\nexport default TeamsInfoWithLogic;\n",null],"names":["module","link","default","v","_regeneratorRuntime","_objectSpread","useMutableCallback","useSetModal","useToastMessageDispatch","useUserId","useSetting","usePermission","useMethod","useTranslation","useRouter","React","useCallback","UiTextContext","GenericModalDoNotAskAgain","useDontAskAgain","useEndpointAction","roomCoordinator","useDeleteRoom","useRoom","useRoomToolbox","ConvertToChannelModal","LeaveTeam","TeamsInfo","retentionPolicyMaxAge","c","p","d","retentionPolicyAppliesTo","exportDefault","_ref","openEditing","room","_useRoomToolbox","openTab","closeTab","t","userId","retentionPolicyEnabled","retentionPolicy","maxAgeDefault","retentionEnabledDefault","excludePinnedDefault","filesOnlyDefault","dontAskHideRoom","dispatchToastMessage","setModal","closeModal","leaveTeam","convertTeamToChannel","hideTeam","router","canEdit","_id","_useDeleteRoom","handleDelete","canDeleteRoom","onClickLeave","createElement","onConfirm","roomsLeft","roomsToLeave","async","_context","prev","next","Array","isArray","Object","keys","length","awrap","teamId","rooms","type","message","navigate","t0","finish","stop","Promise","onCancel","handleHide","hide","warnText","_context3","_callee2","_callee2$","_context2","getRoomDirectives","getUiText","HIDE_WARNING","abrupt","variant","confirmText","cancelText","onClose","dontAskAgain","action","label","fname","onClickViewChannels","onClickConvertToChannel","roomsToRemove","_context4","onClickEdit","onClickClose","onClickDelete","onClickHide"],"mappings":"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"}