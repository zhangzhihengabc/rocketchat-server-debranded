)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/outlookCalendar/hooks/useOutlookCalendarList.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useToastMessageDispatch, useTranslation, useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\n\nimport { syncOutlookEvents } from '../lib/syncOutlookEvents';\nimport { useOutlookAuthenticationMutation } from './useOutlookAuthentication';\n\nexport const useOutlookCalendarListForToday = () => {\n\treturn useOutlookCalendarList(new Date());\n};\n\nexport const useOutlookCalendarList = (date: Date) => {\n\tconst calendarData = useEndpoint('GET', '/v1/calendar-events.list');\n\n\treturn useQuery(['outlook', 'calendar', 'list'], async () => {\n\t\tconst { data } = await calendarData({ date: date.toISOString() });\n\t\treturn data;\n\t});\n};\n\nexport const useMutationOutlookCalendarSync = () => {\n\tconst t = useTranslation();\n\tconst queryClient = useQueryClient();\n\n\tconst checkOutlookCredentials = useOutlookAuthenticationMutation();\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst syncMutation = useMutation({\n\t\tmutationFn: async () => {\n\t\t\tawait syncOutlookEvents();\n\n\t\t\tawait queryClient.invalidateQueries(['outlook', 'calendar', 'list']);\n\n\t\t\tawait checkOutlookCredentials.mutateAsync();\n\t\t},\n\t\tonSuccess: () => {\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Outlook_Sync_Success') });\n\t\t},\n\t\tonError: (error) => {\n\t\t\tif (error instanceof Error && error.message === 'abort') {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdispatchToastMessage({ type: 'error', message: t('Outlook_Sync_Failed') });\n\t\t},\n\t});\n\treturn syncMutation;\n};\n",null],"names":["module","default","v","_regeneratorRuntime","export","useOutlookCalendarListForToday","useOutlookCalendarList","useMutationOutlookCalendarSync","useToastMessageDispatch","useTranslation","useEndpoint","useMutation","useQuery","useQueryClient","syncOutlookEvents","useOutlookAuthenticationMutation","Date","date","calendarData","data","async","_context","prev","next","awrap","toISOString","_await$calendarData","sent","abrupt","stop","Promise","t","queryClient","checkOutlookCredentials","dispatchToastMessage","mutationFn","_context2","invalidateQueries","mutateAsync","onSuccess","type","message","onError","error","Error"],"mappings":"uBAASA,EAAAA,IAAyB,CAAA,6BAA6B,CAAAC,QAAM,SAAAC,CAAA,EAAAC,EAA2BD,CAAA,CAAA,EAAA,GAAhGF,EAAOI,MAAE,CAAA,CAAAC,+BAAyB,WAAgB,OAAaA,CAAM,EAA2BC,uBAAAA,WAAA,OAAAA,CAAA,EAAAC,+BAAAA,WAAA,OAAAA,CAAA,CAAA,GAAAP,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAQ,wBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAV,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAW,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,SAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAb,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAc,kBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAd,EAAAA,IAAAA,CAAAA,6BAAAA,CAAAe,iCAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAMzF,IANPZ,EAAgGK,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAMnFV,EAAiC,WAC7C,OAAOC,EAAuB,IAAIU,KACnC,EAEaV,EAAyB,SAACW,CAAU,EAChD,IAAMC,EAAeR,EAAY,MAAO,4BAExC,OAAOE,EAAS,CAAC,UAAW,WAAY,OAAO,CAAE,WAAA,IAAAO,EAAA,OAAAhB,EAAAiB,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAAA,OAAAF,EAAAE,IAAA,CAAA,EAAApB,EAAAqB,KAAA,CACzBN,EAAa,CAAED,KAAMA,EAAKQ,WAAW,EAAE,GAAG,MAAA,EAArD,OAAJN,EAAIO,AAAqDL,EAAAM,IAAA,CAAzDR,IAAI,CAAAE,EAAAO,MAAA,CAAA,SACLT,EAAI,MAAA,EAAA,IAAA,MAAA,OAAAE,EAAAQ,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,EAEb,EAEavB,EAAiC,WAC7C,IAAMwB,EAAItB,IACJuB,EAAcnB,IAEdoB,EAA0BlB,IAE1BmB,EAAuB1B,IAoB7B,OAlBqBG,EAAY,CAChCwB,WAAY,WAAA,OAAAhC,EAAAiB,KAAA,CAAA,SAAAgB,CAAA,EAAA,OAAA,OAAAA,EAAAd,IAAA,CAAAc,EAAAb,IAAA,EAAA,KAAA,EAAA,OAAAa,EAAAb,IAAA,CAAA,EAAApB,EAAAqB,KAAA,CACLV,IAAmB,MAAA,EAAA,OAAAsB,EAAAb,IAAA,CAAA,EAAApB,EAAAqB,KAAA,CAEnBQ,EAAYK,iBAAiB,CAAC,CAAC,UAAW,WAAY,OAAO,EAAC,MAAA,EAAA,OAAAD,EAAAb,IAAA,CAAA,EAAApB,EAAAqB,KAAA,CAE9DS,EAAwBK,WAAW,GAAE,MAAA,EAAA,IAAA,MAAA,OAAAF,EAAAP,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,EAE5CS,UAAW,WACVL,EAAqB,CAAEM,KAAM,UAAWC,QAASV,EAAE,uBAAuB,EAC3E,EACAW,QAAS,SAACC,CAAK,EACVA,aAAiBC,OAASD,AAAkB,UAAlBA,EAAMF,OAAO,EAG3CP,EAAqB,CAAEM,KAAM,QAASC,QAASV,EAAE,sBAAsB,EACxE,GAGF"}