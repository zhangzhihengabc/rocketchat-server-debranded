)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/outlookCalendar/hooks/useOutlookAuthentication.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useToastMessageDispatch, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\n\nimport { NotOnDesktopError } from '../lib/NotOnDesktopError';\n\nexport const useOutlookAuthentication = () => {\n\tconst {\n\t\tdata: authEnabled,\n\t\tisError,\n\t\terror,\n\t} = useQuery(\n\t\t['outlook', 'auth'],\n\t\tasync () => {\n\t\t\tconst desktopApp = window.RocketChatDesktop;\n\t\t\tif (!desktopApp?.hasOutlookCredentials) {\n\t\t\t\tthrow new NotOnDesktopError();\n\t\t\t}\n\n\t\t\treturn Boolean(await desktopApp?.hasOutlookCredentials?.()) || false;\n\t\t},\n\t\t{\n\t\t\tonError: (error) => {\n\t\t\t\tconsole.error(error);\n\t\t\t},\n\t\t},\n\t);\n\n\treturn { authEnabled: Boolean(authEnabled), isError, error };\n};\n\nexport const useOutlookAuthenticationMutation = () => {\n\tconst queryClient = useQueryClient();\n\treturn useMutation({\n\t\tmutationFn: async () => {\n\t\t\tawait queryClient.invalidateQueries(['outlook', 'auth']);\n\t\t},\n\t});\n};\n\nexport const useOutlookAuthenticationMutationLogout = () => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst mutation = useOutlookAuthenticationMutation();\n\treturn useMutation({\n\t\tmutationFn: async () => {\n\t\t\tconst desktopApp = window.RocketChatDesktop;\n\t\t\tif (!desktopApp?.clearOutlookCredentials) {\n\t\t\t\tthrow new NotOnDesktopError();\n\t\t\t}\n\n\t\t\tawait desktopApp.clearOutlookCredentials();\n\n\t\t\treturn mutation.mutateAsync();\n\t\t},\n\t\tonSuccess: () => {\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Outlook_authentication_disabled') });\n\t\t},\n\t});\n};\n",null],"names":["module","default","v","_regeneratorRuntime","export","useOutlookAuthentication","useOutlookAuthenticationMutation","useOutlookAuthenticationMutationLogout","useToastMessageDispatch","useTranslation","useMutation","useQuery","useQueryClient","NotOnDesktopError","_useQuery","_desktopApp$hasOutloo","desktopApp","async","_context","prev","next","window","RocketChatDesktop","hasOutlookCredentials","t1","Boolean","awrap","call","t2","sent","t0","abrupt","stop","Promise","onError","error","console","authEnabled","data","isError","queryClient","mutationFn","_context2","invalidateQueries","t","dispatchToastMessage","mutation","_context3","clearOutlookCredentials","mutateAsync","onSuccess","type","message"],"mappings":"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"}