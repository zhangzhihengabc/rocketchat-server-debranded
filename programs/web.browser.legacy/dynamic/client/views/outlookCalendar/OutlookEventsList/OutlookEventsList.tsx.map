)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/outlookCalendar/OutlookEventsList/OutlookEventsList.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Box, States, StatesIcon, StatesTitle, StatesSubtitle, ButtonGroup, Button } from '@rocket.chat/fuselage';\nimport { useResizeObserver } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation, useSetting } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React from 'react';\nimport { Virtuoso } from 'react-virtuoso';\n\nimport {\n\tContextualbarHeader,\n\tContextualbarIcon,\n\tContextualbarTitle,\n\tContextualbarClose,\n\tContextualbarContent,\n\tContextualbarFooter,\n\tContextualbarSkeleton,\n} from '../../../components/Contextualbar';\nimport ScrollableContentWrapper from '../../../components/ScrollableContentWrapper';\nimport { getErrorMessage } from '../../../lib/errorHandling';\nimport { useOutlookAuthentication } from '../hooks/useOutlookAuthentication';\nimport { useMutationOutlookCalendarSync, useOutlookCalendarListForToday } from '../hooks/useOutlookCalendarList';\nimport { NotOnDesktopError } from '../lib/NotOnDesktopError';\nimport OutlookEventItem from './OutlookEventItem';\n\ntype OutlookEventsListProps = {\n\tonClose: () => void;\n\tchangeRoute: () => void;\n};\n\nconst OutlookEventsList = ({ onClose, changeRoute }: OutlookEventsListProps): ReactElement => {\n\tconst t = useTranslation();\n\tconst outlookUrl = useSetting<string>('Outlook_Calendar_Outlook_Url');\n\tconst { authEnabled, isError, error } = useOutlookAuthentication();\n\n\tconst hasOutlookMethods = !(isError && error instanceof NotOnDesktopError);\n\n\tconst syncOutlookCalendar = useMutationOutlookCalendarSync();\n\n\tconst calendarListResult = useOutlookCalendarListForToday();\n\n\tconst { ref, contentBoxSize: { inlineSize = 378, blockSize = 1 } = {} } = useResizeObserver<HTMLElement>({\n\t\tdebounceDelay: 200,\n\t});\n\n\tif (calendarListResult.isLoading) {\n\t\treturn <ContextualbarSkeleton />;\n\t}\n\n\tconst calendarEvents = calendarListResult.data;\n\tconst total = calendarEvents?.length || 0;\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarHeader>\n\t\t\t\t<ContextualbarIcon name='calendar' />\n\t\t\t\t<ContextualbarTitle>{t('Outlook_calendar')}</ContextualbarTitle>\n\t\t\t\t<ContextualbarClose onClick={onClose} />\n\t\t\t</ContextualbarHeader>\n\n\t\t\t{hasOutlookMethods && !authEnabled && total === 0 && (\n\t\t\t\t<>\n\t\t\t\t\t<ContextualbarContent paddingInline={0} ref={ref} color='default'>\n\t\t\t\t\t\t<Box display='flex' flexDirection='column' justifyContent='center' height='100%'>\n\t\t\t\t\t\t\t<States>\n\t\t\t\t\t\t\t\t<StatesIcon name='user' />\n\t\t\t\t\t\t\t\t<StatesTitle>{t('Log_in_to_sync')}</StatesTitle>\n\t\t\t\t\t\t\t</States>\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t</ContextualbarContent>\n\t\t\t\t\t<ContextualbarFooter>\n\t\t\t\t\t\t<ButtonGroup mbs={8} stretch>\n\t\t\t\t\t\t\t<Button primary loading={syncOutlookCalendar.isLoading} onClick={() => syncOutlookCalendar.mutate()}>\n\t\t\t\t\t\t\t\t{t('Login')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</ButtonGroup>\n\t\t\t\t\t</ContextualbarFooter>\n\t\t\t\t</>\n\t\t\t)}\n\n\t\t\t{(authEnabled || !hasOutlookMethods) && (\n\t\t\t\t<>\n\t\t\t\t\t<ContextualbarContent paddingInline={0} ref={ref} color='default'>\n\t\t\t\t\t\t{(total === 0 || calendarListResult.isError) && (\n\t\t\t\t\t\t\t<Box display='flex' flexDirection='column' justifyContent='center' height='100%'>\n\t\t\t\t\t\t\t\t{calendarListResult.isError && (\n\t\t\t\t\t\t\t\t\t<States>\n\t\t\t\t\t\t\t\t\t\t<StatesIcon name='circle-exclamation' variation='danger' />\n\t\t\t\t\t\t\t\t\t\t<StatesTitle>{t('Something_went_wrong')}</StatesTitle>\n\t\t\t\t\t\t\t\t\t\t<StatesSubtitle>{getErrorMessage(calendarListResult.error)}</StatesSubtitle>\n\t\t\t\t\t\t\t\t\t</States>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t{!calendarListResult.isError && total === 0 && (\n\t\t\t\t\t\t\t\t\t<States>\n\t\t\t\t\t\t\t\t\t\t<StatesIcon name='calendar' />\n\t\t\t\t\t\t\t\t\t\t<StatesTitle>{t('No_history')}</StatesTitle>\n\t\t\t\t\t\t\t\t\t</States>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{calendarListResult.isSuccess && calendarListResult.data.length > 0 && (\n\t\t\t\t\t\t\t<Box flexGrow={1} flexShrink={1} overflow='hidden' display='flex'>\n\t\t\t\t\t\t\t\t<Virtuoso\n\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\theight: blockSize,\n\t\t\t\t\t\t\t\t\t\twidth: inlineSize,\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\ttotalCount={total}\n\t\t\t\t\t\t\t\t\toverscan={25}\n\t\t\t\t\t\t\t\t\tdata={calendarEvents}\n\t\t\t\t\t\t\t\t\tcomponents={{ Scroller: ScrollableContentWrapper }}\n\t\t\t\t\t\t\t\t\titemContent={(_index, calendarData): ReactElement => <OutlookEventItem {...calendarData} />}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</ContextualbarContent>\n\t\t\t\t\t<ContextualbarFooter>\n\t\t\t\t\t\t<ButtonGroup stretch>\n\t\t\t\t\t\t\t{authEnabled && <Button onClick={changeRoute}>{t('Calendar_settings')}</Button>}\n\t\t\t\t\t\t\t{outlookUrl && (\n\t\t\t\t\t\t\t\t<Button icon='new-window' onClick={() => window.open(outlookUrl, '_blank')}>\n\t\t\t\t\t\t\t\t\t{t('Open_Outlook')}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</ButtonGroup>\n\t\t\t\t\t\t{hasOutlookMethods && (\n\t\t\t\t\t\t\t<ButtonGroup mbs={8} stretch>\n\t\t\t\t\t\t\t\t<Button primary loading={syncOutlookCalendar.isLoading} onClick={() => syncOutlookCalendar.mutate()}>\n\t\t\t\t\t\t\t\t\t{t('Sync')}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</ButtonGroup>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</ContextualbarFooter>\n\t\t\t\t</>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default OutlookEventsList;\n",null],"names":["Box","States","StatesIcon","StatesTitle","StatesSubtitle","ButtonGroup","Button","useResizeObserver","useTranslation","useSetting","React","Virtuoso","ContextualbarHeader","ContextualbarIcon","ContextualbarTitle","ContextualbarClose","ContextualbarContent","ContextualbarFooter","ContextualbarSkeleton","ScrollableContentWrapper","getErrorMessage","useOutlookAuthentication","useMutationOutlookCalendarSync","useOutlookCalendarListForToday","NotOnDesktopError","OutlookEventItem","module","link","v","exportDefault","_ref","onClose","changeRoute","t","outlookUrl","_useOutlookAuthentica","authEnabled","isError","error","hasOutlookMethods","syncOutlookCalendar","calendarListResult","_useResizeObserver","debounceDelay","ref","_useResizeObserver$co","contentBoxSize","_useResizeObserver$co2","inlineSize","_useResizeObserver$co3","blockSize","isLoading","createElement","calendarEvents","data","total","length","Fragment","name","onClick","paddingInline","color","display","flexDirection","justifyContent","height","mbs","stretch","primary","loading","mutate","variation","isSuccess","flexGrow","flexShrink","overflow","style","width","totalCount","overscan","components","Scroller","itemContent","_index","calendarData","icon","window","open"],"mappings":"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"}