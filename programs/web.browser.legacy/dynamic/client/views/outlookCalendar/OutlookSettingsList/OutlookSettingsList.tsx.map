)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/outlookCalendar/OutlookSettingsList/OutlookSettingsList.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { ButtonGroup, Button } from '@rocket.chat/fuselage';\nimport { useTranslation, useUserPreference, useEndpoint, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useCallback } from 'react';\n\nimport {\n\tContextualbarHeader,\n\tContextualbarIcon,\n\tContextualbarTitle,\n\tContextualbarClose,\n\tContextualbarContent,\n\tContextualbarFooter,\n} from '../../../components/Contextualbar';\nimport { useOutlookAuthentication, useOutlookAuthenticationMutationLogout } from '../hooks/useOutlookAuthentication';\nimport OutlookSettingItem from './OutlookSettingItem';\n\ntype OutlookSettingsListProps = {\n\tonClose: () => void;\n\tchangeRoute: () => void;\n};\n\nconst OutlookSettingsList = ({ onClose, changeRoute }: OutlookSettingsListProps): ReactElement => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst saveUserPreferences = useEndpoint('POST', '/v1/users.setPreferences');\n\tconst notifyCalendarEvents = useUserPreference('notifyCalendarEvents') as boolean;\n\tconst { authEnabled } = useOutlookAuthentication();\n\tconst handleDisableAuth = useOutlookAuthenticationMutationLogout();\n\n\tconst handleNotifyCalendarEvents = useCallback(\n\t\t(value: boolean) => {\n\t\t\ttry {\n\t\t\t\tsaveUserPreferences({ data: { notifyCalendarEvents: value } });\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Preferences_saved') });\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t},\n\t\t[saveUserPreferences, dispatchToastMessage, t],\n\t);\n\n\tconst calendarSettings = [\n\t\t{\n\t\t\tid: 'notification',\n\t\t\ttitle: t('Event_notifications'),\n\t\t\tsubTitle: t('Event_notifications_description'),\n\t\t\tenabled: notifyCalendarEvents,\n\t\t\thandleEnable: handleNotifyCalendarEvents,\n\t\t},\n\t\t{\n\t\t\tid: 'authentication',\n\t\t\ttitle: t('Outlook_authentication'),\n\t\t\tsubTitle: t('Outlook_authentication_description'),\n\t\t\tenabled: authEnabled,\n\t\t\thandleEnable: () =>\n\t\t\t\thandleDisableAuth.mutate(undefined, {\n\t\t\t\t\tonSuccess: changeRoute,\n\t\t\t\t}),\n\t\t},\n\t];\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarHeader>\n\t\t\t\t<ContextualbarIcon name='calendar' />\n\t\t\t\t<ContextualbarTitle>{t('Outlook_calendar_settings')}</ContextualbarTitle>\n\t\t\t\t<ContextualbarClose onClick={onClose} />\n\t\t\t</ContextualbarHeader>\n\t\t\t<ContextualbarContent paddingInline={0} color='default'>\n\t\t\t\t{calendarSettings.map((setting, index) => {\n\t\t\t\t\tif (setting.id === 'authentication' && !setting.enabled) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn <OutlookSettingItem key={index} {...setting} />;\n\t\t\t\t})}\n\t\t\t</ContextualbarContent>\n\t\t\t<ContextualbarFooter>\n\t\t\t\t<ButtonGroup stretch>\n\t\t\t\t\t<Button onClick={changeRoute}>{t('Back_to_calendar')}</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</ContextualbarFooter>\n\t\t</>\n\t);\n};\n\nexport default OutlookSettingsList;\n",null],"names":["_extends","ButtonGroup","Button","useTranslation","useUserPreference","useEndpoint","useToastMessageDispatch","React","useCallback","ContextualbarHeader","ContextualbarIcon","ContextualbarTitle","ContextualbarClose","ContextualbarContent","ContextualbarFooter","useOutlookAuthentication","useOutlookAuthenticationMutationLogout","OutlookSettingItem","module","link","default","v","exportDefault","_ref","onClose","changeRoute","t","dispatchToastMessage","saveUserPreferences","notifyCalendarEvents","authEnabled","_useOutlookAuthentica","handleDisableAuth","handleNotifyCalendarEvents","value","data","type","message","error","calendarSettings","id","title","subTitle","enabled","handleEnable","mutate","undefined","onSuccess","createElement","Fragment","name","onClick","paddingInline","color","map","setting","index","key","stretch"],"mappings":"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"}