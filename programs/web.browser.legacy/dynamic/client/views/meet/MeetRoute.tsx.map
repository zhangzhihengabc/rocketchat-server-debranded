)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/meet/MeetRoute.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useEndpoint, useRouter, useSearchParameter, useToastMessageDispatch, useUserId } from '@rocket.chat/ui-contexts';\nimport { useQuery } from '@tanstack/react-query';\nimport React from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport { VisitorDoesNotExistError } from '../../lib/errors/VisitorDoesNotExistError';\nimport PageLoading from '../root/PageLoading';\nimport MeetPage from './MeetPage';\n\nconst MeetRoute = () => {\n\tconst router = useRouter();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst { t } = useTranslation();\n\n\tconst uid = useUserId();\n\tconst token = useSearchParameter('token') ?? '';\n\tconst getVisitorByToken = useEndpoint('GET', '/v1/livechat/visitor/:token', { token });\n\n\tconst { data: hasVisitor } = useQuery(\n\t\t['meet', { token }],\n\t\tasync () => {\n\t\t\tif (token) {\n\t\t\t\tconst result = await getVisitorByToken();\n\t\t\t\tif ('visitor' in result) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tthrow new VisitorDoesNotExistError();\n\t\t\t}\n\n\t\t\tif (!uid) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\t{\n\t\t\tonSuccess: (hasVisitor) => {\n\t\t\t\tif (hasVisitor === false) {\n\t\t\t\t\trouter.navigate('/home');\n\t\t\t\t}\n\t\t\t},\n\t\t\tonError: (error) => {\n\t\t\t\tif (error instanceof VisitorDoesNotExistError) {\n\t\t\t\t\tdispatchToastMessage({ type: 'error', message: t('core.Visitor_does_not_exist') });\n\t\t\t\t\trouter.navigate('/home');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t\trouter.navigate('/home');\n\t\t\t},\n\t\t},\n\t);\n\n\tif (!hasVisitor) {\n\t\treturn <PageLoading />;\n\t}\n\n\treturn <MeetPage />;\n};\n\nexport default MeetRoute;\n",null],"names":["_regeneratorRuntime","useEndpoint","useRouter","useSearchParameter","useToastMessageDispatch","useUserId","useQuery","React","useTranslation","VisitorDoesNotExistError","PageLoading","MeetPage","module","link","default","v","exportDefault","_useSearchParameter","router","dispatchToastMessage","t","_useTranslation","uid","token","getVisitorByToken","_useQuery","async","_context","prev","next","awrap","sent","result","abrupt","stop","Promise","onSuccess","hasVisitor","navigate","onError","error","type","message","data","createElement"],"mappings":"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"}