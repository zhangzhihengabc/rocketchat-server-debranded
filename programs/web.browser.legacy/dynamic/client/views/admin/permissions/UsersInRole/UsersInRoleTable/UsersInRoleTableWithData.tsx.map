)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/permissions/UsersInRole/UsersInRoleTable/UsersInRoleTableWithData.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IRole, IRoom, IUserInRole } from '@rocket.chat/core-typings';\nimport { useEndpoint, useToastMessageDispatch, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useQuery } from '@tanstack/react-query';\nimport type { ReactElement, MutableRefObject } from 'react';\nimport React, { useEffect, useMemo } from 'react';\n\nimport { usePagination } from '../../../../../components/GenericTable/hooks/usePagination';\nimport UsersInRoleTable from './UsersInRoleTable';\n\ntype UsersInRoleTableWithDataProps = {\n\trid?: IRoom['_id'];\n\troleId: IRole['_id'];\n\troleName: IRole['name'];\n\tdescription: IRole['description'];\n\treloadRef: MutableRefObject<() => void>;\n};\n\nconst UsersInRoleTableWithData = ({\n\trid,\n\troleId,\n\troleName,\n\tdescription,\n\treloadRef,\n}: UsersInRoleTableWithDataProps): ReactElement | null => {\n\tconst { itemsPerPage, current, ...paginationData } = usePagination();\n\tconst t = useTranslation();\n\n\tconst query = useMemo(\n\t\t() => ({\n\t\t\trole: roleId,\n\t\t\t...(rid && { roomId: rid }),\n\t\t\t...(itemsPerPage && { count: itemsPerPage }),\n\t\t\t...(current && { offset: current }),\n\t\t}),\n\t\t[itemsPerPage, current, rid, roleId],\n\t);\n\n\tconst getUsersInRole = useEndpoint('GET', '/v1/roles.getUsersInRole');\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst { refetch, ...result } = useQuery(\n\t\t['roles', roleId, 'users', query],\n\t\tasync () => {\n\t\t\tconst { users } = await getUsersInRole(query);\n\n\t\t\tif (users.length === 0) {\n\t\t\t\tthrow new Error(t('No_results_found'));\n\t\t\t}\n\t\t\treturn users;\n\t\t},\n\t\t{\n\t\t\tonError: (error) => {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t},\n\t\t},\n\t);\n\n\tuseEffect(() => {\n\t\treloadRef.current = refetch;\n\t}, [refetch, reloadRef]);\n\n\tif (result.isLoading || result.error || !result.data) {\n\t\treturn null;\n\t}\n\n\tconst users: IUserInRole[] = result.data.map((user) => ({\n\t\t...user,\n\t\tcreatedAt: new Date(user.createdAt),\n\t\t_updatedAt: new Date(user._updatedAt),\n\t}));\n\n\treturn (\n\t\t<UsersInRoleTable\n\t\t\tusers={users}\n\t\t\ttotal={result.data.length}\n\t\t\treload={refetch}\n\t\t\troleName={roleName}\n\t\t\troleId={roleId}\n\t\t\tdescription={description}\n\t\t\trid={rid}\n\t\t\tpaginationData={{ itemsPerPage, current, ...paginationData }}\n\t\t/>\n\t);\n};\n\nexport default UsersInRoleTableWithData;\n",null],"names":["_regeneratorRuntime","_objectSpread","_objectWithoutProperties","useEndpoint","useToastMessageDispatch","useTranslation","useQuery","React","useEffect","useMemo","usePagination","UsersInRoleTable","module","default","v","link","exportDefault","_ref","rid","roleId","roleName","description","reloadRef","_usePagination","itemsPerPage","current","paginationData","_excluded","t","query","role","roomId","count","offset","getUsersInRole","dispatchToastMessage","_useQuery","users","async","_context","prev","next","awrap","_await$getUsersInRole","sent","length","Error","abrupt","stop","Promise","onError","error","type","message","refetch","result","_excluded2","isLoading","data","map","user","createdAt","Date","_updatedAt","createElement","total","reload"],"mappings":"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"}