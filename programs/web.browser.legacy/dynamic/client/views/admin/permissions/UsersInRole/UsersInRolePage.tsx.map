)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/permissions/UsersInRole/UsersInRolePage.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IRole, IRoom } from '@rocket.chat/core-typings';\nimport { Box, Field, FieldLabel, FieldRow, Margins, ButtonGroup, Button, Callout } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useToastMessageDispatch, useRoute, useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useRef } from 'react';\nimport { useForm, Controller } from 'react-hook-form';\n\nimport Page from '../../../../components/Page';\nimport RoomAutoComplete from '../../../../components/RoomAutoComplete';\nimport UserAutoCompleteMultiple from '../../../../components/UserAutoCompleteMultiple';\nimport UsersInRoleTable from './UsersInRoleTable';\n\ntype UsersInRolePayload = {\n\trid?: IRoom['_id'];\n\tusers: string[];\n};\n\nconst UsersInRolePage = ({ role }: { role: IRole }): ReactElement => {\n\tconst t = useTranslation();\n\tconst reload = useRef<() => void>(() => undefined);\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst {\n\t\tcontrol,\n\t\thandleSubmit,\n\t\tformState: { isDirty },\n\t\treset,\n\t\tgetValues,\n\t} = useForm<UsersInRolePayload>({ defaultValues: { users: [] } });\n\n\tconst { _id, name, description } = role;\n\tconst router = useRoute('admin-permissions');\n\tconst addUser = useEndpoint('POST', '/v1/roles.addUserToRole');\n\n\tconst rid = getValues('rid');\n\n\tconst handleReturn = useMutableCallback(() => {\n\t\trouter.push({\n\t\t\tcontext: 'edit',\n\t\t\t_id,\n\t\t});\n\t});\n\n\tconst handleAdd = useMutableCallback(async ({ users, rid }: UsersInRolePayload) => {\n\t\ttry {\n\t\t\tawait Promise.all(\n\t\t\t\tusers.map(async (user) => {\n\t\t\t\t\tif (user) {\n\t\t\t\t\t\tawait addUser({ roleName: _id, username: user, roomId: rid });\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Users_added') });\n\t\t\treload.current();\n\t\t\treset();\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\treturn (\n\t\t<Page>\n\t\t\t<Page.Header title={`${t('Users_in_role')} \"${description || name}\"`}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t<Button onClick={handleReturn}>{t('Back')}</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Header>\n\t\t\t<Page.Content>\n\t\t\t\t<Box display='flex' flexDirection='column' w='full' mi='neg-x4'>\n\t\t\t\t\t<Margins inline={4}>\n\t\t\t\t\t\t{role.scope !== 'Users' && (\n\t\t\t\t\t\t\t<Field mbe={4}>\n\t\t\t\t\t\t\t\t<FieldLabel>{t('Choose_a_room')}</FieldLabel>\n\t\t\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t\t\t<Controller\n\t\t\t\t\t\t\t\t\t\tcontrol={control}\n\t\t\t\t\t\t\t\t\t\tname='rid'\n\t\t\t\t\t\t\t\t\t\trender={({ field: { onChange, value } }): ReactElement => (\n\t\t\t\t\t\t\t\t\t\t\t<RoomAutoComplete value={value} onChange={onChange} placeholder={t('User')} />\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<FieldLabel>{t('Add_users')}</FieldLabel>\n\t\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t\t<Controller\n\t\t\t\t\t\t\t\t\tcontrol={control}\n\t\t\t\t\t\t\t\t\tname='users'\n\t\t\t\t\t\t\t\t\trender={({ field: { onChange, value } }): ReactElement => (\n\t\t\t\t\t\t\t\t\t\t<UserAutoCompleteMultiple value={value} placeholder={t('User')} onChange={onChange} />\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<ButtonGroup mis={8} align='end'>\n\t\t\t\t\t\t\t\t\t<Button primary onClick={handleSubmit(handleAdd)} disabled={!isDirty}>\n\t\t\t\t\t\t\t\t\t\t{t('Add')}\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t</ButtonGroup>\n\t\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t</Margins>\n\t\t\t\t</Box>\n\t\t\t\t<Margins blockStart={8}>\n\t\t\t\t\t{(role.scope === 'Users' || rid) && (\n\t\t\t\t\t\t<UsersInRoleTable reloadRef={reload} rid={rid} roleId={_id} roleName={name} description={description} />\n\t\t\t\t\t)}\n\t\t\t\t\t{role.scope !== 'Users' && !rid && <Callout type='info'>{t('Select_a_room')}</Callout>}\n\t\t\t\t</Margins>\n\t\t\t</Page.Content>\n\t\t</Page>\n\t);\n};\n\nexport default UsersInRolePage;\n",null],"names":["_regeneratorRuntime","Box","Field","FieldLabel","FieldRow","Margins","ButtonGroup","Button","Callout","useMutableCallback","useToastMessageDispatch","useRoute","useEndpoint","useTranslation","React","useRef","useForm","Controller","Page","RoomAutoComplete","UserAutoCompleteMultiple","UsersInRoleTable","module","link","default","v","exportDefault","_ref","role","t","reload","dispatchToastMessage","_useForm","defaultValues","users","control","handleSubmit","isDirty","formState","reset","getValues","_id","name","description","router","addUser","rid","handleReturn","push","context","handleAdd","_ref2","async","_context2","prev","next","awrap","Promise","all","map","_callee","user","_callee$","_context","roleName","username","roomId","stop","type","message","current","t0","createElement","Header","title","onClick","Content","display","flexDirection","w","mi","inline","scope","mbe","render","_ref3","_ref3$field","field","onChange","value","placeholder","_ref4","_ref4$field","mis","align","primary","disabled","blockStart","reloadRef","roleId"],"mappings":"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"}