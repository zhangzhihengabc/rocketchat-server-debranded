)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/permissions/PermissionsTable/PermissionsTable.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Margins, Tabs, Button, Pagination } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useRoute, usePermission, useMethod, useTranslation, useSetModal } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useState } from 'react';\n\nimport GenericNoResults from '../../../../components/GenericNoResults';\nimport { GenericTable, GenericTableHeader, GenericTableHeaderCell, GenericTableBody } from '../../../../components/GenericTable';\nimport { usePagination } from '../../../../components/GenericTable/hooks/usePagination';\nimport Page from '../../../../components/Page';\nimport CustomRoleUpsellModal from '../CustomRoleUpsellModal';\nimport PermissionsContextBar from '../PermissionsContextBar';\nimport { usePermissionsAndRoles } from '../hooks/usePermissionsAndRoles';\nimport PermissionRow from './PermissionRow';\nimport PermissionsTableFilter from './PermissionsTableFilter';\nimport RoleHeader from './RoleHeader';\n\nconst PermissionsTable = ({ isEnterprise }: { isEnterprise: boolean }): ReactElement => {\n\tconst t = useTranslation();\n\tconst [filter, setFilter] = useState('');\n\tconst canViewPermission = usePermission('access-permissions');\n\tconst canViewSettingPermission = usePermission('access-setting-permissions');\n\tconst defaultType = canViewPermission ? 'permissions' : 'settings';\n\tconst [type, setType] = useState(defaultType);\n\tconst router = useRoute('admin-permissions');\n\tconst setModal = useSetModal();\n\n\tconst grantRole = useMethod('authorization:addPermissionToRole');\n\tconst removeRole = useMethod('authorization:removeRoleFromPermission');\n\n\tconst { current, itemsPerPage, setItemsPerPage: onSetItemsPerPage, setCurrent: onSetCurrent, ...paginationProps } = usePagination();\n\tconst { permissions, total, roleList } = usePermissionsAndRoles(type, filter, itemsPerPage, current);\n\n\tconst handlePermissionsTab = useMutableCallback(() => {\n\t\tif (type === 'permissions') {\n\t\t\treturn;\n\t\t}\n\t\tsetType('permissions');\n\t});\n\n\tconst handleSettingsTab = useMutableCallback(() => {\n\t\tif (type === 'settings') {\n\t\t\treturn;\n\t\t}\n\t\tsetType('settings');\n\t});\n\n\tconst handleAdd = useMutableCallback(() => {\n\t\tif (!isEnterprise) {\n\t\t\tsetModal(<CustomRoleUpsellModal onClose={() => setModal(null)} />);\n\t\t\treturn;\n\t\t}\n\t\trouter.push({\n\t\t\tcontext: 'new',\n\t\t});\n\t});\n\n\treturn (\n\t\t<Page flexDirection='row'>\n\t\t\t<Page>\n\t\t\t\t<Page.Header title={t('Permissions')}>\n\t\t\t\t\t<Button primary onClick={handleAdd} aria-label={t('New')} name={t('New_role')}>\n\t\t\t\t\t\t{t('New_role')}\n\t\t\t\t\t</Button>\n\t\t\t\t</Page.Header>\n\t\t\t\t<Margins blockEnd={16}>\n\t\t\t\t\t<Tabs>\n\t\t\t\t\t\t<Tabs.Item\n\t\t\t\t\t\t\tdata-qa='PermissionTable-Permissions'\n\t\t\t\t\t\t\tselected={type === 'permissions'}\n\t\t\t\t\t\t\tonClick={handlePermissionsTab}\n\t\t\t\t\t\t\tdisabled={!canViewPermission}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{t('Permissions')}\n\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t\t<Tabs.Item\n\t\t\t\t\t\t\tdata-qa='PermissionTable-Settings'\n\t\t\t\t\t\t\tselected={type === 'settings'}\n\t\t\t\t\t\t\tonClick={handleSettingsTab}\n\t\t\t\t\t\t\tdisabled={!canViewSettingPermission}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{t('Settings')}\n\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t</Tabs>\n\t\t\t\t</Margins>\n\t\t\t\t<Page.Content mb='neg-x8'>\n\t\t\t\t\t<Margins block={8}>\n\t\t\t\t\t\t<PermissionsTableFilter onChange={setFilter} />\n\t\t\t\t\t\t{permissions?.length === 0 && <GenericNoResults />}\n\t\t\t\t\t\t{permissions?.length > 0 && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<GenericTable fixed={false}>\n\t\t\t\t\t\t\t\t\t<GenericTableHeader>\n\t\t\t\t\t\t\t\t\t\t<GenericTableHeaderCell width='x120'>{t('Name')}</GenericTableHeaderCell>\n\t\t\t\t\t\t\t\t\t\t{roleList?.map(({ _id, name, description }) => (\n\t\t\t\t\t\t\t\t\t\t\t<RoleHeader key={_id} _id={_id} name={name} description={description} />\n\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t</GenericTableHeader>\n\t\t\t\t\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t\t\t\t\t{permissions?.map((permission) => (\n\t\t\t\t\t\t\t\t\t\t\t<PermissionRow\n\t\t\t\t\t\t\t\t\t\t\t\tkey={permission._id}\n\t\t\t\t\t\t\t\t\t\t\t\tpermission={permission}\n\t\t\t\t\t\t\t\t\t\t\t\troleList={roleList}\n\t\t\t\t\t\t\t\t\t\t\t\tonGrant={grantRole}\n\t\t\t\t\t\t\t\t\t\t\t\tonRemove={removeRole}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t</GenericTableBody>\n\t\t\t\t\t\t\t\t</GenericTable>\n\t\t\t\t\t\t\t\t<Pagination\n\t\t\t\t\t\t\t\t\tdivider\n\t\t\t\t\t\t\t\t\tcurrent={current}\n\t\t\t\t\t\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\t\t\t\t\t\tcount={total}\n\t\t\t\t\t\t\t\t\tonSetItemsPerPage={onSetItemsPerPage}\n\t\t\t\t\t\t\t\t\tonSetCurrent={onSetCurrent}\n\t\t\t\t\t\t\t\t\t{...paginationProps}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Margins>\n\t\t\t\t</Page.Content>\n\t\t\t</Page>\n\t\t\t<PermissionsContextBar />\n\t\t</Page>\n\t);\n};\n\nexport default PermissionsTable;\n",null],"names":["_extends","_objectWithoutProperties","_slicedToArray","Margins","Tabs","Button","Pagination","useMutableCallback","useRoute","usePermission","useMethod","useTranslation","useSetModal","React","useState","GenericNoResults","GenericTable","GenericTableHeader","GenericTableHeaderCell","GenericTableBody","usePagination","Page","CustomRoleUpsellModal","PermissionsContextBar","usePermissionsAndRoles","PermissionRow","PermissionsTableFilter","RoleHeader","module","link","default","v","exportDefault","_ref","isEnterprise","t","_useState2","filter","setFilter","canViewPermission","canViewSettingPermission","_useState4","type","setType","router","setModal","grantRole","removeRole","_usePagination","current","itemsPerPage","onSetItemsPerPage","setItemsPerPage","onSetCurrent","setCurrent","paginationProps","_excluded","_usePermissionsAndRol","permissions","total","roleList","handlePermissionsTab","handleSettingsTab","handleAdd","createElement","onClose","push","context","flexDirection","Header","title","primary","onClick","name","blockEnd","Item","selected","disabled","Content","mb","block","onChange","length","Fragment","fixed","width","map","_ref2","_id","description","key","permission","onGrant","onRemove","divider","count"],"mappings":"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"}