)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/permissions/EditRolePage.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IRole } from '@rocket.chat/core-typings';\nimport { Box, ButtonGroup, Button, Margins } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useSetModal, useToastMessageDispatch, useRoute, useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React from 'react';\nimport { FormProvider, useForm } from 'react-hook-form';\n\nimport { ContextualbarFooter, ContextualbarScrollableContent } from '../../../components/Contextualbar';\nimport GenericModal from '../../../components/GenericModal';\nimport RoleForm from './RoleForm';\n\nconst EditRolePage = ({ role, isEnterprise }: { role?: IRole; isEnterprise: boolean }): ReactElement => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst setModal = useSetModal();\n\tconst usersInRoleRouter = useRoute('admin-permissions');\n\tconst router = useRoute('admin-permissions');\n\n\tconst createRole = useEndpoint('POST', '/v1/roles.create');\n\tconst updateRole = useEndpoint('POST', '/v1/roles.update');\n\tconst deleteRole = useEndpoint('POST', '/v1/roles.delete');\n\n\tconst methods = useForm({\n\t\tdefaultValues: {\n\t\t\troleId: role?._id,\n\t\t\tname: role?.name,\n\t\t\tdescription: role?.description,\n\t\t\tscope: role?.scope || 'Users',\n\t\t\tmandatory2fa: !!role?.mandatory2fa,\n\t\t},\n\t});\n\n\tconst handleManageUsers = useMutableCallback(() => {\n\t\tif (role?._id) {\n\t\t\tusersInRoleRouter.push({\n\t\t\t\tcontext: 'users-in-role',\n\t\t\t\t_id: role._id,\n\t\t\t});\n\t\t}\n\t});\n\n\tconst handleSave = useMutableCallback(async (data) => {\n\t\ttry {\n\t\t\tif (data.roleId) {\n\t\t\t\tawait updateRole(data);\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\t\treturn router.push({});\n\t\t\t}\n\n\t\t\tawait createRole(data);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\trouter.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst handleDelete = useMutableCallback(async () => {\n\t\tif (!role?._id) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst deleteRoleAction = async (): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tawait deleteRole({ roleId: role._id });\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Role_removed') });\n\t\t\t\tsetModal();\n\n\t\t\t\trouter.push({});\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t\tsetModal();\n\t\t\t}\n\t\t};\n\n\t\tconst deleteRoleMessage = isEnterprise ? t('Delete_Role_Warning') : t('Delete_Role_Warning_Not_Enterprise');\n\n\t\tsetModal(\n\t\t\t<GenericModal\n\t\t\t\tvariant='danger'\n\t\t\t\tonConfirm={deleteRoleAction}\n\t\t\t\tonClose={(): void => setModal()}\n\t\t\t\tonCancel={(): void => setModal()}\n\t\t\t\tconfirmText={t('Delete')}\n\t\t\t>\n\t\t\t\t{deleteRoleMessage}\n\t\t\t</GenericModal>,\n\t\t);\n\t});\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarScrollableContent>\n\t\t\t\t<Box w='full' alignSelf='center' mb='neg-x8'>\n\t\t\t\t\t<Margins block={8}>\n\t\t\t\t\t\t<FormProvider {...methods}>\n\t\t\t\t\t\t\t<RoleForm editing={Boolean(role?._id)} isProtected={role?.protected} isDisabled={!isEnterprise} />\n\t\t\t\t\t\t</FormProvider>\n\t\t\t\t\t</Margins>\n\t\t\t\t</Box>\n\t\t\t</ContextualbarScrollableContent>\n\t\t\t<ContextualbarFooter>\n\t\t\t\t<ButtonGroup vertical stretch>\n\t\t\t\t\t<Button primary disabled={!methods.formState.isDirty || !isEnterprise} onClick={methods.handleSubmit(handleSave)}>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t{!role?.protected && role?._id && (\n\t\t\t\t\t\t<Button secondary danger onClick={handleDelete}>\n\t\t\t\t\t\t\t{t('Delete')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t{role?._id && <Button onClick={handleManageUsers}>{t('Users_in_role')}</Button>}\n\t\t\t\t</ButtonGroup>\n\t\t\t</ContextualbarFooter>\n\t\t</>\n\t);\n};\n\nexport default EditRolePage;\n",null],"names":["_regeneratorRuntime","Box","ButtonGroup","Button","Margins","useMutableCallback","useSetModal","useToastMessageDispatch","useRoute","useEndpoint","useTranslation","React","FormProvider","useForm","ContextualbarFooter","ContextualbarScrollableContent","GenericModal","RoleForm","module","link","default","v","exportDefault","_ref","role","isEnterprise","t","dispatchToastMessage","setModal","usersInRoleRouter","router","createRole","updateRole","deleteRole","methods","defaultValues","roleId","_id","name","description","scope","mandatory2fa","handleManageUsers","push","context","handleSave","data","async","_context","prev","next","awrap","type","message","abrupt","t0","stop","Promise","handleDelete","deleteRoleAction","deleteRoleMessage","_context3","_callee2","_callee2$","_context2","createElement","variant","onConfirm","onClose","onCancel","confirmText","Fragment","w","alignSelf","mb","block","editing","Boolean","isProtected","protected","isDisabled","vertical","stretch","primary","disabled","formState","isDirty","onClick","handleSubmit","secondary","danger"],"mappings":"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"}