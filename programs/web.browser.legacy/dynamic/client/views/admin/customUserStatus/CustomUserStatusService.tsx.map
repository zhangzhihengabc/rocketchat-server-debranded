)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/customUserStatus/CustomUserStatusService.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import {\n\tBox,\n\tButton,\n\tButtonGroup,\n\tCallout,\n\tMargins,\n\tProgressBar,\n\tSkeleton,\n\tStatesAction,\n\tStatesIcon,\n\tStatesSubtitle,\n\tToggleSwitch,\n} from '@rocket.chat/fuselage';\nimport { useEndpoint, useSetting } from '@rocket.chat/ui-contexts';\nimport { useMutation } from '@tanstack/react-query';\nimport React from 'react';\nimport { Trans, useTranslation } from 'react-i18next';\n\nimport { ContextualbarContent, ContextualbarFooter } from '../../../components/Contextualbar';\nimport { useIsEnterprise } from '../../../hooks/useIsEnterprise';\nimport { useActiveConnections } from '../../hooks/useActiveConnections';\n\nconst CustomUserStatusService = () => {\n\tconst { t } = useTranslation();\n\tconst result = useActiveConnections();\n\tconst presenceDisabled = useSetting<boolean>('Presence_broadcast_disabled');\n\tconst togglePresenceServiceEndpoint = useEndpoint('POST', '/v1/presence.enableBroadcast');\n\tconst disablePresenceService = useMutation(() => togglePresenceServiceEndpoint());\n\tconst { data: license, isLoading: licenseIsLoading } = useIsEnterprise();\n\n\tif (result.isLoading || disablePresenceService.isLoading || licenseIsLoading) {\n\t\treturn (\n\t\t\t<Box pi={16} pb={8}>\n\t\t\t\t<Skeleton />\n\t\t\t\t<Skeleton />\n\t\t\t\t<Skeleton />\n\t\t\t\t<Skeleton />\n\t\t\t\t<Skeleton />\n\t\t\t</Box>\n\t\t);\n\t}\n\tif (result.isError || disablePresenceService.isError) {\n\t\treturn (\n\t\t\t<Box display='flex' flexDirection='column' alignItems='center' pb={20} color='default'>\n\t\t\t\t<StatesIcon name='circle-exclamation' />\n\t\t\t\t<StatesSubtitle>{t('Unable_to_load_active_connections')}</StatesSubtitle>\n\t\t\t\t<StatesAction icon='reload' onClick={() => result.refetch()}>\n\t\t\t\t\t{t('Retry')}\n\t\t\t\t</StatesAction>\n\t\t\t</Box>\n\t\t);\n\t}\n\n\tconst { current, max, percentage } = result.data;\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarContent display='flex' flexDirection='column' justifyContent='space-between' color='default'>\n\t\t\t\t<div>\n\t\t\t\t\t<Box display='flex' justifyContent='space-between' mb={16}>\n\t\t\t\t\t\t<Box fontScale='p1'>{t('Service_status')}</Box>\n\t\t\t\t\t\t<ToggleSwitch\n\t\t\t\t\t\t\tdisabled={disablePresenceService.isLoading || !presenceDisabled || percentage === 100}\n\t\t\t\t\t\t\tchecked={!presenceDisabled}\n\t\t\t\t\t\t\tonChange={() => disablePresenceService.mutate()}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Box>\n\t\t\t\t\t<Box display='flex' fontScale='c1' justifyContent='space-between' mb={16}>\n\t\t\t\t\t\t<Box>{t('Active_connections')}</Box>\n\t\t\t\t\t\t<Box>{license?.isEnterprise ? current : `${current}/${max}`}</Box>\n\t\t\t\t\t</Box>\n\t\t\t\t\t{!license?.isEnterprise && <ProgressBar percentage={percentage} variant={percentage > 80 ? 'danger' : 'success'} />}\n\t\t\t\t\t{presenceDisabled && (\n\t\t\t\t\t\t<Margins block={16}>\n\t\t\t\t\t\t\t<Callout type='danger' title={t('Service_disabled')}>\n\t\t\t\t\t\t\t\t{t('Service_disabled_description')}\n\t\t\t\t\t\t\t</Callout>\n\t\t\t\t\t\t</Margins>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t\t<Box display='flex' flexDirection='column' mb={16}>\n\t\t\t\t\t{license?.isEnterprise ? (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<Box fontScale='p2' mb={8}>\n\t\t\t\t\t\t\t\t{t('Premium_cap_description')}\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t<Box fontScale='p2' mb={8}>\n\t\t\t\t\t\t\t\t<Trans i18nKey='Larger_amounts_of_active_connections'>\n\t\t\t\t\t\t\t\t\tFor larger amounts of active connections you can consider our\n\t\t\t\t\t\t\t\t\t<Box is='a' href='https://docs.rocket.chat/deploy/scaling-rocket.chat' target='_blank' color='info'>\n\t\t\t\t\t\t\t\t\t\tmultiple instance solutions\n\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t.\n\t\t\t\t\t\t\t\t</Trans>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<Box fontScale='p2' mb={8}>\n\t\t\t\t\t\t\t\t{t('Community_cap_description')}\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t<Box fontScale='p2' mb={8}>\n\t\t\t\t\t\t\t\t{t('Premium_cap_description')}\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t</Box>\n\t\t\t</ContextualbarContent>\n\t\t\t{!license?.isEnterprise && (\n\t\t\t\t<ContextualbarFooter borderBlockStartWidth='default' borderBlockColor='extra-light'>\n\t\t\t\t\t<ButtonGroup stretch vertical>\n\t\t\t\t\t\t<Button primary width='100%' is='a' href='https://www.rocket.chat/enterprise' target='_blank'>\n\t\t\t\t\t\t\t{t('More_about_Premium_plans')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</ButtonGroup>\n\t\t\t\t</ContextualbarFooter>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default CustomUserStatusService;\n",null],"names":["Box","Button","ButtonGroup","Callout","Margins","ProgressBar","Skeleton","StatesAction","StatesIcon","StatesSubtitle","ToggleSwitch","useEndpoint","useSetting","useMutation","React","Trans","useTranslation","ContextualbarContent","ContextualbarFooter","useIsEnterprise","useActiveConnections","module","link","v","exportDefault","t","_useTranslation","result","presenceDisabled","togglePresenceServiceEndpoint","disablePresenceService","_useIsEnterprise","license","data","licenseIsLoading","isLoading","createElement","pi","pb","isError","display","flexDirection","alignItems","color","name","icon","onClick","refetch","_result$data","current","max","percentage","Fragment","justifyContent","mb","fontScale","disabled","checked","onChange","mutate","isEnterprise","variant","block","type","title","i18nKey","is","href","target","borderBlockStartWidth","borderBlockColor","stretch","vertical","primary","width"],"mappings":"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"}