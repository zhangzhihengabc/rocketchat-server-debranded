function module(e,t,n){var r,a,o,i,s,c,u,l,p,m,d,f,g,k,v,E,_,y,h,b;n.link("@babel/runtime/regenerator",{default:function(e){r=e}},0),n.link("@rocket.chat/fuselage",{Box:function(e){a=e},Margins:function(e){o=e},ProgressBar:function(e){i=e},Throbber:function(e){s=e}},0),n.link("@rocket.chat/fuselage-hooks",{useMutableCallback:function(e){c=e}},1),n.link("@rocket.chat/ui-contexts",{useToastMessageDispatch:function(e){u=e},useEndpoint:function(e){l=e},useTranslation:function(e){p=e},useStream:function(e){m=e},useRouter:function(e){d=e}},2),n.link("@tanstack/react-query",{useQuery:function(e){f=e},useMutation:function(e){g=e},useQueryClient:function(e){k=e}},3),n.link("react",{default:function(e){v=e},useEffect:function(e){E=e}},4),n.link("../../../../app/importer/lib/ImporterProgressStep",{ImportingStartedStates:function(e){_=e}},5),n.link("../../../../lib/utils/stringUtils",{numberFormat:function(e){y=e}},6),n.link("../../../components/Page",{default:function(e){h=e}},7),n.link("./useErrorHandler",{useErrorHandler:function(e){b=e}},8),n.exportDefault(function(){var e=k(),t=m("importers"),n=p(),S=u(),I=b(),x=d(),w=l("GET","/v1/getCurrentImportOperation"),C=l("GET","/v1/getImportProgress"),P=g({mutationFn:function(t){return r.async(function(n){for(;;)switch(n.prev=n.next){case 0:e.setQueryData(["importers","progress"],t);case 1:case"end":return n.stop()}},null,null,null,Promise)}}),T=f(["ImportProgressPage","currentOperation"],function(){var e;return r.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.awrap(w());case 2:return e=t.sent.operation,t.abrupt("return",e);case 5:case"end":return t.stop()}},null,null,null,Promise)},{refetchInterval:1e3,onSuccess:function(e){var t=e.valid,r=e.status;if(!t){x.navigate("/admin/import");return}if("importer_done"===r){S({type:"success",message:n("Importer_done")}),x.navigate("/admin/import");return}_.includes(r)||x.navigate("/admin/import/prepare")},onError:function(e){I(e,n("Failed_To_Load_Import_Data")),x.navigate("/admin/import")}}),D=c(function(e){var t=e.key,r=e.step,a=e.completed,o=e.total;if(T.isSuccess&&t.toLowerCase()===T.data.importerKey.toLowerCase()){var i=r[0].toUpperCase()+r.slice(1);switch(r){case"importer_done":n.has(i)&&S({type:"success",message:n(i)}),x.navigate("/admin/import");return;case"importer_import_failed":case"importer_import_cancelled":n.has(i)&&I(i),x.navigate("/admin/import");return;default:P.mutate({step:r,completed:a,total:o})}}}),L=f(["importers","progress"],function(){var e,t,n,a,o,i,s,c;return r.async(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,r.awrap(C());case 2:return t=(e=u.sent).key,n=e.step,i=void 0===(o=(a=void 0===(a=e.count)?{}:a).completed)?0:o,c=void 0===(s=a.total)?0:s,u.abrupt("return",{key:t,step:n,completed:i,total:c});case 9:case"end":return u.stop()}},null,null,null,Promise)},{enabled:!!T.isSuccess,onSuccess:function(e){if(!e){S({type:"warning",message:n("Importer_not_in_progress")}),x.navigate("/admin/import/prepare");return}_.includes(e.step)||D({key:e.key,step:e.step,total:e.total,completed:e.completed})},onError:function(e){I(e,n("Failed_To_Load_Import_Data")),x.navigate("/admin/import")}});return E(function(){return t("progress",function(e){"rate"in e||D({key:e.key,step:e.step,completed:e.count.completed,total:e.count.total})})},[D,t]),v.createElement(h,null,v.createElement(h.Header,{title:n("Importing_Data")}),v.createElement(h.ScrollableContentWithShadow,null,v.createElement(a,{marginInline:"auto",marginBlock:"neg-x24",width:"full",maxWidth:"x580"},v.createElement(o,{block:24},T.isLoading&&v.createElement(s,{justifyContent:"center"}),"idle"!==L.fetchStatus&&L.isLoading&&v.createElement(s,{justifyContent:"center"}),(T.isError||L.isError)&&v.createElement(a,{is:"p"},n("Failed_To_Load_Import_Data")),L.isSuccess&&v.createElement(v.Fragment,null,v.createElement(a,{is:"p",fontScale:"p2"},n(L.data.step[0].toUpperCase()+L.data.step.slice(1))),v.createElement(a,{display:"flex",justifyContent:"center"},v.createElement(i,{percentage:L.data.completed/L.data.total*100}),v.createElement(a,{is:"span",fontScale:"p2",mis:24},y(L.data.completed/L.data.total*100,0),"%")))))))})}
//# sourceMappingURL=/dynamic/client/views/admin/import/b3339c75b323cf5a05bc825d7d9822faacb3f888.map
