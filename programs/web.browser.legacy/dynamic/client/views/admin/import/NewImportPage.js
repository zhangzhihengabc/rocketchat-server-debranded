function module(e,n,t){var r,a,l,o,i,c,u,s,m,p,f,d,h,g,_,E,v,y,F,k,x,S,w,b,I,P,T,C,R;t.link("@babel/runtime/regenerator",{default:function(e){r=e}},0),t.link("@babel/runtime/helpers/slicedToArray",{default:function(e){a=e}},1),t.link("@rocket.chat/fuselage",{Box:function(e){l=e},Button:function(e){o=e},ButtonGroup:function(e){i=e},Callout:function(e){c=e},Chip:function(e){u=e},Field:function(e){s=e},Margins:function(e){m=e},Select:function(e){p=e},InputBox:function(e){f=e},TextInput:function(e){d=e},UrlInput:function(e){h=e}},0),t.link("@rocket.chat/fuselage-hooks",{useUniqueId:function(e){g=e},useSafely:function(e){_=e}},1),t.link("@rocket.chat/ui-contexts",{useToastMessageDispatch:function(e){E=e},useRouter:function(e){v=e},useRouteParameter:function(e){y=e},useSetting:function(e){F=e},useEndpoint:function(e){k=e},useTranslation:function(e){x=e}},2),t.link("react",{default:function(e){S=e},useState:function(e){w=e},useMemo:function(e){b=e},useEffect:function(e){I=e}},3),t.link("../../../../app/importer/client/index",{Importers:function(e){P=e}},4),t.link("../../../components/Page",{default:function(e){T=e}},5),t.link("../../../hooks/useFormatMemorySize",{useFormatMemorySize:function(e){C=e}},6),t.link("./useErrorHandler",{useErrorHandler:function(e){R=e}},7),t.exportDefault(function(){var e=x(),n=E(),t=R(),U=a(_(w(!1)),2),B=U[0],L=U[1],M=a(_(w("upload")),2),z=M[0],K=M[1],A=y("importerKey"),D=b(function(){return P.get(A)},[A]),H=F("FileUpload_MaxFileSize"),q=v(),N=k("POST","/v1/uploadImportFile"),O=k("POST","/v1/downloadPublicImportFile");I(function(){A&&!D&&q.navigate("/admin/import/new",{replace:!0})},[D,A,q]);var V=C(),W=a(w([]),2),G=W[0],j=W[1],J=a(_(w("")),2),Q=J[0],X=J[1],Y=a(_(w("")),2),Z=Y[0],$=Y[1],ee=g(),en=g(),et=g(),er="upload"===z&&function(){return r.async(function(n){for(;;)switch(n.prev=n.next){case 0:return L(!0),n.prev=1,n.next=4,r.awrap(Promise.all(Array.from(G,function(n){return new Promise(function(a){var l=new FileReader;l.readAsDataURL(n),l.onloadend=function o(){return r.async(function o(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,r.awrap(N({binaryContent:l.result.split(";base64,")[1],contentType:n.type,fileName:n.name,importerKey:A}));case 3:o.next=8;break;case 5:o.prev=5,o.t0=o.catch(0),t(o.t0,e("Failed_To_upload_Import_File"));case 8:return o.prev=8,a(),o.finish(8);case 11:case"end":return o.stop()}},null,null,[[0,5,8,11]],Promise)},l.onerror=function(){return a()}})})));case 4:q.navigate("/admin/import/prepare");case 5:return n.prev=5,L(!1),n.finish(5);case 8:case"end":return n.stop()}},null,null,[[1,,5,8]],Promise)}||"url"===z&&function(){return r.async(function(a){for(;;)switch(a.prev=a.next){case 0:return L(!0),a.prev=1,a.next=4,r.awrap(O({importerKey:A,fileUrl:Q}));case 4:n({type:"success",message:e("Import_requested_successfully")}),q.navigate("/admin/import/prepare"),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(1),t(a.t0,e("Failed_To_upload_Import_File"));case 11:return a.prev=11,L(!1),a.finish(11);case 14:case"end":return a.stop()}},null,null,[[1,8,11,14]],Promise)}||"path"===z&&function(){return r.async(function(a){for(;;)switch(a.prev=a.next){case 0:return L(!0),a.prev=1,a.next=4,r.awrap(O({importerKey:A,fileUrl:Z}));case 4:n({type:"success",message:e("Import_requested_successfully")}),q.navigate("/admin/import/prepare"),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(1),t(a.t0,e("Failed_To_upload_Import_File"));case 11:return a.prev=11,L(!1),a.finish(11);case 14:case"end":return a.stop()}},null,null,[[1,8,11,14]],Promise)};return S.createElement(T,{className:"page-settings"},S.createElement(T.Header,{title:e("Import_New_File")},S.createElement(i,null,S.createElement(o,{icon:"back",secondary:!0,onClick:function(){q.navigate("/admin/import")}},e("Back_to_imports")),D&&S.createElement(o,{primary:!0,minHeight:"x40",loading:B,onClick:er},e("Import")))),S.createElement(T.ScrollableContentWithShadow,null,S.createElement(l,{marginInline:"auto",marginBlock:"neg-x24",width:"full",maxWidth:"x580"},S.createElement(m,{block:"x24"},S.createElement(s,null,S.createElement(s.Label,{alignSelf:"stretch",htmlFor:ee},e("Import_Type")),S.createElement(s.Row,null,S.createElement(p,{id:ee,value:A,disabled:B,placeholder:e("Select_an_option"),onChange:function(e){q.navigate(q.buildRoutePath({pattern:"/admin/import/new/:importerKey",params:{importerKey:e}}),{replace:!0})},options:P.getAll().map(function(n){return[n.key,e(n.name)]})})),D&&S.createElement(s.Hint,null,"CSV"===D.name?e("Importer_From_Description_CSV"):e("Importer_From_Description",{from:e(D.name)}))),D&&S.createElement(s,null,S.createElement(s.Label,{alignSelf:"stretch",htmlFor:en},e("File_Type")),S.createElement(s.Row,null,S.createElement(p,{id:en,value:z,disabled:B,placeholder:e("Select_an_option"),onChange:function(e){K(e)},options:[["upload",e("Upload")],["url",e("Public_URL")],["path",e("Server_File_Path")]]}))),D&&S.createElement(S.Fragment,null,"upload"===z&&S.createElement(S.Fragment,null,H>0?S.createElement(c,{type:"warning",marginBlock:"x16"},e("Importer_Upload_FileSize_Message",{maxFileSize:V(H)})):S.createElement(c,{type:"info",marginBlock:"x16"},e("Importer_Upload_Unlimited_FileSize")),S.createElement(s,null,S.createElement(s.Label,{alignSelf:"stretch",htmlFor:et},e("Importer_Source_File")),S.createElement(s.Row,null,S.createElement(f,{type:"file",id:et,onChange:function(e){var n;return r.async(function(t){for(;;)switch(t.prev=t.next){case 0:(n=(e=e.originalEvent||e).target.files)&&0!==n.length||(n=(null!=e.dataTransfer?e.dataTransfer.files:void 0)||[]),j(Array.from(n));case 4:case"end":return t.stop()}},null,null,null,Promise)}})),(null==G?void 0:G.length)>0&&S.createElement(s.Row,null,G.map(function(e,n){return S.createElement(u,{key:n,onClick:function(){j(function(n){return n.filter(function(n){return n!==e})})}},e.name)})))),"url"===z&&S.createElement(s,null,S.createElement(s.Label,{alignSelf:"stretch",htmlFor:et},e("File_URL")),S.createElement(s.Row,null,S.createElement(h,{id:et,value:Q,onChange:function(e){X(e.currentTarget.value)}}))),"path"===z&&S.createElement(s,null,S.createElement(s.Label,{alignSelf:"stretch",htmlFor:et},e("File_Path")),S.createElement(s.Row,null,S.createElement(d,{id:et,value:Z,onChange:function(e){$(e.currentTarget.value)}}))))))))})}
//# sourceMappingURL=/dynamic/client/views/admin/import/b9fe820972ffff2f687271e20e129713b6dd4a5a.map
