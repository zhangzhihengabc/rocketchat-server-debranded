function module(e,t,n){var r,a,o,i,l,s,u,c,d,m,p,f,g,_,E,v,y,w,h,S,k,b;n.link("@babel/runtime/helpers/extends",{default:function(e){r=e}},0),n.link("@babel/runtime/regenerator",{default:function(e){a=e}},1),n.link("@rocket.chat/fuselage",{Button:function(e){o=e},ButtonGroup:function(e){i=e},Table:function(e){l=e},TableHead:function(e){s=e},TableCell:function(e){u=e},TableRow:function(e){c=e},TableBody:function(e){d=e}},0),n.link("@rocket.chat/fuselage-hooks",{useMediaQuery:function(e){m=e}},1),n.link("@rocket.chat/ui-contexts",{useToastMessageDispatch:function(e){p=e},useEndpoint:function(e){f=e},useTranslation:function(e){g=e},useRouter:function(e){_=e}},2),n.link("@tanstack/react-query",{useQuery:function(e){E=e},useMutation:function(e){v=e},useQueryClient:function(e){y=e}},3),n.link("react",{default:function(e){w=e},useMemo:function(e){h=e}},4),n.link("../../../../app/importer/lib/ImporterProgressStep",{ProgressStep:function(e){S=e}},5),n.link("../../../components/Page",{default:function(e){k=e}},6),n.link("./ImportOperationSummary",{default:function(e){b=e}},7),n.exportDefault(function(){var e,t=y(),n=g(),P=p(),T=f("POST","/v1/downloadPendingFiles"),F=f("POST","/v1/downloadPendingAvatars"),I=f("GET","/v1/getCurrentImportOperation"),x=f("GET","/v1/getLatestImportOperations"),O=_(),L=E(["ImportHistoryPage","currentOperation"],function(){var e,t;return a.async(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a.awrap(I());case 2:return t=void 0===(e=n.sent.operation)?{valid:!1}:e,n.abrupt("return",t);case 6:case"end":return n.stop()}},null,null,null,Promise)},{onError:function(){return P({type:"error",message:n("Failed_To_Load_Import_Operation")})}}),C=E(["ImportHistoryPage","latestOperations"],function(){var e;return a.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.awrap(x());case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}},null,null,null,Promise)},{onError:function(){return P({type:"error",message:n("Failed_To_Load_Import_History")})}}),D=L.isLoading||C.isLoading,H=h(function(){return C.isSuccess&&C.data.some(function(e){return e.status===S.DONE})},[C.isSuccess,C.data]),Q=v({mutationFn:function(){return a.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",T());case 1:case"end":return e.stop()}},null,null,null,Promise)},onError:function(e){console.error(e),P({type:"error",message:n("Failed_To_Download_Files")})},onSuccess:function(e){var r=e.count;if(t.invalidateQueries(["ImportHistoryPage","currentOperation"]),t.invalidateQueries(["ImportHistoryPage","latestOperations"]),!r){P({type:"info",message:n("No_files_left_to_download")});return}P({type:"info",message:n("File_Downloads_Started")}),O.navigate("/admin/import/progress")}}),M=v({mutationFn:function(){return a.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",F());case 1:case"end":return e.stop()}},null,null,null,Promise)},onError:function(e){console.error(e),P({type:"error",message:n("Failed_To_Download_Files")})},onSuccess:function(e){var r=e.count;if(t.invalidateQueries(["ImportHistoryPage","currentOperation"]),t.invalidateQueries(["ImportHistoryPage","latestOperations"]),!r){P({type:"info",message:n("No_files_left_to_download")});return}P({type:"info",message:n("File_Downloads_Started")}),O.navigate("/admin/import/progress")}}),N=m("(max-width: 768px)");return w.createElement(k,null,w.createElement(k.Header,{title:n("Import")},w.createElement(i,null,w.createElement(o,{primary:!0,disabled:D,onClick:function(){O.navigate("/admin/import/new")}},n("Import_New_File")),H&&w.createElement(o,{loading:Q.isLoading,disabled:M.isLoading,onClick:function(){return Q.mutate()}},n("Download_Pending_Files")),H&&w.createElement(o,{loading:M.isLoading,disabled:Q.isLoading,onClick:function(){return M.mutate()}},n("Download_Pending_Avatars")))),w.createElement(k.ScrollableContentWithShadow,null,w.createElement(l,{fixed:!0,"data-qa-id":"ImportTable"},w.createElement(s,null,w.createElement(c,null,w.createElement(u,{is:"th",rowSpan:2,width:"x140"},n("Import_Type")),w.createElement(u,{is:"th",rowSpan:2},n("Last_Updated")),!N&&w.createElement(w.Fragment,null,w.createElement(u,{is:"th",rowSpan:2},n("Last_Status")),w.createElement(u,{is:"th",rowSpan:2},n("File")),w.createElement(u,{is:"th",align:"center",colSpan:4,width:"x320"},n("Counters")))),!N&&w.createElement(c,null,w.createElement(u,{is:"th",align:"center"},n("Users")),w.createElement(u,{is:"th",align:"center"},n("Channels")),w.createElement(u,{is:"th",align:"center"},n("Messages")),w.createElement(u,{is:"th",align:"center"},n("Total")))),w.createElement(d,null,D&&w.createElement(w.Fragment,null,Array.from({length:20},function(e,t){return w.createElement(b.Skeleton,{small:N,key:t})})),L.isSuccess&&L.data.valid&&w.createElement(b,r({},L.data,{small:N})),L.isSuccess&&C.isSuccess&&w.createElement(w.Fragment,null,null===(e=C.data.filter(function(e){var t=e._id;return!L.data.valid||L.data._id!==t}))||void 0===e?void 0:e.map(function(e){return w.createElement(b,r({key:e._id},e,{valid:!1,small:N}))}))))))})}
//# sourceMappingURL=/dynamic/client/views/admin/import/f6b4510a47b8d3c0ba8e5888030908e0d35d476f.map
