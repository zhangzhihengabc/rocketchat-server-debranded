)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/users/AdminUserInfoActions.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IUser } from '@rocket.chat/core-typings';\nimport { ButtonGroup, Menu, Option } from '@rocket.chat/fuselage';\nimport { useRoute, usePermission, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useCallback, useMemo } from 'react';\n\nimport UserInfo from '../../../components/UserInfo';\nimport { useActionSpread } from '../../hooks/useActionSpread';\nimport { useChangeAdminStatusAction } from './hooks/useChangeAdminStatusAction';\nimport { useChangeUserStatusAction } from './hooks/useChangeUserStatusAction';\nimport { useDeleteUserAction } from './hooks/useDeleteUserAction';\nimport { useResetE2EEKeyAction } from './hooks/useResetE2EEKeyAction';\nimport { useResetTOTPAction } from './hooks/useResetTOTPAction';\n\ntype AdminUserInfoActionsProps = {\n\tusername: IUser['username'];\n\tuserId: IUser['_id'];\n\tisFederatedUser: IUser['federated'];\n\tisActive: boolean;\n\tisAdmin: boolean;\n\tonChange: () => void;\n\tonReload: () => void;\n};\n\nconst AdminUserInfoActions = ({\n\tusername,\n\tuserId,\n\tisFederatedUser,\n\tisActive,\n\tisAdmin,\n\tonChange,\n\tonReload,\n}: AdminUserInfoActionsProps): ReactElement => {\n\tconst t = useTranslation();\n\tconst directRoute = useRoute('direct');\n\tconst userRoute = useRoute('admin-users');\n\tconst canDirectMessage = usePermission('create-d');\n\tconst canEditOtherUserInfo = usePermission('edit-other-user-info');\n\n\tconst changeAdminStatusAction = useChangeAdminStatusAction(userId, isAdmin, onChange);\n\tconst changeUserStatusAction = useChangeUserStatusAction(userId, isActive, onChange);\n\tconst deleteUserAction = useDeleteUserAction(userId, onChange, onReload);\n\tconst resetTOTPAction = useResetTOTPAction(userId);\n\tconst resetE2EKeyAction = useResetE2EEKeyAction(userId);\n\n\tconst directMessageClick = useCallback(\n\t\t() =>\n\t\t\tusername &&\n\t\t\tdirectRoute.push({\n\t\t\t\trid: username,\n\t\t\t}),\n\t\t[directRoute, username],\n\t);\n\n\tconst editUserClick = useCallback(\n\t\t() =>\n\t\t\tuserRoute.push({\n\t\t\t\tcontext: 'edit',\n\t\t\t\tid: userId,\n\t\t\t}),\n\t\t[userId, userRoute],\n\t);\n\n\tconst options = useMemo(\n\t\t() => ({\n\t\t\t...(canDirectMessage && {\n\t\t\t\tdirectMessage: {\n\t\t\t\t\ticon: 'balloon' as const,\n\t\t\t\t\tlabel: t('Direct_Message'),\n\t\t\t\t\ttitle: t('Direct_Message'),\n\t\t\t\t\taction: directMessageClick,\n\t\t\t\t},\n\t\t\t}),\n\t\t\t...(canEditOtherUserInfo && {\n\t\t\t\teditUser: {\n\t\t\t\t\ticon: 'edit' as const,\n\t\t\t\t\tlabel: t('Edit'),\n\t\t\t\t\ttitle: isFederatedUser ? t('Edit_Federated_User_Not_Allowed') : t('Edit'),\n\t\t\t\t\taction: editUserClick,\n\t\t\t\t\tdisabled: isFederatedUser,\n\t\t\t\t},\n\t\t\t}),\n\t\t\t...(changeAdminStatusAction && !isFederatedUser && { makeAdmin: changeAdminStatusAction }),\n\t\t\t...(resetE2EKeyAction && !isFederatedUser && { resetE2EKey: resetE2EKeyAction }),\n\t\t\t...(resetTOTPAction && !isFederatedUser && { resetTOTP: resetTOTPAction }),\n\t\t\t...(deleteUserAction && { delete: deleteUserAction }),\n\t\t\t...(changeUserStatusAction && !isFederatedUser && { changeActiveStatus: changeUserStatusAction }),\n\t\t}),\n\t\t[\n\t\t\tt,\n\t\t\tcanDirectMessage,\n\t\t\tdirectMessageClick,\n\t\t\tcanEditOtherUserInfo,\n\t\t\teditUserClick,\n\t\t\tchangeAdminStatusAction,\n\t\t\tchangeUserStatusAction,\n\t\t\tdeleteUserAction,\n\t\t\tresetE2EKeyAction,\n\t\t\tresetTOTPAction,\n\t\t\tisFederatedUser,\n\t\t],\n\t);\n\n\tconst { actions: actionsDefinition, menu: menuOptions } = useActionSpread(options);\n\n\tconst menu = useMemo(() => {\n\t\tif (!menuOptions) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn (\n\t\t\t<Menu\n\t\t\t\tmi={4}\n\t\t\t\tplacement='bottom-start'\n\t\t\t\tsmall={false}\n\t\t\t\tsecondary\n\t\t\t\tflexShrink={0}\n\t\t\t\tkey='menu'\n\t\t\t\trenderItem={({ label: { label, icon }, ...props }): ReactElement => <Option label={label} title={label} icon={icon} {...props} />}\n\t\t\t\toptions={menuOptions}\n\t\t\t/>\n\t\t);\n\t}, [menuOptions]);\n\n\t// TODO: sanitize Action type to avoid any\n\tconst actions = useMemo(() => {\n\t\tconst mapAction = ([key, { label, icon, action, disabled, title }]: any): ReactElement => (\n\t\t\t<UserInfo.Action key={key} title={title} label={label} onClick={action} disabled={disabled} icon={icon} />\n\t\t);\n\t\treturn [...actionsDefinition.map(mapAction), menu].filter(Boolean);\n\t}, [actionsDefinition, menu]);\n\n\treturn (\n\t\t<ButtonGroup flexGrow={0} justifyContent='center' data-qa-id='UserInfoActions'>\n\t\t\t{actions}\n\t\t</ButtonGroup>\n\t);\n};\n\nexport default AdminUserInfoActions;\n",null],"names":["_toConsumableArray","_slicedToArray","_extends","_objectWithoutProperties","_objectSpread","ButtonGroup","Menu","Option","useRoute","usePermission","useTranslation","React","useCallback","useMemo","UserInfo","useActionSpread","useChangeAdminStatusAction","useChangeUserStatusAction","useDeleteUserAction","useResetE2EEKeyAction","useResetTOTPAction","module","link","default","v","exportDefault","_ref","username","userId","isFederatedUser","isActive","isAdmin","onChange","onReload","t","directRoute","userRoute","canDirectMessage","canEditOtherUserInfo","changeAdminStatusAction","changeUserStatusAction","deleteUserAction","resetTOTPAction","resetE2EKeyAction","directMessageClick","push","rid","editUserClick","context","id","_useActionSpread","directMessage","icon","label","title","action","editUser","disabled","makeAdmin","resetE2EKey","resetTOTP","changeActiveStatus","actionsDefinition","actions","menuOptions","menu","createElement","mi","placement","small","secondary","flexShrink","key","renderItem","_ref2","_ref2$label","props","_excluded","options","concat","map","_ref3","_ref4","_ref4$","Action","onClick","filter","Boolean","flexGrow","justifyContent"],"mappings":"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"}