)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/users/hooks/useResetTOTPAction.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IUser } from '@rocket.chat/core-typings';\nimport { useSetModal, usePermission, useSetting, useEndpoint, useTranslation, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\nimport React, { useCallback } from 'react';\n\nimport GenericModal from '../../../../components/GenericModal';\nimport type { Action } from '../../../hooks/useActionSpread';\n\nexport const useResetTOTPAction = (userId: IUser['_id']): Action | undefined => {\n\tconst t = useTranslation();\n\tconst setModal = useSetModal();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst canResetTOTP = usePermission('edit-other-user-totp');\n\tconst twoFactorEnabled = useSetting('Accounts_TwoFactorAuthentication_Enabled');\n\tconst resetTOTPRequest = useEndpoint('POST', '/v1/users.resetTOTP');\n\n\tconst resetTOTP = useCallback(async () => {\n\t\ttry {\n\t\t\tawait resetTOTPRequest({ userId });\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Users_TOTP_has_been_reset') });\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t} finally {\n\t\t\tsetModal();\n\t\t}\n\t}, [resetTOTPRequest, setModal, t, userId, dispatchToastMessage]);\n\n\tconst confirmResetTOTP = useCallback(() => {\n\t\tsetModal(\n\t\t\t<GenericModal variant='danger' onConfirm={resetTOTP} onCancel={(): void => setModal()} confirmText={t('Reset')}>\n\t\t\t\t{t('TOTP_Reset_Other_Key_Warning')}\n\t\t\t</GenericModal>,\n\t\t);\n\t}, [resetTOTP, t, setModal]);\n\n\treturn canResetTOTP && twoFactorEnabled\n\t\t? {\n\t\t\t\ticon: 'key',\n\t\t\t\tlabel: t('Reset_TOTP'),\n\t\t\t\taction: confirmResetTOTP,\n\t\t  }\n\t\t: undefined;\n};\n",null],"names":["module","default","v","_regeneratorRuntime","export","useResetTOTPAction","useSetModal","usePermission","useSetting","useEndpoint","useTranslation","useToastMessageDispatch","React","useCallback","GenericModal","userId","t","setModal","dispatchToastMessage","canResetTOTP","twoFactorEnabled","resetTOTPRequest","resetTOTP","async","_context","prev","next","awrap","type","message","t0","finish","stop","Promise","confirmResetTOTP","createElement","variant","onConfirm","onCancel","confirmText","icon","label","action","undefined"],"mappings":"uBACsBA,EAAAA,IAAa,CAAA,6BAA2B,CAAAC,QAAAA,SAAgBC,CAAAA,EAAAC,EAAyBD,CAAA,CAAA,EAAM,GAA7GF,EAAOI,MAAE,CAAA,CAAAC,mBAAa,WAAe,OAAYA,CAAa,CAAA,GAA0EL,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAM,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,cAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,WAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,wBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAX,EAAAA,IAAAA,CAAAA,QAAAA,CAAA,QAAA,SAAAE,CAAA,EAAAU,EAAAA,CAAA,EAAAC,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAb,EAAAA,IAAAA,CAAAA,sCAAAA,CAAA,QAAA,SAAAE,CAAA,EAAAY,EAAAA,CAAA,CAAA,EAAA,GAMjI,IANPX,EAA8EG,EAAAA,EAAyBE,EAAMC,EAAAC,EAA2BC,EAAAC,EAAAC,EAAAC,EAM3HT,EAAqB,SAACU,CAAoB,EACtD,IAAMC,EAAIN,IACJO,EAAWX,IACXY,EAAuBP,IACvBQ,EAAeZ,EAAc,wBAC7Ba,EAAmBZ,EAAW,4CAC9Ba,EAAmBZ,EAAY,OAAQ,uBAEvCa,EAAYT,EAAY,WAAA,OAAAV,EAAAoB,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAAA,OAAAF,EAAAC,IAAA,CAAA,EAAAD,EAAAE,IAAA,CAAA,EAAAvB,EAAAwB,KAAA,CAEtBN,EAAiB,CAAEN,OAAAA,CAAM,GAAG,MAAA,EAClCG,EAAqB,CAAEU,KAAM,UAAWC,QAASb,EAAE,4BAA4B,GAAIQ,EAAAE,IAAA,CAAA,EAAA,KAAA,MAAA,EAAAF,EAAAC,IAAA,CAAA,EAAAD,EAAAM,EAAA,CAAAN,EAAA,KAAA,CAAA,GAEnFN,EAAqB,CAAEU,KAAM,QAASC,QAAOL,EAAAM,EAAA,AAAO,EAAI,MAAA,EAE7C,OAF6CN,EAAAC,IAAA,CAAA,EAExDR,IAAWO,EAAAO,MAAA,CAAA,EAAA,MAAA,GAAA,IAAA,MAAA,OAAAP,EAAAQ,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,CAAA,CAAA,EAAA,EAAA,EAAA,GAAA,CAAA,CAAAC,QAAA,EAEV,CAACZ,EAAkBJ,EAAUD,EAAGD,EAAQG,EAAqB,EAE1DgB,EAAmBrB,EAAY,WACpCI,EACCL,EAAAuB,aAAA,CAACrB,EAAY,CAACsB,QAAQ,SAASC,UAAWf,EAAWgB,SAAU,WAAA,OAAYrB,GAAU,EAAEsB,YAAavB,EAAE,QAAS,EAC7GA,EAAE,iCAGN,EAAG,CAACM,EAAWN,EAAGC,EAAS,EAE3B,OAAOE,GAAgBC,EACpB,CACAoB,KAAM,MACNC,MAAOzB,EAAE,cACT0B,OAAQR,GAERS,KAAAA,CACJ"}