)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/users/AdminUserInfoWithData.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { isUserFederated } from '@rocket.chat/core-typings';\nimport type { IUser } from '@rocket.chat/core-typings';\nimport { Callout } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useSetting, useRolesDescription, useTranslation, useEndpoint, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\nimport { useQuery } from '@tanstack/react-query';\nimport type { ReactElement } from 'react';\nimport React, { useMemo } from 'react';\n\nimport { getUserEmailAddress } from '../../../../lib/getUserEmailAddress';\nimport { ContextualbarContent } from '../../../components/Contextualbar';\nimport { FormSkeleton } from '../../../components/Skeleton';\nimport UserCard from '../../../components/UserCard';\nimport UserInfo from '../../../components/UserInfo';\nimport { UserStatus } from '../../../components/UserStatus';\nimport { getUserEmailVerified } from '../../../lib/utils/getUserEmailVerified';\nimport AdminUserInfoActions from './AdminUserInfoActions';\n\ntype AdminUserInfoWithDataProps = {\n\tuid: IUser['_id'];\n\tonReload: () => void;\n};\n\nconst AdminUserInfoWithData = ({ uid, onReload }: AdminUserInfoWithDataProps): ReactElement => {\n\tconst t = useTranslation();\n\tconst getRoles = useRolesDescription();\n\tconst approveManuallyUsers = useSetting('Accounts_ManuallyApproveNewUsers');\n\n\tconst getUsersInfo = useEndpoint('GET', '/v1/users.info');\n\n\tconst query = useMemo(() => ({ userId: uid }), [uid]);\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst { data, isLoading, error, refetch } = useQuery(\n\t\t['users', query, 'admin'],\n\t\tasync () => {\n\t\t\tconst usersInfo = await getUsersInfo(query);\n\t\t\treturn usersInfo;\n\t\t},\n\t\t{\n\t\t\tonError: (error) => {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t},\n\t\t},\n\t);\n\n\tconst onChange = useMutableCallback(() => {\n\t\tonReload();\n\t\trefetch();\n\t});\n\n\tconst user = useMemo(() => {\n\t\tif (!data?.user) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst {\n\t\t\tavatarETag,\n\t\t\tname,\n\t\t\tusername,\n\t\t\tphone,\n\t\t\tcreatedAt,\n\t\t\troles = [],\n\t\t\tstatus,\n\t\t\tstatusText,\n\t\t\tbio,\n\t\t\tutcOffset,\n\t\t\tlastLogin,\n\t\t\tnickname,\n\t\t\tcanViewAllInfo,\n\t\t} = data.user;\n\n\t\treturn {\n\t\t\tavatarETag,\n\t\t\tname,\n\t\t\tusername,\n\t\t\tlastLogin,\n\t\t\troles: getRoles(roles).map((role, index) => <UserCard.Role key={index}>{role}</UserCard.Role>),\n\t\t\tbio,\n\t\t\tcanViewAllInfo,\n\t\t\tphone,\n\t\t\tutcOffset,\n\t\t\tcustomFields: {\n\t\t\t\t...data.user.customFields,\n\t\t\t\t...(approveManuallyUsers && !data.user.active && data.user.reason ? { Reason: data.user.reason } : undefined),\n\t\t\t},\n\t\t\tverified: getUserEmailVerified(data.user),\n\t\t\temail: getUserEmailAddress(data.user),\n\t\t\tcreatedAt,\n\t\t\tstatus: <UserStatus status={status} />,\n\t\t\tstatusText,\n\t\t\tnickname,\n\t\t};\n\t}, [approveManuallyUsers, data, getRoles]);\n\n\tif (isLoading) {\n\t\treturn (\n\t\t\t<ContextualbarContent>\n\t\t\t\t<FormSkeleton />\n\t\t\t</ContextualbarContent>\n\t\t);\n\t}\n\n\tif (error || !user || !data?.user) {\n\t\treturn (\n\t\t\t<ContextualbarContent pb={16}>\n\t\t\t\t<Callout type='danger'>{t('User_not_found')}</Callout>\n\t\t\t</ContextualbarContent>\n\t\t);\n\t}\n\n\treturn (\n\t\t<UserInfo\n\t\t\t{...user}\n\t\t\tactions={\n\t\t\t\t<AdminUserInfoActions\n\t\t\t\t\tisActive={data?.user.active}\n\t\t\t\t\tisAdmin={data?.user.roles?.includes('admin')}\n\t\t\t\t\tuserId={data?.user._id}\n\t\t\t\t\tusername={user.username}\n\t\t\t\t\tisFederatedUser={isUserFederated(data?.user as unknown as IUser)}\n\t\t\t\t\tonChange={onChange}\n\t\t\t\t\tonReload={onReload}\n\t\t\t\t/>\n\t\t\t}\n\t\t/>\n\t);\n};\n\nexport default AdminUserInfoWithData;\n",null],"names":["_extends","_objectSpread","_regeneratorRuntime","isUserFederated","Callout","useMutableCallback","useSetting","useRolesDescription","useTranslation","useEndpoint","useToastMessageDispatch","useQuery","React","useMemo","getUserEmailAddress","ContextualbarContent","FormSkeleton","UserCard","UserInfo","UserStatus","getUserEmailVerified","AdminUserInfoActions","module","default","v","link","exportDefault","_ref","_data$user$roles2","uid","onReload","t","getRoles","approveManuallyUsers","getUsersInfo","query","userId","dispatchToastMessage","_useQuery","usersInfo","async","_context","prev","next","awrap","sent","abrupt","stop","Promise","onError","error","type","message","data","isLoading","refetch","onChange","user","_data$user","avatarETag","name","username","phone","createdAt","_data$user$roles","roles","status","statusText","bio","utcOffset","lastLogin","nickname","canViewAllInfo","map","role","index","createElement","Role","key","customFields","active","reason","Reason","undefined","verified","email","actions","isActive","isAdmin","includes","_id","isFederatedUser","pb"],"mappings":"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"}