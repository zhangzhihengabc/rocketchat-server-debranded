)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/settings/groups/OAuthGroupPage.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { ISetting } from '@rocket.chat/core-typings';\nimport { Button } from '@rocket.chat/fuselage';\nimport { capitalize } from '@rocket.chat/string-helpers';\nimport { useToastMessageDispatch, useAbsoluteUrl, useMethod, useTranslation, useSetModal } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { memo, useEffect, useState } from 'react';\n\nimport { strRight } from '../../../../../lib/utils/stringUtils';\nimport GenericModal from '../../../../components/GenericModal';\nimport { useEditableSettingsGroupSections } from '../../EditableSettingsContext';\nimport GroupPage from '../GroupPage';\nimport Section from '../Section';\nimport CreateOAuthModal from './CreateOAuthModal';\n\ntype OAuthGroupPageProps = ISetting;\n\nfunction OAuthGroupPage({ _id, ...group }: OAuthGroupPageProps): ReactElement {\n\tconst sections = useEditableSettingsGroupSections(_id);\n\tconst solo = sections.length === 1;\n\tconst t = useTranslation();\n\n\tconst [settingSections, setSettingSections] = useState(sections);\n\n\tconst sectionIsCustomOAuth = (sectionName: string): string | boolean => sectionName && /^Custom OAuth:\\s.+/.test(sectionName);\n\n\tconst getAbsoluteUrl = useAbsoluteUrl();\n\n\tconst callbackURL = (sectionName: string): string => {\n\t\tconst id = strRight(sectionName, 'Custom OAuth: ').toLowerCase();\n\t\treturn getAbsoluteUrl(`_oauth/${id}`);\n\t};\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst refreshOAuthService = useMethod('refreshOAuthService');\n\tconst addOAuthService = useMethod('addOAuthService');\n\tconst removeOAuthService = useMethod('removeOAuthService');\n\tconst setModal = useSetModal();\n\n\tconst handleRefreshOAuthServicesButtonClick = async (): Promise<void> => {\n\t\tdispatchToastMessage({ type: 'info', message: t('Refreshing') });\n\t\ttry {\n\t\t\tawait refreshOAuthService();\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Done') });\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t};\n\n\tconst handleAddCustomOAuthButtonClick = (): void => {\n\t\tconst onConfirm = async (text: string): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tawait addOAuthService(text);\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Custom_OAuth_has_been_added') });\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t} finally {\n\t\t\t\tsetModal(null);\n\t\t\t}\n\t\t};\n\t\tsetModal(<CreateOAuthModal onConfirm={onConfirm} onClose={(): void => setModal(null)} />);\n\t};\n\n\tuseEffect(() => {\n\t\tsetSettingSections(sections);\n\t}, [sections]);\n\n\tconst removeCustomOauthFactory =\n\t\t(id: string): (() => void) =>\n\t\t(): void => {\n\t\t\tconst handleConfirm = async (): Promise<void> => {\n\t\t\t\ttry {\n\t\t\t\t\tawait removeOAuthService(id);\n\t\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Custom_OAuth_has_been_removed') });\n\t\t\t\t\tsetSettingSections(settingSections.filter((section) => section !== `Custom OAuth: ${capitalize(id)}`));\n\t\t\t\t} catch (error) {\n\t\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t\t} finally {\n\t\t\t\t\tsetModal(null);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tsetModal(\n\t\t\t\t<GenericModal\n\t\t\t\t\tonClose={() => setModal(null)}\n\t\t\t\t\tonCancel={() => setModal(null)}\n\t\t\t\t\ttitle={t('Are_you_sure')}\n\t\t\t\t\tvariant='danger'\n\t\t\t\t\tconfirmText={t('Yes_delete_it')}\n\t\t\t\t\tonConfirm={handleConfirm}\n\t\t\t\t/>,\n\t\t\t);\n\t\t};\n\n\treturn (\n\t\t<GroupPage\n\t\t\t_id={_id}\n\t\t\t{...group}\n\t\t\theaderButtons={\n\t\t\t\t<>\n\t\t\t\t\t<Button onClick={handleRefreshOAuthServicesButtonClick}>{t('Refresh_oauth_services')}</Button>\n\t\t\t\t\t<Button onClick={handleAddCustomOAuthButtonClick}>{t('Add_custom_oauth')}</Button>\n\t\t\t\t</>\n\t\t\t}\n\t\t>\n\t\t\t{settingSections.map((sectionName) => {\n\t\t\t\tif (sectionIsCustomOAuth(sectionName)) {\n\t\t\t\t\tconst id = strRight(sectionName, 'Custom OAuth: ').toLowerCase();\n\n\t\t\t\t\tconst handleRemoveCustomOAuthButtonClick = removeCustomOauthFactory(id);\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<Section\n\t\t\t\t\t\t\tkey={sectionName}\n\t\t\t\t\t\t\tgroupId={_id}\n\t\t\t\t\t\t\thelp={\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tdangerouslySetInnerHTML={{\n\t\t\t\t\t\t\t\t\t\t__html: t('Custom_oauth_helper', callbackURL(sectionName)),\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsectionName={sectionName}\n\t\t\t\t\t\t\tsolo={solo}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div className='submit'>\n\t\t\t\t\t\t\t\t<Button secondary danger onClick={handleRemoveCustomOAuthButtonClick}>\n\t\t\t\t\t\t\t\t\t{t('Remove_custom_oauth')}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Section>\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\treturn <Section key={sectionName} groupId={_id} sectionName={sectionName} solo={solo} />;\n\t\t\t})}\n\t\t</GroupPage>\n\t);\n}\n\nexport default memo(OAuthGroupPage);\n",null],"names":["_regeneratorRuntime","_extends","_slicedToArray","_objectWithoutProperties","Button","capitalize","useToastMessageDispatch","useAbsoluteUrl","useMethod","useTranslation","useSetModal","React","memo","useEffect","useState","strRight","GenericModal","useEditableSettingsGroupSections","GroupPage","Section","CreateOAuthModal","module","default","link","v","exportDefault","_ref","_id","group","_excluded","sections","solo","length","t","_useState2","settingSections","setSettingSections","getAbsoluteUrl","dispatchToastMessage","refreshOAuthService","addOAuthService","removeOAuthService","setModal","createElement","headerButtons","Fragment","onClick","async","_context","prev","next","type","message","awrap","t0","stop","Promise","onConfirm","text","_context2","finish","onClose","map","sectionName","test","id","handleRemoveCustomOAuthButtonClick","toLowerCase","onCancel","title","variant","confirmText","_context3","filter","section","key","groupId","help","dangerouslySetInnerHTML","__html","className","secondary","danger"],"mappings":"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"}