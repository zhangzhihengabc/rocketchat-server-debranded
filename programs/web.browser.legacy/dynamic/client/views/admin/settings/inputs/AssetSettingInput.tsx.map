)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/settings/inputs/AssetSettingInput.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Button, FieldLabel, FieldRow, Icon } from '@rocket.chat/fuselage';\nimport { Random } from '@rocket.chat/random';\nimport { useToastMessageDispatch, useEndpoint, useTranslation, useUpload } from '@rocket.chat/ui-contexts';\nimport type { ChangeEventHandler, DragEvent, ReactElement, SyntheticEvent } from 'react';\nimport React from 'react';\n\nimport './AssetSettingInput.styles.css';\n\ntype AssetSettingInputProps = {\n\t_id: string;\n\tlabel: string;\n\tvalue?: { url: string };\n\tasset?: any;\n\tfileConstraints?: { extensions: string[] };\n};\n\nfunction AssetSettingInput({ _id, label, value, asset, fileConstraints }: AssetSettingInputProps): ReactElement {\n\tconst t = useTranslation();\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst setAsset = useUpload('/v1/assets.setAsset');\n\tconst unsetAsset = useEndpoint('POST', '/v1/assets.unsetAsset');\n\n\tconst isDataTransferEvent = <T extends SyntheticEvent>(event: T): event is T & DragEvent<HTMLInputElement> =>\n\t\tBoolean('dataTransfer' in event && (event as any).dataTransfer.files);\n\n\tconst handleUpload: ChangeEventHandler<HTMLInputElement> = (event): void => {\n\t\tlet { files } = event.target;\n\n\t\tif (!files || files.length === 0) {\n\t\t\tif (isDataTransferEvent(event)) {\n\t\t\t\tfiles = event.dataTransfer.files;\n\t\t\t}\n\t\t}\n\n\t\tObject.values(files ?? []).forEach(async (blob) => {\n\t\t\tdispatchToastMessage({ type: 'info', message: t('Uploading_file') });\n\n\t\t\tconst fileData = new FormData();\n\t\t\tfileData.append('asset', blob, asset);\n\t\t\tfileData.append('assetName', asset);\n\n\t\t\ttry {\n\t\t\t\tawait setAsset(fileData);\n\t\t\t} catch (e) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: e });\n\t\t\t}\n\t\t});\n\t};\n\n\tconst handleDeleteButtonClick = async (): Promise<void> => {\n\t\ttry {\n\t\t\tawait unsetAsset({ assetName: asset });\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<FieldLabel htmlFor={_id} title={_id}>\n\t\t\t\t{label}\n\t\t\t</FieldLabel>\n\t\t\t<FieldRow>\n\t\t\t\t<div className='settings-file-preview'>\n\t\t\t\t\t{value?.url ? (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName='preview'\n\t\t\t\t\t\t\tstyle={{ backgroundImage: `url(${value.url}?_dc=${Random.id()})` }}\n\t\t\t\t\t\t\trole='img'\n\t\t\t\t\t\t\taria-label={t('Asset_preview')}\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className='preview no-file background-transparent-light secondary-font-color'>\n\t\t\t\t\t\t\t<Icon size='x16' name='upload' />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t\t<div className='action'>\n\t\t\t\t\t\t{value?.url ? (\n\t\t\t\t\t\t\t<Button icon='trash' onClick={handleDeleteButtonClick}>\n\t\t\t\t\t\t\t\t{t('Delete')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<div className='rc-button rc-button--primary'>\n\t\t\t\t\t\t\t\t{t('Select_file')}\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tclassName='AssetSettingInput__input'\n\t\t\t\t\t\t\t\t\ttype='file'\n\t\t\t\t\t\t\t\t\taccept={`.${fileConstraints?.extensions?.join(', .')}`}\n\t\t\t\t\t\t\t\t\tonChange={handleUpload}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</FieldRow>\n\t\t</>\n\t);\n}\n\nexport default AssetSettingInput;\n",null],"names":["_regeneratorRuntime","Button","FieldLabel","FieldRow","Icon","Random","useToastMessageDispatch","useEndpoint","useTranslation","useUpload","React","module","link","default","v","exportDefault","_ref","_fileConstraints$exte","_id","label","value","asset","fileConstraints","t","dispatchToastMessage","setAsset","unsetAsset","createElement","Fragment","htmlFor","title","className","url","style","backgroundImage","id","role","size","name","icon","onClick","async","_context2","prev","next","awrap","assetName","t0","type","message","stop","Promise","accept","extensions","join","onChange","event","_files","files","target","length","dataTransfer","Object","values","forEach","blob","fileData","_context","FormData","append"],"mappings":"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"}