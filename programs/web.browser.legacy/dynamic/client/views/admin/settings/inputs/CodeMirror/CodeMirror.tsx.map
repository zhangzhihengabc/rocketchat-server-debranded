)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/settings/inputs/CodeMirror/CodeMirror.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { Editor, EditorFromTextArea } from 'codemirror';\nimport type { ReactElement } from 'react';\nimport React, { useEffect, useRef, useState } from 'react';\n\nconst defaultGutters = ['CodeMirror-linenumbers', 'CodeMirror-foldgutter'];\n\ntype CodeMirrorProps = {\n\tid: string;\n\tplaceholder?: string;\n\tdisabled?: boolean;\n\tautoComplete?: string | undefined;\n\tlineNumbers?: boolean;\n\tlineWrapping?: boolean;\n\tmode?: string;\n\tgutters?: string[];\n\tfoldGutter?: boolean;\n\tmatchBrackets?: boolean;\n\tautoCloseBrackets?: boolean;\n\tmatchTags?: boolean;\n\tshowTrailingSpace?: boolean;\n\thighlightSelectionMatches?: boolean;\n\treadOnly: boolean;\n\tvalue: string;\n\tdefaultValue?: string;\n\tonChange: (value: string) => void;\n};\n\nfunction CodeMirror({\n\tlineNumbers = true,\n\tlineWrapping = true,\n\tmode = 'javascript',\n\tgutters = defaultGutters,\n\tfoldGutter = true,\n\tmatchBrackets = true,\n\tautoCloseBrackets = true,\n\tmatchTags = true,\n\tshowTrailingSpace = true,\n\thighlightSelectionMatches = true,\n\treadOnly,\n\tvalue: valueProp,\n\tdefaultValue,\n\tonChange,\n\t...props\n}: CodeMirrorProps): ReactElement {\n\tconst [value, setValue] = useState(valueProp || defaultValue);\n\n\tconst textAreaRef = useRef<HTMLTextAreaElement>(null);\n\tconst editorRef = useRef<EditorFromTextArea | null>(null);\n\tconst handleChange = useMutableCallback(onChange);\n\n\tuseEffect(() => {\n\t\tif (editorRef.current) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst setupCodeMirror = async (): Promise<void> => {\n\t\t\tconst CodeMirror = await import('codemirror');\n\t\t\tawait Promise.all([\n\t\t\t\timport('../../../../../../app/ui/client/lib/codeMirror/codeMirror'),\n\t\t\t\timport('codemirror/addon/edit/matchbrackets'),\n\t\t\t\timport('codemirror/addon/edit/closebrackets'),\n\t\t\t\timport('codemirror/addon/edit/matchtags'),\n\t\t\t\timport('codemirror/addon/edit/trailingspace'),\n\t\t\t\timport('codemirror/addon/search/match-highlighter'),\n\t\t\t\timport('codemirror/lib/codemirror.css'),\n\t\t\t]);\n\n\t\t\tif (!textAreaRef.current) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\teditorRef.current = CodeMirror.fromTextArea(textAreaRef.current, {\n\t\t\t\tlineNumbers,\n\t\t\t\tlineWrapping,\n\t\t\t\tmode,\n\t\t\t\tgutters,\n\t\t\t\tfoldGutter,\n\t\t\t\tmatchBrackets,\n\t\t\t\tautoCloseBrackets,\n\t\t\t\tmatchTags,\n\t\t\t\tshowTrailingSpace,\n\t\t\t\thighlightSelectionMatches,\n\t\t\t\treadOnly,\n\t\t\t});\n\n\t\t\teditorRef.current.on('change', (doc: Editor) => {\n\t\t\t\tconst value = doc.getValue();\n\t\t\t\tsetValue(value);\n\t\t\t\thandleChange(value);\n\t\t\t});\n\t\t};\n\n\t\tsetupCodeMirror();\n\n\t\treturn (): void => {\n\t\t\tif (!editorRef.current) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\teditorRef.current.toTextArea();\n\t\t};\n\t}, [\n\t\tautoCloseBrackets,\n\t\tfoldGutter,\n\t\tgutters,\n\t\thighlightSelectionMatches,\n\t\tlineNumbers,\n\t\tlineWrapping,\n\t\tmatchBrackets,\n\t\tmatchTags,\n\t\tmode,\n\t\thandleChange,\n\t\treadOnly,\n\t\ttextAreaRef,\n\t\tshowTrailingSpace,\n\t]);\n\n\tuseEffect(() => {\n\t\tsetValue(valueProp);\n\t}, [valueProp]);\n\n\tuseEffect(() => {\n\t\tif (!editorRef.current) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (value !== editorRef.current.getValue()) {\n\t\t\teditorRef.current.setValue(value ?? '');\n\t\t}\n\t}, [textAreaRef, value]);\n\n\treturn <textarea readOnly ref={textAreaRef} style={{ display: 'none' }} value={value} {...props} />;\n}\n\nexport default CodeMirror;\n",null],"names":["_regeneratorRuntime","_extends","_slicedToArray","_objectWithoutProperties","useMutableCallback","React","useEffect","useRef","useState","module","link","default","v","defaultGutters","exportDefault","_ref","_ref$lineNumbers","lineNumbers","_ref$lineWrapping","lineWrapping","_ref$mode","mode","_ref$gutters","gutters","_ref$foldGutter","foldGutter","_ref$matchBrackets","matchBrackets","_ref$autoCloseBracket","autoCloseBrackets","_ref$matchTags","matchTags","_ref$showTrailingSpac","showTrailingSpace","_ref$highlightSelecti","highlightSelectionMatches","readOnly","valueProp","value","defaultValue","onChange","props","_excluded","_useState2","setValue","textAreaRef","editorRef","handleChange","CodeMirror","current","async","_context","prev","next","awrap","dynamicImport","sent","Promise","all","abrupt","fromTextArea","on","doc","getValue","stop","toTextArea","createElement","ref","style","display"],"mappings":"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"}