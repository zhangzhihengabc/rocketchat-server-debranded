)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/settings/GroupPage.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { ISetting, ISettingColor } from '@rocket.chat/core-typings';\nimport { Accordion, Box, Button, ButtonGroup } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\nimport {\n\tuseToastMessageDispatch,\n\tuseUser,\n\tuseSettingsDispatch,\n\tuseSettings,\n\tuseTranslation,\n\tuseLoadLanguage,\n\tuseRoute,\n} from '@rocket.chat/ui-contexts';\nimport type { FC, ReactNode, FormEvent, MouseEvent } from 'react';\nimport React, { useMemo, memo } from 'react';\n\nimport Page from '../../../components/Page';\nimport type { EditableSetting } from '../EditableSettingsContext';\nimport { useEditableSettingsDispatch, useEditableSettings } from '../EditableSettingsContext';\nimport GroupPageSkeleton from './GroupPageSkeleton';\n\ntype GroupPageProps = {\n\tchildren: ReactNode;\n\theaderButtons?: ReactNode;\n\t_id: string;\n\ti18nLabel: string;\n\ti18nDescription?: string;\n\ttabs?: ReactNode;\n\tisCustom?: boolean;\n};\n\nconst GroupPage: FC<GroupPageProps> = ({\n\tchildren = undefined,\n\theaderButtons = undefined,\n\t_id,\n\ti18nLabel,\n\ti18nDescription = undefined,\n\ttabs = undefined,\n\tisCustom = false,\n}) => {\n\tconst t = useTranslation();\n\tconst user = useUser();\n\tconst router = useRoute('admin-settings');\n\tconst dispatch = useSettingsDispatch();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst loadLanguage = useLoadLanguage();\n\n\tconst changedEditableSettings = useEditableSettings(\n\t\tuseMemo(\n\t\t\t() => ({\n\t\t\t\tgroup: _id,\n\t\t\t\tchanged: true,\n\t\t\t}),\n\t\t\t[_id],\n\t\t),\n\t);\n\n\tconst originalSettings = useSettings(\n\t\tuseMemo(\n\t\t\t() => ({\n\t\t\t\t_id: changedEditableSettings.map(({ _id }) => _id),\n\t\t\t}),\n\t\t\t[changedEditableSettings],\n\t\t),\n\t);\n\n\tconst isColorSetting = (setting: ISetting): setting is ISettingColor => setting.type === 'color';\n\n\tconst save = useMutableCallback(async () => {\n\t\tconst changes = changedEditableSettings.map((setting) => {\n\t\t\tif (isColorSetting(setting)) {\n\t\t\t\treturn {\n\t\t\t\t\t_id: setting._id,\n\t\t\t\t\tvalue: setting.value,\n\t\t\t\t\teditor: setting.editor,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\t_id: setting._id,\n\t\t\t\tvalue: setting.value,\n\t\t\t};\n\t\t});\n\n\t\tif (changes.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tawait dispatch(changes);\n\n\t\t\tif (changes.some(({ _id }) => _id === 'Language')) {\n\t\t\t\tconst lng = user?.language || changes.filter(({ _id }) => _id === 'Language').shift()?.value || 'en';\n\t\t\t\tif (typeof lng === 'string') {\n\t\t\t\t\tawait loadLanguage(lng);\n\t\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Settings_updated', { lng }) });\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthrow new Error('lng is not a string');\n\t\t\t}\n\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Settings_updated') });\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst dispatchToEditing = useEditableSettingsDispatch();\n\n\tconst cancel = useMutableCallback(() => {\n\t\tconst settingsToDispatch = changedEditableSettings\n\t\t\t.map(({ _id }) => originalSettings.find((setting) => setting._id === _id))\n\t\t\t.map((setting) => {\n\t\t\t\tif (!setting) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (isColorSetting(setting)) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t_id: setting._id,\n\t\t\t\t\t\tvalue: setting.value,\n\t\t\t\t\t\teditor: setting.editor,\n\t\t\t\t\t\tchanged: false,\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\t_id: setting._id,\n\t\t\t\t\tvalue: setting.value,\n\t\t\t\t\tchanged: false,\n\t\t\t\t};\n\t\t\t})\n\t\t\t.filter(Boolean);\n\t\tdispatchToEditing(settingsToDispatch as Partial<EditableSetting>[]);\n\t});\n\n\tconst handleSubmit = (event: FormEvent<HTMLFormElement>): void => {\n\t\tevent.preventDefault();\n\t\tsave();\n\t};\n\n\tconst handleBack = useMutableCallback(() => router.push({}));\n\n\tconst handleCancelClick = (event: MouseEvent<HTMLOrSVGElement>): void => {\n\t\tevent.preventDefault();\n\t\tcancel();\n\t};\n\n\tconst handleSaveClick = (event: MouseEvent<HTMLOrSVGElement>): void => {\n\t\tevent.preventDefault();\n\t\tsave();\n\t};\n\n\tif (!_id) {\n\t\treturn <Page>{children}</Page>;\n\t}\n\n\t// The settings\n\tconst isTranslationKey = (key: string): key is TranslationKey => (key as TranslationKey) !== undefined;\n\n\treturn (\n\t\t<Page is='form' action='#' method='post' onSubmit={handleSubmit}>\n\t\t\t<Page.Header onClickBack={handleBack} title={i18nLabel && isTranslationKey(i18nLabel) && t(i18nLabel)}>\n\t\t\t\t<ButtonGroup>{headerButtons}</ButtonGroup>\n\t\t\t</Page.Header>\n\t\t\t{tabs}\n\t\t\t{isCustom ? (\n\t\t\t\tchildren\n\t\t\t) : (\n\t\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t\t<Box marginBlock='none' marginInline='auto' width='full' maxWidth='x580'>\n\t\t\t\t\t\t{i18nDescription && isTranslationKey(i18nDescription) && t.has(i18nDescription) && (\n\t\t\t\t\t\t\t<Box is='p' color='hint' fontScale='p2'>\n\t\t\t\t\t\t\t\t{t(i18nDescription)}\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t<Accordion className='page-settings'>{children}</Accordion>\n\t\t\t\t\t</Box>\n\t\t\t\t</Page.ScrollableContentWithShadow>\n\t\t\t)}\n\t\t\t<Page.Footer isDirty={!(changedEditableSettings.length === 0)}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t{changedEditableSettings.length > 0 && (\n\t\t\t\t\t\t<Button type='reset' onClick={handleCancelClick}>\n\t\t\t\t\t\t\t{t('Cancel')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tchildren={t('Save_changes')}\n\t\t\t\t\t\tclassName='save'\n\t\t\t\t\t\tdisabled={changedEditableSettings.length === 0}\n\t\t\t\t\t\tprimary\n\t\t\t\t\t\ttype='submit'\n\t\t\t\t\t\tonClick={handleSaveClick}\n\t\t\t\t\t/>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Footer>\n\t\t</Page>\n\t);\n};\n\nexport default Object.assign(memo(GroupPage), {\n\tSkeleton: GroupPageSkeleton,\n});\n",null],"names":["_regeneratorRuntime","Accordion","Box","Button","ButtonGroup","useMutableCallback","useToastMessageDispatch","useUser","useSettingsDispatch","useSettings","useTranslation","useLoadLanguage","useRoute","React","useMemo","memo","Page","useEditableSettingsDispatch","useEditableSettings","GroupPageSkeleton","module","link","default","v","exportDefault","Object","assign","_ref","_ref$children","children","undefined","_ref$headerButtons","headerButtons","_id","i18nLabel","_ref$i18nDescription","i18nDescription","_ref$tabs","tabs","_ref$isCustom","isCustom","t","user","router","dispatch","dispatchToastMessage","loadLanguage","changedEditableSettings","group","changed","originalSettings","map","_ref2","isColorSetting","setting","type","save","changes","_changes$filter$shift","lng","async","_context","prev","next","value","editor","length","abrupt","awrap","some","_ref3","language","filter","_ref4","shift","message","Error","t0","stop","Promise","dispatchToEditing","cancel","_ref5","find","Boolean","handleBack","push","createElement","isTranslationKey","key","is","action","method","onSubmit","event","preventDefault","Header","onClickBack","title","ScrollableContentWithShadow","marginBlock","marginInline","width","maxWidth","has","color","fontScale","className","Footer","isDirty","onClick","disabled","primary","Skeleton"],"mappings":"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"}