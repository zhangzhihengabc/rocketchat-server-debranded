)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/settings/Setting.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { ISettingColor, SettingEditor, SettingValue } from '@rocket.chat/core-typings';\nimport { isSettingColor, isSetting } from '@rocket.chat/core-typings';\nimport { Button } from '@rocket.chat/fuselage';\nimport { useDebouncedCallback } from '@rocket.chat/fuselage-hooks';\nimport { ExternalLink } from '@rocket.chat/ui-client';\nimport { useSettingStructure, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useEffect, useMemo, useState, useCallback } from 'react';\n\nimport MarkdownText from '../../../components/MarkdownText';\nimport { useEditableSetting, useEditableSettingsDispatch, useIsEnterprise } from '../EditableSettingsContext';\nimport MemoizedSetting from './MemoizedSetting';\nimport SettingSkeleton from './SettingSkeleton';\n\ntype SettingProps = {\n\tclassName?: string;\n\tsettingId: string;\n\tsectionChanged?: boolean;\n};\n\nfunction Setting({ className = undefined, settingId, sectionChanged }: SettingProps): ReactElement {\n\tconst setting = useEditableSetting(settingId);\n\tconst persistedSetting = useSettingStructure(settingId);\n\tconst isEnterprise = useIsEnterprise();\n\n\tif (!setting || !persistedSetting) {\n\t\tthrow new Error(`Setting ${settingId} not found`);\n\t}\n\n\t// Checks if setting has at least required fields before doing anything\n\tif (!isSetting(setting)) {\n\t\tthrow new Error(`Setting ${settingId} is not valid`);\n\t}\n\n\tconst dispatch = useEditableSettingsDispatch();\n\n\tconst update = useDebouncedCallback(\n\t\t({ value, editor }: { value?: SettingValue; editor?: SettingEditor }) => {\n\t\t\tif (!persistedSetting) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdispatch([\n\t\t\t\t{\n\t\t\t\t\t_id: persistedSetting._id,\n\t\t\t\t\t...(value !== undefined && { value }),\n\t\t\t\t\t...(editor !== undefined && { editor }),\n\t\t\t\t\tchanged:\n\t\t\t\t\t\tJSON.stringify(persistedSetting.value) !== JSON.stringify(value) ||\n\t\t\t\t\t\t(isSettingColor(persistedSetting) && JSON.stringify(persistedSetting.editor) !== JSON.stringify(editor)),\n\t\t\t\t},\n\t\t\t]);\n\t\t},\n\t\t230,\n\t\t[persistedSetting, dispatch],\n\t);\n\n\tconst t = useTranslation();\n\n\tconst [value, setValue] = useState(setting.value);\n\tconst [editor, setEditor] = useState(isSettingColor(setting) ? setting.editor : undefined);\n\n\tuseEffect(() => {\n\t\tsetValue(setting.value);\n\t}, [setting.value]);\n\n\tuseEffect(() => {\n\t\tsetEditor(isSettingColor(setting) ? setting.editor : undefined);\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [(setting as ISettingColor).editor]);\n\n\tconst onChangeValue = useCallback(\n\t\t(value) => {\n\t\t\tsetValue(value);\n\t\t\tupdate({ value });\n\t\t},\n\t\t[update],\n\t);\n\n\tconst onChangeEditor = useCallback(\n\t\t(editor) => {\n\t\t\tsetEditor(editor);\n\t\t\tupdate({ editor });\n\t\t},\n\t\t[update],\n\t);\n\n\tconst onResetButtonClick = useCallback(() => {\n\t\tsetValue(setting.value);\n\t\tsetEditor(isSettingColor(setting) ? setting.editor : undefined);\n\t\tupdate({\n\t\t\tvalue: persistedSetting.packageValue,\n\t\t\t...(isSettingColor(persistedSetting) && { editor: persistedSetting.packageEditor }),\n\t\t});\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [setting.value, (setting as ISettingColor).editor, update, persistedSetting]);\n\n\tconst { _id, disabled, readonly, type, packageValue, i18nLabel, i18nDescription, alert, invisible } = setting;\n\n\tconst label = (t.has(i18nLabel) && t(i18nLabel)) || (t.has(_id) && t(_id)) || i18nLabel || _id;\n\n\tconst hint = useMemo(\n\t\t() =>\n\t\t\ti18nDescription && t.has(i18nDescription) ? <MarkdownText variant='inline' preserveHtml content={t(i18nDescription)} /> : undefined,\n\t\t[i18nDescription, t],\n\t);\n\tconst callout = useMemo(() => alert && <span dangerouslySetInnerHTML={{ __html: t.has(alert) ? t(alert) : alert }} />, [alert, t]);\n\n\tconst shouldDisableEnterprise = setting.enterprise && !isEnterprise;\n\n\tconst PRICING_URL = 'https://go.rocket.chat/i/see-paid-plan-customize-homepage';\n\n\tconst showUpgradeButton = useMemo(\n\t\t() =>\n\t\t\tshouldDisableEnterprise ? (\n\t\t\t\t<ExternalLink to={PRICING_URL}>\n\t\t\t\t\t<Button>{t('See_Paid_Plan')}</Button>\n\t\t\t\t</ExternalLink>\n\t\t\t) : undefined,\n\t\t[shouldDisableEnterprise, t],\n\t);\n\n\tconst hasResetButton =\n\t\t!shouldDisableEnterprise &&\n\t\t!readonly &&\n\t\ttype !== 'asset' &&\n\t\t((isSettingColor(setting) && JSON.stringify(setting.packageEditor) !== JSON.stringify(editor)) ||\n\t\t\tJSON.stringify(value) !== JSON.stringify(packageValue)) &&\n\t\t!disabled;\n\n\t// @todo: type check props based on setting type\n\n\treturn (\n\t\t<MemoizedSetting\n\t\t\tclassName={className}\n\t\t\tlabel={label || undefined}\n\t\t\thint={hint}\n\t\t\tcallout={callout}\n\t\t\tshowUpgradeButton={showUpgradeButton}\n\t\t\tsectionChanged={sectionChanged}\n\t\t\t{...setting}\n\t\t\tdisabled={setting.disabled || shouldDisableEnterprise}\n\t\t\tvalue={value}\n\t\t\teditor={editor}\n\t\t\thasResetButton={hasResetButton}\n\t\t\tonChangeValue={onChangeValue}\n\t\t\tonChangeEditor={onChangeEditor}\n\t\t\tonResetButtonClick={onResetButtonClick}\n\t\t\tinvisible={invisible}\n\t\t/>\n\t);\n}\n\nexport default Object.assign(Setting, {\n\tMemoized: MemoizedSetting,\n\tSkeleton: SettingSkeleton,\n});\n",null],"names":["_extends","_slicedToArray","_objectSpread","isSettingColor","isSetting","Button","useDebouncedCallback","ExternalLink","useSettingStructure","useTranslation","React","useEffect","useMemo","useState","useCallback","MarkdownText","useEditableSetting","useEditableSettingsDispatch","useIsEnterprise","MemoizedSetting","SettingSkeleton","module","default","v","link","exportDefault","Object","assign","_ref","_ref$className","className","settingId","sectionChanged","setting","persistedSetting","isEnterprise","Error","dispatch","update","_ref2","value","editor","_id","undefined","changed","JSON","stringify","t","_useState2","setValue","_useState4","setEditor","onChangeValue","onChangeEditor","onResetButtonClick","packageValue","packageEditor","disabled","readonly","type","i18nLabel","i18nDescription","alert","invisible","label","has","hint","createElement","variant","preserveHtml","content","callout","dangerouslySetInnerHTML","__html","shouldDisableEnterprise","enterprise","showUpgradeButton","to","hasResetButton","Memoized","Skeleton"],"mappings":"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"}