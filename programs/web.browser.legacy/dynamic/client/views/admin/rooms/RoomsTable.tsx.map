)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/rooms/RoomsTable.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Pagination, States, StatesIcon, StatesTitle, StatesActions, StatesAction } from '@rocket.chat/fuselage';\nimport { useMediaQuery, useDebouncedValue } from '@rocket.chat/fuselage-hooks';\nimport type { OptionProp } from '@rocket.chat/ui-client';\nimport { useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useQuery } from '@tanstack/react-query';\nimport type { ReactElement, MutableRefObject } from 'react';\nimport React, { useRef, useState, useEffect, useMemo } from 'react';\n\nimport GenericNoResults from '../../../components/GenericNoResults';\nimport {\n\tGenericTable,\n\tGenericTableBody,\n\tGenericTableHeader,\n\tGenericTableHeaderCell,\n\tGenericTableLoadingTable,\n} from '../../../components/GenericTable';\nimport { usePagination } from '../../../components/GenericTable/hooks/usePagination';\nimport { useSort } from '../../../components/GenericTable/hooks/useSort';\nimport RoomRow from './RoomRow';\nimport RoomsTableFilters from './RoomsTableFilters';\n\ntype RoomFilters = {\n\tsearchText: string;\n\ttypes: OptionProp[];\n};\n\nconst DEFAULT_TYPES = ['d', 'p', 'c', 'l', 'discussions', 'teams'];\n\nconst RoomsTable = ({ reload }: { reload: MutableRefObject<() => void> }): ReactElement => {\n\tconst t = useTranslation();\n\tconst mediaQuery = useMediaQuery('(min-width: 1024px)');\n\n\tconst [roomFilters, setRoomFilters] = useState<RoomFilters>({ searchText: '', types: [] });\n\n\tconst prevRoomFilterText = useRef<string>(roomFilters.searchText);\n\n\tconst { sortBy, sortDirection, setSort } = useSort<'name' | 't' | 'usersCount' | 'msgs' | 'default' | 'featured'>('name');\n\tconst { current, itemsPerPage, setItemsPerPage, setCurrent, ...paginationProps } = usePagination();\n\tconst searchText = useDebouncedValue(roomFilters.searchText, 500);\n\n\tconst query = useDebouncedValue(\n\t\tuseMemo(() => {\n\t\t\tif (searchText !== prevRoomFilterText.current) {\n\t\t\t\tsetCurrent(0);\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tfilter: searchText || '',\n\t\t\t\tsort: `{ \"${sortBy}\": ${sortDirection === 'asc' ? 1 : -1} }`,\n\t\t\t\tcount: itemsPerPage,\n\t\t\t\toffset: searchText === prevRoomFilterText.current ? current : 0,\n\t\t\t\ttypes: roomFilters.types.length ? [...roomFilters.types.map((roomType) => roomType.id)] : DEFAULT_TYPES,\n\t\t\t};\n\t\t}, [searchText, sortBy, sortDirection, itemsPerPage, current, roomFilters.types, setCurrent]),\n\t\t500,\n\t);\n\n\tconst getAdminRooms = useEndpoint('GET', '/v1/rooms.adminRooms');\n\n\tconst { data, refetch, isSuccess, isLoading, isError } = useQuery(['rooms', query, 'admin'], async () => getAdminRooms(query));\n\n\tuseEffect(() => {\n\t\treload.current = refetch;\n\t}, [reload, refetch]);\n\n\tuseEffect(() => {\n\t\tprevRoomFilterText.current = searchText;\n\t}, [searchText]);\n\n\tconst headers = (\n\t\t<>\n\t\t\t<GenericTableHeaderCell key='name' direction={sortDirection} active={sortBy === 'name'} onClick={setSort} sort='name' w='x200'>\n\t\t\t\t{t('Name')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell key='type' direction={sortDirection} active={sortBy === 't'} onClick={setSort} sort='t' w='x100'>\n\t\t\t\t{t('Type')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell\n\t\t\t\tkey='users'\n\t\t\t\tdirection={sortDirection}\n\t\t\t\tactive={sortBy === 'usersCount'}\n\t\t\t\tonClick={setSort}\n\t\t\t\tsort='usersCount'\n\t\t\t\tw='x80'\n\t\t\t>\n\t\t\t\t{t('Users')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t{mediaQuery && (\n\t\t\t\t<>\n\t\t\t\t\t<GenericTableHeaderCell key='messages' direction={sortDirection} active={sortBy === 'msgs'} onClick={setSort} sort='msgs' w='x80'>\n\t\t\t\t\t\t{t('Msgs')}\n\t\t\t\t\t</GenericTableHeaderCell>\n\t\t\t\t\t<GenericTableHeaderCell\n\t\t\t\t\t\tkey='default'\n\t\t\t\t\t\tdirection={sortDirection}\n\t\t\t\t\t\tactive={sortBy === 'default'}\n\t\t\t\t\t\tonClick={setSort}\n\t\t\t\t\t\tsort='default'\n\t\t\t\t\t\tw='x80'\n\t\t\t\t\t>\n\t\t\t\t\t\t{t('Default')}\n\t\t\t\t\t</GenericTableHeaderCell>\n\t\t\t\t\t<GenericTableHeaderCell\n\t\t\t\t\t\tkey='featured'\n\t\t\t\t\t\tdirection={sortDirection}\n\t\t\t\t\t\tactive={sortBy === 'featured'}\n\t\t\t\t\t\tonClick={setSort}\n\t\t\t\t\t\tsort='featured'\n\t\t\t\t\t\tw='x80'\n\t\t\t\t\t>\n\t\t\t\t\t\t{t('Featured')}\n\t\t\t\t\t</GenericTableHeaderCell>\n\t\t\t\t</>\n\t\t\t)}\n\t\t</>\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t<RoomsTableFilters setFilters={setRoomFilters} />\n\t\t\t{isLoading && (\n\t\t\t\t<GenericTable>\n\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t<GenericTableLoadingTable headerCells={mediaQuery ? 6 : 3} />\n\t\t\t\t\t</GenericTableBody>\n\t\t\t\t</GenericTable>\n\t\t\t)}\n\t\t\t{isSuccess && data.rooms.length === 0 && <GenericNoResults />}\n\t\t\t{isSuccess && data.rooms.length > 0 && (\n\t\t\t\t<>\n\t\t\t\t\t<GenericTable>\n\t\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t\t{data.rooms?.map((room) => (\n\t\t\t\t\t\t\t\t<RoomRow key={room._id} room={room} />\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</GenericTableBody>\n\t\t\t\t\t</GenericTable>\n\t\t\t\t\t<Pagination\n\t\t\t\t\t\tdivider\n\t\t\t\t\t\tcurrent={current}\n\t\t\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\t\t\tcount={data?.total || 0}\n\t\t\t\t\t\tonSetItemsPerPage={setItemsPerPage}\n\t\t\t\t\t\tonSetCurrent={setCurrent}\n\t\t\t\t\t\t{...paginationProps}\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t)}\n\t\t\t{isError && (\n\t\t\t\t<States>\n\t\t\t\t\t<StatesIcon name='warning' variation='danger' />\n\t\t\t\t\t<StatesTitle>{t('Something_went_wrong')}</StatesTitle>\n\t\t\t\t\t<StatesActions>\n\t\t\t\t\t\t<StatesAction onClick={() => refetch()}>{t('Reload_page')}</StatesAction>\n\t\t\t\t\t</StatesActions>\n\t\t\t\t</States>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default RoomsTable;\n",null],"names":["_regeneratorRuntime","_extends","_toConsumableArray","_objectWithoutProperties","_slicedToArray","Pagination","States","StatesIcon","StatesTitle","StatesActions","StatesAction","useMediaQuery","useDebouncedValue","useEndpoint","useTranslation","useQuery","React","useRef","useState","useEffect","useMemo","GenericNoResults","GenericTable","GenericTableBody","GenericTableHeader","GenericTableHeaderCell","GenericTableLoadingTable","usePagination","useSort","RoomRow","RoomsTableFilters","module","link","default","v","DEFAULT_TYPES","exportDefault","_ref","_data$rooms","reload","t","mediaQuery","_useState2","searchText","types","roomFilters","setRoomFilters","prevRoomFilterText","_useSort","sortBy","sortDirection","setSort","_usePagination","current","itemsPerPage","setItemsPerPage","setCurrent","paginationProps","_excluded","query","filter","sort","count","offset","length","map","roomType","id","getAdminRooms","_useQuery","async","_context","prev","next","abrupt","stop","Promise","data","refetch","isSuccess","isLoading","isError","headers","createElement","Fragment","key","direction","active","onClick","w","setFilters","headerCells","rooms","room","_id","divider","total","onSetItemsPerPage","onSetCurrent","name","variation"],"mappings":"2BAAAA,EAAiHC,EAAAC,EAAAC,EAAAC,EAAjHC,EAASC,EAAYC,EAAQC,EAAYC,EAAaC,EAA2DC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,8DAA5FC,EAAQC,IAAA,CAAA,6BAAyB,CAAAC,QAAe,SAAcC,CAAAA,EAAAlC,EAAMkC,CAAA,CAAA,EAAA,GAAwBH,EAAAA,IAAAA,CAAAA,iCAAAA,CAAAE,QAAAA,SAAAA,CAAAA,EAAAhC,EAAAA,CAAA,CAAA,EAAA,GAAA8B,EAAAA,IAAAA,CAAAA,2CAAAA,CAAAE,QAAAA,SAAAA,CAAAA,EAAA/B,EAAAA,CAAA,CAAA,EAAA,GAAA6B,EAAAA,IAAAA,CAAAA,iDAAAA,CAAAE,QAAAA,SAAAA,CAAAA,EAAA9B,EAAAA,CAAA,CAAA,EAAA,GAAA4B,EAAAA,IAAAA,CAAAA,uCAAAA,CAAAE,QAAAA,SAAAA,CAAAA,EAAA7B,EAAAA,CAAA,CAAA,EAAA,GAA5C2B,EAAAA,IAAc,CAAA,wBAAM,CAAA1B,WAAwB,SAAA6B,CAAA,EAAA7B,EAAAA,CAAA,EAAAC,OAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,WAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,cAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,aAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAqB,EAAAA,IAAAA,CAAAA,8BAAAA,CAAApB,cAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,kBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAmB,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAlB,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAiB,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAhB,SAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAgB,EAAAA,IAAAA,CAAAA,QAAAA,CAAA,QAAA,SAAAG,CAAA,EAAAlB,EAAAA,CAAA,EAAAC,OAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,SAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,UAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,QAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAW,EAAAA,IAAAA,CAAAA,uCAAAA,CAAA,QAAA,SAAAG,CAAA,EAAAb,EAAAA,CAAA,CAAA,EAAA,GAAAU,EAAAA,IAAAA,CAAAA,mCAAAA,CAAAT,aAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,iBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,mBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,uBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,yBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAK,EAAAA,IAAAA,CAAAA,uDAAAA,CAAAJ,cAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,iDAAAA,CAAAH,QAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,YAAAA,CAAA,QAAA,SAAAG,CAAA,EAAAL,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,sBAAAA,CAAA,QAAA,SAAAG,CAAA,EAAAJ,EAAAA,CAAA,CAAA,EAAA,IA0BjH,IAAMK,EAAgB,CAAC,IAAK,IAAK,IAAK,IAAK,cAAe,QAAQ,CA1BlEJ,EAAOK,aAAY,CA4BA,SAAAC,CAAA,EAAuE,IAAAC,EAApEC,EAAMF,EAANE,MAAM,CACrBC,EAAI1B,IACJ2B,EAAa9B,EAAc,uBAEyD+B,EAAAtC,EAApDc,EAAsB,CAAEyB,WAAY,GAAIC,MAAO,EAAA,AAAE,GAAG,GAAnFC,EAAWH,CAAA,CAAA,EAAA,CAAEI,EAAcJ,CAAA,CAAA,EAAA,CAE5BK,EAAqB9B,EAAe4B,EAAYF,UAAU,EAEhEK,EAA2CpB,EAAuE,QAA1GqB,EAAMD,EAANC,MAAM,CAAEC,EAAaF,EAAbE,aAAa,CAAEC,EAAOH,EAAPG,OAAO,CACtCC,EAAmFzB,IAA3E0B,EAAOD,EAAPC,OAAO,CAAEC,EAAYF,EAAZE,YAAY,CAAEC,EAAeH,EAAfG,eAAe,CAAEC,EAAUJ,EAAVI,UAAU,CAAKC,EAAetD,EAAAiD,EAAAM,GACxEf,EAAa/B,EAAkBiC,EAAYF,UAAU,CAAE,KAEvDgB,EAAQ/C,EACbQ,EAAQ,WAIP,OAHIuB,IAAeI,EAAmBM,OAAO,EAC5CG,EAAW,GAEL,CACNI,OAAQjB,GAAc,GACtBkB,KAAI,MAAQZ,EAAM,MAAMC,CAAAA,AAAkB,QAAlBA,EAA0B,EAAI,EAAC,EAAC,KACxDY,MAAOR,EACPS,OAAQpB,IAAeI,EAAmBM,OAAO,CAAGA,EAAU,EAC9DT,MAAOC,EAAYD,KAAK,CAACoB,MAAM,CAAA9D,EAAO2C,EAAYD,KAAK,CAACqB,GAAG,CAAC,SAACC,CAAQ,EAAA,OAAKA,EAASC,EAAE,IAAKhC,EAE5F,EAAG,CAACQ,EAAYM,EAAQC,EAAeI,EAAcD,EAASR,EAAYD,KAAK,CAAEY,EAAW,EAC5F,KAGKY,GAAgBvD,EAAY,MAAO,wBAEzCwD,GAAyDtD,EAAS,CAAC,QAAS4C,EAAO,QAAQ,CAAE,WAAA,OAAA3D,EAAAsE,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAAA,OAAAF,EAAAG,MAAA,CAAA,SAAYN,GAAcT,GAAM,MAAA,EAAA,IAAA,MAAA,OAAAY,EAAAI,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,GAArHC,GAAIR,GAAJQ,IAAI,CAAEC,GAAOT,GAAPS,OAAO,CAAEC,GAASV,GAATU,SAAS,CAAEC,GAASX,GAATW,SAAS,CAAEC,GAAOZ,GAAPY,OAAO,CAEpD9D,EAAU,WACToB,EAAOc,OAAO,CAAGyB,EAClB,EAAG,CAACvC,EAAQuC,GAAQ,EAEpB3D,EAAU,WACT4B,EAAmBM,OAAO,CAAGV,CAC9B,EAAG,CAACA,EAAW,EAEf,IAAMuC,GACLlE,EAAAmE,aAAA,CAAAnE,EAAAoE,QAAA,CAAA,KACCpE,EAAAmE,aAAA,CAAC1D,EAAsB,CAAC4D,IAAI,OAAOC,UAAWpC,EAAeqC,OAAQtC,AAAW,SAAXA,EAAmBuC,QAASrC,EAASU,KAAK,OAAO4B,EAAE,MAAM,EAC5HjD,EAAE,SAEJxB,EAAAmE,aAAA,CAAC1D,EAAsB,CAAC4D,IAAI,OAAOC,UAAWpC,EAAeqC,OAAQtC,AAAW,MAAXA,EAAgBuC,QAASrC,EAASU,KAAK,IAAI4B,EAAE,MAAM,EACtHjD,EAAE,SAEJxB,EAAAmE,aAAA,CAAC1D,EAAsB,CACtB4D,IAAI,QACJC,UAAWpC,EACXqC,OAAQtC,AAAW,eAAXA,EACRuC,QAASrC,EACTU,KAAK,aACL4B,EAAE,KAAK,EAENjD,EAAE,UAEHC,GACAzB,EAAAmE,aAAA,CAAAnE,EAAAoE,QAAA,CAAA,KACCpE,EAAAmE,aAAA,CAAC1D,EAAsB,CAAC4D,IAAI,WAAWC,UAAWpC,EAAeqC,OAAQtC,AAAW,SAAXA,EAAmBuC,QAASrC,EAASU,KAAK,OAAO4B,EAAE,KAAK,EAC/HjD,EAAE,SAEJxB,EAAAmE,aAAA,CAAC1D,EAAsB,CACtB4D,IAAI,UACJC,UAAWpC,EACXqC,OAAQtC,AAAW,YAAXA,EACRuC,QAASrC,EACTU,KAAK,UACL4B,EAAE,KAAK,EAENjD,EAAE,YAEJxB,EAAAmE,aAAA,CAAC1D,EAAsB,CACtB4D,IAAI,WACJC,UAAWpC,EACXqC,OAAQtC,AAAW,aAAXA,EACRuC,QAASrC,EACTU,KAAK,WACL4B,EAAE,KAAK,EAENjD,EAAE,eAOR,OACCxB,EAAAmE,aAAA,CAAAnE,EAAAoE,QAAA,CAAA,KACCpE,EAAAmE,aAAA,CAACrD,EAAiB,CAAC4D,WAAY5C,CAAe,GAC7CkC,IACAhE,EAAAmE,aAAA,CAAC7D,EAAY,KACZN,EAAAmE,aAAA,CAAC3D,EAAkB,KAAE0D,IACrBlE,EAAAmE,aAAA,CAAC5D,EAAgB,KAChBP,EAAAmE,aAAA,CAACzD,EAAwB,CAACiE,YAAalD,EAAa,EAAI,CAAE,KAI5DsC,IAAaF,AAAsB,IAAtBA,GAAKe,KAAK,CAAC5B,MAAM,EAAUhD,EAAAmE,aAAA,CAAC9D,EAAgB,MACzD0D,IAAaF,GAAKe,KAAK,CAAC5B,MAAM,CAAG,GACjChD,EAAAmE,aAAA,CAAAnE,EAAAoE,QAAA,CAAA,KACCpE,EAAAmE,aAAA,CAAC7D,EAAY,KACZN,EAAAmE,aAAA,CAAC3D,EAAkB,KAAE0D,IACrBlE,EAAAmE,aAAA,CAAC5D,EAAgB,KAAA,AACL,OADKe,CAAAA,EACfuC,GAAKe,KAAK,AAALA,GAAKtD,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAVA,EAAY2B,GAAG,CAAC,SAAC4B,CAAI,EAAA,OACrB7E,EAAAmE,aAAA,CAACtD,EAAO,CAACwD,IAAKQ,EAAKC,GAAI,CAACD,KAAMA,CAAK,EAAG,KAIzC7E,EAAAmE,aAAA,CAAC9E,EAAUJ,EAAA,CACV8F,QAAO,CAAA,EACP1C,QAASA,EACTC,aAAcA,EACdQ,MAAO,AAAAe,CAAAA,MAAAA,GAAI,KAAA,EAAJA,GAAMmB,KAAK,AAALA,GAAS,EACtBC,kBAAmB1C,EACnB2C,aAAc1C,CAAW,EACrBC,KAINwB,IACAjE,EAAAmE,aAAA,CAAC7E,EAAM,KACNU,EAAAmE,aAAA,CAAC5E,EAAU,CAAC4F,KAAK,UAAUC,UAAU,QAAQ,GAC7CpF,EAAAmE,aAAA,CAAC3E,EAAW,KAAEgC,EAAE,yBAChBxB,EAAAmE,aAAA,CAAC1E,EAAa,KACbO,EAAAmE,aAAA,CAACzE,EAAY,CAAC8E,QAAS,WAAA,OAAMV,IAAS,CAAC,EAAEtC,EAAE,kBAMjD"}