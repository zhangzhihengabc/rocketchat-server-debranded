)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/integrations/incoming/EditIncomingWebhook.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IIncomingIntegration, Serialized } from '@rocket.chat/core-typings';\nimport { Button, ButtonGroup, Tabs, TabsItem } from '@rocket.chat/fuselage';\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport { useSetModal, useTranslation, useRouter, useRouteParameter } from '@rocket.chat/ui-contexts';\nimport React, { useCallback } from 'react';\nimport { FormProvider, useForm } from 'react-hook-form';\n\nimport GenericModal from '../../../../components/GenericModal';\nimport Page from '../../../../components/Page';\nimport { useCreateIntegration } from '../hooks/useCreateIntegration';\nimport { useDeleteIntegration } from '../hooks/useDeleteIntegration';\nimport { useUpdateIntegration } from '../hooks/useUpdateIntegration';\nimport IncomingWebhookForm from './IncomingWebhookForm';\n\nconst getInitialValue = (webhookData: Serialized<IIncomingIntegration> | undefined) => ({\n\tenabled: webhookData?.enabled || false,\n\tchannel: webhookData?.channel.join(', ') || '',\n\tusername: webhookData?.username || '',\n\tname: webhookData?.name || '',\n\talias: webhookData?.alias || '',\n\tavatar: webhookData?.avatar || '',\n\temoji: webhookData?.emoji || '',\n\tscriptEnabled: webhookData?.scriptEnabled || false,\n\tscriptEngine: webhookData?.scriptEngine || 'isolated-vm',\n\toverrideDestinationChannelEnabled: webhookData?.overrideDestinationChannelEnabled || false,\n\tscript: webhookData?.script || '',\n});\n\nconst INCOMING_TYPE = 'webhook-incoming';\n\nconst EditIncomingWebhook = ({ webhookData }: { webhookData?: Serialized<IIncomingIntegration> }) => {\n\tconst t = useTranslation();\n\tconst router = useRouter();\n\tconst setModal = useSetModal();\n\tconst tab = useRouteParameter('type');\n\n\tconst deleteIntegration = useDeleteIntegration(INCOMING_TYPE);\n\tconst updateIntegration = useUpdateIntegration(INCOMING_TYPE);\n\tconst createIntegration = useCreateIntegration(INCOMING_TYPE);\n\n\tconst methods = useForm({ mode: 'onBlur', values: getInitialValue(webhookData) });\n\n\tconst {\n\t\treset,\n\t\thandleSubmit,\n\t\tformState: { isDirty },\n\t} = methods;\n\n\tconst handleDeleteIntegration = useCallback(() => {\n\t\tconst onDelete = async () => {\n\t\t\tif (!webhookData?._id) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdeleteIntegration.mutate({ integrationId: webhookData._id, type: INCOMING_TYPE });\n\t\t};\n\n\t\tsetModal(\n\t\t\t<GenericModal variant='danger' onConfirm={onDelete} onCancel={() => setModal(null)} confirmText={t('Delete')}>\n\t\t\t\t{t('Integration_Delete_Warning')}\n\t\t\t</GenericModal>,\n\t\t);\n\t}, [webhookData?._id, deleteIntegration, setModal, t]);\n\n\tconst handleSave = useCallback(\n\t\tasync (formValues) => {\n\t\t\tif (webhookData?._id) {\n\t\t\t\treturn updateIntegration.mutate({ integrationId: webhookData?._id, type: INCOMING_TYPE, ...formValues });\n\t\t\t}\n\n\t\t\treturn createIntegration.mutate({ type: INCOMING_TYPE, ...formValues });\n\t\t},\n\t\t[webhookData?._id, updateIntegration, createIntegration],\n\t);\n\n\tconst formId = useUniqueId();\n\n\treturn (\n\t\t<Page flexDirection='column'>\n\t\t\t<Page.Header title={t('Integration_Incoming_WebHook')}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t<Button icon='back' onClick={() => router.navigate('/admin/integrations/webhook-incoming')}>\n\t\t\t\t\t\t{t('Back')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t{webhookData?._id && (\n\t\t\t\t\t\t<Button danger onClick={handleDeleteIntegration}>\n\t\t\t\t\t\t\t{t('Delete')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Header>\n\t\t\t{!webhookData?._id && (\n\t\t\t\t<Tabs>\n\t\t\t\t\t<TabsItem selected={tab === 'incoming'} onClick={() => router.navigate('/admin/integrations/new/incoming')}>\n\t\t\t\t\t\t{t('Incoming')}\n\t\t\t\t\t</TabsItem>\n\t\t\t\t\t<TabsItem selected={tab === 'outgoing'} onClick={() => router.navigate('/admin/integrations/new/outgoing')}>\n\t\t\t\t\t\t{t('Outgoing')}\n\t\t\t\t\t</TabsItem>\n\t\t\t\t</Tabs>\n\t\t\t)}\n\t\t\t<Page.ScrollableContentWithShadow id={formId} is='form' onSubmit={handleSubmit(handleSave)}>\n\t\t\t\t<FormProvider {...methods}>\n\t\t\t\t\t<IncomingWebhookForm webhookData={webhookData} />\n\t\t\t\t</FormProvider>\n\t\t\t</Page.ScrollableContentWithShadow>\n\t\t\t<Page.Footer isDirty={isDirty}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t<Button type='reset' onClick={() => reset()}>\n\t\t\t\t\t\t{t('Cancel')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button form={formId} primary type='submit'>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Footer>\n\t\t</Page>\n\t);\n};\n\nexport default EditIncomingWebhook;\n",null],"names":["module","default","v","_objectSpread","_regeneratorRuntime","link","Button","ButtonGroup","Tabs","TabsItem","useUniqueId","useSetModal","useTranslation","useRouter","useRouteParameter","React","useCallback","FormProvider","useForm","GenericModal","Page","useCreateIntegration","useDeleteIntegration","useUpdateIntegration","IncomingWebhookForm","INCOMING_TYPE","exportDefault","_ref","webhookData","t","router","setModal","tab","deleteIntegration","updateIntegration","createIntegration","methods","mode","values","enabled","channel","join","username","name","alias","avatar","emoji","scriptEnabled","scriptEngine","overrideDestinationChannelEnabled","script","reset","handleSubmit","isDirty","formState","handleDeleteIntegration","createElement","variant","onConfirm","async","_context","prev","next","_id","abrupt","mutate","integrationId","type","stop","Promise","onCancel","confirmText","handleSave","formValues","_context2","formId","flexDirection","Header","title","icon","onClick","navigate","danger","selected","ScrollableContentWithShadow","id","is","onSubmit","Footer","form","primary"],"mappings":"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"}