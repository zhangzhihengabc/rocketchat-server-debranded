)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/customSounds/CustomSoundsTable/CustomSoundsTable.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Pagination, States, StatesIcon, StatesActions, StatesAction, StatesTitle } from '@rocket.chat/fuselage';\nimport { useDebouncedValue } from '@rocket.chat/fuselage-hooks';\nimport { escapeRegExp } from '@rocket.chat/string-helpers';\nimport { useTranslation, useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useQuery } from '@tanstack/react-query';\nimport type { MutableRefObject } from 'react';\nimport React, { useState, useMemo, useEffect } from 'react';\n\nimport FilterByText from '../../../../components/FilterByText';\nimport GenericNoResults from '../../../../components/GenericNoResults';\nimport {\n\tGenericTable,\n\tGenericTableBody,\n\tGenericTableHeader,\n\tGenericTableHeaderCell,\n\tGenericTableLoadingTable,\n} from '../../../../components/GenericTable';\nimport { usePagination } from '../../../../components/GenericTable/hooks/usePagination';\nimport { useSort } from '../../../../components/GenericTable/hooks/useSort';\nimport CustomSoundRow from './CustomSoundRow';\n\ntype CustomSoundsTableProps = {\n\tonClick: (soundId: string) => () => void;\n\treload: MutableRefObject<() => void>;\n};\n\nconst CustomSoundsTable = ({ reload, onClick }: CustomSoundsTableProps) => {\n\tconst t = useTranslation();\n\tconst { sortBy, sortDirection, setSort } = useSort<'name'>('name');\n\tconst { current, itemsPerPage, setItemsPerPage: onSetItemsPerPage, setCurrent: onSetCurrent, ...paginationProps } = usePagination();\n\n\tconst [text, setParams] = useState('');\n\n\tconst query = useDebouncedValue(\n\t\tuseMemo(\n\t\t\t() => ({\n\t\t\t\tquery: JSON.stringify({ name: { $regex: escapeRegExp(text), $options: 'i' } }),\n\t\t\t\tsort: `{ \"${sortBy}\": ${sortDirection === 'asc' ? 1 : -1} }`,\n\t\t\t\t...(itemsPerPage && { count: itemsPerPage }),\n\t\t\t\t...(current && { offset: current }),\n\t\t\t}),\n\t\t\t[text, itemsPerPage, current, sortBy, sortDirection],\n\t\t),\n\t\t500,\n\t);\n\n\tconst getSounds = useEndpoint('GET', '/v1/custom-sounds.list');\n\tconst { data, refetch, isLoading, isError, isSuccess } = useQuery(['custom-sounds', query], async () => getSounds(query), {\n\t\trefetchOnMount: false,\n\t});\n\n\tuseEffect(() => {\n\t\treload.current = refetch;\n\t}, [reload, refetch]);\n\n\tconst headers = (\n\t\t<>\n\t\t\t<GenericTableHeaderCell key='name' direction={sortDirection} active={sortBy === 'name'} onClick={setSort} sort='name'>\n\t\t\t\t{t('Name')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell w='x40' key='action' />\n\t\t</>\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t<FilterByText onChange={({ text }): void => setParams(text)} />\n\t\t\t{isLoading && (\n\t\t\t\t<GenericTable>\n\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t<GenericTableLoadingTable headerCells={2} />\n\t\t\t\t\t</GenericTableBody>\n\t\t\t\t</GenericTable>\n\t\t\t)}\n\t\t\t{isSuccess && data?.sounds.length > 0 && (\n\t\t\t\t<>\n\t\t\t\t\t<GenericTable>\n\t\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t\t{data.sounds.map((sound) => (\n\t\t\t\t\t\t\t\t<CustomSoundRow key={sound._id} sound={sound} onClick={onClick} />\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</GenericTableBody>\n\t\t\t\t\t</GenericTable>\n\t\t\t\t\t<Pagination\n\t\t\t\t\t\tdivider\n\t\t\t\t\t\tcurrent={current}\n\t\t\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\t\t\tcount={data.sounds.length || 0}\n\t\t\t\t\t\tonSetItemsPerPage={onSetItemsPerPage}\n\t\t\t\t\t\tonSetCurrent={onSetCurrent}\n\t\t\t\t\t\t{...paginationProps}\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t)}\n\t\t\t{isSuccess && data?.sounds.length === 0 && <GenericNoResults />}\n\t\t\t{isError && (\n\t\t\t\t<States>\n\t\t\t\t\t<StatesIcon name='warning' variation='danger' />\n\t\t\t\t\t<StatesTitle>{t('Something_went_wrong')}</StatesTitle>\n\t\t\t\t\t<StatesActions>\n\t\t\t\t\t\t<StatesAction onClick={() => refetch()}>{t('Reload_page')}</StatesAction>\n\t\t\t\t\t</StatesActions>\n\t\t\t\t</States>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default CustomSoundsTable;\n",null],"names":["_regeneratorRuntime","_extends","_objectSpread","_slicedToArray","_objectWithoutProperties","Pagination","States","StatesIcon","StatesActions","StatesAction","StatesTitle","useDebouncedValue","escapeRegExp","useTranslation","useEndpoint","useQuery","React","useState","useMemo","useEffect","FilterByText","GenericNoResults","GenericTable","GenericTableBody","GenericTableHeader","GenericTableHeaderCell","GenericTableLoadingTable","usePagination","useSort","CustomSoundRow","module","link","default","v","exportDefault","_ref","reload","onClick","t","_useSort","sortBy","sortDirection","setSort","_usePagination","current","itemsPerPage","onSetItemsPerPage","setItemsPerPage","onSetCurrent","setCurrent","paginationProps","_excluded","_useState2","text","setParams","query","JSON","stringify","name","$regex","$options","sort","count","offset","getSounds","_useQuery","async","_context","prev","next","abrupt","stop","Promise","refetchOnMount","data","refetch","isLoading","isError","isSuccess","headers","createElement","Fragment","key","direction","active","w","onChange","_ref2","headerCells","sounds","length","map","sound","_id","divider","variation"],"mappings":"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"}