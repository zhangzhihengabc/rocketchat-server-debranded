)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/moderation/hooks/useDeleteMessage.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useEndpoint, useSetModal, useToastMessageDispatch, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport React from 'react';\n\nimport GenericModal from '../../../../components/GenericModal';\n\nconst useDeleteMessage = (mid: string, rid: string, onChange: () => void) => {\n\tconst t = useTranslation();\n\tconst deleteMessage = useEndpoint('POST', '/v1/chat.delete');\n\tconst dismissMessage = useEndpoint('POST', '/v1/moderation.dismissReports');\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst setModal = useSetModal();\n\tconst queryClient = useQueryClient();\n\n\tconst handleDeleteMessages = useMutation({\n\t\tmutationFn: deleteMessage,\n\t\tonError: (error) => {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\tsetModal();\n\t\t},\n\t\tonSuccess: async () => {\n\t\t\tawait handleDismissMessage.mutateAsync({ msgId: mid });\n\t\t},\n\t});\n\n\tconst handleDismissMessage = useMutation({\n\t\tmutationFn: dismissMessage,\n\t\tonError: (error) => {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t},\n\t\tonSuccess: () => {\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Moderation_Message_deleted') });\n\t\t},\n\t\tonSettled: () => {\n\t\t\tonChange();\n\t\t\tqueryClient.invalidateQueries({ queryKey: ['moderation.reports'] });\n\t\t\tsetModal();\n\t\t},\n\t});\n\n\tconst onDeleteAll = async () => {\n\t\tawait handleDeleteMessages.mutateAsync({ msgId: mid, roomId: rid, asUser: true });\n\t};\n\n\tconst confirmDeletMessage = (): void => {\n\t\tsetModal(\n\t\t\t<GenericModal\n\t\t\t\tconfirmText={t('Moderation_Dismiss_and_delete')}\n\t\t\t\ttitle={t('Moderation_Delete_this_message')}\n\t\t\t\tvariant='danger'\n\t\t\t\tonConfirm={() => onDeleteAll()}\n\t\t\t\tonCancel={() => setModal()}\n\t\t\t>\n\t\t\t\t{t('Moderation_Are_you_sure_you_want_to_delete_this_message')}\n\t\t\t</GenericModal>,\n\t\t);\n\t};\n\n\treturn confirmDeletMessage;\n};\n\nexport default useDeleteMessage;\n",null],"names":["_regeneratorRuntime","useEndpoint","useSetModal","useToastMessageDispatch","useTranslation","useMutation","useQueryClient","React","GenericModal","module","default","v","link","exportDefault","mid","rid","onChange","t","deleteMessage","dismissMessage","dispatchToastMessage","setModal","queryClient","handleDeleteMessages","mutationFn","onError","error","type","message","onSuccess","async","_context","prev","next","awrap","handleDismissMessage","mutateAsync","msgId","stop","Promise","onSettled","invalidateQueries","queryKey","createElement","confirmText","title","variant","onConfirm","_context2","roomId","asUser","onCancel"],"mappings":"uBAMA,IANAA,EAAAC,EAASC,EAAaC,EAAaC,EAA0EC,EAAAC,EAAAC,EAAAC,EAAvFC,EAAAA,IAAa,CAAA,6BAAyB,CAAAC,QAAc,SAAQC,CAAAA,EAAAX,EAAAA,CAAA,CAA0B,EAAC,GAAjDS,EAAcG,IAAE,CAAA,2BAAM,CAAAX,YAA2B,SAAAU,CAAA,EAAAV,EAAAA,CAAA,EAAAC,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,wBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAK,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAJ,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,QAAAA,CAAA,QAAA,SAAAE,CAAA,EAAAJ,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,sCAAAA,CAAA,QAAA,SAAAE,CAAA,EAAAH,EAAAA,CAAA,CAAA,EAAA,GAA7GC,EAAOI,aAAa,CAMK,SAACC,CAAW,CAAEC,CAAW,CAAEC,CAAoB,EACvE,IAAMC,EAAIb,IACJc,EAAgBjB,EAAY,OAAQ,mBACpCkB,EAAiBlB,EAAY,OAAQ,iCACrCmB,EAAuBjB,IACvBkB,EAAWnB,IACXoB,EAAchB,IAEdiB,EAAuBlB,EAAY,CACxCmB,WAAYN,EACZO,QAAS,SAACC,CAAK,EACdN,EAAqB,CAAEO,KAAM,QAASC,QAASF,CAAK,GACpDL,GACD,EACAQ,UAAW,WAAA,OAAA7B,EAAA8B,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAAA,OAAAF,EAAAE,IAAA,CAAA,EAAAjC,EAAAkC,KAAA,CACJC,EAAqBC,WAAW,CAAC,CAAEC,MAAOvB,CAAG,GAAG,MAAA,EAAA,IAAA,MAAA,OAAAiB,EAAAO,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,IAIlDJ,EAAuB9B,EAAY,CACxCmB,WAAYL,EACZM,QAAS,SAACC,CAAK,EACdN,EAAqB,CAAEO,KAAM,QAASC,QAASF,CAAK,EACrD,EACAG,UAAW,WACVT,EAAqB,CAAEO,KAAM,UAAWC,QAASX,EAAE,6BAA6B,EACjF,EACAuB,UAAW,WACVxB,IACAM,EAAYmB,iBAAiB,CAAC,CAAEC,SAAU,CAAC,qBAAoB,AAAC,GAChErB,GACD,IAqBD,OAd4B,WAC3BA,EACCd,EAAAoC,aAAA,CAACnC,EAAY,CACZoC,YAAa3B,EAAE,iCACf4B,MAAO5B,EAAE,kCACT6B,QAAQ,SACRC,UAAW,WAAA,OAVM/C,EAAA8B,KAAA,CAAA,SAAAkB,CAAA,EAAA,OAAA,OAAAA,EAAAhB,IAAA,CAAAgB,EAAAf,IAAA,EAAA,KAAA,EAAA,OAAAe,EAAAf,IAAA,CAAA,EAAAjC,EAAAkC,KAAA,CACbX,EAAqBa,WAAW,CAAC,CAAEC,MAAOvB,EAAKmC,OAAQlC,EAAKmC,OAAQ,CAAA,CAAI,GAAG,MAAA,EAAA,IAAA,MAAA,OAAAF,EAAAV,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QASjD,EAC9BY,SAAU,WAAA,OAAM9B,GAAU,CAAC,EAE1BJ,EAAE,4DAGN,CAGD"}