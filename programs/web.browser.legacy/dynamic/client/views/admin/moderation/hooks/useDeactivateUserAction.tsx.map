)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/moderation/hooks/useDeactivateUserAction.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useEndpoint, useRoute, useSetModal, useToastMessageDispatch, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport React from 'react';\n\nimport type { GenericMenuItemProps } from '../../../../components/GenericMenu/GenericMenuItem';\nimport GenericModal from '../../../../components/GenericModal';\n\nconst useDeactivateUserAction = (userId: string): GenericMenuItemProps => {\n\tconst t = useTranslation();\n\tconst setModal = useSetModal();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst queryClient = useQueryClient();\n\n\tconst deactiveUser = useEndpoint('POST', '/v1/users.setActiveStatus');\n\tconst deleteMessages = useEndpoint('POST', '/v1/moderation.user.deleteReportedMessages');\n\tconst moderationRoute = useRoute('moderation-console');\n\n\tconst handleDeactivateUser = useMutation({\n\t\tmutationFn: deactiveUser,\n\t\tonError: (error) => {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t},\n\t\tonSuccess: () => {\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Moderation_User_deactivated') });\n\t\t},\n\t});\n\n\tconst handleDeleteMessages = useMutation({\n\t\tmutationFn: deleteMessages,\n\t\tonError: (error) => {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t},\n\t\tonSuccess: () => {\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Moderation_Messages_deleted') });\n\t\t},\n\t});\n\n\tconst onDeactivateUser = async () => {\n\t\tsetModal();\n\t\tawait handleDeleteMessages.mutateAsync({ userId });\n\t\tawait handleDeactivateUser.mutateAsync({ userId, activeStatus: false, confirmRelinquish: true });\n\t\tqueryClient.invalidateQueries({ queryKey: ['moderation.reports'] });\n\t\tmoderationRoute.push({});\n\t};\n\n\tconst confirmDeactivateUser = (): void => {\n\t\tsetModal(\n\t\t\t<GenericModal\n\t\t\t\ttitle={t('Moderation_Deactivate_User')}\n\t\t\t\tconfirmText={t('Moderation_Deactivate_User')}\n\t\t\t\tvariant='danger'\n\t\t\t\tonConfirm={() => onDeactivateUser()}\n\t\t\t\tonCancel={() => setModal()}\n\t\t\t>\n\t\t\t\t{t('Moderation_Are_you_sure_you_want_to_deactivate_this_user')}\n\t\t\t</GenericModal>,\n\t\t);\n\t};\n\n\treturn {\n\t\tid: 'deactiveUser',\n\t\tcontent: t('Moderation_Deactivate_User'),\n\t\ticon: 'ban',\n\t\tonClick: () => confirmDeactivateUser(),\n\t};\n};\n\nexport default useDeactivateUserAction;\n",null],"names":["_regeneratorRuntime","useEndpoint","useRoute","useSetModal","useToastMessageDispatch","useTranslation","useMutation","useQueryClient","React","GenericModal","module","link","default","v","exportDefault","userId","t","setModal","dispatchToastMessage","queryClient","deactiveUser","deleteMessages","moderationRoute","handleDeactivateUser","mutationFn","onError","error","type","message","onSuccess","handleDeleteMessages","confirmDeactivateUser","createElement","title","confirmText","variant","onConfirm","async","_context","prev","next","awrap","mutateAsync","activeStatus","confirmRelinquish","invalidateQueries","queryKey","push","stop","Promise","onCancel","id","content","icon","onClick"],"mappings":"uBAOA,IAPAA,EAAAC,EAASC,EAAaC,EAAUC,EAAaC,EAA0EC,EAAAC,EAAAC,EAAAC,EAAjGC,EAAQC,IAAE,CAAA,6BAAa,CAAAC,QAAyB,SAAAC,CAAc,EAAEb,EAAMa,CAAA,CAAA,EAAA,GAAtBH,EAAAA,IAAgB,CAAA,2BAAM,CAAAT,YAA2B,SAAAY,CAAA,EAAAZ,EAAAA,CAAA,EAAAC,SAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,wBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAK,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAJ,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,QAAAA,CAAA,QAAA,SAAAG,CAAA,EAAAL,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,sCAAAA,CAAA,QAAA,SAAAG,CAAA,EAAAJ,EAAAA,CAAA,CAAA,EAAA,GAAvHC,EAAOI,aAAa,CAOY,SAACC,CAAc,EAC9C,IAAMC,EAAIX,IACJY,EAAWd,IACXe,EAAuBd,IACvBe,EAAcZ,IAEda,EAAenB,EAAY,OAAQ,6BACnCoB,EAAiBpB,EAAY,OAAQ,8CACrCqB,EAAkBpB,EAAS,sBAE3BqB,EAAuBjB,EAAY,CACxCkB,WAAYJ,EACZK,QAAS,SAACC,CAAK,EACdR,EAAqB,CAAES,KAAM,QAASC,QAASF,CAAK,EACrD,EACAG,UAAW,WACVX,EAAqB,CAAES,KAAM,UAAWC,QAASZ,EAAE,8BAA8B,EAClF,IAGKc,EAAuBxB,EAAY,CACxCkB,WAAYH,EACZI,QAAS,SAACC,CAAK,EACdR,EAAqB,CAAES,KAAM,QAASC,QAASF,CAAK,EACrD,EACAG,UAAW,WACVX,EAAqB,CAAES,KAAM,UAAWC,QAASZ,EAAE,8BAA8B,EAClF,IAWKe,EAAwB,WAC7Bd,EACCT,EAAAwB,aAAA,CAACvB,EAAY,CACZwB,MAAOjB,EAAE,8BACTkB,YAAalB,EAAE,8BACfmB,QAAQ,SACRC,UAAW,WAAA,OAdWpC,EAAAqC,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EACb,OAAXvB,IAAWqB,EAAAE,IAAA,CAAA,EAAAxC,EAAAyC,KAAA,CACLX,EAAqBY,WAAW,CAAC,CAAE3B,OAAAA,CAAM,GAAG,MAAA,EAAA,OAAAuB,EAAAE,IAAA,CAAA,EAAAxC,EAAAyC,KAAA,CAC5ClB,EAAqBmB,WAAW,CAAC,CAAE3B,OAAAA,EAAQ4B,aAAc,CAAA,EAAOC,kBAAmB,CAAA,CAAI,GAAG,MAAA,EAChGzB,EAAY0B,iBAAiB,CAAC,CAAEC,SAAU,CAAC,qBAAoB,AAAC,GAChExB,EAAgByB,IAAI,CAAC,CAAA,EAAI,MAAA,EAAA,IAAA,MAAA,OAAAT,EAAAU,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QASY,EACnCC,SAAU,WAAA,OAAMjC,GAAU,CAAC,EAE1BD,EAAE,6DAGN,EAEA,MAAO,CACNmC,GAAI,eACJC,QAASpC,EAAE,8BACXqC,KAAM,MACNC,QAAS,WAAA,OAAMvB,GAAuB,EAExC"}