)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/workspace/VersionCard/modals/RegisterWorkspaceSetupModal/RegisterWorkspaceSetupStepTwoModal.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Modal, Box, Field, FieldLabel, FieldRow, TextInput } from '@rocket.chat/fuselage';\nimport { useEndpoint, useToastMessageDispatch, useTranslation } from '@rocket.chat/ui-contexts';\nimport React, { useCallback, useEffect } from 'react';\nimport { Trans } from 'react-i18next';\n\ntype Props = {\n\temail: string;\n\tstep: number;\n\tsetStep: (step: number) => void;\n\tonClose: () => void;\n\tintentData: {\n\t\tdevice_code: string;\n\t\tinterval: number;\n\t\tuser_code: string;\n\t};\n\tonSuccess: () => void;\n};\n\nconst setIntervalTime = (interval?: number): number => (interval ? interval * 1000 : 0);\n\nconst RegisterWorkspaceSetupStepTwoModal = ({ email, step, setStep, onClose, intentData, onSuccess, ...props }: Props) => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst cloudConfirmationPoll = useEndpoint('GET', '/v1/cloud.confirmationPoll');\n\tconst createRegistrationIntent = useEndpoint('POST', '/v1/cloud.createRegistrationIntent');\n\n\tconst handleBackFromConfirmation = (): void => setStep(step - 1);\n\n\tconst handleResendRegistrationEmail = async () => {\n\t\ttry {\n\t\t\tawait createRegistrationIntent({ resend: true, email });\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Email_sent') });\n\t\t} catch (error: unknown) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t};\n\n\tconst getConfirmation = useCallback(async () => {\n\t\ttry {\n\t\t\tconst { pollData } = await cloudConfirmationPoll({\n\t\t\t\tdeviceCode: intentData.device_code,\n\t\t\t});\n\n\t\t\tif ('successful' in pollData && pollData.successful) {\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Workspace_registered') });\n\t\t\t\tonSuccess();\n\t\t\t}\n\t\t} catch (error: any) {\n\t\t\tconsole.log(error);\n\t\t}\n\t}, [cloudConfirmationPoll, intentData.device_code, dispatchToastMessage, t]);\n\n\tuseEffect(() => {\n\t\tconst pollInterval = setInterval(() => getConfirmation(), setIntervalTime(intentData.interval));\n\n\t\treturn (): void => clearInterval(pollInterval);\n\t}, [getConfirmation, intentData]);\n\n\treturn (\n\t\t<Modal {...props}>\n\t\t\t<Modal.Header>\n\t\t\t\t<Modal.HeaderText>\n\t\t\t\t\t<Modal.Tagline>{t('RegisterWorkspace_Setup_Steps', { step, numberOfSteps: 2 })}</Modal.Tagline>\n\t\t\t\t\t<Modal.Title>{t('Awaiting_confirmation')}</Modal.Title>\n\t\t\t\t</Modal.HeaderText>\n\t\t\t\t<Modal.Close onClick={onClose} />\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Content>\n\t\t\t\t<Box fontSize='p2'>\n\t\t\t\t\t<Box>\n\t\t\t\t\t\t<Trans i18nKey='RegisterWorkspace_Setup_Email_Confirmation'>\n\t\t\t\t\t\t\t<Box is='p'>\n\t\t\t\t\t\t\t\tEmail sent to{' '}\n\t\t\t\t\t\t\t\t<Box is='span' fontScale='p2b'>\n\t\t\t\t\t\t\t\t\t{email}{' '}\n\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\twith a confirmation link.\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Trans>\n\t\t\t\t\t</Box>\n\t\t\t\t\t<Box is='p'>{t('RegisterWorkspace_Setup_Email_Verification')}</Box>\n\t\t\t\t\t<Field pbs={10}>\n\t\t\t\t\t\t<FieldLabel>{t('Security_code')}</FieldLabel>\n\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t<TextInput defaultValue={intentData.user_code} disabled />\n\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t</Field>\n\t\t\t\t</Box>\n\t\t\t</Modal.Content>\n\t\t\t<Modal.Footer>\n\t\t\t\t<Box is='div' display='flex' justifyContent='start' fontSize='c1' w='full'>\n\t\t\t\t\tDidnâ€™t receive email?{' '}\n\t\t\t\t\t<Box is='a' pi={4} onClick={handleResendRegistrationEmail}>\n\t\t\t\t\t\tResend\n\t\t\t\t\t</Box>{' '}\n\t\t\t\t\tor{' '}\n\t\t\t\t\t<Box is='a' pi={4} onClick={handleBackFromConfirmation}>\n\t\t\t\t\t\tchange email\n\t\t\t\t\t</Box>\n\t\t\t\t</Box>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n};\n\nexport default RegisterWorkspaceSetupStepTwoModal;\n",null],"names":["_regeneratorRuntime","_objectWithoutProperties","Modal","Box","Field","FieldLabel","FieldRow","TextInput","useEndpoint","useToastMessageDispatch","useTranslation","React","useCallback","useEffect","Trans","module","link","default","v","exportDefault","_ref","email","step","setStep","onClose","intentData","onSuccess","props","_excluded","t","dispatchToastMessage","cloudConfirmationPoll","createRegistrationIntent","getConfirmation","pollData","async","_context2","prev","next","awrap","deviceCode","device_code","_await$cloudConfirmat","sent","successful","type","message","t0","console","log","stop","Promise","interval","pollInterval","setInterval","clearInterval","createElement","Header","HeaderText","Tagline","numberOfSteps","Title","Close","onClick","Content","fontSize","i18nKey","is","fontScale","pbs","defaultValue","user_code","disabled","Footer","display","justifyContent","w","pi","_context","resend"],"mappings":"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"}