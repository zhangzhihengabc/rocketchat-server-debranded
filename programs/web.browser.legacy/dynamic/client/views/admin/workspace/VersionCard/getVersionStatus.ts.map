)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/workspace/VersionCard/getVersionStatus.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { SupportedVersions } from '@rocket.chat/server-cloud-communication';\nimport semver from 'semver';\n\nimport type { VersionStatus } from './components/VersionTag';\n\nexport const getVersionStatus = (\n\tserverVersion: string,\n\tversions: SupportedVersions['versions'],\n): { label: VersionStatus; expiration: Date | undefined; version: string } => {\n\tconst highestVersion = versions\n\t\t.sort((prev, current) => semver.compare(current.version, prev.version))\n\t\t.filter((v) => {\n\t\t\tconst [prerelease] = semver.prerelease(v.version) || [];\n\t\t\tconst [currentPrerelease] = semver.prerelease(serverVersion) || [];\n\n\t\t\treturn !prerelease || prerelease === currentPrerelease;\n\t\t})[0];\n\n\tconst currentVersionData =\n\t\tversions.find((v) => v.version === serverVersion) ||\n\t\tversions.find((v) =>\n\t\t\tsemver.satisfies(String(semver.coerce(v.version)), `=${semver.major(serverVersion)}.${semver.minor(serverVersion)}.x`),\n\t\t);\n\n\tconst currentVersionIsExpired = currentVersionData?.expiration && new Date(currentVersionData.expiration) < new Date();\n\n\tconst isSupported = !currentVersionIsExpired && !!currentVersionData;\n\n\treturn {\n\t\tlabel: 'outdated',\n\t\tversion: serverVersion,\n\t\t...(isSupported && semver.gte(currentVersionData?.version, highestVersion.version) && { label: 'latest' }),\n\t\t...(isSupported &&\n\t\t\tsemver.gt(highestVersion.version, currentVersionData?.version) && { label: 'available_version', version: highestVersion.version }),\n\t\texpiration: currentVersionData?.expiration,\n\t};\n};\n",null],"names":["module","link","default","_objectSpread","_slicedToArray","export","getVersionStatus","v","semver","serverVersion","versions","highestVersion","sort","prev","current","compare","version","filter","prerelease","_ref2","currentPrerelease","_ref4","currentVersionData","find","satisfies","String","coerce","major","minor","isSupported","expiration","Date","label","gte","gt"],"mappings":"uBACaA,EAAMC,IAAS,CAAA,uCAAA,CAAAC,QAAAA,SAAAA,CAAAA,EAAAC,EAAAA,CAAA,CAAA,EAAA,GAAAH,EAAAA,IAAAA,CAAAA,uCAAAA,CAAAE,QAAAA,SAAAA,CAAAA,EAAAE,EAAAA,CAAA,CAAA,EAAA,GAA5BJ,EAAOK,MAAM,CAAA,CAAAC,iBAAe,WAAA,OAAAA,CAAA,CAAA,GAAAN,EAAAA,IAAAA,CAAAA,SAAAA,CAAA,QAAA,SAAAO,CAAA,EAAAC,EAAAA,CAAA,CAAA,EAAA,GAIrB,IAJPL,EAA4BC,EAAAI,EAIfF,EAAmB,SAC/BG,CAAqB,CACrBC,CAAuC,EAEvC,IAAMC,EAAiBD,EACrBE,IAAI,CAAC,SAACC,CAAI,CAAEC,CAAO,EAAA,OAAKN,EAAOO,OAAO,CAACD,EAAQE,OAAO,CAAEH,EAAKG,OAAO,CAAC,GACrEC,MAAM,CAAC,SAACV,CAAC,EACT,IAAOW,EAAUC,AAAsCf,EAAlCI,EAAOU,UAAU,CAACX,EAAES,OAAO,GAAK,EAAE,CAAA,EAAtC,CAAA,EAAA,CACVI,EAAiBC,AAA0CjB,EAAtCI,EAAOU,UAAU,CAACT,IAAkB,EAAE,CAAA,EAA1C,CAAA,EAAA,CAExB,MAAO,CAACS,GAAcA,IAAeE,CACtC,EAAE,CAAC,EAAE,CAEAE,EACLZ,EAASa,IAAI,CAAC,SAAChB,CAAC,EAAA,OAAKA,EAAES,OAAO,GAAKP,CAAa,IAChDC,EAASa,IAAI,CAAC,SAAChB,CAAC,EAAA,OACfC,EAAOgB,SAAS,CAACC,OAAOjB,EAAOkB,MAAM,CAACnB,EAAES,OAAO,GAAE,IAAMR,EAAOmB,KAAK,CAAClB,GAAc,IAAID,EAAOoB,KAAK,CAACnB,GAAc,KAAK,GAKlHoB,EAAc,CAFY,CAAA,AAAAP,CAAAA,MAAAA,EAAkB,KAAA,EAAlBA,EAAoBQ,UAAU,AAAVA,GAAc,IAAIC,KAAKT,EAAmBQ,UAAU,EAAI,IAAIC,IAAI,GAEpE,CAAC,CAACT,EAElD,OAAAnB,EAAAA,EAAAA,EAAA,CACC6B,MAAO,WACPhB,QAASP,CAAa,EAClBoB,GAAerB,EAAOyB,GAAG,CAACX,MAAAA,EAAkB,KAAA,EAAlBA,EAAoBN,OAAO,CAAEL,EAAeK,OAAO,GAAK,CAAEgB,MAAO,QAAQ,GACnGH,GACHrB,EAAO0B,EAAE,CAACvB,EAAeK,OAAO,CAAEM,MAAAA,EAAkB,KAAA,EAAlBA,EAAoBN,OAAO,GAAK,CAAEgB,MAAO,oBAAqBhB,QAASL,EAAeK,OAAAA,AAAO,GAAE,CAAA,EAAA,CAClIc,WAAYR,MAAAA,EAAkB,KAAA,EAAlBA,EAAoBQ,UAAAA,AAAU,EAE5C"}