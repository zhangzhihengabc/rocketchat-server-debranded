)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/root/MainLayout/TwoFactorAuthSetupCheck.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useLayout, useUser, useSetting } from '@rocket.chat/ui-contexts';\nimport type { ReactElement, ReactNode } from 'react';\nimport React, { lazy, useCallback } from 'react';\n\nimport { Roles } from '../../../../app/models/client';\nimport { useReactiveValue } from '../../../hooks/useReactiveValue';\nimport LayoutWithSidebar from './LayoutWithSidebar';\n\nconst AccountSecurityPage = lazy(() => import('../../account/security/AccountSecurityPage'));\n\nconst TwoFactorAuthSetupCheck = ({ children }: { children: ReactNode }): ReactElement => {\n\tconst { isEmbedded: embeddedLayout } = useLayout();\n\tconst user = useUser();\n\tconst tfaEnabled = useSetting('Accounts_TwoFactorAuthentication_Enabled');\n\tconst require2faSetup = useReactiveValue(\n\t\tuseCallback(() => {\n\t\t\t// User is already using 2fa\n\t\t\tif (!user || user?.services?.totp?.enabled || user?.services?.email2fa?.enabled) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst mandatoryRole = Roles.findOne({ _id: { $in: user.roles ?? [] }, mandatory2fa: true });\n\t\t\treturn mandatoryRole !== undefined && tfaEnabled;\n\t\t}, [tfaEnabled, user]),\n\t);\n\n\tif (require2faSetup) {\n\t\treturn (\n\t\t\t<main id='rocket-chat' className={embeddedLayout ? 'embedded-view' : undefined}>\n\t\t\t\t<div className='rc-old main-content content-background-color'>\n\t\t\t\t\t<AccountSecurityPage />\n\t\t\t\t</div>\n\t\t\t</main>\n\t\t);\n\t}\n\n\treturn <LayoutWithSidebar>{children}</LayoutWithSidebar>;\n};\n\nexport default TwoFactorAuthSetupCheck;\n",null],"names":["module","link","useLayout","v","useUser","useSetting","React","lazy","useCallback","Roles","useReactiveValue","LayoutWithSidebar","AccountSecurityPage","dynamicImport","exportDefault","_ref","children","embeddedLayout","_useLayout","isEmbedded","user","tfaEnabled","_user$services","_user$services$totp","_user$services2","_user$services2$email","_user$roles","services","totp","enabled","email2fa","mandatoryRole","undefined","findOne","_id","$in","roles","mandatory2fa","createElement","id","className"],"mappings":"uBAA6BA,EAAUC,IAAE,CAAA,2BAAM,CAA0BC,UAAC,SAAAC,CAAA,EAAAD,EAAAA,CAAA,EAAAE,QAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,WAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAL,EAAAA,IAAAA,CAAAA,QAAAA,CAAA,QAAA,SAAAG,CAAA,EAAAG,EAAAA,CAAA,EAAAC,KAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAR,EAAAA,IAAAA,CAAAA,gCAAAA,CAAAS,MAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAT,EAAAA,IAAAA,CAAAA,kCAAAA,CAAAU,iBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAV,EAAAA,IAAAA,CAAAA,sBAAAA,CAAA,QAAA,SAAAG,CAAA,EAAAQ,EAAAA,CAAA,CAAA,EAAA,GAQ1E,IARAT,EAASE,EAAWC,EAAsDC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAQpEC,EAAsBL,EAAK,WAAA,OAAMP,EAAAa,aAAA,CAAO,6CAA6C,GAR3Fb,EAAOc,aAAa,CAUY,SAAAC,CAAA,EAAwD,IAArDC,EAAQD,EAARC,QAAQ,CACtBC,EAAcC,AAAKhB,IAA/BiB,UAAU,CACZC,EAAOhB,IACPiB,EAAahB,EAAW,mDAa9B,AAZwBK,EACvBF,EAAY,eAAKc,EAAAC,EAAAC,EAAAC,EAAAC,QAEhB,CAAI,CAACN,GAAQA,CAAAA,MAAAA,GAAI,AAAU,OAAVE,CAAAA,EAAJF,EAAMO,QAAQ,AAARA,GAAQL,AAAA,KAAA,IAAAA,GAAA,AAAM,OAANC,CAAAA,EAAdD,EAAgBM,IAAI,AAAJA,GAAIL,AAAA,KAAA,IAAAA,IAApBA,EAAsBM,OAAO,AAAPA,GAAWT,CAAAA,MAAAA,GAAI,AAAU,OAAVI,CAAAA,EAAJJ,EAAMO,QAAQ,AAARA,GAAQH,AAAA,KAAA,IAAAA,GAAA,AAAU,OAAVC,CAAAA,EAAdD,EAAgBM,QAAQ,AAARA,GAAQL,AAAA,KAAA,IAAAA,IAAxBA,EAA0BI,OAAO,AAAPA,GAKjEE,AAAkBC,KAAAA,IADHvB,EAAMwB,OAAO,CAAC,CAAEC,IAAK,CAAEC,IAAG,AAAY,OAAZT,CAAAA,EAAEN,EAAKgB,KAAK,AAALA,GAAKV,AAAA,KAAA,IAAAA,EAAAA,EAAI,EAAA,AAAE,EAAIW,aAAc,CAAA,CAAI,IAClDhB,CACvC,EAAG,CAACA,EAAYD,EAAK,GAKpBd,EAAAgC,aAAA,CAAA,OAAA,CAAMC,GAAG,cAAcC,UAAWvB,EAAiB,gBAAkBe,KAAAA,CAAU,EAC9E1B,EAAAgC,aAAA,CAAA,MAAA,CAAKE,UAAU,8CAA8C,EAC5DlC,EAAAgC,aAAA,CAAC1B,EAAmB,QAMjBN,EAAAgC,aAAA,CAAC3B,EAAiB,KAAEK,EAC5B"}