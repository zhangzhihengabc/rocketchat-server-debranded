)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/lib/chats/flows/requestMessageDeletion.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IMessage } from '@rocket.chat/core-typings';\n\nimport { t } from '../../../../app/utils/lib/i18n';\nimport GenericModal from '../../../components/GenericModal';\nimport { imperativeModal } from '../../imperativeModal';\nimport { dispatchToastMessage } from '../../toast';\nimport type { ChatAPI } from '../ChatAPI';\n\nexport const requestMessageDeletion = async (chat: ChatAPI, message: IMessage): Promise<void> => {\n\tif (!(await chat.data.canDeleteMessage(message))) {\n\t\tdispatchToastMessage({ type: 'error', message: t('Message_deleting_blocked') });\n\t\treturn;\n\t}\n\n\tconst room = message.drid ? await chat.data.getDiscussionByID(message.drid) : undefined;\n\n\tawait new Promise<void>((resolve, reject) => {\n\t\tconst onConfirm = async (): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tif (!(await chat.data.canDeleteMessage(message))) {\n\t\t\t\t\tdispatchToastMessage({ type: 'error', message: t('Message_deleting_blocked') });\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tawait chat.data.deleteMessage(message._id);\n\n\t\t\t\timperativeModal.close();\n\n\t\t\t\tif (chat.currentEditing?.mid === message._id) {\n\t\t\t\t\tchat.currentEditing.stop();\n\t\t\t\t}\n\t\t\t\tchat.composer?.focus();\n\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Your_entry_has_been_deleted') });\n\t\t\t\tresolve();\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t\treject(error);\n\t\t\t}\n\t\t};\n\n\t\tconst onCloseModal = async (): Promise<void> => {\n\t\t\timperativeModal.close();\n\n\t\t\tif (chat.currentEditing?.mid === message._id) {\n\t\t\t\tchat.currentEditing.stop();\n\t\t\t}\n\t\t\tchat.composer?.focus();\n\n\t\t\tresolve();\n\t\t};\n\n\t\timperativeModal.open({\n\t\t\tcomponent: GenericModal,\n\t\t\tprops: {\n\t\t\t\ttitle: t('Are_you_sure'),\n\t\t\t\tchildren: room ? t('The_message_is_a_discussion_you_will_not_be_able_to_recover') : t('You_will_not_be_able_to_recover'),\n\t\t\t\tvariant: 'danger',\n\t\t\t\tconfirmText: t('Yes_delete_it'),\n\t\t\t\tonConfirm,\n\t\t\t\tonClose: onCloseModal,\n\t\t\t\tonCancel: onCloseModal,\n\t\t\t},\n\t\t});\n\t});\n};\n",null],"names":["module","default","_regeneratorRuntime","export","requestMessageDeletion","t","v","GenericModal","imperativeModal","dispatchToastMessage","chat","message","room","async","_context3","prev","next","awrap","data","canDeleteMessage","sent","type","abrupt","drid","getDiscussionByID","t0","undefined","Promise","resolve","reject","onConfirm","_callee","_chat$currentEditing","_chat$composer","_callee$","_context","deleteMessage","_id","close","currentEditing","mid","stop","composer","focus","onCloseModal","_callee2","_chat$currentEditing2","_chat$composer2","_callee2$","_context2","open","component","props","title","children","variant","confirmText","onClose","onCancel"],"mappings":"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"}