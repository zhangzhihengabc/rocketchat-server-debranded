function module(n,e,t){t.link("@babel/runtime/regenerator",{default:function(n){r=n}},0),t.link("@babel/runtime/helpers/objectSpread2",{default:function(n){i=n}},1),t.link("@babel/runtime/helpers/toConsumableArray",{default:function(n){o=n}},2),t.export({createUploadsAPI:function(){return E}}),t.link("@rocket.chat/emitter",{Emitter:function(n){u=n}},0),t.link("@rocket.chat/random",{Random:function(n){c=n}},1),t.link("../../../app/ui/client/lib/UserAction",{UserAction:function(n){a=n},USER_ACTIVITIES:function(n){l=n}},2),t.link("../../../app/utils/client/lib/SDKClient",{sdk:function(n){f=n}},3),t.link("../errorHandling",{getErrorMessage:function(n){s=n}},4);var r,i,o,u,c,a,l,f,s,d=[],p=new u,m=function(n){d=n(d),p.emit("update")},g=function(){return d},b=function(n){return p.on("update",n)},k=function(n){p.emit("cancelling-"+n)},h=function(){m(function(n){return n.filter(function(n){return!n.error})})},v=function(n,e){var t,u,g,b,k;return r.async(function(h){for(;;)switch(h.prev=h.next){case 0:return t=e.description,u=e.msg,g=e.rid,b=e.tmid,k=c.id(),m(function(e){return[].concat(o(e),[{id:k,name:n.name,percentage:0}])}),h.prev=3,h.next=6,r.awrap(new Promise(function(e,r){var o=f.rest.upload("/v1/rooms.upload/"+g,{msg:u,tmid:b,file:n,description:t},{load:function(n){e(n)},progress:function(n){if(n.lengthComputable){var e=n.loaded/n.total*100;100!==e&&m(function(n){return n.map(function(n){return n.id!==k?n:i(i({},n),{},{percentage:Math.round(e)||0})})})}},error:function(n){m(function(n){return n.map(function(n){return n.id!==k?n:i(i({},n),{},{percentage:0,error:Error(o.responseText)})})}),r(n)}});d.length&&a.performContinuously(g,l.USER_UPLOADING,{tmid:b}),p.once("cancelling-"+k,function(){o.abort(),m(function(n){return n.filter(function(n){return n.id!==k})})})}));case 6:m(function(n){return n.filter(function(n){return n.id!==k})}),h.next=12;break;case 9:h.prev=9,h.t0=h.catch(3),m(function(n){return n.map(function(n){return n.id!==k?n:i(i({},n),{},{percentage:0,error:Error(s(h.t0))})})});case 12:return h.prev=12,d.length||a.stop(g,l.USER_UPLOADING,{tmid:b}),h.finish(12);case 15:case"end":return h.stop()}},null,null,[[3,9,12,15]],Promise)},E=function(n){var e=n.rid,t=n.tmid;return{get:g,subscribe:b,wipeFailedOnes:h,cancel:k,send:function(n,r){return v(n,{description:r.description,msg:r.msg,rid:e,tmid:t})}}}}
//# sourceMappingURL=/dynamic/client/lib/chats/d4908df29f37e462f11bd6fbc1348306f3c72440.map
