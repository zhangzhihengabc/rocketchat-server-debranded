)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/lib/banners.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { UiKit } from '@rocket.chat/core-typings';\nimport { Emitter } from '@rocket.chat/emitter';\nimport type { Keys as IconName } from '@rocket.chat/icons';\n\nexport type LegacyBannerPayload = {\n\tid: string;\n\tclosable?: boolean;\n\ttitle?: string | (() => string);\n\ttext?: string | (() => string);\n\thtml?: string | (() => string);\n\ticon?: IconName;\n\tmodifiers?: ('large' | 'danger')[];\n\ttimer?: number;\n\taction?: () => Promise<void> | void;\n\tonClose?: () => Promise<void> | void;\n};\n\ntype BannerPayload = LegacyBannerPayload | UiKit.BannerView;\n\nexport const isLegacyPayload = (payload: BannerPayload): payload is LegacyBannerPayload => !('blocks' in payload);\n\nconst queue: BannerPayload[] = [];\nconst emitter = new Emitter<{\n\t'update': undefined;\n\t'update-first': undefined;\n}>();\n\nexport const firstSubscription = [\n\t(callback: () => void): (() => void) => emitter.on('update-first', callback),\n\t(): BannerPayload | null => queue[0] ?? null,\n] as const;\n\nexport const open = (payload: BannerPayload): void => {\n\tlet index = queue.findIndex((_payload) => {\n\t\tif (isLegacyPayload(_payload) && isLegacyPayload(payload)) {\n\t\t\treturn _payload.id === payload.id;\n\t\t}\n\n\t\tif (!isLegacyPayload(_payload) && !isLegacyPayload(payload)) {\n\t\t\treturn _payload.viewId === payload.viewId;\n\t\t}\n\n\t\treturn false;\n\t});\n\n\tif (index === -1) {\n\t\tindex = queue.length;\n\t}\n\n\tqueue[index] = payload;\n\n\temitter.emit('update');\n\n\tif (index === 0) {\n\t\temitter.emit('update-first');\n\t}\n};\n\nexport const closeById = (id: string): void => {\n\tconst index = queue.findIndex((banner) => {\n\t\tif (!isLegacyPayload(banner)) {\n\t\t\treturn banner.viewId === id;\n\t\t}\n\t\treturn banner.id === id;\n\t});\n\n\tif (index < 0) {\n\t\treturn;\n\t}\n\n\tqueue.splice(index, 1);\n\temitter.emit('update');\n\tindex === 0 && emitter.emit('update-first');\n};\n\nexport const close = (): void => {\n\tqueue.shift();\n\temitter.emit('update');\n\temitter.emit('update-first');\n};\n\nexport const clear = (): void => {\n\tqueue.splice(0, queue.length);\n\temitter.emit('update');\n\temitter.emit('update-first');\n};\n",null],"names":["module","export","isLegacyPayload","firstSubscription","open","closeById","close","clear","Emitter","payload","queue","emitter","callback","on","_queue$","index","findIndex","_payload","id","viewId","length","emit","banner","splice","shift"],"mappings":"uBACAA,EAAOC,MAAE,CAAA,CAAAC,gBAAe,WAAA,OAAuBA,CAAA,EAAAC,kBAAAA,WAAA,OAAAA,CAAA,EAAAC,KAAAA,WAAA,OAAAA,CAAA,EAAAC,UAAAA,WAAA,OAAAA,CAAA,EAAAC,MAAAA,WAAA,OAAAA,CAAA,EAAAC,MAAAA,WAAA,OAAAA,CAAA,CAAA,GAAAP,EAAAA,IAAAA,CAAAA,uBAAAA,CAAAQ,QAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAkBxC,IAlBwCA,EAkBlCN,EAAkB,SAACO,CAAsB,EAAA,MAAqC,CAAE,CAAA,WAAYA,CAAAA,CAAQ,EAE3GC,EAAyB,EAAE,CAC3BC,EAAU,IAAIH,EAKPL,EAAoB,CAChC,SAACS,CAAoB,EAAA,OAAmBD,EAAQE,EAAE,CAAC,eAAgBD,EAAS,EAC5E,WAAA,IAAAE,EAAA,OAAA,AAAoC,OAApCA,CAAAA,EAA4BJ,CAAK,CAAC,EAAE,AAAD,GAACI,AAAA,KAAA,IAAAA,EAAAA,EAAI,IAAI,EACnC,CAEGV,EAAO,SAACK,CAAsB,EAC1C,IAAIM,EAAQL,EAAMM,SAAS,CAAC,SAACC,CAAQ,SACpC,AAAIf,EAAgBe,IAAaf,EAAgBO,GACzCQ,EAASC,EAAE,GAAKT,EAAQS,EAAE,EAG9B,CAAA,AAAChB,EAAgBe,IAAcf,EAAgBO,EAAO,GAClDQ,EAASE,MAAM,GAAKV,EAAQU,MAAM,AAI3C,EAEc,CAAA,KAAVJ,GACHA,CAAAA,EAAQL,EAAMU,MAAM,AAANA,EAGfV,CAAK,CAACK,EAAM,CAAGN,EAEfE,EAAQU,IAAI,CAAC,UAEC,IAAVN,GACHJ,EAAQU,IAAI,CAAC,eAEf,EAEahB,EAAY,SAACa,CAAU,EACnC,IAAMH,EAAQL,EAAMM,SAAS,CAAC,SAACM,CAAM,SACpC,AAAKpB,EAAgBoB,GAGdA,EAAOJ,EAAE,GAAKA,EAFbI,EAAOH,MAAM,GAAKD,CAG3B,GAEIH,EAAQ,IAIZL,EAAMa,MAAM,CAACR,EAAO,GACpBJ,EAAQU,IAAI,CAAC,UACbN,AAAU,IAAVA,GAAeJ,EAAQU,IAAI,CAAC,gBAC7B,EAEaf,EAAQ,WACpBI,EAAMc,KAAK,GACXb,EAAQU,IAAI,CAAC,UACbV,EAAQU,IAAI,CAAC,eACd,EAEad,EAAQ,WACpBG,EAAMa,MAAM,CAAC,EAAGb,EAAMU,MAAM,EAC5BT,EAAQU,IAAI,CAAC,UACbV,EAAQU,IAAI,CAAC,eACd"}