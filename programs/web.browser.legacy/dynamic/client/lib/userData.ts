function module(e,t,n){var i,r,a,o,u,c,s,d,l=["type","id"],p=["ldap","lastLogin","services"],f=["email","cloud","resume","email2fa","emailCode"];n.link("@babel/runtime/regenerator",{default:function(e){i=e}},0),n.link("@babel/runtime/helpers/objectWithoutProperties",{default:function(e){r=e}},1),n.link("@babel/runtime/helpers/objectSpread2",{default:function(e){a=e}},2),n.export({isSyncReady:function(){return m},synchronizeUserData:function(){return w},removeLocalUserData:function(){return k}}),n.link("meteor/reactive-var",{ReactiveVar:function(e){o=e}},0),n.link("../../app/models/client",{Users:function(e){u=e}},1),n.link("../../app/notifications/client",{Notifications:function(e){c=e}},2),n.link("../../app/utils/client/lib/SDKClient",{sdk:function(e){s=e}},3);var m=new o(!1),v=function(e){var t=u.findOne({_id:e._id});if(!(null!=t&&t._updatedAt)||t._updatedAt.getTime()<e._updatedAt.getTime()){u.upsert({_id:e._id},e);return}Object.keys(t).forEach(function(t){delete e[t]}),u.update({_id:t._id},{$set:a({},e)})},w=function(e){var t,n,o,w,k,h,A,b,D,_,g,x,y,T;return i.async(function(U){for(;;)switch(U.prev=U.next){case 0:if(e){U.next=2;break}return U.abrupt("return");case 2:return u.remove({_id:{$ne:e}}),null===(t=d)||void 0===t||t(),d=(n=c.onUser("userData",function(t){switch(t.type){case"inserted":t.type,t.id;var n=r(t,l);u.insert(n);break;case"updated":u.upsert({_id:e},{$set:t.diff,$unset:t.unset});break;case"removed":u.remove({_id:e})}})).stop,U.next=8,i.awrap(n.ready());case 8:return U.next=10,i.awrap(s.rest.get("/v1/me"));case 10:return w=(o=U.sent).ldap,k=o.lastLogin,h=o.services,(A=r(o,p))&&(D=(b=h||{}).email,_=b.cloud,g=b.resume,x=b.email2fa,y=b.emailCode,T=r(b,f),v(a(a(a(a({},A),h&&{services:a(a(a(a(a(a({},T?a({},T):{}),g?{resume:a({},g.loginTokens&&{loginTokens:g.loginTokens.map(function(e){return a(a({},e),{},{when:new Date("when"in e?e.when:""),createdAt:"createdAt"in e?new Date(e.createdAt):void 0,twoFactorAuthorizedUntil:e.twoFactorAuthorizedUntil?new Date(e.twoFactorAuthorizedUntil):void 0})})})}:{}),_?{cloud:a(a({},_),{},{expiresAt:new Date(_.expiresAt)})}:{}),y?a(a({},y),{},{expire:new Date(y.expire)}):{}),x?{email2fa:a(a({},x),{},{changedAt:new Date(x.changedAt)})}:{}),(null==D?void 0:D.verificationTokens)&&{email:{verificationTokens:D.verificationTokens.map(function(e){return a(a({},e),{},{when:new Date(e.when)})})}})}),k&&{lastLogin:new Date(k)}),{},{ldap:!!w,createdAt:new Date(A.createdAt),_updatedAt:new Date(A._updatedAt)}))),m.set(!0),U.abrupt("return",A);case 18:case"end":return U.stop()}},null,null,null,Promise)},k=function(){return u.remove({})}}
//# sourceMappingURL=/dynamic/client/lib/0d75e86a8c78933da620211d850c55829f102bfe.map
