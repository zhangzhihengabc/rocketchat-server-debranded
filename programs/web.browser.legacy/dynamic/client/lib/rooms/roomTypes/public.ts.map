)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/lib/rooms/roomTypes/public.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { AtLeast, IRoom } from '@rocket.chat/core-typings';\nimport { isRoomFederated } from '@rocket.chat/core-typings';\nimport { Meteor } from 'meteor/meteor';\nimport type { Mongo } from 'meteor/mongo';\n\nimport { hasAtLeastOnePermission } from '../../../../app/authorization/client';\nimport { ChatRoom } from '../../../../app/models/client';\nimport { settings } from '../../../../app/settings/client';\nimport { getUserPreference } from '../../../../app/utils/client';\nimport { getRoomAvatarURL } from '../../../../app/utils/client/getRoomAvatarURL';\nimport type { IRoomTypeClientDirectives } from '../../../../definition/IRoomTypeConfig';\nimport { RoomSettingsEnum, RoomMemberActions, UiTextContext } from '../../../../definition/IRoomTypeConfig';\nimport { getPublicRoomType } from '../../../../lib/rooms/roomTypes/public';\nimport * as Federation from '../../federation/Federation';\nimport { roomCoordinator } from '../roomCoordinator';\n\nexport const PublicRoomType = getPublicRoomType(roomCoordinator);\n\nroomCoordinator.add(\n\t{\n\t\t...PublicRoomType,\n\t\tlabel: 'Channels',\n\t},\n\t{\n\t\tallowRoomSettingChange(room, setting) {\n\t\t\tif (isRoomFederated(room as IRoom)) {\n\t\t\t\treturn Federation.isRoomSettingAllowed(room, setting);\n\t\t\t}\n\t\t\tswitch (setting) {\n\t\t\t\tcase RoomSettingsEnum.BROADCAST:\n\t\t\t\t\treturn Boolean(room.broadcast);\n\t\t\t\tcase RoomSettingsEnum.READ_ONLY:\n\t\t\t\t\treturn Boolean(!room.broadcast);\n\t\t\t\tcase RoomSettingsEnum.REACT_WHEN_READ_ONLY:\n\t\t\t\t\treturn Boolean(!room.broadcast && room.ro);\n\t\t\t\tcase RoomSettingsEnum.E2E:\n\t\t\t\t\treturn false;\n\t\t\t\tcase RoomSettingsEnum.SYSTEM_MESSAGES:\n\t\t\t\tdefault:\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t},\n\n\t\tallowMemberAction(_room, action, showingUserId, userSubscription) {\n\t\t\tif (isRoomFederated(_room as IRoom)) {\n\t\t\t\treturn Federation.actionAllowed(_room, action, showingUserId, userSubscription);\n\t\t\t}\n\t\t\tswitch (action) {\n\t\t\t\tcase RoomMemberActions.BLOCK:\n\t\t\t\t\treturn false;\n\t\t\t\tdefault:\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t},\n\n\t\troomName(roomData) {\n\t\t\tif (roomData.prid || isRoomFederated(roomData)) {\n\t\t\t\treturn roomData.fname;\n\t\t\t}\n\t\t\tif (settings.get('UI_Allow_room_names_with_special_chars')) {\n\t\t\t\treturn roomData.fname || roomData.name;\n\t\t\t}\n\t\t\treturn roomData.name;\n\t\t},\n\n\t\tisGroupChat(_room) {\n\t\t\treturn true;\n\t\t},\n\n\t\tgetUiText(context) {\n\t\t\tswitch (context) {\n\t\t\t\tcase UiTextContext.HIDE_WARNING:\n\t\t\t\t\treturn 'Hide_Room_Warning';\n\t\t\t\tcase UiTextContext.LEAVE_WARNING:\n\t\t\t\t\treturn 'Leave_Room_Warning';\n\t\t\t\tdefault:\n\t\t\t\t\treturn '';\n\t\t\t}\n\t\t},\n\n\t\tcondition() {\n\t\t\tconst groupByType = getUserPreference(Meteor.userId(), 'sidebarGroupByType');\n\t\t\treturn (\n\t\t\t\tgroupByType &&\n\t\t\t\t(hasAtLeastOnePermission(['view-c-room', 'view-joined-room']) || settings.get('Accounts_AllowAnonymousRead') === true)\n\t\t\t);\n\t\t},\n\n\t\tgetAvatarPath(room) {\n\t\t\treturn getRoomAvatarURL({ roomId: room._id, cache: room.avatarETag });\n\t\t},\n\n\t\tgetIcon(room) {\n\t\t\tif (room.prid) {\n\t\t\t\treturn 'discussion';\n\t\t\t}\n\t\t\tif (room.teamMain) {\n\t\t\t\treturn 'team';\n\t\t\t}\n\t\t\tif (isRoomFederated(room)) {\n\t\t\t\treturn 'globe';\n\t\t\t}\n\n\t\t\treturn 'hashtag';\n\t\t},\n\n\t\textractOpenRoomParams({ name }) {\n\t\t\treturn { type: 'c', reference: name };\n\t\t},\n\n\t\tfindRoom(identifier) {\n\t\t\tconst query: Mongo.Selector<IRoom> = {\n\t\t\t\tt: 'c',\n\t\t\t\tname: identifier,\n\t\t\t};\n\n\t\t\treturn ChatRoom.findOne(query);\n\t\t},\n\n\t\tshowJoinLink(roomId) {\n\t\t\treturn !!ChatRoom.findOne({ _id: roomId, t: 'c' });\n\t\t},\n\t} as AtLeast<IRoomTypeClientDirectives, 'isGroupChat' | 'roomName'>,\n);\n",null],"names":["module","link","default","_objectSpread","export","PublicRoomType","isRoomFederated","Meteor","hasAtLeastOnePermission","ChatRoom","settings","getUserPreference","getRoomAvatarURL","RoomSettingsEnum","RoomMemberActions","UiTextContext","getPublicRoomType","v","Federation","roomCoordinator","add","label","allowRoomSettingChange","room","setting","isRoomSettingAllowed","BROADCAST","Boolean","broadcast","READ_ONLY","REACT_WHEN_READ_ONLY","ro","E2E","SYSTEM_MESSAGES","allowMemberAction","_room","action","showingUserId","userSubscription","actionAllowed","BLOCK","roomName","roomData","prid","fname","get","name","isGroupChat","getUiText","context","HIDE_WARNING","LEAVE_WARNING","condition","groupByType","userId","getAvatarPath","roomId","_id","cache","avatarETag","getIcon","teamMain","extractOpenRoomParams","_ref","type","reference","findRoom","identifier","findOne","t","showJoinLink"],"mappings":"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"}