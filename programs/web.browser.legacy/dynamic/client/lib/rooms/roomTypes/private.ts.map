)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/lib/rooms/roomTypes/private.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { AtLeast, IRoom } from '@rocket.chat/core-typings';\nimport { isRoomFederated } from '@rocket.chat/core-typings';\nimport { Meteor } from 'meteor/meteor';\nimport type { Mongo } from 'meteor/mongo';\n\nimport { hasPermission } from '../../../../app/authorization/client';\nimport { ChatRoom } from '../../../../app/models/client';\nimport { settings } from '../../../../app/settings/client';\nimport { getUserPreference } from '../../../../app/utils/client';\nimport { getRoomAvatarURL } from '../../../../app/utils/client/getRoomAvatarURL';\nimport type { IRoomTypeClientDirectives } from '../../../../definition/IRoomTypeConfig';\nimport { RoomSettingsEnum, RoomMemberActions, UiTextContext } from '../../../../definition/IRoomTypeConfig';\nimport { getPrivateRoomType } from '../../../../lib/rooms/roomTypes/private';\nimport * as Federation from '../../federation/Federation';\nimport { roomCoordinator } from '../roomCoordinator';\n\nexport const PrivateRoomType = getPrivateRoomType(roomCoordinator);\n\nroomCoordinator.add(\n\t{\n\t\t...PrivateRoomType,\n\t\tlabel: 'Private_Groups',\n\t},\n\t{\n\t\tallowRoomSettingChange(room, setting) {\n\t\t\tif (isRoomFederated(room as IRoom)) {\n\t\t\t\treturn Federation.isRoomSettingAllowed(room, setting);\n\t\t\t}\n\t\t\tswitch (setting) {\n\t\t\t\tcase RoomSettingsEnum.JOIN_CODE:\n\t\t\t\t\treturn false;\n\t\t\t\tcase RoomSettingsEnum.BROADCAST:\n\t\t\t\t\treturn Boolean(room.broadcast);\n\t\t\t\tcase RoomSettingsEnum.READ_ONLY:\n\t\t\t\t\treturn !room.broadcast;\n\t\t\t\tcase RoomSettingsEnum.REACT_WHEN_READ_ONLY:\n\t\t\t\t\treturn Boolean(!room.broadcast && room.ro);\n\t\t\t\tcase RoomSettingsEnum.E2E:\n\t\t\t\t\treturn settings.get('E2E_Enable') === true;\n\t\t\t\tcase RoomSettingsEnum.SYSTEM_MESSAGES:\n\t\t\t\tdefault:\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t},\n\n\t\tallowMemberAction(_room, action, showingUserId, userSubscription) {\n\t\t\tif (isRoomFederated(_room as IRoom)) {\n\t\t\t\treturn Federation.actionAllowed(_room, action, showingUserId, userSubscription);\n\t\t\t}\n\t\t\tswitch (action) {\n\t\t\t\tcase RoomMemberActions.BLOCK:\n\t\t\t\t\treturn false;\n\t\t\t\tdefault:\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t},\n\n\t\troomName(roomData) {\n\t\t\tif (roomData.prid || isRoomFederated(roomData)) {\n\t\t\t\treturn roomData.fname;\n\t\t\t}\n\t\t\tif (settings.get('UI_Allow_room_names_with_special_chars')) {\n\t\t\t\treturn roomData.fname || roomData.name;\n\t\t\t}\n\n\t\t\treturn roomData.name;\n\t\t},\n\n\t\tisGroupChat(_room) {\n\t\t\treturn true;\n\t\t},\n\n\t\tgetUiText(context) {\n\t\t\tswitch (context) {\n\t\t\t\tcase UiTextContext.HIDE_WARNING:\n\t\t\t\t\treturn 'Hide_Group_Warning';\n\t\t\t\tcase UiTextContext.LEAVE_WARNING:\n\t\t\t\t\treturn 'Leave_Group_Warning';\n\t\t\t\tdefault:\n\t\t\t\t\treturn '';\n\t\t\t}\n\t\t},\n\n\t\tcondition() {\n\t\t\tconst groupByType = getUserPreference(Meteor.userId(), 'sidebarGroupByType');\n\t\t\treturn groupByType && hasPermission('view-p-room');\n\t\t},\n\n\t\tgetAvatarPath(room) {\n\t\t\treturn getRoomAvatarURL({ roomId: room._id, cache: room.avatarETag });\n\t\t},\n\n\t\tgetIcon(room) {\n\t\t\tif (room.prid) {\n\t\t\t\treturn 'discussion';\n\t\t\t}\n\t\t\tif (room.teamMain) {\n\t\t\t\treturn 'team-lock';\n\t\t\t}\n\n\t\t\tif (isRoomFederated(room)) {\n\t\t\t\treturn 'globe';\n\t\t\t}\n\n\t\t\treturn 'hashtag-lock';\n\t\t},\n\n\t\textractOpenRoomParams({ name }) {\n\t\t\treturn { type: 'p', reference: name };\n\t\t},\n\n\t\tfindRoom(identifier) {\n\t\t\tconst query: Mongo.Selector<IRoom> = {\n\t\t\t\tt: 'p',\n\t\t\t\tname: identifier,\n\t\t\t};\n\n\t\t\treturn ChatRoom.findOne(query);\n\t\t},\n\t} as AtLeast<IRoomTypeClientDirectives, 'isGroupChat' | 'roomName'>,\n);\n",null],"names":["module","link","default","_objectSpread","export","PrivateRoomType","isRoomFederated","Meteor","hasPermission","ChatRoom","settings","getUserPreference","getRoomAvatarURL","RoomSettingsEnum","RoomMemberActions","UiTextContext","getPrivateRoomType","v","Federation","roomCoordinator","add","label","allowRoomSettingChange","room","setting","isRoomSettingAllowed","JOIN_CODE","BROADCAST","Boolean","broadcast","READ_ONLY","REACT_WHEN_READ_ONLY","ro","E2E","get","SYSTEM_MESSAGES","allowMemberAction","_room","action","showingUserId","userSubscription","actionAllowed","BLOCK","roomName","roomData","prid","fname","name","isGroupChat","getUiText","context","HIDE_WARNING","LEAVE_WARNING","condition","groupByType","userId","getAvatarPath","roomId","_id","cache","avatarETag","getIcon","teamMain","extractOpenRoomParams","_ref","type","reference","findRoom","identifier","findOne","t"],"mappings":"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"}