)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/startup/messageObserve.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Meteor } from 'meteor/meteor';\n\nimport { ChatMessage } from '../../app/models/client';\nimport { LegacyRoomManager } from '../../app/ui-utils/client';\n\nMeteor.startup(() => {\n\tChatMessage.find().observe({\n\t\tremoved(record) {\n\t\t\tif (!LegacyRoomManager.getOpenedRoomByRid(record.rid)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst recordBefore = ChatMessage.findOne({ ts: { $lt: record.ts } }, { sort: { ts: -1 } });\n\t\t\tif (recordBefore) {\n\t\t\t\tChatMessage.update({ _id: recordBefore._id }, { $set: { tick: new Date() } });\n\t\t\t}\n\n\t\t\tconst recordAfter = ChatMessage.findOne({ ts: { $gt: record.ts } }, { sort: { ts: 1 } });\n\t\t\tif (recordAfter) {\n\t\t\t\treturn ChatMessage.update({ _id: recordAfter._id }, { $set: { tick: new Date() } });\n\t\t\t}\n\t\t},\n\t});\n});\n",null],"names":["Meteor","ChatMessage","LegacyRoomManager","module","link","startup","find","observe","removed","record","getOpenedRoomByRid","rid","recordBefore","findOne","ts","$lt","sort","update","_id","$set","tick","Date","recordAfter","$gt"],"mappings":"2BAAAA,EAAuCC,EAAAC,EAA9BC,EAAQC,IAAA,CAAM,gBAAgB,CAAAJ,OAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,0BAAAA,CAAAF,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,4BAAAA,CAAAD,kBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAKvCF,EAAOK,OAAO,CAAC,WACdJ,EAAYK,IAAI,GAAGC,OAAO,CAAC,CAC1BC,QAAO,SAACC,CAAM,EACb,GAAKP,EAAkBQ,kBAAkB,CAACD,EAAOE,GAAG,GAIpD,IAAMC,EAAeX,EAAYY,OAAO,CAAC,CAAEC,GAAI,CAAEC,IAAKN,EAAOK,EAAAA,AAAE,CAAE,EAAI,CAAEE,KAAM,CAAEF,GAAI,EAAE,CAAE,GACnFF,GACHX,EAAYgB,MAAM,CAAC,CAAEC,IAAKN,EAAaM,GAAAA,AAAG,EAAI,CAAEC,KAAM,CAAEC,KAAM,IAAIC,IAAM,CAAE,GAG3E,IAAMC,EAAcrB,EAAYY,OAAO,CAAC,CAAEC,GAAI,CAAES,IAAKd,EAAOK,EAAAA,AAAE,CAAE,EAAI,CAAEE,KAAM,CAAEF,GAAI,CAAC,CAAE,GACrF,GAAIQ,EACH,OAAOrB,EAAYgB,MAAM,CAAC,CAAEC,IAAKI,EAAYJ,GAAAA,AAAG,EAAI,CAAEC,KAAM,CAAEC,KAAM,IAAIC,IAAM,CAAE,GAElF,GAEF"}