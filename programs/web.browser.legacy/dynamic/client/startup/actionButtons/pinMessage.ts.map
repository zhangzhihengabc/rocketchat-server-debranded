)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/startup/actionButtons/pinMessage.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Meteor } from 'meteor/meteor';\n\nimport { hasAtLeastOnePermission } from '../../../app/authorization/client';\nimport { settings } from '../../../app/settings/client';\nimport { MessageAction } from '../../../app/ui-utils/client';\nimport { sdk } from '../../../app/utils/client/lib/SDKClient';\nimport { queryClient } from '../../lib/queryClient';\nimport { roomCoordinator } from '../../lib/rooms/roomCoordinator';\nimport { dispatchToastMessage } from '../../lib/toast';\nimport { messageArgs } from '../../lib/utils/messageArgs';\n\nMeteor.startup(() => {\n\tMessageAction.addButton({\n\t\tid: 'pin-message',\n\t\ticon: 'pin',\n\t\tlabel: 'Pin',\n\t\ttype: 'interaction',\n\t\tcontext: ['pinned', 'message', 'message-mobile', 'threads', 'direct', 'videoconf', 'videoconf-threads'],\n\t\tasync action(_, props) {\n\t\t\tconst { message = messageArgs(this).msg } = props;\n\t\t\tmessage.pinned = true;\n\t\t\ttry {\n\t\t\t\tawait sdk.call('pinMessage', message);\n\t\t\t\tqueryClient.invalidateQueries(['rooms', message.rid, 'pinned-messages']);\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t},\n\t\tcondition({ message, subscription, room }) {\n\t\t\tif (!settings.get('Message_AllowPinning') || message.pinned || !subscription) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst isLivechatRoom = roomCoordinator.isLivechatRoom(room.t);\n\t\t\tif (isLivechatRoom) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn hasAtLeastOnePermission('pin-message', message.rid);\n\t\t},\n\t\torder: 2,\n\t\tgroup: 'menu',\n\t});\n});\n",null],"names":["_regeneratorRuntime","Meteor","hasAtLeastOnePermission","settings","MessageAction","sdk","queryClient","roomCoordinator","dispatchToastMessage","messageArgs","module","default","link","startup","addButton","id","icon","label","type","context","action","_","props","_props$message","message","async","_context","prev","next","msg","pinned","awrap","call","invalidateQueries","rid","t0","stop","Promise","condition","_ref","subscription","room","get","isLivechatRoom","t","order","group"],"mappings":"2BAAAA,EAAAC,EAAuCC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAhBC,EAAAA,IAAAA,CAAAA,6BAAgB,CAAAC,QAAAA,SAAAA,CAAAA,EAAAX,EAAAA,CAAA,CAAA,EAAA,GAA9BU,EAAQE,IAAA,CAAM,gBAAgB,CAAAX,OAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAS,EAAAA,IAAAA,CAAAA,oCAAAA,CAAAR,wBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAQ,EAAAA,IAAAA,CAAAA,+BAAAA,CAAAP,SAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAO,EAAAA,IAAAA,CAAAA,+BAAAA,CAAAN,cAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,0CAAAA,CAAAL,IAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAK,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAJ,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,kCAAAA,CAAAH,gBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,kBAAAA,CAAAF,qBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,8BAAAA,CAAAD,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAWvCR,EAAOY,OAAO,CAAC,WACdT,EAAcU,SAAS,CAAC,CACvBC,GAAI,cACJC,KAAM,MACNC,MAAO,MACPC,KAAM,cACNC,QAAS,CAAC,SAAU,UAAW,iBAAkB,UAAW,SAAU,YAAa,oBAAoB,CACjGC,OAAM,SAACC,CAAC,CAAEC,CAAK,EAAA,IAAAC,EAAAC,EAAA,OAAAxB,EAAAyB,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAEE,MAAtBJ,AADQA,CAAAA,EAAOD,AAAA,KAAA,IADKA,CAAAA,EACwBD,EAApCE,OAAO,AAAPA,EAAUf,EAAY,IAAI,EAAEoB,GAAG,CAAAN,CAAA,EAC/BO,MAAM,CAAG,CAAA,EAAKJ,EAAAC,IAAA,CAAA,EAAAD,EAAAE,IAAA,CAAA,EAAA5B,EAAA+B,KAAA,CAEf1B,EAAI2B,IAAI,CAAC,aAAcR,GAAQ,MAAA,EACrClB,EAAY2B,iBAAiB,CAAC,CAAC,QAAST,EAAQU,GAAG,CAAE,kBAAkB,EAAER,EAAAE,IAAA,CAAA,GAAA,KAAA,MAAA,EAAAF,EAAAC,IAAA,CAAA,EAAAD,EAAAS,EAAA,CAAAT,EAAA,KAAA,CAAA,GAEzElB,EAAqB,CAAEU,KAAM,QAASM,QAAOE,EAAAS,EAAA,AAAO,EAAI,MAAA,GAAA,IAAA,MAAA,OAAAT,EAAAU,IAAA,EAAA,CAAA,EAAA,KAAA,IAAA,CAAA,CAAA,CAAA,EAAA,EAAA,CAAA,CAAAC,QAAA,EAG1DC,UAAS,SAAAC,CAAA,EAAgC,IAA7Bf,EAAOe,EAAPf,OAAO,CAAEgB,EAAYD,EAAZC,YAAY,CAAEC,EAAIF,EAAJE,IAAI,OACtC,EAAKtC,EAASuC,GAAG,CAAC,0BAA2BlB,EAAQM,MAAM,IAAKU,IAGzCjC,EAAgBoC,cAAc,CAACF,EAAKG,CAAC,GAIrD1C,EAAwB,cAAesB,EAAQU,GAAG,CAC1D,EACAW,MAAO,EACPC,MAAO,QAET"}