)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/startup/startup.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { UserStatus } from '@rocket.chat/core-typings';\nimport { Meteor } from 'meteor/meteor';\nimport { UserPresence } from 'meteor/rocketchat:user-presence';\nimport { Session } from 'meteor/session';\nimport { Tracker } from 'meteor/tracker';\nimport moment from 'moment';\n\nimport { register } from '../../app/markdown/lib/hljs';\nimport { settings } from '../../app/settings/client';\nimport { getUserPreference } from '../../app/utils/client';\nimport 'hljs9/styles/github.css';\nimport { sdk } from '../../app/utils/client/lib/SDKClient';\nimport { synchronizeUserData, removeLocalUserData } from '../lib/userData';\nimport { fireGlobalEvent } from '../lib/utils/fireGlobalEvent';\n\nMeteor.startup(() => {\n\tfireGlobalEvent('startup', true);\n\n\tSession.setDefault('AvatarRandom', 0);\n\n\twindow.lastMessageWindow = {};\n\twindow.lastMessageWindowHistory = {};\n\n\tlet status: UserStatus | undefined = undefined;\n\tTracker.autorun(async () => {\n\t\tconst uid = Meteor.userId();\n\t\tif (!uid) {\n\t\t\tremoveLocalUserData();\n\t\t\treturn;\n\t\t}\n\t\tif (!Meteor.status().connected) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst user = await synchronizeUserData(uid);\n\t\tif (!user) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst utcOffset = moment().utcOffset() / 60;\n\t\tif (user.utcOffset !== utcOffset) {\n\t\t\tsdk.call('userSetUtcOffset', utcOffset);\n\t\t}\n\n\t\tif (getUserPreference(user, 'enableAutoAway')) {\n\t\t\tconst idleTimeLimit = (getUserPreference(user, 'idleTimeLimit') as number | null | undefined) || 300;\n\t\t\tUserPresence.awayTime = idleTimeLimit * 1000;\n\t\t} else {\n\t\t\tdelete UserPresence.awayTime;\n\t\t\tUserPresence.stopTimer();\n\t\t}\n\n\t\tUserPresence.start();\n\n\t\tif (user.status !== status) {\n\t\t\tstatus = user.status;\n\t\t\tfireGlobalEvent('status-changed', status);\n\t\t}\n\t});\n});\nMeteor.startup(() => {\n\tTracker.autorun(() => {\n\t\tconst code = settings.get('Message_Code_highlight') as string | undefined;\n\t\tcode?.split(',').forEach((language: string) => {\n\t\t\tlanguage.trim() && register(language.trim());\n\t\t});\n\t});\n});\n",null],"names":["_regeneratorRuntime","Meteor","UserPresence","Session","Tracker","moment","register","settings","getUserPreference","sdk","synchronizeUserData","removeLocalUserData","fireGlobalEvent","module","default","link","v","startup","setDefault","window","lastMessageWindow","lastMessageWindowHistory","status","undefined","autorun","uid","user","utcOffset","idleTimeLimit","async","_context","prev","next","userId","abrupt","connected","awrap","sent","call","awayTime","stopTimer","start","stop","Promise","code","get","split","forEach","language","trim"],"mappings":"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"}