function module(n,e,t){t.link("@babel/runtime/regenerator",{default:function(n){r=n}},0),t.link("meteor/meteor",{Meteor:function(n){i=n}},0),t.link("meteor/tracker",{Tracker:function(n){o=n}},1),t.link("../../app/models/client",{ChatMessage:function(n){a=n},ChatSubscription:function(n){s=n}},2),t.link("../../app/ui-utils/client",{LegacyRoomManager:function(n){c=n},upsertMessage:function(n){u=n}},3),t.link("../lib/utils/callWithErrorHandling",{callWithErrorHandling:function(n){l=n}},4);var r,i,o,a,s,c,u,l,f=function(n){var e,t,i;return r.async(function(o){for(;;)switch(o.prev=o.next){case 0:if(e=a.findOne({rid:n,_hidden:{$ne:!0},temp:{$exists:!1}},{sort:{ts:-1},limit:1})){o.next=3;break}return o.abrupt("return");case 3:return o.prev=3,o.next=6,r.awrap(l("loadMissedMessages",n,e.ts));case 6:if(!(t=o.sent)){o.next=11;break}return i=s.findOne({rid:n}),o.next=11,r.awrap(Promise.all(Array.from(t).map(function(n){return u({msg:n,subscription:i})})));case 11:o.next=16;break;case 13:o.prev=13,o.t0=o.catch(3),console.error(o.t0);case 16:case"end":return o.stop()}},null,null,[[3,13]],Promise)};i.startup(function(){var n=!0;o.autorun(function(){var e=i.connection.status().connected;!0===e&&!1===n&&c.openedRooms&&Object.keys(c.openedRooms).forEach(function(n){var e=c.openedRooms[n];e.rid&&f(e.rid)}),n=e})})}
//# sourceMappingURL=/dynamic/client/startup/0bfbeac575aa930761942bb3a47b18296868885a.map
