)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/components/avatar/RoomAvatarEditor.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { isRoomFederated } from '@rocket.chat/core-typings';\nimport type { IRoom, RoomAdminFieldsType } from '@rocket.chat/core-typings';\nimport { css } from '@rocket.chat/css-in-js';\nimport { Box, Button, ButtonGroup } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useToastMessageDispatch, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useEffect } from 'react';\n\nimport { getAvatarURL } from '../../../app/utils/client/getAvatarURL';\nimport { useFileInput } from '../../hooks/useFileInput';\nimport { isValidImageFormat } from '../../lib/utils/isValidImageFormat';\nimport RoomAvatar from './RoomAvatar';\n\ntype RoomAvatarEditorProps = {\n\troom: Pick<IRoom, RoomAdminFieldsType>;\n\tdisabled?: boolean;\n\troomAvatar?: string;\n\tonChangeAvatar: (url: string | null) => void;\n};\n\nconst RoomAvatarEditor = ({ disabled = false, room, roomAvatar, onChangeAvatar }: RoomAvatarEditorProps): ReactElement => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst handleChangeAvatar = useMutableCallback(async (file) => {\n\t\tconst reader = new FileReader();\n\t\treader.readAsDataURL(file);\n\t\treader.onloadend = async (): Promise<void> => {\n\t\t\tconst { result } = reader;\n\t\t\tif (typeof result === 'string' && (await isValidImageFormat(result))) {\n\t\t\t\tonChangeAvatar(result);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdispatchToastMessage({ type: 'error', message: t('Avatar_format_invalid') });\n\t\t};\n\t});\n\n\tconst [clickUpload, reset] = useFileInput(handleChangeAvatar);\n\tconst clickReset = useMutableCallback(() => {\n\t\treset();\n\t\tonChangeAvatar(null);\n\t});\n\n\tuseEffect(() => {\n\t\t!roomAvatar && reset();\n\t}, [roomAvatar, reset]);\n\n\tconst defaultUrl = room.prid ? getAvatarURL({ roomId: room.prid }) : getAvatarURL({ username: `@${room.name}` }); // Discussions inherit avatars from the parent room\n\n\treturn (\n\t\t<Box borderRadius='x2' maxWidth='x332' w='full' position='relative'>\n\t\t\t<RoomAvatar {...(roomAvatar !== undefined && { url: roomAvatar === null ? defaultUrl : roomAvatar })} room={room} size='x332' />\n\t\t\t<Box\n\t\t\t\tclassName={[\n\t\t\t\t\tcss`\n\t\t\t\t\t\tbottom: 0;\n\t\t\t\t\t\tright: 0;\n\t\t\t\t\t`,\n\t\t\t\t]}\n\t\t\t\tposition='absolute'\n\t\t\t\tm={12}\n\t\t\t>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t<Button icon='upload' disabled={isRoomFederated(room) || disabled} small title={t('Upload_user_avatar')} onClick={clickUpload}>\n\t\t\t\t\t\t{t('Upload')}\n\t\t\t\t\t</Button>\n\n\t\t\t\t\t<Button\n\t\t\t\t\t\tsmall\n\t\t\t\t\t\tdanger\n\t\t\t\t\t\ticon='trash'\n\t\t\t\t\t\ttitle={t('Accounts_SetDefaultAvatar')}\n\t\t\t\t\t\tdisabled={!roomAvatar || isRoomFederated(room) || disabled}\n\t\t\t\t\t\tonClick={clickReset}\n\t\t\t\t\t/>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Box>\n\t\t</Box>\n\t);\n};\n\nexport default RoomAvatarEditor;\n",null],"names":["_taggedTemplateLiteralLoose","_extends","_slicedToArray","_regeneratorRuntime","isRoomFederated","css","Box","Button","ButtonGroup","useMutableCallback","useToastMessageDispatch","useTranslation","React","useEffect","getAvatarURL","useFileInput","isValidImageFormat","RoomAvatar","module","default","link","v","exportDefault","_ref","_ref$disabled","disabled","room","roomAvatar","onChangeAvatar","t","dispatchToastMessage","_useFileInput2","file","reader","async","_context2","prev","next","FileReader","readAsDataURL","onloadend","_callee","result","_callee$","_context","t0","awrap","sent","abrupt","type","message","stop","Promise","clickUpload","reset","clickReset","defaultUrl","prid","roomId","username","name","createElement","borderRadius","maxWidth","w","position","undefined","url","size","className","_templateObject","m","icon","small","title","onClick","danger"],"mappings":"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"}