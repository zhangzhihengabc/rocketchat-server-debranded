)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/components/message/variants/room/RoomMessageContent.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IMessage } from '@rocket.chat/core-typings';\nimport { isDiscussionMessage, isThreadMainMessage, isE2EEMessage } from '@rocket.chat/core-typings';\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\nimport { useSetting, useTranslation, useUserId } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { memo } from 'react';\n\nimport { useUserData } from '../../../../hooks/useUserData';\nimport type { UserPresence } from '../../../../lib/presence';\nimport { useChat } from '../../../../views/room/contexts/ChatContext';\nimport MessageContentBody from '../../MessageContentBody';\nimport ReadReceiptIndicator from '../../ReadReceiptIndicator';\nimport Attachments from '../../content/Attachments';\nimport BroadcastMetrics from '../../content/BroadcastMetrics';\nimport DiscussionMetrics from '../../content/DiscussionMetrics';\nimport Location from '../../content/Location';\nimport MessageActions from '../../content/MessageActions';\nimport Reactions from '../../content/Reactions';\nimport ThreadMetrics from '../../content/ThreadMetrics';\nimport UrlPreviews from '../../content/UrlPreviews';\nimport { useNormalizedMessage } from '../../hooks/useNormalizedMessage';\nimport { useOembedLayout } from '../../hooks/useOembedLayout';\nimport { useSubscriptionFromMessageQuery } from '../../hooks/useSubscriptionFromMessageQuery';\nimport UiKitMessageBlock from '../../uikit/UiKitMessageBlock';\n\ntype RoomMessageContentProps = {\n\tmessage: IMessage;\n\tunread: boolean;\n\tmention: boolean;\n\tall: boolean;\n\tsearchText?: string;\n};\n\nconst RoomMessageContent = ({ message, unread, all, mention, searchText }: RoomMessageContentProps): ReactElement => {\n\tconst encrypted = isE2EEMessage(message);\n\tconst { enabled: oembedEnabled } = useOembedLayout();\n\tconst subscription = useSubscriptionFromMessageQuery(message).data ?? undefined;\n\tconst broadcast = subscription?.broadcast ?? false;\n\tconst uid = useUserId();\n\tconst messageUser: UserPresence = { ...message.u, roles: [], ...useUserData(message.u._id) };\n\tconst readReceiptEnabled = useSetting('Message_Read_Receipt_Enabled', false);\n\tconst chat = useChat();\n\tconst t = useTranslation();\n\n\tconst normalizedMessage = useNormalizedMessage(message);\n\n\treturn (\n\t\t<>\n\t\t\t{!normalizedMessage.blocks?.length && !!normalizedMessage.md?.length && (\n\t\t\t\t<>\n\t\t\t\t\t{(!encrypted || normalizedMessage.e2e === 'done') && (\n\t\t\t\t\t\t<MessageContentBody\n\t\t\t\t\t\t\tmd={normalizedMessage.md}\n\t\t\t\t\t\t\tmentions={normalizedMessage.mentions}\n\t\t\t\t\t\t\tchannels={normalizedMessage.channels}\n\t\t\t\t\t\t\tsearchText={searchText}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t{encrypted && normalizedMessage.e2e === 'pending' && t('E2E_message_encrypted_placeholder')}\n\t\t\t\t</>\n\t\t\t)}\n\n\t\t\t{normalizedMessage.blocks && (\n\t\t\t\t<UiKitMessageBlock rid={normalizedMessage.rid} mid={normalizedMessage._id} blocks={normalizedMessage.blocks} />\n\t\t\t)}\n\n\t\t\t{!!normalizedMessage?.attachments?.length && <Attachments attachments={normalizedMessage.attachments} />}\n\n\t\t\t{oembedEnabled && !!normalizedMessage.urls?.length && <UrlPreviews urls={normalizedMessage.urls} />}\n\n\t\t\t{normalizedMessage.actionLinks?.length && (\n\t\t\t\t<MessageActions\n\t\t\t\t\tmessage={normalizedMessage}\n\t\t\t\t\tactions={normalizedMessage.actionLinks.map(({ method_id: methodId, i18nLabel, ...action }) => ({\n\t\t\t\t\t\tmethodId,\n\t\t\t\t\t\ti18nLabel: i18nLabel as TranslationKey,\n\t\t\t\t\t\t...action,\n\t\t\t\t\t}))}\n\t\t\t\t/>\n\t\t\t)}\n\n\t\t\t{normalizedMessage.reactions && Object.keys(normalizedMessage.reactions).length && <Reactions message={normalizedMessage} />}\n\n\t\t\t{chat && isThreadMainMessage(normalizedMessage) && (\n\t\t\t\t<ThreadMetrics\n\t\t\t\t\tcounter={normalizedMessage.tcount}\n\t\t\t\t\tfollowing={Boolean(uid && normalizedMessage?.replies?.indexOf(uid) > -1)}\n\t\t\t\t\tmid={normalizedMessage._id}\n\t\t\t\t\trid={normalizedMessage.rid}\n\t\t\t\t\tlm={normalizedMessage.tlm}\n\t\t\t\t\tunread={unread}\n\t\t\t\t\tmention={mention}\n\t\t\t\t\tall={all}\n\t\t\t\t\tparticipants={normalizedMessage?.replies?.length}\n\t\t\t\t/>\n\t\t\t)}\n\n\t\t\t{isDiscussionMessage(normalizedMessage) && (\n\t\t\t\t<DiscussionMetrics\n\t\t\t\t\tcount={normalizedMessage.dcount}\n\t\t\t\t\tdrid={normalizedMessage.drid}\n\t\t\t\t\tlm={normalizedMessage.dlm}\n\t\t\t\t\trid={normalizedMessage.rid}\n\t\t\t\t/>\n\t\t\t)}\n\n\t\t\t{normalizedMessage.location && <Location location={normalizedMessage.location} />}\n\n\t\t\t{broadcast && !!messageUser.username && normalizedMessage.u._id !== uid && (\n\t\t\t\t<BroadcastMetrics username={messageUser.username} message={normalizedMessage} />\n\t\t\t)}\n\n\t\t\t{readReceiptEnabled && <ReadReceiptIndicator unread={normalizedMessage.unread} />}\n\t\t</>\n\t);\n};\n\nexport default memo(RoomMessageContent);\n",null],"names":["_objectWithoutProperties","_objectSpread","isDiscussionMessage","isThreadMainMessage","isE2EEMessage","useSetting","useTranslation","useUserId","React","memo","useUserData","useChat","MessageContentBody","ReadReceiptIndicator","Attachments","BroadcastMetrics","DiscussionMetrics","Location","MessageActions","Reactions","ThreadMetrics","UrlPreviews","useNormalizedMessage","useOembedLayout","useSubscriptionFromMessageQuery","UiKitMessageBlock","module","link","default","v","exportDefault","_ref","_useSubscriptionFromM","_subscription$broadca","_normalizedMessage$bl","_normalizedMessage$md","_normalizedMessage$at","_normalizedMessage$ur","_normalizedMessage$ac","_normalizedMessage$re","_normalizedMessage$re2","message","unread","all","mention","searchText","encrypted","oembedEnabled","_useOembedLayout","enabled","subscription","data","undefined","broadcast","uid","messageUser","u","roles","_id","readReceiptEnabled","chat","t","normalizedMessage","createElement","Fragment","blocks","length","md","e2e","mentions","channels","rid","mid","attachments","urls","actionLinks","actions","map","_ref2","methodId","method_id","i18nLabel","_excluded","reactions","Object","keys","counter","tcount","following","Boolean","replies","indexOf","lm","tlm","participants","count","dcount","drid","dlm","location","username"],"mappings":"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"}