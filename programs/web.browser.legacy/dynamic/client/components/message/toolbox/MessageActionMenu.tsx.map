)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/components/message/toolbox/MessageActionMenu.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { MessageToolboxItem, Option, OptionDivider, OptionTitle } from '@rocket.chat/fuselage';\nimport { useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ComponentProps, MouseEvent, MouseEventHandler, ReactElement } from 'react';\nimport React, { Fragment, useCallback, useRef, useState } from 'react';\n\nimport type { MessageActionConfig } from '../../../../app/ui-utils/client/lib/MessageAction';\nimport { useEmbeddedLayout } from '../../../hooks/useEmbeddedLayout';\nimport ToolboxDropdown from './ToolboxDropdown';\n\ntype MessageActionConfigOption = Omit<MessageActionConfig, 'condition' | 'context' | 'order' | 'action'> & {\n\taction: ((event: MouseEvent<HTMLElement, MouseEvent>) => void) & MouseEventHandler<HTMLElement>;\n};\n\ntype MessageActionMenuProps = {\n\tonChangeMenuVisibility: (visible: boolean) => void;\n\toptions: MessageActionConfigOption[];\n};\n\nconst getSectionOrder = (section: string): number => {\n\tswitch (section) {\n\t\tcase 'communication':\n\t\t\treturn 0;\n\t\tcase 'interaction':\n\t\t\treturn 1;\n\t\tcase 'duplication':\n\t\t\treturn 2;\n\t\tcase 'apps':\n\t\t\treturn 3;\n\t\tcase 'management':\n\t\t\treturn 4;\n\t\tdefault:\n\t\t\treturn 5;\n\t}\n};\n\nconst MessageActionMenu = ({ options, onChangeMenuVisibility, ...props }: MessageActionMenuProps): ReactElement => {\n\tconst buttonRef = useRef<HTMLButtonElement | null>(null);\n\tconst t = useTranslation();\n\tconst [visible, setVisible] = useState(false);\n\tconst isLayoutEmbedded = useEmbeddedLayout();\n\n\tconst handleChangeMenuVisibility = useCallback(\n\t\t(visible: boolean): void => {\n\t\t\tsetVisible(visible);\n\t\t\tonChangeMenuVisibility(visible);\n\t\t},\n\t\t[onChangeMenuVisibility],\n\t);\n\n\tconst groupOptions = options.reduce((acc, option) => {\n\t\tconst { type = '' } = option;\n\n\t\tif (option.color === 'alert') {\n\t\t\toption.variant = 'danger' as const;\n\t\t}\n\n\t\tconst order = getSectionOrder(type);\n\n\t\tconst [sectionType, options] = acc[getSectionOrder(type)] ?? [type, []];\n\n\t\tif (!(isLayoutEmbedded && option.id === 'reply-directly')) {\n\t\t\toptions.push(option);\n\t\t}\n\n\t\tif (options.length === 0) {\n\t\t\treturn acc;\n\t\t}\n\n\t\tacc[order] = [sectionType, options];\n\n\t\treturn acc;\n\t}, [] as unknown as [section: string, options: Array<MessageActionConfigOption>][]);\n\n\tconst handleClose = useCallback(() => {\n\t\thandleChangeMenuVisibility(false);\n\t}, [handleChangeMenuVisibility]);\n\treturn (\n\t\t<>\n\t\t\t<MessageToolboxItem\n\t\t\t\tref={buttonRef}\n\t\t\t\ticon='kebab'\n\t\t\t\tonClick={(): void => handleChangeMenuVisibility(!visible)}\n\t\t\t\tdata-qa-id='menu'\n\t\t\t\tdata-qa-type='message-action-menu'\n\t\t\t\ttitle={t('More')}\n\t\t\t/>\n\t\t\t{visible && (\n\t\t\t\t<>\n\t\t\t\t\t<ToolboxDropdown handleClose={handleClose} reference={buttonRef} {...props}>\n\t\t\t\t\t\t{groupOptions.map(([section, options], index, arr) => (\n\t\t\t\t\t\t\t<Fragment key={index}>\n\t\t\t\t\t\t\t\t{section === 'apps' && <OptionTitle>Apps</OptionTitle>}\n\t\t\t\t\t\t\t\t{options.map((option) => (\n\t\t\t\t\t\t\t\t\t<Option\n\t\t\t\t\t\t\t\t\t\tvariant={option.variant}\n\t\t\t\t\t\t\t\t\t\tkey={option.id}\n\t\t\t\t\t\t\t\t\t\tid={option.id}\n\t\t\t\t\t\t\t\t\t\ticon={option.icon as ComponentProps<typeof Option>['icon']}\n\t\t\t\t\t\t\t\t\t\tlabel={t(option.label)}\n\t\t\t\t\t\t\t\t\t\tonClick={(e) => {\n\t\t\t\t\t\t\t\t\t\t\thandleClose();\n\t\t\t\t\t\t\t\t\t\t\toption.action(e);\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tdata-qa-type='message-action'\n\t\t\t\t\t\t\t\t\t\tdata-qa-id={option.id}\n\t\t\t\t\t\t\t\t\t\trole={option.role ? option.role : 'button'}\n\t\t\t\t\t\t\t\t\t\tgap={!option.icon && option.type === 'apps'}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t{index !== arr.length - 1 && <OptionDivider />}\n\t\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</ToolboxDropdown>\n\t\t\t\t</>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default MessageActionMenu;\n",null],"names":["_extends","_slicedToArray","_objectWithoutProperties","MessageToolboxItem","Option","OptionDivider","OptionTitle","useTranslation","React","Fragment","useCallback","useRef","useState","useEmbeddedLayout","ToolboxDropdown","module","default","v","link","getSectionOrder","section","exportDefault","_ref","options","onChangeMenuVisibility","props","_excluded","buttonRef","t","_useState2","visible","setVisible","isLayoutEmbedded","handleChangeMenuVisibility","groupOptions","reduce","acc","option","_acc$getSectionOrder","_option$type","type","color","variant","order","_ref3","sectionType","id","push","length","handleClose","createElement","ref","icon","onClick","title","reference","map","_ref4","index","arr","_ref5","key","label","e","action","role","gap"],"mappings":"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"}