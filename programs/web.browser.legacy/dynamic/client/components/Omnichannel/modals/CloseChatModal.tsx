function module(e,t,n){var r,l,a,c,o,i,u,m,s,f,d,_,E,p,h,g,v,b,k,C,F,T,S,y,q,j,w,x;n.link("@babel/runtime/helpers/extends",{default:function(e){r=e}},0),n.link("@babel/runtime/helpers/slicedToArray",{default:function(e){l=e}},1),n.link("@rocket.chat/fuselage",{Field:function(e){a=e},FieldGroup:function(e){c=e},Button:function(e){o=e},TextInput:function(e){i=e},Modal:function(e){u=e},Box:function(e){m=e},CheckBox:function(e){s=e},Divider:function(e){f=e},EmailInput:function(e){d=e},FieldLabel:function(e){_=e},FieldRow:function(e){E=e},FieldError:function(e){p=e}},0),n.link("@rocket.chat/ui-contexts",{usePermission:function(e){h=e},useSetting:function(e){g=e},useTranslation:function(e){v=e},useUserPreference:function(e){b=e}},1),n.link("react",{default:function(e){k=e},useCallback:function(e){C=e},useState:function(e){F=e},useEffect:function(e){T=e},useMemo:function(e){S=e}},2),n.link("react-hook-form",{useForm:function(e){y=e}},3),n.link("../../../../ee/client/hooks/useHasLicenseModule",{useHasLicenseModule:function(e){q=e}},4),n.link("../../../lib/toast",{dispatchToastMessage:function(e){j=e}},5),n.link("../../GenericModal",{default:function(e){w=e}},6),n.link("../Tags",{default:function(e){x=e}},7),n.exportDefault(function(e){var t,n,B,M,P,D=e.department,G=e.visitorEmail,A=e.onCancel,L=e.onConfirm,O=v(),H=y(),I=H.formState.errors,R=H.handleSubmit,N=H.register,U=H.setError,V=H.setFocus,W=H.setValue,z=H.watch,J=g("Livechat_request_comment_when_closing_conversation"),K=l(F(!1),2),Q=K[0],X=K[1],Y=z("tags"),Z=z("comment"),$=z("transcriptEmail"),ee=z("subject"),et=null!==(t=b("omnichannelTranscriptEmail"))&&void 0!==t&&t,en=null!==(n=b("omnichannelTranscriptPDF"))&&void 0!==n&&n,er=q("livechat-enterprise"),el=h("request-pdf-transcript"),ea=h("send-omnichannel-chat-transcript")&&G,ec=el&&er,eo=ea||ec,ei=C(function(e){var t=e.comment,n=e.tags,r=e.transcriptPDF,l=e.transcriptEmail,a=e.subject,c=l&&G?{email:G,subject:a}:void 0;!(null!=t&&t.trim())&&J&&U("comment",{type:"custom",message:O("The_field_is_required",O("Comment"))}),l&&!a&&U("subject",{type:"custom",message:O("The_field_is_required",O("Subject"))}),!(null!=n&&n.length)&&Q&&U("tags",{type:"custom",message:O("error-tags-must-be-assigned-before-closing-chat")}),(!I.comment||I.tags)&&L(t,n,{omnichannelTranscriptPDF:!!r,omnichannelTranscriptEmail:!!l},c)},[J,Q,G,I,U,O,L]),eu=S(function(){var e=Q&&!(null!=Y&&Y.length)||I.tags,t=J&&!(null!=Z&&Z.trim())||I.comment,n=$&&(!G||!ee);return!!(e||t||n)},[Z,J,I,Q,Y,$,G,ee]);return T(function(){null!=D&&D.requestTagBeforeClosingChat&&X(!0)},[D]),T(function(){J&&V("comment")},[J,V]),T(function(){Q&&N("tags")},[N,Q]),T(function(){if($){if(!G){j({type:"error",message:O("Customer_without_registered_email")});return}W("subject",ee||O("Transcript_of_your_livechat_conversation"))}},[$,W,G,ee,O]),J||Q||eo?k.createElement(u,{wrapperFunction:function(e){return k.createElement(m,r({is:"form",onSubmit:R(ei)},e))}},k.createElement(u.Header,null,k.createElement(u.Icon,{name:"baloon-close-top-right"}),k.createElement(u.Title,null,O("Wrap_up_conversation")),k.createElement(u.Close,{onClick:A})),k.createElement(u.Content,{fontScale:"p2"},k.createElement(m,{color:"annotation"},O("Close_room_description")),k.createElement(c,null,k.createElement(a,null,k.createElement(_,{required:J},O("Comment")),k.createElement(E,null,k.createElement(i,r({},N("comment"),{error:I.comment&&O("error-the-field-is-required",{field:O("Comment")}),flexGrow:1,placeholder:O("Please_add_a_comment")}))),k.createElement(p,null,null===(B=I.comment)||void 0===B?void 0:B.message)),k.createElement(a,null,k.createElement(x,r({tagRequired:Q,tags:Y,handler:function(e){W("tags",e)}},D&&{department:D._id})),k.createElement(p,null,null===(M=I.tags)||void 0===M?void 0:M.message)),eo&&k.createElement(k.Fragment,null,k.createElement(a,null,k.createElement(f,null),k.createElement(_,{marginBlockStart:8},O("Chat_transcript"))),ec&&k.createElement(a,{marginBlockStart:10},k.createElement(E,null,k.createElement(s,r({id:"transcript-pdf"},N("transcriptPDF",{value:en}))),k.createElement(_,{htmlFor:"transcript-pdf",color:"default",fontScale:"c1"},O("Omnichannel_transcript_pdf")))),ea&&k.createElement(k.Fragment,null,k.createElement(a,{marginBlockStart:10},k.createElement(E,null,k.createElement(s,r({id:"transcript-email"},N("transcriptEmail",{value:et}))),k.createElement(_,{htmlFor:"transcript-email",color:"default",fontScale:"c1"},O("Omnichannel_transcript_email")))),$&&k.createElement(k.Fragment,null,k.createElement(a,{marginBlockStart:14},k.createElement(_,{required:!0},O("Contact_email")),k.createElement(E,null,k.createElement(d,{value:G,required:!0,disabled:!0,flexGrow:1}))),k.createElement(a,{marginBlockStart:12},k.createElement(_,{required:!0},O("Subject")),k.createElement(E,null,k.createElement(i,r({},N("subject",{required:!0}),{className:"active",error:I.subject&&O("error-the-field-is-required",{field:O("Subject")}),flexGrow:1}))),k.createElement(p,null,null===(P=I.subject)||void 0===P?void 0:P.message)))),k.createElement(a,{marginBlockStart:16},k.createElement(_,{color:"annotation",fontScale:"c1"},ec&&ea?O("These_options_affect_this_conversation_only_To_set_default_selections_go_to_My_Account_Omnichannel"):O("This_option_affect_this_conversation_only_To_set_default_selection_go_to_My_Account_Omnichannel")))))),k.createElement(u.Footer,null,k.createElement(u.FooterControllers,null,k.createElement(o,{onClick:A},O("Cancel")),k.createElement(o,{type:"submit",disabled:eu,primary:!0},O("Confirm"))))):k.createElement(w,{variant:"warning",title:O("Are_you_sure_you_want_to_close_this_chat"),onConfirm:function(){return L()},onCancel:A,onClose:A,confirmText:O("Confirm")})})}
//# sourceMappingURL=/dynamic/client/components/Omnichannel/modals/4dc277e57a05cb0de163ba292998b597f32f8ecc.map
