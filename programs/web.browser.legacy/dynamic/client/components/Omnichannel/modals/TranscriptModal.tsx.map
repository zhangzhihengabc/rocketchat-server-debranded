)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/components/Omnichannel/modals/TranscriptModal.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IOmnichannelRoom } from '@rocket.chat/core-typings';\nimport { Field, Button, TextInput, Modal, Box, FieldGroup, FieldLabel, FieldRow, FieldError } from '@rocket.chat/fuselage';\nimport { useTranslation } from '@rocket.chat/ui-contexts';\nimport type { FC } from 'react';\nimport React, { useCallback, useEffect } from 'react';\nimport { useForm } from 'react-hook-form';\n\ntype TranscriptModalProps = {\n\temail: string;\n\troom: IOmnichannelRoom;\n\tonRequest: (email: string, subject: string) => void;\n\tonSend?: (email: string, subject: string, token: string) => void;\n\tonCancel: () => void;\n\tonDiscard: () => void;\n};\n\nconst TranscriptModal: FC<TranscriptModalProps> = ({\n\temail: emailDefault = '',\n\troom,\n\tonRequest,\n\tonSend,\n\tonCancel,\n\tonDiscard,\n\t...props\n}) => {\n\tconst t = useTranslation();\n\n\tconst {\n\t\tregister,\n\t\thandleSubmit,\n\t\tsetValue,\n\t\tsetFocus,\n\t\twatch,\n\t\tformState: { errors, isValid, isSubmitting },\n\t} = useForm({\n\t\tdefaultValues: { email: emailDefault || '', subject: t('Transcript_of_your_livechat_conversation') },\n\t});\n\n\tuseEffect(() => {\n\t\tsetFocus('subject');\n\t}, [setFocus]);\n\n\tconst { transcriptRequest } = room;\n\tconst roomOpen = room?.open;\n\tconst token = room?.v?.token;\n\n\tconst handleDiscard = useCallback(() => onDiscard(), [onDiscard]);\n\n\tconst submit = useCallback(\n\t\t({ email, subject }: { email: string; subject: string }) => {\n\t\t\tif (roomOpen && !transcriptRequest) {\n\t\t\t\tonRequest(email, subject);\n\t\t\t}\n\t\t\tif (!roomOpen && onSend && token) {\n\t\t\t\tonSend(email, subject, token);\n\t\t\t}\n\t\t},\n\t\t[onRequest, onSend, roomOpen, token, transcriptRequest],\n\t);\n\n\tuseEffect(() => {\n\t\tif (transcriptRequest) {\n\t\t\tsetValue('email', transcriptRequest.email);\n\t\t\tsetValue('subject', transcriptRequest.subject);\n\t\t}\n\t}, [setValue, transcriptRequest]);\n\n\tconst canSubmit = isValid && Boolean(watch('subject'));\n\n\treturn (\n\t\t<Modal open wrapperFunction={(props) => <Box is='form' onSubmit={handleSubmit(submit)} {...props} />} {...props}>\n\t\t\t<Modal.Header>\n\t\t\t\t<Modal.Icon name='mail-arrow-top-right' />\n\t\t\t\t<Modal.Title>{t('Transcript')}</Modal.Title>\n\t\t\t\t<Modal.Close onClick={onCancel} />\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Content fontScale='p2'>\n\t\t\t\t{!!transcriptRequest && <p>{t('Livechat_transcript_already_requested_warning')}</p>}\n\t\t\t\t<FieldGroup>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<FieldLabel>{t('Email')}*</FieldLabel>\n\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\t\tdisabled={!!emailDefault || !!transcriptRequest}\n\t\t\t\t\t\t\t\terror={errors.email?.message}\n\t\t\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t\t\t{...register('email', { required: t('The_field_is_required', t('Email')) })}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t<FieldError>{errors.email?.message}</FieldError>\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<FieldLabel>{t('Subject')}*</FieldLabel>\n\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\t\tdisabled={!!transcriptRequest}\n\t\t\t\t\t\t\t\terror={errors.subject?.message}\n\t\t\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t\t\t{...register('subject', { required: t('The_field_is_required', t('Subject')) })}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t<FieldError>{errors.subject?.message}</FieldError>\n\t\t\t\t\t</Field>\n\t\t\t\t</FieldGroup>\n\t\t\t</Modal.Content>\n\t\t\t<Modal.Footer>\n\t\t\t\t<Modal.FooterControllers>\n\t\t\t\t\t<Button onClick={onCancel}>{t('Cancel')}</Button>\n\t\t\t\t\t{roomOpen && transcriptRequest && (\n\t\t\t\t\t\t<Button danger onClick={handleDiscard}>\n\t\t\t\t\t\t\t{t('Undo_request')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t{roomOpen && !transcriptRequest && (\n\t\t\t\t\t\t<Button aria-label='request-button' disabled={!canSubmit} loading={isSubmitting} primary type='submit'>\n\t\t\t\t\t\t\t{t('Request')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t{!roomOpen && (\n\t\t\t\t\t\t<Button aria-label='send-button' disabled={!canSubmit} loading={isSubmitting} primary type='submit'>\n\t\t\t\t\t\t\t{t('Send')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t</Modal.FooterControllers>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n};\n\nexport default TranscriptModal;\n",null],"names":["_extends","_objectWithoutProperties","Field","Button","TextInput","Modal","Box","FieldGroup","FieldLabel","FieldRow","useTranslation","React","useCallback","useEffect","useForm","module","link","default","v","FieldError","exportDefault","_ref","_room$v","_errors$email","_errors$email2","_errors$subject","_errors$subject2","_ref$email","email","emailDefault","room","onRequest","onSend","onCancel","onDiscard","props","_excluded","t","_useForm","defaultValues","subject","register","handleSubmit","setValue","setFocus","watch","_useForm$formState","formState","errors","isValid","isSubmitting","transcriptRequest","roomOpen","open","token","handleDiscard","submit","_ref2","canSubmit","Boolean","createElement","wrapperFunction","is","onSubmit","Header","Icon","name","Title","Close","onClick","Content","fontScale","disabled","error","message","flexGrow","required","Footer","FooterControllers","danger","loading","primary","type"],"mappings":"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"}