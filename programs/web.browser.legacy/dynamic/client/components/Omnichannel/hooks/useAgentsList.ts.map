)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/components/Omnichannel/hooks/useAgentsList.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useCallback, useState } from 'react';\n\nimport { useScrollableRecordList } from '../../../hooks/lists/useScrollableRecordList';\nimport { useComponentDidUpdate } from '../../../hooks/useComponentDidUpdate';\nimport { RecordList } from '../../../lib/lists/RecordList';\n\ntype AgentsListOptions = {\n\ttext: string;\n\thaveAll: boolean;\n\thaveNoAgentsSelectedOption: boolean;\n\texcludeId?: string;\n\tshowIdleAgents?: boolean;\n\tonlyAvailable?: boolean;\n};\n\ntype AgentOption = { value: string; label: string; _updatedAt: Date; _id: string };\n\nexport const useAgentsList = (\n\toptions: AgentsListOptions,\n): {\n\titemsList: RecordList<AgentOption>;\n\tinitialItemCount: number;\n\treload: () => void;\n\tloadMoreItems: (start: number, end: number) => void;\n} => {\n\tconst t = useTranslation();\n\tconst [itemsList, setItemsList] = useState(() => new RecordList<AgentOption>());\n\tconst reload = useCallback(() => setItemsList(new RecordList<AgentOption>()), []);\n\n\tconst getAgents = useEndpoint('GET', '/v1/livechat/users/agent');\n\tconst { text, onlyAvailable = false, showIdleAgents = true, excludeId, haveAll, haveNoAgentsSelectedOption } = options;\n\n\tuseComponentDidUpdate(() => {\n\t\toptions && reload();\n\t}, [options, reload]);\n\n\tconst fetchData = useCallback(\n\t\tasync (start, end) => {\n\t\t\tconst { users: agents, total } = await getAgents({\n\t\t\t\t...(text && { text }),\n\t\t\t\t...(excludeId && { excludeId }),\n\t\t\t\tshowIdleAgents,\n\t\t\t\tonlyAvailable,\n\t\t\t\toffset: start,\n\t\t\t\tcount: end + start,\n\t\t\t\tsort: `{ \"name\": 1 }`,\n\t\t\t});\n\n\t\t\tconst items = agents.map<AgentOption>((agent) => {\n\t\t\t\tconst agentOption = {\n\t\t\t\t\t_updatedAt: new Date(agent._updatedAt),\n\t\t\t\t\tlabel: `${agent.name || agent._id} (@${agent.username})`,\n\t\t\t\t\tvalue: agent._id,\n\t\t\t\t\t_id: agent._id,\n\t\t\t\t};\n\t\t\t\treturn agentOption;\n\t\t\t});\n\n\t\t\thaveAll &&\n\t\t\t\titems.unshift({\n\t\t\t\t\tlabel: t('All'),\n\t\t\t\t\tvalue: 'all',\n\t\t\t\t\t_updatedAt: new Date(),\n\t\t\t\t\t_id: 'all',\n\t\t\t\t});\n\n\t\t\thaveNoAgentsSelectedOption &&\n\t\t\t\titems.unshift({\n\t\t\t\t\tlabel: t('Empty_no_agent_selected'),\n\t\t\t\t\tvalue: 'no-agent-selected',\n\t\t\t\t\t_updatedAt: new Date(),\n\t\t\t\t\t_id: 'no-agent-selected',\n\t\t\t\t});\n\n\t\t\treturn {\n\t\t\t\titems,\n\t\t\t\titemCount: total + 1,\n\t\t\t};\n\t\t},\n\t\t[excludeId, getAgents, haveAll, haveNoAgentsSelectedOption, onlyAvailable, showIdleAgents, t, text],\n\t);\n\n\tconst { loadMoreItems, initialItemCount } = useScrollableRecordList(itemsList, fetchData, 25);\n\n\treturn {\n\t\treload,\n\t\titemsList,\n\t\tloadMoreItems,\n\t\tinitialItemCount,\n\t};\n};\n",null],"names":["module","default","v","_regeneratorRuntime","_objectSpread","_slicedToArray","export","useAgentsList","useEndpoint","useTranslation","useCallback","useState","useScrollableRecordList","useComponentDidUpdate","RecordList","options","t","_useState2","itemsList","setItemsList","reload","getAgents","text","_options$onlyAvailabl","onlyAvailable","_options$showIdleAgen","showIdleAgents","excludeId","haveAll","haveNoAgentsSelectedOption","_useScrollableRecordL","start","end","_await$getAgents","agents","total","items","async","_context","prev","next","awrap","offset","count","sort","sent","users","map","agent","_updatedAt","Date","label","name","_id","username","value","unshift","abrupt","itemCount","stop","Promise","loadMoreItems","initialItemCount"],"mappings":"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"}