)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/components/Omnichannel/hooks/useDepartmentsList.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useCallback, useState } from 'react';\n\nimport { useScrollableRecordList } from '../../../hooks/lists/useScrollableRecordList';\nimport { useComponentDidUpdate } from '../../../hooks/useComponentDidUpdate';\nimport { RecordList } from '../../../lib/lists/RecordList';\n\ntype DepartmentsListOptions = {\n\tfilter: string;\n\tdepartmentId?: string;\n\tonlyMyDepartments?: boolean;\n\thaveAll?: boolean;\n\thaveNone?: boolean;\n\texcludeDepartmentId?: string;\n\tenabled?: boolean;\n\tshowArchived?: boolean;\n};\n\ntype DepartmentListItem = {\n\t_id: string;\n\tlabel: string;\n\tvalue: string;\n};\n\nexport const useDepartmentsList = (\n\toptions: DepartmentsListOptions,\n): {\n\titemsList: RecordList<DepartmentListItem>;\n\tinitialItemCount: number;\n\treload: () => void;\n\tloadMoreItems: (start: number, end: number) => void;\n} => {\n\tconst t = useTranslation();\n\tconst [itemsList, setItemsList] = useState(() => new RecordList<DepartmentListItem>());\n\tconst reload = useCallback(() => setItemsList(new RecordList<DepartmentListItem>()), []);\n\n\tconst getDepartments = useEndpoint('GET', '/v1/livechat/department');\n\n\tuseComponentDidUpdate(() => {\n\t\toptions && reload();\n\t}, [options, reload]);\n\n\tconst fetchData = useCallback(\n\t\tasync (start, end) => {\n\t\t\tconst { departments, total } = await getDepartments({\n\t\t\t\tonlyMyDepartments: `${!!options.onlyMyDepartments}`,\n\t\t\t\ttext: options.filter,\n\t\t\t\toffset: start,\n\t\t\t\tcount: end + start,\n\t\t\t\tsort: `{ \"name\": 1 }`,\n\t\t\t\texcludeDepartmentId: options.excludeDepartmentId,\n\t\t\t\tenabled: options.enabled ? 'true' : 'false',\n\t\t\t\tshowArchived: options.showArchived ? 'true' : 'false',\n\t\t\t});\n\n\t\t\tconst items = departments\n\t\t\t\t.filter((department) => {\n\t\t\t\t\tif (options.departmentId && department._id === options.departmentId) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t})\n\t\t\t\t.map(({ _id, name, _updatedAt, ...department }): DepartmentListItem => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t_id,\n\t\t\t\t\t\tlabel: department.archived ? `${name} [${t('Archived')}]` : name,\n\t\t\t\t\t\tvalue: _id,\n\t\t\t\t\t};\n\t\t\t\t});\n\n\t\t\toptions.haveAll &&\n\t\t\t\titems.unshift({\n\t\t\t\t\t_id: '',\n\t\t\t\t\tlabel: t('All'),\n\t\t\t\t\tvalue: 'all',\n\t\t\t\t});\n\n\t\t\toptions.haveNone &&\n\t\t\t\titems.unshift({\n\t\t\t\t\t_id: '',\n\t\t\t\t\tlabel: t('None'),\n\t\t\t\t\tvalue: '',\n\t\t\t\t});\n\n\t\t\treturn {\n\t\t\t\titems,\n\t\t\t\titemCount: options.departmentId ? total - 1 : total,\n\t\t\t};\n\t\t},\n\t\t[\n\t\t\tgetDepartments,\n\t\t\toptions.onlyMyDepartments,\n\t\t\toptions.filter,\n\t\t\toptions.excludeDepartmentId,\n\t\t\toptions.enabled,\n\t\t\toptions.showArchived,\n\t\t\toptions.haveAll,\n\t\t\toptions.haveNone,\n\t\t\toptions.departmentId,\n\t\t\tt,\n\t\t],\n\t);\n\n\tconst { loadMoreItems, initialItemCount } = useScrollableRecordList(itemsList, fetchData, 25);\n\n\treturn {\n\t\treload,\n\t\titemsList,\n\t\tloadMoreItems,\n\t\tinitialItemCount,\n\t};\n};\n",null],"names":["_regeneratorRuntime","_objectWithoutProperties","_slicedToArray","useEndpoint","useTranslation","useCallback","useState","useScrollableRecordList","useComponentDidUpdate","RecordList","module","default","v","export","useDepartmentsList","options","t","_useState2","itemsList","setItemsList","reload","getDepartments","_useScrollableRecordL","start","end","_await$getDepartments","departments","total","items","async","_context","prev","next","awrap","onlyMyDepartments","text","filter","offset","count","sort","excludeDepartmentId","enabled","showArchived","sent","department","departmentId","_id","map","_ref","name","label","_updatedAt","_excluded","archived","value","haveAll","unshift","haveNone","abrupt","itemCount","stop","Promise","loadMoreItems","initialItemCount"],"mappings":"2BAAAA,EAAuEC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,gCAAjDC,EAAAA,IAAAA,CAAc,6BAAQ,CAAAC,QAA2B,SAAAC,CAAA,EAAAZ,EAAAA,CAAA,CAAA,EAAA,GAAAU,EAAAA,IAAAA,CAAAA,iDAAAA,CAAAC,QAAAA,SAAAA,CAAAA,EAAAV,EAAAA,CAAA,CAAA,EAAA,GAAAS,EAAAA,IAAAA,CAAAA,uCAAAA,CAAAC,QAAAA,SAAAA,CAAAA,EAAAT,EAAAA,CAAA,CAAA,EAAA,GAAvEQ,EAAOG,MAAE,CAAA,CAAAC,mBAAa,WAAsB,OAAAA,CAA0B,CAAC,GAAAJ,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAP,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,QAAAA,CAAAL,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,SAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,+CAAAA,CAAAH,wBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,uCAAAA,CAAAF,sBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,gCAAAA,CAAAD,WAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAwBhE,IAAMK,EAAqB,SACjCC,CAA+B,EAO/B,IAAMC,EAAIZ,IAC4Ea,EAAAf,EAApDI,EAAS,WAAA,OAAM,IAAIG,CAAgC,GAAC,GAA/ES,EAASD,CAAA,CAAA,EAAA,CAAEE,EAAYF,CAAA,CAAA,EAAA,CACxBG,EAASf,EAAY,WAAA,OAAMc,EAAa,IAAIV,EAAiC,EAAE,EAAE,EAEjFY,EAAiBlB,EAAY,MAAO,2BAE1CK,EAAsB,WACrBO,GAAWK,GACZ,EAAG,CAACL,EAASK,EAAO,EA+DpB,IAAAE,EAA4Cf,EAAwBW,EA7DlDb,EACjB,SAAOkB,CAAK,CAAEC,CAAG,EAAA,IAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAA5B,EAAA6B,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAAA,OAAAF,EAAAE,IAAA,CAAA,EAAAhC,EAAAiC,KAAA,CACqBZ,EAAe,CACnDa,kBAAiB,GAAK,CAAC,CAACnB,EAAQmB,iBAAmB,CACnDC,KAAMpB,EAAQqB,MAAM,CACpBC,OAAQd,EACRe,MAAOd,EAAMD,EACbgB,KAAI,gBACJC,oBAAqBzB,EAAQyB,mBAAmB,CAChDC,QAAS1B,EAAQ0B,OAAO,CAAG,OAAS,QACpCC,aAAc3B,EAAQ2B,YAAY,CAAG,OAAS,UAC7C,MAAA,EA6BE,OAtCIhB,EAAWD,AASjBA,CAAAA,EAAAK,EAAAa,IAAA,EATMjB,WAAW,CAAEC,EAAKF,EAALE,KAAK,CAWpBC,EAAQF,EACZU,MAAM,CAAC,SAACQ,CAAU,QACd7B,CAAAA,EAAQ8B,YAAY,EAAID,EAAWE,GAAG,GAAK/B,EAAQ8B,YAAY,AAIpE,GACCE,GAAG,CAAC,SAAAC,CAAA,EAAiE,IAA9DF,EAAGE,EAAHF,GAAG,CAAEG,EAAID,EAAJC,IAAI,CAChB,MAAO,CACNH,IAAAA,EACAI,MAAON,CAHoBI,EAAVG,UAAU,CAAelD,EAAA+C,EAAAI,IAGxBC,QAAQ,CAAMJ,EAAI,KAAKjC,EAAE,YAAW,IAAMiC,EAC5DK,MAAOR,EAET,GAED/B,EAAQwC,OAAO,EACd3B,EAAM4B,OAAO,CAAC,CACbV,IAAK,GACLI,MAAOlC,EAAE,OACTsC,MAAO,QAGTvC,EAAQ0C,QAAQ,EACf7B,EAAM4B,OAAO,CAAC,CACbV,IAAK,GACLI,MAAOlC,EAAE,QACTsC,MAAO,KACLxB,EAAA4B,MAAA,CAAA,SAEG,CACN9B,MAAAA,EACA+B,UAAW5C,EAAQ8B,YAAY,CAAGlB,EAAQ,EAAIA,GAC9C,MAAA,EAAA,IAAA,MAAA,OAAAG,EAAA8B,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,EAEF,CACCxC,EACAN,EAAQmB,iBAAiB,CACzBnB,EAAQqB,MAAM,CACdrB,EAAQyB,mBAAmB,CAC3BzB,EAAQ0B,OAAO,CACf1B,EAAQ2B,YAAY,CACpB3B,EAAQwC,OAAO,CACfxC,EAAQ0C,QAAQ,CAChB1C,EAAQ8B,YAAY,CACpB7B,EACA,EAGwF,IAAlF8C,EAAaxC,EAAbwC,aAAa,CAAEC,EAAgBzC,EAAhByC,gBAAgB,CAEvC,MAAO,CACN3C,OAAAA,EACAF,UAAAA,EACA4C,cAAAA,EACAC,iBAAAA,EAEF"}