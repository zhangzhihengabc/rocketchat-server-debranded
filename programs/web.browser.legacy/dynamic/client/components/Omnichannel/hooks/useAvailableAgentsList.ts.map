)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/components/Omnichannel/hooks/useAvailableAgentsList.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { ILivechatAgent } from '@rocket.chat/core-typings';\nimport { useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useCallback, useState } from 'react';\n\nimport { useScrollableRecordList } from '../../../hooks/lists/useScrollableRecordList';\nimport { useComponentDidUpdate } from '../../../hooks/useComponentDidUpdate';\nimport { RecordList } from '../../../lib/lists/RecordList';\n\ntype AgentsListOptions = {\n\ttext: string;\n\tincludeExtension?: string;\n};\n\nexport const useAvailableAgentsList = (\n\toptions: AgentsListOptions,\n): {\n\titemsList: RecordList<ILivechatAgent>;\n\tinitialItemCount: number;\n\treload: () => void;\n\tloadMoreItems: (start: number, end: number) => void;\n} => {\n\tconst [itemsList, setItemsList] = useState(() => new RecordList<ILivechatAgent>());\n\tconst reload = useCallback(() => setItemsList(new RecordList<ILivechatAgent>()), []);\n\n\tconst getAgents = useEndpoint('GET', '/v1/omnichannel/agents/available');\n\n\tuseComponentDidUpdate(() => {\n\t\toptions && reload();\n\t}, [options, reload]);\n\n\tconst fetchData = useCallback(\n\t\tasync (start, end) => {\n\t\t\tconst { agents, total } = await getAgents({\n\t\t\t\t...(options.text && { text: options.text }),\n\t\t\t\t...(options.includeExtension && { includeExtension: options.includeExtension }),\n\t\t\t\toffset: start,\n\t\t\t\tcount: end + start,\n\t\t\t\tsort: `{ \"name\": 1 }`,\n\t\t\t});\n\n\t\t\tconst items = agents.map((agent: any) => {\n\t\t\t\tagent._updatedAt = new Date(agent._updatedAt);\n\t\t\t\tagent.label = agent.username;\n\t\t\t\tagent.value = agent._id;\n\t\t\t\treturn agent;\n\t\t\t});\n\n\t\t\treturn {\n\t\t\t\titems,\n\t\t\t\titemCount: total,\n\t\t\t};\n\t\t},\n\t\t[getAgents, options.includeExtension, options.text],\n\t);\n\n\tconst { loadMoreItems, initialItemCount } = useScrollableRecordList(itemsList, fetchData, 25);\n\n\treturn {\n\t\treload,\n\t\titemsList,\n\t\tloadMoreItems,\n\t\tinitialItemCount,\n\t};\n};\n",null],"names":["module","link","default","_regeneratorRuntime","_objectSpread","_slicedToArray","export","useAvailableAgentsList","useEndpoint","useCallback","useState","useScrollableRecordList","useComponentDidUpdate","RecordList","options","_useState2","itemsList","setItemsList","reload","getAgents","_useScrollableRecordL","start","end","_await$getAgents","agents","total","items","async","_context","prev","next","awrap","text","includeExtension","offset","count","sort","sent","map","agent","_updatedAt","Date","label","username","value","_id","abrupt","itemCount","stop","Promise","loadMoreItems","initialItemCount"],"mappings":"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"}