)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/hooks/useRoomsList.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IRoom } from '@rocket.chat/core-typings';\nimport { useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useCallback, useState } from 'react';\n\nimport { RecordList } from '../lib/lists/RecordList';\nimport { useScrollableRecordList } from './lists/useScrollableRecordList';\nimport { useComponentDidUpdate } from './useComponentDidUpdate';\n\ntype RoomListOptions = {\n\ttext: string;\n};\n\ntype IRoomClient = Pick<IRoom, '_updatedAt' | '_id'> & {\n\tlabel: string;\n\tvalue: string;\n};\n\nexport const useRoomsList = (\n\toptions: RoomListOptions,\n): {\n\titemsList: RecordList<IRoomClient>;\n\tinitialItemCount: number;\n\treload: () => void;\n\tloadMoreItems: (start: number, end: number) => void;\n} => {\n\tconst [itemsList, setItemsList] = useState(() => new RecordList<IRoomClient>());\n\tconst reload = useCallback(() => setItemsList(new RecordList<IRoomClient>()), []);\n\n\tconst getRooms = useEndpoint('GET', '/v1/rooms.autocomplete.channelAndPrivate.withPagination');\n\n\tuseComponentDidUpdate(() => {\n\t\toptions && reload();\n\t}, [options, reload]);\n\n\tconst fetchData = useCallback(\n\t\tasync (start, end) => {\n\t\t\tconst { items: rooms, total } = await getRooms({\n\t\t\t\tselector: JSON.stringify({ name: options.text || '' }),\n\t\t\t\toffset: start,\n\t\t\t\tcount: start + end,\n\t\t\t\tsort: JSON.stringify({ name: 1 }),\n\t\t\t});\n\n\t\t\tconst items = rooms.map((room: any) => ({\n\t\t\t\t_id: room._id,\n\t\t\t\t_updatedAt: new Date(room._updatedAt),\n\t\t\t\tlabel: room.name ?? '',\n\t\t\t\tvalue: room.name ?? '',\n\t\t\t}));\n\n\t\t\treturn {\n\t\t\t\titems,\n\t\t\t\titemCount: total,\n\t\t\t};\n\t\t},\n\t\t[getRooms, options.text],\n\t);\n\n\tconst { loadMoreItems, initialItemCount } = useScrollableRecordList(itemsList, fetchData, 25);\n\n\treturn {\n\t\treload,\n\t\titemsList,\n\t\tloadMoreItems,\n\t\tinitialItemCount,\n\t};\n};\n",null],"names":["module","link","default","_regeneratorRuntime","_slicedToArray","export","useRoomsList","useEndpoint","useCallback","useState","RecordList","useScrollableRecordList","useComponentDidUpdate","options","_useState2","itemsList","setItemsList","reload","getRooms","_useScrollableRecordL","start","end","_await$getRooms","rooms","total","items","async","_context","prev","next","awrap","selector","JSON","stringify","name","text","offset","count","sort","sent","map","room","_room$name","_room$name2","_id","_updatedAt","Date","label","value","abrupt","itemCount","stop","Promise","loadMoreItems","initialItemCount"],"mappings":"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"}