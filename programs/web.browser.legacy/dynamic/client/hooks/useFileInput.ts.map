)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/hooks/useFileInput.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useRef, useEffect } from 'react';\n\nexport const useFileInput = (\n\tonSetFile: (file: FileList[number], formData: FormData) => void,\n\tfileType = 'image/*',\n\tfileField = 'image',\n): [onClick: () => void, reset: () => void] => {\n\tconst ref = useRef<HTMLInputElement>();\n\n\tuseEffect(() => {\n\t\tconst fileInput = document.createElement('input');\n\t\tfileInput.setAttribute('type', 'file');\n\t\tfileInput.setAttribute('style', 'display: none');\n\t\tdocument.body.appendChild(fileInput);\n\t\tref.current = fileInput;\n\n\t\treturn (): void => {\n\t\t\tref.current = undefined;\n\t\t\tfileInput.remove();\n\t\t};\n\t}, []);\n\n\tuseEffect(() => {\n\t\tconst fileInput = ref.current;\n\t\tif (!fileInput) {\n\t\t\treturn;\n\t\t}\n\n\t\tfileInput.setAttribute('accept', fileType);\n\t}, [fileType]);\n\n\tuseEffect(() => {\n\t\tconst fileInput = ref.current;\n\t\tif (!fileInput) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst handleFiles = (): void => {\n\t\t\tif (!fileInput?.files?.length) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst formData = new FormData();\n\t\t\tformData.append(fileField, fileInput.files[0]);\n\t\t\tonSetFile(fileInput.files[0], formData);\n\t\t};\n\n\t\tfileInput.addEventListener('change', handleFiles, false);\n\n\t\treturn (): void => {\n\t\t\tfileInput.removeEventListener('change', handleFiles, false);\n\t\t};\n\t}, [fileField, fileType, onSetFile]);\n\n\tconst onClick = useMutableCallback(() => ref?.current?.click());\n\tconst reset = useMutableCallback(() => {\n\t\tif (ref.current) {\n\t\t\tref.current.value = '';\n\t\t}\n\t});\n\treturn [onClick, reset];\n};\n",null],"names":["module","export","useFileInput","useMutableCallback","useRef","useEffect","onSetFile","fileType","arguments","length","undefined","fileField","ref","fileInput","document","createElement","setAttribute","body","appendChild","current","remove","handleFiles","_fileInput$files","files","formData","FormData","append","addEventListener","removeEventListener","_ref$current","click","value"],"mappings":"uBAAAA,EAAOC,MAAE,CAAA,CAAAC,aAAkB,WAAQ,OAAAA,CAAA,CAAA,GAA8BF,EAAAA,IAAAA,CAAAA,8BAAAA,CAAAG,mBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAH,EAAAA,IAAAA,CAAAA,QAAAA,CAAAI,OAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,UAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAG1D,IAH0DF,EAAAC,EAAAC,EAGpDH,EAAe,SAC3BI,CAA+D,EAGlB,IAF7CC,EAAQC,UAAAC,MAAA,CAAA,GAAAD,AAAAE,KAAAA,IAAAF,SAAA,CAAA,EAAA,CAAAA,SAAA,CAAA,EAAA,CAAG,UACXG,EAASH,UAAAC,MAAA,CAAA,GAAAD,AAAAE,KAAAA,IAAAF,SAAA,CAAA,EAAA,CAAAA,SAAA,CAAA,EAAA,CAAG,QAENI,EAAMR,IAoDZ,OAlDAC,EAAU,WACT,IAAMQ,EAAYC,SAASC,aAAa,CAAC,SAMzC,OALAF,EAAUG,YAAY,CAAC,OAAQ,QAC/BH,EAAUG,YAAY,CAAC,QAAS,iBAChCF,SAASG,IAAI,CAACC,WAAW,CAACL,GAC1BD,EAAIO,OAAO,CAAGN,EAEP,WACND,EAAIO,OAAO,CAAGT,KAAAA,EACdG,EAAUO,MAAM,EACjB,CACD,EAAG,EAAE,EAELf,EAAU,WACT,IAAMQ,EAAYD,EAAIO,OAAO,CACxBN,GAILA,EAAUG,YAAY,CAAC,SAAUT,EAClC,EAAG,CAACA,EAAS,EAEbF,EAAU,WACT,IAAMQ,EAAYD,EAAIO,OAAO,CAC7B,GAAKN,GAIL,IAAMQ,EAAc,WACnB,GAAKR,MAAAA,GAAS,AAAO,OAAPS,CAAAA,EAATT,EAAWU,KAAK,AAALA,GAAKD,AAAA,KAAA,IAAAA,GAAhBA,EAAkBb,MAAM,EAG7B,IAJ8Ba,EAIxBE,EAAW,IAAIC,SACrBD,EAASE,MAAM,CAACf,EAAWE,EAAUU,KAAK,CAAC,EAAE,EAC7CjB,EAAUO,EAAUU,KAAK,CAAC,EAAE,CAAEC,GAC/B,EAIA,OAFAX,EAAUc,gBAAgB,CAAC,SAAUN,EAAa,CAAA,GAE3C,WACNR,EAAUe,mBAAmB,CAAC,SAAUP,EAAa,CAAA,EACtD,EACD,EAAG,CAACV,EAAWJ,EAAUD,EAAU,EAQ5B,CANSH,EAAmB,WAAA,IAAA0B,EAAA,OAAMjB,MAAAA,EAAG,KAAA,EAAA,AAAS,OAATiB,CAAAA,EAAHjB,EAAKO,OAAO,AAAPA,GAAOU,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAZA,EAAcC,KAAK,EAAE,GAChD3B,EAAmB,WAC5BS,EAAIO,OAAO,EACdP,CAAAA,EAAIO,OAAO,CAACY,KAAK,CAAG,EAAA,CAEtB,GACuB,AACxB"}