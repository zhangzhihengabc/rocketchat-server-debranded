)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/hooks/roomActions/useWebRTCVideoRoomAction.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { isRoomFederated } from '@rocket.chat/core-typings';\nimport { useSetting } from '@rocket.chat/ui-contexts';\nimport { useCallback, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport { sdk } from '../../../app/utils/client/lib/SDKClient';\nimport { useRoom } from '../../views/room/contexts/RoomContext';\nimport type { RoomToolboxActionConfig } from '../../views/room/contexts/RoomToolboxContext';\n\nexport const useWebRTCVideoRoomAction = () => {\n\tconst enabled = useSetting('WebRTC_Enabled', false);\n\tconst room = useRoom();\n\tconst federated = isRoomFederated(room);\n\tconst callProvider = useSetting<string>('Omnichannel_call_provider', 'default-provider');\n\n\tconst allowed = enabled && callProvider === 'WebRTC' && room.servedBy;\n\n\tconst { t } = useTranslation();\n\n\tconst handleClick = useCallback(async () => {\n\t\tif (!room.callStatus || room.callStatus === 'declined' || room.callStatus === 'ended') {\n\t\t\tawait sdk.rest.get('/v1/livechat/webrtc.call', { rid: room._id });\n\t\t}\n\t\twindow.open(`/meet/${room._id}`, room._id);\n\t}, [room._id, room.callStatus]);\n\n\treturn useMemo((): RoomToolboxActionConfig | undefined => {\n\t\tif (!allowed) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn {\n\t\t\tid: 'webRTCVideo',\n\t\t\tgroups: ['live'],\n\t\t\ttitle: 'WebRTC_Call',\n\t\t\ticon: 'phone',\n\t\t\t...(federated && {\n\t\t\t\ttooltip: t('core.Call_unavailable_for_federation'),\n\t\t\t\tdisabled: true,\n\t\t\t}),\n\t\t\taction: () => void handleClick(),\n\t\t\tfull: true,\n\t\t\torder: 4,\n\t\t};\n\t}, [allowed, federated, handleClick, t]);\n};\n",null],"names":["module","link","default","_objectSpread","_regeneratorRuntime","export","useWebRTCVideoRoomAction","isRoomFederated","useSetting","useCallback","useMemo","useTranslation","sdk","useRoom","enabled","room","federated","callProvider","allowed","servedBy","t","_useTranslation","handleClick","async","_context","prev","next","callStatus","awrap","rest","get","rid","_id","window","open","stop","Promise","id","groups","title","icon","tooltip","disabled","action","full","order"],"mappings":"uBAASA,EAAeC,IAAE,CAAA,uCAAkC,CAAAC,QAAAA,SAAAA,CAAAA,EAAAC,EAAAA,CAAA,CAAA,EAAA,GAAAH,EAAAA,IAAAA,CAAAA,6BAAAA,CAAAE,QAAAA,SAAAA,CAAAA,EAAAE,EAAAA,CAAA,CAAA,EAAA,GAA5DJ,EAAOK,MAAE,CAAA,CAAAC,yBAAuB,WAAA,OAAAA,CAA4B,CAAA,GAAAN,EAAAA,IAAAA,CAAAA,4BAAAA,CAAAO,gBAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAP,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAQ,WAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAR,EAAAA,IAAAA,CAAAA,QAAAA,CAAAS,YAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,QAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAV,EAAAA,IAAAA,CAAAA,gBAAAA,CAAAW,eAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAX,EAAAA,IAAAA,CAAAA,0CAAAA,CAAAY,IAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAZ,EAAAA,IAAAA,CAAAA,wCAAAA,CAAAa,QAAAA,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GASrD,IATPV,EAA4DC,EAAAG,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAS/CP,EAA2B,WACvC,IAAMQ,EAAUN,EAAW,iBAAkB,CAAA,GACvCO,EAAOF,IACPG,EAAYT,EAAgBQ,GAC5BE,EAAeT,EAAmB,4BAA6B,oBAE/DU,EAAUJ,GAAWG,AAAiB,WAAjBA,GAA6BF,EAAKI,QAAQ,CAE7DC,EAACC,AAAKV,IAANS,CAAC,CAEHE,EAAcb,EAAY,WAAA,OAAAL,EAAAmB,KAAA,CAAA,SAAAC,CAAA,EAAA,OAAA,OAAAA,EAAAC,IAAA,CAAAD,EAAAE,IAAA,EAAA,KAAA,EAAA,GAAA,CAC3B,CAAA,CAACX,EAAKY,UAAU,EAAIZ,AAAoB,aAApBA,EAAKY,UAAU,EAAmBZ,AAAoB,UAApBA,EAAKY,UAAU,AAAK,EAAO,CAAAH,EAAAE,IAAA,CAAA,EAAA,KAAA,CAAA,OAAAF,EAAAE,IAAA,CAAA,EAAAtB,EAAAwB,KAAA,CAC9EhB,EAAIiB,IAAI,CAACC,GAAG,CAAC,2BAA4B,CAAEC,IAAKhB,EAAKiB,GAAAA,AAAG,GAAG,MAAA,EAElEC,OAAOC,IAAI,CAAA,SAAUnB,EAAKiB,GAAG,CAAIjB,EAAKiB,GAAG,CAAE,MAAA,EAAA,IAAA,MAAA,OAAAR,EAAAW,IAAA,EAAA,CAAA,EAAA,KAAA,KAAA,KAAAC,QAAA,EACzC,CAACrB,EAAKiB,GAAG,CAAEjB,EAAKY,UAAU,CAAC,EAE9B,OAAOjB,EAAQ,WACd,GAAKQ,EAIL,OAAAf,EAAAA,EAAA,CACCkC,GAAI,cACJC,OAAQ,CAAC,OAAO,CAChBC,MAAO,cACPC,KAAM,OAAO,EACTxB,GAAa,CAChByB,QAASrB,EAAE,wCACXsB,SAAU,CAAA,IACV,CAAA,EAAA,CACDC,OAAQ,WAAWrB,GAAa,EAChCsB,KAAM,CAAA,EACNC,MAAO,CAAC,EAEV,EAAG,CAAC3B,EAASF,EAAWM,EAAaF,EAAE,CACxC"}