)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/hooks/useAnalyticsEventTracking.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useRouter, useSetting, useUserId } from '@rocket.chat/ui-contexts';\nimport { useEffect } from 'react';\n\nimport { callbacks } from '../../lib/callbacks';\n\nfunction trackEvent(category: string, action: string, label?: unknown) {\n\tconst { _paq, ga } = window;\n\n\t_paq?.push(['trackEvent', category, action, label]);\n\tga?.('send', 'event', category, action, label);\n}\n\nexport const useAnalyticsEventTracking = () => {\n\tconst router = useRouter();\n\n\tuseEffect(\n\t\t() =>\n\t\t\trouter.subscribeToRouteChange(() => {\n\t\t\t\tconst { _paq, ga } = window;\n\n\t\t\t\tif (_paq) {\n\t\t\t\t\tconst http = location.protocol;\n\t\t\t\t\tconst slashes = http.concat('//');\n\t\t\t\t\tconst host = slashes.concat(location.hostname);\n\t\t\t\t\t_paq.push(['setCustomUrl', host + router.getLocationPathname()]);\n\t\t\t\t\t_paq.push(['trackPageView']);\n\t\t\t\t}\n\n\t\t\t\tga?.('send', 'pageview', router.getLocationPathname());\n\t\t\t}),\n\t\t[router],\n\t);\n\n\tuseEffect(() => {\n\t\tcallbacks.add(\n\t\t\t'loginPageStateChange',\n\t\t\t(state) => {\n\t\t\t\ttrackEvent('Navigation', 'Login Page State Change', state);\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'analytics-login-state-change',\n\t\t);\n\n\t\treturn () => {\n\t\t\tcallbacks.remove('loginPageStateChange', 'analytics-login-state-change');\n\t\t};\n\t}, []);\n\n\tconst featuresMessages = useSetting('Analytics_features_messages', true);\n\n\tuseEffect(() => {\n\t\tif (!featuresMessages) {\n\t\t\treturn;\n\t\t}\n\n\t\tcallbacks.add(\n\t\t\t'afterSaveMessage',\n\t\t\t(_message, room, _uid) => {\n\t\t\t\ttrackEvent('Message', 'Send', `${room.name} (${room._id})`);\n\t\t\t},\n\t\t\tcallbacks.priority.LOW,\n\t\t\t'trackEvents',\n\t\t);\n\n\t\treturn () => {\n\t\t\tcallbacks.remove('afterSaveMessage', 'trackEvents');\n\t\t};\n\t}, [featuresMessages]);\n\n\tconst featuresRooms = useSetting('Analytics_features_rooms', true);\n\n\tuseEffect(() => {\n\t\tif (!featuresRooms) {\n\t\t\treturn;\n\t\t}\n\n\t\tcallbacks.add(\n\t\t\t'afterCreateChannel',\n\t\t\t(_owner, room) => {\n\t\t\t\ttrackEvent('Room', 'Create', `${room.name} (${room._id})`);\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'analytics-after-create-channel',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'roomNameChanged',\n\t\t\t(room) => {\n\t\t\t\ttrackEvent('Room', 'Changed Name', `${room.name} (${room._id})`);\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'analytics-room-name-changed',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'roomTopicChanged',\n\t\t\t(room) => {\n\t\t\t\ttrackEvent('Room', 'Changed Topic', `${room.name} (${room._id})`);\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'analytics-room-topic-changed',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'roomAnnouncementChanged',\n\t\t\t(room) => {\n\t\t\t\ttrackEvent('Room', 'Changed Announcement', `${room.name} (${room._id})`);\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'analytics-room-announcement-changed',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'roomTypeChanged',\n\t\t\t(room) => {\n\t\t\t\ttrackEvent('Room', 'Changed Room Type', `${room.name} (${room._id})`);\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'analytics-room-type-changed',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'archiveRoom',\n\t\t\t(room) => {\n\t\t\t\ttrackEvent('Room', 'Archived', `${room.name} (${room._id})`);\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'analytics-archive-room',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'unarchiveRoom',\n\t\t\t(room) => {\n\t\t\t\ttrackEvent('Room', 'Unarchived', `${room.name} (${room._id})`);\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'analytics-unarchive-room',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'roomAvatarChanged',\n\t\t\t(room) => {\n\t\t\t\ttrackEvent('Room', 'Changed Avatar', `${room.name} (${room._id})`);\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'analytics-room-avatar-changed',\n\t\t);\n\n\t\treturn () => {\n\t\t\tcallbacks.remove('afterCreateChannel', 'analytics-after-create-channel');\n\t\t\tcallbacks.remove('roomNameChanged', 'analytics-room-name-changed');\n\t\t\tcallbacks.remove('roomTopicChanged', 'analytics-room-topic-changed');\n\t\t\tcallbacks.remove('roomAnnouncementChanged', 'analytics-room-announcement-changed');\n\t\t\tcallbacks.remove('roomTypeChanged', 'analytics-room-type-changed');\n\t\t\tcallbacks.remove('archiveRoom', 'analytics-archive-room');\n\t\t\tcallbacks.remove('unarchiveRoom', 'analytics-unarchive-room');\n\t\t\tcallbacks.remove('roomAvatarChanged', 'analytics-room-avatar-changed');\n\t\t};\n\t}, [featuresRooms]);\n\n\tconst featuresUsers = useSetting('Analytics_features_users', true);\n\n\tuseEffect(() => {\n\t\tif (!featuresUsers) {\n\t\t\treturn;\n\t\t}\n\n\t\tcallbacks.add(\n\t\t\t'userRegistered',\n\t\t\t() => {\n\t\t\t\ttrackEvent('User', 'Registered');\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'piwik-user-resitered',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'usernameSet',\n\t\t\t() => {\n\t\t\t\ttrackEvent('User', 'Username Set');\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'piweik-username-set',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'userPasswordReset',\n\t\t\t() => {\n\t\t\t\ttrackEvent('User', 'Reset Password');\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'piwik-user-password-reset',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'userConfirmationEmailRequested',\n\t\t\t() => {\n\t\t\t\ttrackEvent('User', 'Confirmation Email Requested');\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'piwik-user-confirmation-email-requested',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'userForgotPasswordEmailRequested',\n\t\t\t() => {\n\t\t\t\ttrackEvent('User', 'Forgot Password Email Requested');\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'piwik-user-forgot-password-email-requested',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'userStatusManuallySet',\n\t\t\t(status) => {\n\t\t\t\ttrackEvent('User', 'Status Manually Changed', status);\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'analytics-user-status-manually-set',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'userAvatarSet',\n\t\t\t(service) => {\n\t\t\t\ttrackEvent('User', 'Avatar Changed', service);\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'analytics-user-avatar-set',\n\t\t);\n\n\t\treturn () => {\n\t\t\tcallbacks.remove('userRegistered', 'piwik-user-resitered');\n\t\t\tcallbacks.remove('usernameSet', 'piweik-username-set');\n\t\t\tcallbacks.remove('userPasswordReset', 'piwik-user-password-reset');\n\t\t\tcallbacks.remove('userConfirmationEmailRequested', 'piwik-user-confirmation-email-requested');\n\t\t\tcallbacks.remove('userForgotPasswordEmailRequested', 'piwik-user-forgot-password-email-requested');\n\t\t\tcallbacks.remove('userStatusManuallySet', 'analytics-user-status-manually-set');\n\t\t\tcallbacks.remove('userAvatarSet', 'analytics-user-avatar-set');\n\t\t};\n\t}, [featuresUsers]);\n\n\tconst uid = useUserId();\n\n\tuseEffect(() => {\n\t\tif (!featuresUsers) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { _paq } = window;\n\n\t\ttrackEvent('User', 'Login', uid);\n\t\t_paq?.push(['setUserId', uid]);\n\n\t\treturn () => {\n\t\t\ttrackEvent('User', 'Logout', uid);\n\t\t};\n\t}, [featuresUsers, uid]);\n};\n",null],"names":["trackEvent","category","action","label","_window","window","_paq","ga","push","module","export","useAnalyticsEventTracking","useRouter","useSetting","useUserId","useEffect","callbacks","router","subscribeToRouteChange","_window2","host","slashes","http","location","protocol","concat","hostname","getLocationPathname","add","state","priority","MEDIUM","remove","featuresMessages","_message","room","_uid","name","_id","LOW","featuresRooms","_owner","featuresUsers","status","service","uid","_window3"],"mappings":"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"}