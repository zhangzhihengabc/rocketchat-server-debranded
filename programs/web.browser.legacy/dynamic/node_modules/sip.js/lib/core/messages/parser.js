function module(e,r,a){var t,s,n,o;a.export({Parser:function(){return o}}),a.link("../../grammar",{Grammar:function(e){t=e}},0),a.link("./incoming-request-message",{IncomingRequestMessage:function(e){s=e}},1),a.link("./incoming-response-message",{IncomingResponseMessage:function(e){n=e}},2),function(e){function r(e,r){let a=r,t=0,s=0;if(e.substring(a,a+2).match(/(^\r\n)/))return -2;for(;0===t;){if(-1===(s=e.indexOf("\r\n",a)))return s;!e.substring(s+2,s+4).match(/(^\r\n)/)&&e.charAt(s+2).match(/(^\s+)/)?a=s+2:t=s}return t}function a(e,r,a,s){let o;let c=r.indexOf(":",a),d=r.substring(a,c).trim(),i=r.substring(c+1,s).trim();switch(d.toLowerCase()){case"via":case"v":e.addHeader("via",i),1===e.getHeaders("via").length?(o=e.parseHeader("Via"))&&(e.via=o,e.viaBranch=o.branch):o=0;break;case"from":case"f":e.setHeader("from",i),(o=e.parseHeader("from"))&&(e.from=o,e.fromTag=o.getParam("tag"));break;case"to":case"t":e.setHeader("to",i),(o=e.parseHeader("to"))&&(e.to=o,e.toTag=o.getParam("tag"));break;case"record-route":if(-1===(o=t.parse(i,"Record_Route"))||!(o instanceof Array)){o=void 0;break}o.forEach(r=>{e.addHeader("record-route",i.substring(r.position,r.offset)),e.headers["Record-Route"][e.getHeaders("record-route").length-1].parsed=r.parsed});break;case"call-id":case"i":e.setHeader("call-id",i),(o=e.parseHeader("call-id"))&&(e.callId=i);break;case"contact":case"m":if(-1===(o=t.parse(i,"Contact"))||!(o instanceof Array)){o=void 0;break}o.forEach(r=>{e.addHeader("contact",i.substring(r.position,r.offset)),e.headers.Contact[e.getHeaders("contact").length-1].parsed=r.parsed});break;case"content-length":case"l":e.setHeader("content-length",i),o=e.parseHeader("content-length");break;case"content-type":case"c":e.setHeader("content-type",i),o=e.parseHeader("content-type");break;case"cseq":e.setHeader("cseq",i),(o=e.parseHeader("cseq"))&&(e.cseq=o.value),e instanceof n&&(e.method=o.method);break;case"max-forwards":e.setHeader("max-forwards",i),o=e.parseHeader("max-forwards");break;case"www-authenticate":e.setHeader("www-authenticate",i),o=e.parseHeader("www-authenticate");break;case"proxy-authenticate":e.setHeader("proxy-authenticate",i),o=e.parseHeader("proxy-authenticate");break;case"refer-to":case"r":e.setHeader("refer-to",i),(o=e.parseHeader("refer-to"))&&(e.referTo=o);break;default:e.addHeader(d.toLowerCase(),i),o=0}return void 0!==o||{error:"error parsing header '"+d+"'"}}e.getHeader=r,e.parseHeader=a,e.parseMessage=function(e,o){let c,d,i=0,u=e.indexOf("\r\n");if(-1===u){o.warn("no CRLF found, not a SIP message, discarded");return}let f=e.substring(0,u),g=t.parse(f,"Request_Response");if(-1===g){o.warn('error parsing first line of SIP message: "'+f+'"');return}for(g.status_code?((c=new n).statusCode=g.status_code,c.reasonPhrase=g.reason_phrase):((c=new s).method=g.method,c.ruri=g.uri),c.data=e,i=u+2;;){if(-2===(u=r(e,i))){d=i+2;break}if(-1===u){o.error("malformed message");return}let t=a(c,e,i,u);if(t&&!0!==t){o.error(t.error);return}i=u+2}return c.hasHeader("content-length")?c.body=e.substr(d,Number(c.getHeader("content-length"))):c.body=e.substring(d),c}}(o||a.runSetters(o={},["Parser"]))}
//# sourceMappingURL=/dynamic/node_modules/sip.js/lib/core/messages/76afd3f63a31f5f8c6cf4674318a3c55b20eb080.map
