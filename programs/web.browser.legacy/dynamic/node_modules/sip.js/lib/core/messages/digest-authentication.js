function module(t,i,e){var s,h;function n(t){return s.hashStr(t)}e.export({DigestAuthentication:function(){return o}}),e.link("./md5",{Md5:function(t){s=t}},0),e.link("./utils",{createRandomToken:function(t){h=t}},1);class o{constructor(t,i,e,s){this.logger=t.getLogger("sipjs.digestauthentication"),this.username=e,this.password=s,this.ha1=i,this.nc=0,this.ncHex="00000000"}authenticate(t,i,e){if(this.algorithm=i.algorithm,this.realm=i.realm,this.nonce=i.nonce,this.opaque=i.opaque,this.stale=i.stale,this.algorithm){if("MD5"!==this.algorithm)return this.logger.warn("challenge with Digest algorithm different than 'MD5', authentication aborted"),!1}else this.algorithm="MD5";if(!this.realm)return this.logger.warn("challenge without Digest realm, authentication aborted"),!1;if(!this.nonce)return this.logger.warn("challenge without Digest nonce, authentication aborted"),!1;if(i.qop){if(i.qop.indexOf("auth")>-1)this.qop="auth";else{if(!(i.qop.indexOf("auth-int")>-1))return this.logger.warn("challenge without Digest qop different than 'auth' or 'auth-int', authentication aborted"),!1;this.qop="auth-int"}}else this.qop=void 0;return this.method=t.method,this.uri=t.ruri,this.cnonce=h(12),this.nc+=1,this.updateNcHex(),4294967296===this.nc&&(this.nc=1,this.ncHex="00000001"),this.calculateResponse(e),!0}toString(){let t=[];if(!this.response)throw Error("response field does not exist, cannot generate Authorization header");return t.push("algorithm="+this.algorithm),t.push('username="'+this.username+'"'),t.push('realm="'+this.realm+'"'),t.push('nonce="'+this.nonce+'"'),t.push('uri="'+this.uri+'"'),t.push('response="'+this.response+'"'),this.opaque&&t.push('opaque="'+this.opaque+'"'),this.qop&&(t.push("qop="+this.qop),t.push('cnonce="'+this.cnonce+'"'),t.push("nc="+this.ncHex)),"Digest "+t.join(", ")}updateNcHex(){let t=Number(this.nc).toString(16);this.ncHex="00000000".substr(0,8-t.length)+t}calculateResponse(t){let i,e;(""===(i=this.ha1)||void 0===i)&&(i=n(this.username+":"+this.realm+":"+this.password)),"auth"===this.qop?(e=n(this.method+":"+this.uri),this.response=n(i+":"+this.nonce+":"+this.ncHex+":"+this.cnonce+":auth:"+e)):"auth-int"===this.qop?(e=n(this.method+":"+this.uri+":"+n(t||"")),this.response=n(i+":"+this.nonce+":"+this.ncHex+":"+this.cnonce+":auth-int:"+e)):void 0===this.qop&&(e=n(this.method+":"+this.uri),this.response=n(i+":"+this.nonce+":"+e))}}}
//# sourceMappingURL=/dynamic/node_modules/sip.js/lib/core/messages/03124338b0449edce6993daa4ffb2c71b2318234.map
