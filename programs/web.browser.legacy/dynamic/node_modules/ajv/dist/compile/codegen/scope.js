function module(e,t){"use strict";var s,r;Object.defineProperty(t,"__esModule",{value:!0}),t.ValueScope=t.ValueScopeName=t.Scope=t.varKinds=t.UsedValueState=void 0;let a=e("./code");class n extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}}(r=s=t.UsedValueState||(t.UsedValueState={}))[r.Started=0]="Started",r[r.Completed=1]="Completed",t.varKinds={const:new a.Name("const"),let:new a.Name("let"),var:new a.Name("var")};class o{constructor({prefixes:e,parent:t}={}){this._names={},this._prefixes=e,this._parent=t}toName(e){return e instanceof a.Name?e:this.name(e)}name(e){return new a.Name(this._newName(e))}_newName(e){let t=this._names[e]||this._nameGroup(e);return`${e}${t.index++}`}_nameGroup(e){var t,s;if((null===(s=null===(t=this._parent)||void 0===t?void 0:t._prefixes)||void 0===s?void 0:s.has(e))||this._prefixes&&!this._prefixes.has(e))throw Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}}t.Scope=o;class i extends a.Name{constructor(e,t){super(t),this.prefix=e}setValue(e,{property:t,itemIndex:s}){this.value=e,this.scopePath=(0,a._)`.${new a.Name(t)}[${s}]`}}t.ValueScopeName=i;let l=(0,a._)`\n`;t.ValueScope=class e extends o{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?l:a.nil}}get(){return this._scope}name(e){return new i(e,this._newName(e))}value(e,t){var s;if(void 0===t.ref)throw Error("CodeGen: ref must be passed in value");let r=this.toName(e),{prefix:a}=r,n=null!==(s=t.key)&&void 0!==s?s:t.ref,o=this._values[a];if(o){let e=o.get(n);if(e)return e}else o=this._values[a]=new Map;o.set(n,r);let i=this._scope[a]||(this._scope[a]=[]),l=i.length;return i[l]=t.ref,r.setValue(t,{property:a,itemIndex:l}),r}getValue(e,t){let s=this._values[e];if(s)return s.get(t)}scopeRefs(e,t=this._values){return this._reduceValues(t,t=>{if(void 0===t.scopePath)throw Error(`CodeGen: name "${t}" has no value`);return(0,a._)`${e}${t.scopePath}`})}scopeCode(e=this._values,t,s){return this._reduceValues(e,e=>{if(void 0===e.value)throw Error(`CodeGen: name "${e}" has no value`);return e.value.code},t,s)}_reduceValues(e,r,o={},i){let l=a.nil;for(let u in e){let h=e[u];if(!h)continue;let d=o[u]=o[u]||new Map;h.forEach(e=>{if(d.has(e))return;d.set(e,s.Started);let o=r(e);if(o){let s=this.opts.es5?t.varKinds.var:t.varKinds.const;l=(0,a._)`${l}${s} ${e} = ${o};${this.opts._n}`}else if(o=null==i?void 0:i(e))l=(0,a._)`${l}${o}${this.opts._n}`;else throw new n(e);d.set(e,s.Completed)})}return l}}}
//# sourceMappingURL=/dynamic/node_modules/ajv/dist/compile/codegen/15b98962921b367d8d67033c89314899631363eb.map
