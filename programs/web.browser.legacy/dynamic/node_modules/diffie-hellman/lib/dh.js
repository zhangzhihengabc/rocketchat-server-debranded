function module(e,t,r){var i=e("bn.js"),n=new(e("miller-rabin")),o=new i(24),s=new i(11),u=new i(10),f=new i(3),p=new i(7),h=e("./generatePrime"),_=e("randombytes");function m(e,t){return t=t||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,t)),this._pub=new i(e),this}function c(e,t){return t=t||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,t)),this._priv=new i(e),this}r.exports=g;var a={};function g(e,t,r){this.setGenerator(t),this.__prime=new i(e),this._prime=i.mont(this.__prime),this._primeLen=e.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,r?(this.setPublicKey=m,this.setPrivateKey=c):this._primeCode=8}function v(e,t){var r=new Buffer(e.toArray());return t?r.toString(t):r}Object.defineProperty(g.prototype,"verifyError",{enumerable:!0,get:function(){return"number"!=typeof this._primeCode&&(this._primeCode=function(e,t){var r,i=t.toString("hex"),_=[i,e.toString(16)].join("_");if(_ in a)return a[_];var m=0;if(e.isEven()||!h.simpleSieve||!h.fermatTest(e)||!n.test(e))return m+=1,"02"===i||"05"===i?m+=8:m+=4,a[_]=m,m;switch(n.test(e.shrn(1))||(m+=2),i){case"02":e.mod(o).cmp(s)&&(m+=8);break;case"05":(r=e.mod(u)).cmp(f)&&r.cmp(p)&&(m+=8);break;default:m+=4}return a[_]=m,m}(this.__prime,this.__gen)),this._primeCode}}),g.prototype.generateKeys=function(){return this._priv||(this._priv=new i(_(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},g.prototype.computeSecret=function(e){var t=(e=(e=new i(e)).toRed(this._prime)).redPow(this._priv).fromRed(),r=new Buffer(t.toArray()),n=this.getPrime();if(r.length<n.length){var o=new Buffer(n.length-r.length);o.fill(0),r=Buffer.concat([o,r])}return r},g.prototype.getPublicKey=function e(e){return v(this._pub,e)},g.prototype.getPrivateKey=function e(e){return v(this._priv,e)},g.prototype.getPrime=function(e){return v(this.__prime,e)},g.prototype.getGenerator=function(e){return v(this._gen,e)},g.prototype.setGenerator=function(e,t){return t=t||"utf8",Buffer.isBuffer(e)||(e=new Buffer(e,t)),this.__gen=e,this._gen=new i(e),this}}
//# sourceMappingURL=/dynamic/node_modules/diffie-hellman/lib/5efc66b3932b7359ec617132e68e83b64e020fff.map
