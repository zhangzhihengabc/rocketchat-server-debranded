function module(t,i,e){"use strict";var r=t("bn.js"),n=t("../utils").assert;function u(t,i){this.ec=t,this.priv=null,this.pub=null,i.priv&&this._importPrivate(i.priv,i.privEnc),i.pub&&this._importPublic(i.pub,i.pubEnc)}e.exports=u,u.fromPublic=function t(t,i,e){return i instanceof u?i:new u(t,{pub:i,pubEnc:e})},u.fromPrivate=function t(t,i,e){return i instanceof u?i:new u(t,{priv:i,privEnc:e})},u.prototype.validate=function t(){var t=this.getPublic();return t.isInfinity()?{result:!1,reason:"Invalid public key"}:t.validate()?t.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},u.prototype.getPublic=function t(t,i){return("string"==typeof t&&(i=t,t=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),i)?this.pub.encode(i,t):this.pub},u.prototype.getPrivate=function t(t){return"hex"===t?this.priv.toString(16,2):this.priv},u.prototype._importPrivate=function t(t,i){this.priv=new r(t,i||16),this.priv=this.priv.umod(this.ec.curve.n)},u.prototype._importPublic=function t(t,i){if(t.x||t.y){"mont"===this.ec.curve.type?n(t.x,"Need x coordinate"):("short"===this.ec.curve.type||"edwards"===this.ec.curve.type)&&n(t.x&&t.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(t.x,t.y);return}this.pub=this.ec.curve.decodePoint(t,i)},u.prototype.derive=function t(t){return t.validate()||n(t.validate(),"public point not validated"),t.mul(this.priv).getX()},u.prototype.sign=function t(t,i,e){return this.ec.sign(t,this,i,e)},u.prototype.verify=function t(t,i){return this.ec.verify(t,i,this)},u.prototype.inspect=function t(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}}
//# sourceMappingURL=/dynamic/node_modules/elliptic/lib/elliptic/ec/95a2129972ab9155a71a4c604e15438a1d2da925.map
