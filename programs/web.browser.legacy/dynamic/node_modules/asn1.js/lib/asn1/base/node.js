function module(e,t,n){"use strict";let i=e("../base/reporter").Reporter,r=e("../base/buffer").EncoderBuffer,o=e("../base/buffer").DecoderBuffer,l=e("minimalistic-assert"),s=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],c=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(s);function u(e,t,n){let i={};this._baseState=i,i.name=n,i.enc=e,i.parent=t||null,i.children=null,i.tag=null,i.args=null,i.reverseArgs=null,i.choice=null,i.optional=!1,i.any=!1,i.obj=!1,i.use=null,i.useDecoder=null,i.key=null,i.default=null,i.explicit=null,i.implicit=null,i.contains=null,i.parent||(i.children=[],this._wrap())}n.exports=u;let a=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];u.prototype.clone=function e(){let e=this._baseState,t={};a.forEach(function(n){t[n]=e[n]});let n=new this.constructor(t.parent);return n._baseState=t,n},u.prototype._wrap=function e(){let e=this._baseState;c.forEach(function(t){this[t]=function n(){let n=new this.constructor(this);return e.children.push(n),n[t].apply(n,arguments)}},this)},u.prototype._init=function e(e){let t=this._baseState;l(null===t.parent),e.call(this),t.children=t.children.filter(function(e){return e._baseState.parent===this},this),l.equal(t.children.length,1,"Root node can have only one child")},u.prototype._useArgs=function e(e){let t=this._baseState,n=e.filter(function(e){return e instanceof this.constructor},this);e=e.filter(function(e){return!(e instanceof this.constructor)},this),0!==n.length&&(l(null===t.children),t.children=n,n.forEach(function(e){e._baseState.parent=this},this)),0!==e.length&&(l(null===t.args),t.args=e,t.reverseArgs=e.map(function(e){if("object"!=typeof e||e.constructor!==Object)return e;let t={};return Object.keys(e).forEach(function(n){n==(0|n)&&(n|=0);let i=e[n];t[i]=n}),t}))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach(function(e){u.prototype[e]=function t(){let t=this._baseState;throw Error(e+" not implemented for encoding: "+t.enc)}}),s.forEach(function(e){u.prototype[e]=function t(){let t=this._baseState,n=Array.prototype.slice.call(arguments);return l(null===t.tag),t.tag=e,this._useArgs(n),this}}),u.prototype.use=function e(e){l(e);let t=this._baseState;return l(null===t.use),t.use=e,this},u.prototype.optional=function e(){let e=this._baseState;return e.optional=!0,this},u.prototype.def=function e(e){let t=this._baseState;return l(null===t.default),t.default=e,t.optional=!0,this},u.prototype.explicit=function e(e){let t=this._baseState;return l(null===t.explicit&&null===t.implicit),t.explicit=e,this},u.prototype.implicit=function e(e){let t=this._baseState;return l(null===t.explicit&&null===t.implicit),t.implicit=e,this},u.prototype.obj=function e(){let e=this._baseState,t=Array.prototype.slice.call(arguments);return e.obj=!0,0!==t.length&&this._useArgs(t),this},u.prototype.key=function e(e){let t=this._baseState;return l(null===t.key),t.key=e,this},u.prototype.any=function e(){let e=this._baseState;return e.any=!0,this},u.prototype.choice=function e(e){let t=this._baseState;return l(null===t.choice),t.choice=e,this._useArgs(Object.keys(e).map(function(t){return e[t]})),this},u.prototype.contains=function e(e){let t=this._baseState;return l(null===t.use),t.contains=e,this},u.prototype._decode=function e(e,t){let n;let i=this._baseState;if(null===i.parent)return e.wrapResult(i.children[0]._decode(e,t));let r=i.default,l=!0,s=null;if(null!==i.key&&(s=e.enterKey(i.key)),i.optional){let n=null;if(null!==i.explicit?n=i.explicit:null!==i.implicit?n=i.implicit:null!==i.tag&&(n=i.tag),null!==n||i.any){if(l=this._peekTag(e,n,i.any),e.isError(l))return l}else{let n=e.save();try{null===i.choice?this._decodeGeneric(i.tag,e,t):this._decodeChoice(e,t),l=!0}catch(e){l=!1}e.restore(n)}}if(i.obj&&l&&(n=e.enterObject()),l){if(null!==i.explicit){let t=this._decodeTag(e,i.explicit);if(e.isError(t))return t;e=t}let n=e.offset;if(null===i.use&&null===i.choice){let t;i.any&&(t=e.save());let n=this._decodeTag(e,null!==i.implicit?i.implicit:i.tag,i.any);if(e.isError(n))return n;i.any?r=e.raw(t):e=n}if(t&&t.track&&null!==i.tag&&t.track(e.path(),n,e.length,"tagged"),t&&t.track&&null!==i.tag&&t.track(e.path(),e.offset,e.length,"content"),i.any||(r=null===i.choice?this._decodeGeneric(i.tag,e,t):this._decodeChoice(e,t)),e.isError(r))return r;if(i.any||null!==i.choice||null===i.children||i.children.forEach(function n(n){n._decode(e,t)}),i.contains&&("octstr"===i.tag||"bitstr"===i.tag)){let n=new o(r);r=this._getUse(i.contains,e._reporterState.obj)._decode(n,t)}}return i.obj&&l&&(r=e.leaveObject(n)),null!==i.key&&(null!==r||!0===l)?e.leaveKey(s,i.key,r):null!==s&&e.exitKey(s),r},u.prototype._decodeGeneric=function e(e,t,n){let i=this._baseState;if("seq"===e||"set"===e)return null;if("seqof"===e||"setof"===e)return this._decodeList(t,e,i.args[0],n);if(/str$/.test(e))return this._decodeStr(t,e,n);if("objid"===e&&i.args)return this._decodeObjid(t,i.args[0],i.args[1],n);if("objid"===e)return this._decodeObjid(t,null,null,n);if("gentime"===e||"utctime"===e)return this._decodeTime(t,e,n);if("null_"===e)return this._decodeNull(t,n);if("bool"===e)return this._decodeBool(t,n);else if("objDesc"===e)return this._decodeStr(t,e,n);else if("int"===e||"enum"===e)return this._decodeInt(t,i.args&&i.args[0],n);return null!==i.use?this._getUse(i.use,t._reporterState.obj)._decode(t,n):t.error("unknown tag: "+e)},u.prototype._getUse=function e(e,t){let n=this._baseState;return n.useDecoder=this._use(e,t),l(null===n.useDecoder._baseState.parent),n.useDecoder=n.useDecoder._baseState.children[0],n.implicit!==n.useDecoder._baseState.implicit&&(n.useDecoder=n.useDecoder.clone(),n.useDecoder._baseState.implicit=n.implicit),n.useDecoder},u.prototype._decodeChoice=function e(e,t){let n=this._baseState,i=null,r=!1;return(Object.keys(n.choice).some(function(o){let l=e.save(),s=n.choice[o];try{let n=s._decode(e,t);if(e.isError(n))return!1;i={type:o,value:n},r=!0}catch(t){return e.restore(l),!1}return!0},this),r)?i:e.error("Choice not matched")},u.prototype._createEncoderBuffer=function e(e){return new r(e,this.reporter)},u.prototype._encode=function e(e,t,n){let i=this._baseState;if(null!==i.default&&i.default===e)return;let r=this._encodeValue(e,t,n);if(void 0!==r&&!this._skipDefault(r,t,n))return r},u.prototype._encodeValue=function e(e,t,n){let r=this._baseState;if(null===r.parent)return r.children[0]._encode(e,t||new i);let o=null;if(this.reporter=t,r.optional&&void 0===e){if(null===r.default)return;e=r.default}let l=null,s=!1;if(r.any)o=this._createEncoderBuffer(e);else if(r.choice)o=this._encodeChoice(e,t);else if(r.contains)l=this._getUse(r.contains,n)._encode(e,t),s=!0;else if(r.children)l=r.children.map(function(n){if("null_"===n._baseState.tag)return n._encode(null,t,e);if(null===n._baseState.key)return t.error("Child should have a key");let i=t.enterKey(n._baseState.key);if("object"!=typeof e)return t.error("Child expected, but input is not object");let r=n._encode(e[n._baseState.key],t,e);return t.leaveKey(i),r},this).filter(function(e){return e}),l=this._createEncoderBuffer(l);else if("seqof"===r.tag||"setof"===r.tag){if(!(r.args&&1===r.args.length))return t.error("Too many args for : "+r.tag);if(!Array.isArray(e))return t.error("seqof/setof, but data is not Array");let n=this.clone();n._baseState.implicit=null,l=this._createEncoderBuffer(e.map(function(n){let i=this._baseState;return this._getUse(i.args[0],e)._encode(n,t)},n))}else null!==r.use?o=this._getUse(r.use,n)._encode(e,t):(l=this._encodePrimitive(r.tag,e),s=!0);if(!r.any&&null===r.choice){let e=null!==r.implicit?r.implicit:r.tag,n=null===r.implicit?"universal":"context";null===e?null===r.use&&t.error("Tag could be omitted only for .use()"):null===r.use&&(o=this._encodeComposite(e,s,n,l))}return null!==r.explicit&&(o=this._encodeComposite(r.explicit,!1,"context",o)),o},u.prototype._encodeChoice=function e(e,t){let n=this._baseState,i=n.choice[e.type];return i||l(!1,e.type+" not found in "+JSON.stringify(Object.keys(n.choice))),i._encode(e.value,t)},u.prototype._encodePrimitive=function e(e,t){let n=this._baseState;if(/str$/.test(e))return this._encodeStr(t,e);if("objid"===e&&n.args)return this._encodeObjid(t,n.reverseArgs[0],n.args[1]);if("objid"===e)return this._encodeObjid(t,null,null);if("gentime"===e||"utctime"===e)return this._encodeTime(t,e);if("null_"===e)return this._encodeNull();if("int"===e||"enum"===e)return this._encodeInt(t,n.args&&n.reverseArgs[0]);if("bool"===e)return this._encodeBool(t);else if("objDesc"===e)return this._encodeStr(t,e);else throw Error("Unsupported tag: "+e)},u.prototype._isNumstr=function e(e){return/^[0-9 ]*$/.test(e)},u.prototype._isPrintstr=function e(e){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(e)}}
//# sourceMappingURL=/dynamic/node_modules/asn1.js/lib/asn1/base/3561dacc5d4a1cbed5c221a12d4b7b2ebd703db5.map
