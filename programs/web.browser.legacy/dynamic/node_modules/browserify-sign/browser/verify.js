function module(r,e,o){var t=r("safe-buffer").Buffer,n=r("bn.js"),a=r("elliptic").ec,d=r("parse-asn1"),u=r("./curves.json");function i(r,e){if(0>=r.cmpn(0)||r.cmp(e)>=e)throw Error("invalid sig")}o.exports=function(r,e,o,c,f){var m,s,l,p,h,g,v,w,y,b,E,R,j=d(o);if("ec"===j.type){if("ecdsa"!==c&&"ecdsa/rsa"!==c)throw Error("wrong public key type");return function(r,e,o){var t=u[o.data.algorithm.curve.join(".")];if(!t)throw Error("unknown curve "+o.data.algorithm.curve.join("."));var n=new a(t),d=o.data.subjectPrivateKey.data;return n.verify(e,r,d)}(r,e,j)}if("dsa"===j.type){if("dsa"!==c)throw Error("wrong public key type");return m=r,s=e,p=j.data.p,h=j.data.q,g=j.data.g,v=j.data.pub_key,y=(w=d.signature.decode(m,"der")).s,b=w.r,i(y,h),i(b,h),E=n.mont(p),R=y.invm(h),0===g.toRed(E).redPow(new n(s).mul(R).mod(h)).fromRed().mul(v.toRed(E).redPow(b.mul(R).mod(h)).fromRed()).mod(p).mod(h).cmp(b)}if("rsa"!==c&&"ecdsa/rsa"!==c)throw Error("wrong public key type");e=t.concat([f,e]);for(var k=j.modulus.byteLength(),P=[1],x=0;e.length+P.length+2<k;)P.push(255),x++;P.push(0);for(var q=-1;++q<e.length;)P.push(e[q]);P=t.from(P);var A=n.mont(j.modulus);r=(r=new n(r).toRed(A)).redPow(new n(j.publicExponent));var B=x<8?1:0;for(k=Math.min((r=t.from(r.fromRed().toArray())).length,P.length),r.length!==P.length&&(B=1),q=-1;++q<k;)B|=r[q]^P[q];return 0===B}}
//# sourceMappingURL=/dynamic/node_modules/browserify-sign/browser/201f65bb6c7319644d196f2e121a0e92db3d17fe.map
