function module(e,r,t){var a=e("safe-buffer").Buffer,n=e("create-hmac"),o=e("browserify-rsa"),u=e("elliptic").ec,i=e("bn.js"),c=e("parse-asn1"),d=e("./curves.json");function p(e,r,t,o){if((e=a.from(e.toArray())).length<r.byteLength()){var u=a.alloc(r.byteLength()-e.length);e=a.concat([u,e])}var i=t.length,c=function(e,r){e=(e=s(e,r)).mod(r);var t=a.from(e.toArray());if(t.length<r.byteLength()){var n=a.alloc(r.byteLength()-t.length);t=a.concat([n,t])}return t}(t,r),d=a.alloc(i);d.fill(1);var p=a.alloc(i);return p=n(o,p).update(d).update(a.from([0])).update(e).update(c).digest(),d=n(o,p).update(d).digest(),p=n(o,p).update(d).update(a.from([1])).update(e).update(c).digest(),d=n(o,p).update(d).digest(),{k:p,v:d}}function s(e,r){var t=new i(e),a=(e.length<<3)-r.bitLength();return a>0&&t.ishrn(a),t}function f(e,r,t){var o,u;do{for(o=a.alloc(0);8*o.length<e.bitLength();)r.v=n(t,r.k).update(r.v).digest(),o=a.concat([o,r.v]);u=s(o,e),r.k=n(t,r.k).update(r.v).update(a.from([0])).digest(),r.v=n(t,r.k).update(r.v).digest()}while(-1!==u.cmp(e));return u}t.exports=function(e,r,t,n,g){var l=c(r);if(l.curve){if("ecdsa"!==n&&"ecdsa/rsa"!==n)throw Error("wrong private key type");return function(e,r){var t=d[r.curve.join(".")];if(!t)throw Error("unknown curve "+r.curve.join("."));var n=new u(t).keyFromPrivate(r.privateKey).sign(e);return a.from(n.toDER())}(e,l)}if("dsa"===l.type){if("dsa"!==n)throw Error("wrong private key type");return function(e,r,t){for(var n,o,u,c,d,g,l,v,h=r.params.priv_key,m=r.params.p,y=r.params.q,w=r.params.g,k=new i(0),b=s(e,y).mod(y),L=!1,E=p(h,y,e,t);!1===L;)o=v=f(y,E,t),k=w.toRed(i.mont(m)).redPow(o).fromRed().mod(y),0===(L=v.invm(y).imul(b.add(h.mul(k))).mod(y)).cmpn(0)&&(L=!1,k=new i(0));return d=k,g=L,d=d.toArray(),g=g.toArray(),128&d[0]&&(d=[0].concat(d)),128&g[0]&&(g=[0].concat(g)),l=(l=[48,d.length+g.length+4,2,d.length]).concat(d,[2,g.length],g),a.from(l)}(e,l,t)}if("rsa"!==n&&"ecdsa/rsa"!==n)throw Error("wrong private key type");e=a.concat([g,e]);for(var v=l.modulus.byteLength(),h=[0,1];e.length+h.length+1<v;)h.push(255);h.push(0);for(var m=-1;++m<e.length;)h.push(e[m]);return o(h,l)},t.exports.getKey=p,t.exports.makeKey=f}
//# sourceMappingURL=/dynamic/node_modules/browserify-sign/browser/a8332e1d4ef8658c9bef569ea28e10d48a8a9bff.map
