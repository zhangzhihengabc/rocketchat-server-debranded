!function(){"use strict";window.RocketChat=window.RocketChat||{_:[]};const e={};let t,n,i,o,a=[],s=!1,c=!1;const d=["chat-maximized","chat-minimized","chat-started","chat-ended","pre-chat-form-submit","offline-form-submit","show-widget","hide-widget","assign-agent","agent-status-change","queue-position-change","no-agent-online"],l={all:u=u||new Map,on:function(e,t){var n=u.get(e);n&&n.push(t)||u.set(e,[t])},off:function(e,t){var n=u.get(e);n&&n.splice(n.indexOf(t)>>>0,1)},emit:function(e,t){(u.get(e)||[]).slice().map((function(e){e(t)})),(u.get("*")||[]).slice().map((function(n){n(e,t)}))}};var u;function r(e,t){return-1!==d.indexOf(e)&&l.on(e,t)}function h(e,t){void 0!==t?l.emit(e,t):l.emit(e)}function m(e,t){if(!s)return a.push([e,t]);const i={src:"rocketchat",fn:e,args:t};n.contentWindow.postMessage(i,"*")}const p=e=>{const n=c&&"triggered"!==t.dataset.state;c&&e?(i=document.documentElement.scrollTop,document.body.classList.add("rc-livechat-mobile-full-screen")):(document.body.classList.remove("rc-livechat-mobile-full-screen"),c&&(document.documentElement.scrollTop=i)),e?(t.style.left=n?"0":"auto",t.style.height=n?"100%":`${16+o+16+54}px`,t.style.width=n?"100%":"397px"):(t.style.left="auto",t.style.width="86px",t.style.height="86px")},f=()=>{"opened"!==t.dataset.state&&(o=525,t.dataset.state="opened",p(!0),n.focus(),h("chat-maximized"))};function g(){"closed"!==t.dataset.state&&(t.dataset.state="closed",p(!1),h("chat-minimized"))}const w={popup:null,ready(){s=!0,a.length>0&&(a.forEach((function(e){m.apply(this,e)})),a=[])},minimizeWindow(){g()},restoreWindow(){w.popup&&!0!==w.popup.closed&&(w.popup.close(),w.popup=null),f()},openPopout(){g(),w.popup=window.open(`${e.url}${e.url.lastIndexOf("?")>-1?"&":"?"}mode=popout`,"livechat-popout",`width=365, height=${o}, toolbars=no`),w.popup.focus()},openWidget(){f()},resizeWidget(e){(e=>{o=e,t.dataset.state="triggered",p(!0)})(e)},removeWidget(){document.body.removeChild(t)},callback(e,t){h(e,t)},showWidget(){n.style.display="initial",h("show-widget")},hideWidget(){n.style.display="none",h("hide-widget")},resetDocumentStyle(){document.body.classList.remove("rc-livechat-mobile-full-screen")},setFullScreenDocumentMobile(){c&&document.body.classList.add("rc-livechat-mobile-full-screen")}};function y(e){m("pageVisited",{change:e,location:JSON.parse(JSON.stringify(document.location)),title:document.title})}function v(e,t,n){void 0===n&&(n=!0),m("setCustomField",[e,t,n])}function b(e){m("setTheme",e)}function k(e){m("setDepartment",e)}function C(e){m("setBusinessUnit",e)}function x(e){m("setGuestToken",e)}function W(e){m("setGuestName",e)}function z(e){m("setGuestEmail",e)}function E(e){m("registerGuest",e)}function R(e){m("setAgent",e)}function S(e){m("setLanguage",e)}function G(e){m("setParentUrl",e)}const U={href:null,title:null},L=i=>{const o=i.trim();o&&(e.url=o,(e=>{t=document.createElement("div"),t.className="rocketchat-widget",t.style.position="fixed",t.style.width="86px",t.style.height="86px",t.style.maxHeight="100vh",t.style.bottom="0",t.style.right="0",t.style.zIndex="12345",t.dataset.state="closed";const i=document.createElement("div");i.className="rocketchat-container",i.style.width="100%",i.style.height="100%",n=document.createElement("iframe"),n.id="rocketchat-iframe",n.allowTransparency="true",n.src=e,n.style.width="100%",n.style.height="100%",n.style.border="none",n.style.backgroundColor="transparent",i.appendChild(n),t.appendChild(i),document.body.appendChild(t);const o=({matches:e})=>{t&&(c=e,p("opened"===t.dataset.state),m("setExpanded",c),m("setParentUrl",window.location.href))},a=window.matchMedia("screen and (max-device-width: 480px)");a.addListener(o),o(a)})(o),window.addEventListener("message",(e=>{if("object"==typeof e.data&&void 0!==e.data.src&&"rocketchat"===e.data.src&&void 0!==w[e.data.fn]&&"function"==typeof w[e.data.fn]){const t=[].concat(e.data.args||[]);e.data.fn,w[e.data.fn].apply(null,t)}}),!1),setInterval((()=>{document.location.href!==U.href&&(y("url"),U.href=document.location.href),document.title!==U.title&&(y("title"),U.title=document.title)}),800))};void 0!==window.initRocket&&(console.warn("initRocket is now deprecated. Please update the livechat code."),L(window.initRocket[0])),void 0!==window.RocketChat.url&&L(window.RocketChat.url);const O=window.RocketChat._;window.RocketChat._.push=function(e){e.call(window.RocketChat.livechat)},window.RocketChat=window.RocketChat._.push,window.RocketChat.livechat={pageVisited:y,setCustomField:v,initialize:function(e){for(const t in e)if(e.hasOwnProperty(t))switch(t){case"customField":const{key:n,value:i,overwrite:o}=e[t];v(n,i,o);continue;case"setCustomFields":if(!Array.isArray(e[t])){console.log("Error: Invalid parameters. Value must be an array of objects");continue}e[t].forEach((e=>{const{key:t,value:n,overwrite:i}=e;v(t,n,i)}));continue;case"theme":b(e[t]);continue;case"department":k(e[t]);continue;case"businessUnit":C(e[t]);continue;case"guestToken":x(e[t]);continue;case"guestName":W(e[t]);continue;case"guestEmail":z(e[t]);continue;case"registerGuest":E(e[t]);continue;case"language":S(e[t]);continue;case"agent":R(e[t]);continue;case"parentUrl":G(e[t]);continue;default:continue}},setTheme:b,setDepartment:k,clearDepartment:function(){m("clearDepartment")},setGuestToken:x,setGuestName:W,setGuestEmail:z,setAgent:R,registerGuest:E,setLanguage:S,showWidget:function(){m("showWidget")},hideWidget:function(){m("hideWidget")},maximizeWidget:function(){m("maximizeWidget")},minimizeWidget:function(){m("minimizeWidget")},setBusinessUnit:C,clearBusinessUnit:function(){m("clearBusinessUnit")},setParentUrl:G,onChatMaximized(e){r("chat-maximized",e)},onChatMinimized(e){r("chat-minimized",e)},onChatStarted(e){r("chat-started",e)},onChatEnded(e){r("chat-ended",e)},onPrechatFormSubmit(e){r("pre-chat-form-submit",e)},onOfflineFormSubmit(e){r("offline-form-submit",e)},onWidgetShown(e){r("show-widget",e)},onWidgetHidden(e){r("hide-widget",e)},onAssignAgent(e){r("assign-agent",e)},onAgentStatusChange(e){r("agent-status-change",e)},onQueuePositionChange(e){r("queue-position-change",e)},onServiceOffline(e){r("no-agent-online",e)}},O.forEach((e=>{e.call(window.RocketChat.livechat)}))}();
//# sourceMappingURL=rocketchat-livechat.min.js.map