)]}'
{"version":3,"sources":["meteor://ðŸ’»app/app/ui-message/client/popup/ComposerBoxPopup.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Box, Option, OptionSkeleton, Tile } from '@rocket.chat/fuselage';\nimport { useUniqueId, useContentBoxSize } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation } from '@rocket.chat/ui-contexts';\nimport type { UseQueryResult } from '@tanstack/react-query';\nimport type { ReactElement } from 'react';\nimport React, { useEffect, memo, useMemo, useRef } from 'react';\n\nexport type ComposerBoxPopupProps<\n\tT extends {\n\t\t_id: string;\n\t\tsort?: number;\n\t},\n> = {\n\ttitle?: string;\n\tfocused?: T;\n\titems: UseQueryResult<T[]>[];\n\tselect: (item: T) => void;\n\trenderItem?: ({ item }: { item: T }) => ReactElement;\n};\n\nconst ComposerBoxPopup = <\n\tT extends {\n\t\t_id: string;\n\t\tsort?: number;\n\t},\n>({\n\ttitle,\n\titems,\n\tfocused,\n\tselect,\n\trenderItem = ({ item }: { item: T }) => <>{JSON.stringify(item)}</>,\n}: ComposerBoxPopupProps<T>): ReactElement | null => {\n\tconst t = useTranslation();\n\tconst id = useUniqueId();\n\tconst composerBoxPopupRef = useRef<HTMLElement>(null);\n\tconst popupSizes = useContentBoxSize(composerBoxPopupRef);\n\n\tconst variant = popupSizes && popupSizes.inlineSize < 480 ? 'small' : 'large';\n\n\tconst getOptionTitle = <T extends { _id: string; sort?: number; outside?: boolean; suggestion?: boolean }>(item: T) => {\n\t\tif (variant !== 'small') {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (item.outside) {\n\t\t\treturn t('Not_in_channel');\n\t\t}\n\n\t\tif (item.suggestion) {\n\t\t\treturn t('Suggestion_from_recent_messages');\n\t\t}\n\t};\n\n\tconst itemsFlat = useMemo(\n\t\t() =>\n\t\t\titems\n\t\t\t\t.flatMap((item) => {\n\t\t\t\t\tif (item.isSuccess) {\n\t\t\t\t\t\treturn item.data;\n\t\t\t\t\t}\n\t\t\t\t\treturn [];\n\t\t\t\t})\n\t\t\t\t.sort((a, b) => (('sort' in a && a.sort) || 0) - (('sort' in b && b.sort) || 0)),\n\t\t[items],\n\t);\n\n\tconst isLoading = items.some((item) => item.isLoading && item.fetchStatus !== 'idle');\n\n\tuseEffect(() => {\n\t\tif (focused) {\n\t\t\tconst element = document.getElementById(`popup-item-${focused._id}`);\n\t\t\tif (element) {\n\t\t\t\telement.scrollIntoView({ behavior: 'smooth', block: 'nearest' });\n\t\t\t}\n\t\t}\n\t}, [focused]);\n\n\treturn (\n\t\t<Box className='message-popup-position' position='relative'>\n\t\t\t<Tile ref={composerBoxPopupRef} className='message-popup' padding={0} role='menu' mbe={8} overflow='hidden' aria-labelledby={id}>\n\t\t\t\t{title && (\n\t\t\t\t\t<Box bg='tint' pi={16} pb={8} id={id}>\n\t\t\t\t\t\t{title}\n\t\t\t\t\t</Box>\n\t\t\t\t)}\n\t\t\t\t<Box pb={8} maxHeight='x320'>\n\t\t\t\t\t{!isLoading && itemsFlat.length === 0 && <Option>{t('No_results_found')}</Option>}\n\t\t\t\t\t{isLoading && <OptionSkeleton />}\n\t\t\t\t\t{itemsFlat.map((item, index) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<Option\n\t\t\t\t\t\t\t\ttitle={getOptionTitle(item)}\n\t\t\t\t\t\t\t\tonClick={() => select(item)}\n\t\t\t\t\t\t\t\tselected={item === focused}\n\t\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\t\tid={`popup-item-${item._id}`}\n\t\t\t\t\t\t\t\ttabIndex={item === focused ? 0 : -1}\n\t\t\t\t\t\t\t\taria-selected={item === focused}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{renderItem({ item: { ...item, variant } })}\n\t\t\t\t\t\t\t</Option>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</Box>\n\t\t\t</Tile>\n\t\t</Box>\n\t);\n};\n\nexport default memo(ComposerBoxPopup);\n",null],"names":["_objectSpread","Box","Option","OptionSkeleton","Tile","useUniqueId","useContentBoxSize","useTranslation","React","useEffect","memo","useMemo","useRef","module","link","default","v","exportDefault","_ref","title","items","focused","select","renderItem","_ref2","item","createElement","Fragment","JSON","stringify","t","id","composerBoxPopupRef","popupSizes","variant","inlineSize","getOptionTitle","outside","suggestion","itemsFlat","flatMap","isSuccess","data","sort","a","b","isLoading","some","fetchStatus","element","document","getElementById","concat","_id","scrollIntoView","behavior","block","className","position","ref","padding","role","mbe","overflow","bg","pi","pb","maxHeight","length","map","index","onClick","selected","key","tabIndex"],"mappings":"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"}