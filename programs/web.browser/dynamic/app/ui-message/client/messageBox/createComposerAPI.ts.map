)]}'
{"version":3,"sources":["meteor://ðŸ’»app/app/ui-message/client/messageBox/createComposerAPI.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IMessage } from '@rocket.chat/core-typings';\nimport { Emitter } from '@rocket.chat/emitter';\nimport { Meteor } from 'meteor/meteor';\n\nimport type { ComposerAPI } from '../../../../client/lib/chats/ChatAPI';\nimport { withDebouncing } from '../../../../lib/utils/highOrderFunctions';\nimport type { FormattingButton } from './messageBoxFormatting';\nimport { formattingButtons } from './messageBoxFormatting';\n\nexport const createComposerAPI = (input: HTMLTextAreaElement, storageID: string): ComposerAPI => {\n\tconst triggerEvent = (input: HTMLTextAreaElement, evt: string): void => {\n\t\tconst event = new Event(evt, { bubbles: true });\n\t\t// TODO: Remove this hack for react to trigger onChange\n\t\tconst tracker = (input as any)._valueTracker;\n\t\tif (tracker) {\n\t\t\ttracker.setValue(new Date().toString());\n\t\t}\n\t\tinput.dispatchEvent(event);\n\t};\n\n\tconst emitter = new Emitter<{\n\t\tquotedMessagesUpdate: void;\n\t\tediting: void;\n\t\trecording: void;\n\t\trecordingVideo: void;\n\t\tformatting: void;\n\t\tmircophoneDenied: void;\n\t}>();\n\n\tlet _quotedMessages: IMessage[] = [];\n\n\tconst persist = withDebouncing({ wait: 300 })(() => {\n\t\tif (input.value) {\n\t\t\tMeteor._localStorage.setItem(storageID, input.value);\n\t\t\treturn;\n\t\t}\n\n\t\tMeteor._localStorage.removeItem(storageID);\n\t});\n\n\tconst notifyQuotedMessagesUpdate = (): void => {\n\t\temitter.emit('quotedMessagesUpdate');\n\t};\n\n\tinput.addEventListener('input', persist);\n\n\tconst setText = (\n\t\ttext: string,\n\t\t{\n\t\t\tselection,\n\t\t\tskipFocus,\n\t\t}: {\n\t\t\tselection?:\n\t\t\t\t| { readonly start?: number; readonly end?: number }\n\t\t\t\t| ((previous: { readonly start: number; readonly end: number }) => { readonly start?: number; readonly end?: number });\n\t\t\tskipFocus?: boolean;\n\t\t} = {},\n\t): void => {\n\t\t!skipFocus && focus();\n\n\t\tconst { selectionStart, selectionEnd } = input;\n\t\tconst textAreaTxt = input.value;\n\n\t\tif (typeof selection === 'function') {\n\t\t\tselection = selection({ start: selectionStart, end: selectionEnd });\n\t\t}\n\n\t\tif (selection) {\n\t\t\tif (!document.execCommand?.('insertText', false, text)) {\n\t\t\t\tinput.value = textAreaTxt.substring(0, selectionStart) + text + textAreaTxt.substring(selectionStart);\n\t\t\t\t!skipFocus && focus();\n\t\t\t}\n\t\t\tinput.setSelectionRange(selection.start ?? 0, selection.end ?? text.length);\n\t\t}\n\n\t\tif (!selection) {\n\t\t\tinput.value = text;\n\t\t}\n\n\t\ttriggerEvent(input, 'input');\n\t\ttriggerEvent(input, 'change');\n\n\t\t!skipFocus && focus();\n\t};\n\n\tconst insertText = (text: string): void => {\n\t\tsetText(text, {\n\t\t\tselection: ({ start, end }) => ({\n\t\t\t\tstart: start + text.length,\n\t\t\t\tend: end + text.length,\n\t\t\t}),\n\t\t});\n\t};\n\n\tconst clear = (): void => {\n\t\tsetText('');\n\t};\n\n\tconst focus = (): void => {\n\t\tinput.focus();\n\t};\n\n\tconst replyWith = async (text: string): Promise<void> => {\n\t\tif (input) {\n\t\t\tinput.value = text;\n\t\t\tinput.focus();\n\t\t}\n\t};\n\n\tconst quoteMessage = async (message: IMessage): Promise<void> => {\n\t\t_quotedMessages = [..._quotedMessages.filter((_message) => _message._id !== message._id), message];\n\t\tnotifyQuotedMessagesUpdate();\n\t\tinput.focus();\n\t};\n\n\tconst dismissQuotedMessage = async (mid: IMessage['_id']): Promise<void> => {\n\t\t_quotedMessages = _quotedMessages.filter((message) => message._id !== mid);\n\t\tnotifyQuotedMessagesUpdate();\n\t};\n\n\tconst dismissAllQuotedMessages = async (): Promise<void> => {\n\t\t_quotedMessages = [];\n\t\tnotifyQuotedMessagesUpdate();\n\t};\n\n\tconst quotedMessages = {\n\t\tget: () => _quotedMessages,\n\t\tsubscribe: (callback: () => void) => emitter.on('quotedMessagesUpdate', callback),\n\t};\n\n\tconst [editing, setEditing] = (() => {\n\t\tlet editing = false;\n\n\t\treturn [\n\t\t\t{\n\t\t\t\tget: () => editing,\n\t\t\t\tsubscribe: (callback: () => void) => emitter.on('editing', callback),\n\t\t\t},\n\t\t\t(value: boolean) => {\n\t\t\t\tediting = value;\n\t\t\t\temitter.emit('editing');\n\t\t\t},\n\t\t];\n\t})();\n\n\tconst [recording, setRecordingMode] = (() => {\n\t\tlet recording = false;\n\n\t\treturn [\n\t\t\t{\n\t\t\t\tget: () => recording,\n\t\t\t\tsubscribe: (callback: () => void) => emitter.on('recording', callback),\n\t\t\t},\n\t\t\t(value: boolean) => {\n\t\t\t\trecording = value;\n\t\t\t\temitter.emit('recording');\n\t\t\t},\n\t\t];\n\t})();\n\n\tconst [recordingVideo, setRecordingVideo] = (() => {\n\t\tlet recordingVideo = false;\n\n\t\treturn [\n\t\t\t{\n\t\t\t\tget: () => recordingVideo,\n\t\t\t\tsubscribe: (callback: () => void) => emitter.on('recordingVideo', callback),\n\t\t\t},\n\t\t\t(value: boolean) => {\n\t\t\t\trecordingVideo = value;\n\t\t\t\temitter.emit('recordingVideo');\n\t\t\t},\n\t\t];\n\t})();\n\n\tconst [isMicrophoneDenied, setIsMicrophoneDenied] = (() => {\n\t\tlet isMicrophoneDenied = false;\n\n\t\treturn [\n\t\t\t{\n\t\t\t\tget: () => isMicrophoneDenied,\n\t\t\t\tsubscribe: (callback: () => void) => emitter.on('mircophoneDenied', callback),\n\t\t\t},\n\t\t\t(value: boolean) => {\n\t\t\t\tisMicrophoneDenied = value;\n\t\t\t\temitter.emit('mircophoneDenied');\n\t\t\t},\n\t\t];\n\t})();\n\n\tconst setEditingMode = (editing: boolean): void => {\n\t\tsetEditing(editing);\n\t};\n\n\tconst [formatters, stopFormatterTracker] = (() => {\n\t\tlet actions: FormattingButton[] = [];\n\n\t\tconst c = Tracker.autorun(() => {\n\t\t\tactions = formattingButtons.filter(({ condition }) => !condition || condition());\n\t\t\temitter.emit('formatting');\n\t\t});\n\n\t\treturn [\n\t\t\t{\n\t\t\t\tget: () => actions,\n\t\t\t\tsubscribe: (callback: () => void) => emitter.on('formatting', callback),\n\t\t\t},\n\t\t\tc,\n\t\t];\n\t})();\n\n\tconst release = (): void => {\n\t\tinput.removeEventListener('input', persist);\n\t\tstopFormatterTracker.stop();\n\t};\n\n\tconst wrapSelection = (pattern: string): void => {\n\t\tconst { selectionEnd = input.value.length, selectionStart = 0 } = input;\n\t\tconst initText = input.value.slice(0, selectionStart);\n\t\tconst selectedText = input.value.slice(selectionStart, selectionEnd);\n\t\tconst finalText = input.value.slice(selectionEnd, input.value.length);\n\n\t\tfocus();\n\n\t\tconst startPattern = pattern.slice(0, pattern.indexOf('{{text}}'));\n\t\tconst startPatternFound = [...startPattern].reverse().every((char, index) => input.value.slice(selectionStart - index - 1, 1) === char);\n\n\t\tif (startPatternFound) {\n\t\t\tconst endPattern = pattern.slice(pattern.indexOf('{{text}}') + '{{text}}'.length);\n\t\t\tconst endPatternFound = [...endPattern].every((char, index) => input.value.slice(selectionEnd + index, 1) === char);\n\n\t\t\tif (endPatternFound) {\n\t\t\t\tinsertText(selectedText);\n\t\t\t\tinput.selectionStart = selectionStart - startPattern.length;\n\t\t\t\tinput.selectionEnd = selectionEnd + endPattern.length;\n\n\t\t\t\tif (!document.execCommand?.('insertText', false, selectedText)) {\n\t\t\t\t\tinput.value = initText.slice(0, initText.length - startPattern.length) + selectedText + finalText.slice(endPattern.length);\n\t\t\t\t}\n\n\t\t\t\tinput.selectionStart = selectionStart - startPattern.length;\n\t\t\t\tinput.selectionEnd = input.selectionStart + selectedText.length;\n\t\t\t\ttriggerEvent(input, 'input');\n\t\t\t\ttriggerEvent(input, 'change');\n\n\t\t\t\tfocus();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (!document.execCommand?.('insertText', false, pattern.replace('{{text}}', selectedText))) {\n\t\t\tinput.value = initText + pattern.replace('{{text}}', selectedText) + finalText;\n\t\t}\n\n\t\tinput.selectionStart = selectionStart + pattern.indexOf('{{text}}');\n\t\tinput.selectionEnd = input.selectionStart + selectedText.length;\n\t\ttriggerEvent(input, 'input');\n\t\ttriggerEvent(input, 'change');\n\n\t\tfocus();\n\t};\n\n\tconst insertNewLine = (): void => insertText('\\n');\n\n\tsetText(Meteor._localStorage.getItem(storageID) ?? '', {\n\t\tskipFocus: true,\n\t});\n\n\t// Gets the text that is connected to the cursor and replaces it with the given text\n\tconst replaceText = (text: string, selection: { readonly start: number; readonly end: number }): void => {\n\t\tconst { selectionStart, selectionEnd } = input;\n\n\t\t// Selects the text that is connected to the cursor\n\t\tinput.setSelectionRange(selection.start ?? 0, selection.end ?? text.length);\n\t\tconst textAreaTxt = input.value;\n\n\t\tif (!document.execCommand?.('insertText', false, text)) {\n\t\t\tinput.value = textAreaTxt.substring(0, selection.start) + text + textAreaTxt.substring(selection.end);\n\t\t}\n\n\t\tinput.selectionStart = selectionStart + text.length;\n\t\tinput.selectionEnd = selectionStart + text.length;\n\t\tif (selectionStart !== selectionEnd) {\n\t\t\tinput.selectionStart = selectionStart;\n\t\t}\n\n\t\ttriggerEvent(input, 'input');\n\t\ttriggerEvent(input, 'change');\n\n\t\tfocus();\n\t};\n\n\treturn {\n\t\treplaceText,\n\t\tinsertNewLine,\n\t\tblur: () => input.blur(),\n\n\t\tsubstring: (start: number, end?: number) => {\n\t\t\treturn input.value.substring(start, end);\n\t\t},\n\n\t\tgetCursorPosition: () => {\n\t\t\treturn input.selectionStart;\n\t\t},\n\t\tsetCursorToEnd: () => {\n\t\t\tinput.selectionEnd = input.value.length;\n\t\t\tinput.selectionStart = input.selectionEnd;\n\t\t\tfocus();\n\t\t},\n\t\tsetCursorToStart: () => {\n\t\t\tinput.selectionStart = 0;\n\t\t\tinput.selectionEnd = input.selectionStart;\n\t\t\tfocus();\n\t\t},\n\t\trelease,\n\t\twrapSelection,\n\t\tget text(): string {\n\t\t\treturn input.value;\n\t\t},\n\t\tget selection(): { start: number; end: number } {\n\t\t\treturn {\n\t\t\t\tstart: input.selectionStart,\n\t\t\t\tend: input.selectionEnd,\n\t\t\t};\n\t\t},\n\n\t\tediting,\n\t\tsetEditingMode,\n\t\trecording,\n\t\tsetRecordingMode,\n\t\trecordingVideo,\n\t\tsetRecordingVideo,\n\t\tinsertText,\n\t\tsetText,\n\t\tclear,\n\t\tfocus,\n\t\treplyWith,\n\t\tquoteMessage,\n\t\tdismissQuotedMessage,\n\t\tdismissAllQuotedMessages,\n\t\tquotedMessages,\n\t\tformatters,\n\t\tisMicrophoneDenied,\n\t\tsetIsMicrophoneDenied,\n\t};\n};\n",null],"names":["Emitter","Meteor","withDebouncing","formattingButtons","module","export","createComposerAPI","input","storageID","_Meteor$_localStorage","editing","recording","recordingVideo","isMicrophoneDenied","triggerEvent","evt","event","Event","bubbles","tracker","_valueTracker","setValue","Date","toString","dispatchEvent","emitter","_quotedMessages","persist","wait","value","_localStorage","setItem","removeItem","notifyQuotedMessagesUpdate","emit","addEventListener","setText","text","selection","skipFocus","arguments","length","undefined","focus","selectionStart","selectionEnd","textAreaTxt","start","end","_document$execCommand","_document","_selection$start","_selection$end","document","execCommand","call","substring","setSelectionRange","insertText","_ref","replyWith","quoteMessage","message","filter","_message","_id","dismissQuotedMessage","mid","dismissAllQuotedMessages","setEditing","get","subscribe","callback","on","setRecordingMode","setRecordingVideo","setIsMicrophoneDenied","formatters","stopFormatterTracker","actions","c","Tracker","autorun","_ref2","condition","getItem","replaceText","_selection$start2","_selection$end2","_document$execCommand4","_document4","insertNewLine","blur","getCursorPosition","setCursorToEnd","setCursorToStart","release","removeEventListener","stop","wrapSelection","pattern","_document$execCommand3","_document3","_document$execCommand2","_document2","initText","slice","selectedText","finalText","startPattern","indexOf","startPatternFound","reverse","every","char","index","endPattern","endPatternFound","replace","setEditingMode","clear","quotedMessages"],"mappings":"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"}