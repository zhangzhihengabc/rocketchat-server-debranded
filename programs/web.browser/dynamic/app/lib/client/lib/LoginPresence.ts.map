)]}'
{"version":3,"sources":["meteor://ðŸ’»app/app/lib/client/lib/LoginPresence.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Meteor } from 'meteor/meteor';\n\nimport { settings } from '../../../settings/client';\n\nclass LoginPresence {\n\tprivate awayTime = 600_000; // 10 minutes\n\n\tprivate started = false;\n\n\tprivate timer: ReturnType<typeof setTimeout>;\n\n\tprivate startTimer(): void {\n\t\tthis.stopTimer();\n\t\tif (!this.awayTime) {\n\t\t\treturn;\n\t\t}\n\t\tthis.timer = setTimeout(() => this.disconnect(), this.awayTime);\n\t}\n\n\tprivate stopTimer(): void {\n\t\tclearTimeout(this.timer);\n\t}\n\n\tprivate disconnect(): void {\n\t\tconst status = Meteor.status();\n\t\tif (status && status.status !== 'offline') {\n\t\t\tif (!Meteor.userId() && settings.get('Accounts_AllowAnonymousRead') !== true) {\n\t\t\t\tMeteor.disconnect();\n\t\t\t}\n\t\t}\n\t\tthis.stopTimer();\n\t}\n\n\tprivate connect(): void {\n\t\tconst status = Meteor.status();\n\t\tif (status && status.status === 'offline') {\n\t\t\tMeteor.reconnect();\n\t\t}\n\t}\n\n\tpublic start(): void {\n\t\tif (this.started) {\n\t\t\treturn;\n\t\t}\n\n\t\twindow.addEventListener('focus', () => {\n\t\t\tthis.stopTimer();\n\t\t\tthis.connect();\n\t\t});\n\n\t\twindow.addEventListener('blur', () => {\n\t\t\tthis.startTimer();\n\t\t});\n\n\t\tif (!window.document.hasFocus()) {\n\t\t\tthis.startTimer();\n\t\t}\n\n\t\tthis.started = true;\n\t}\n}\n\nconst instance = new LoginPresence();\n\ninstance.start();\n\nexport { instance as LoginPresence };\n",null],"names":["Meteor","settings","module","export","LoginPresence","instance","constructor","awayTime","started","timer","startTimer","stopTimer","setTimeout","disconnect","clearTimeout","status","userId","get","connect","reconnect","start","window","addEventListener","document","hasFocus"],"mappings":"2BAAuCA,EAAAC,EAAvCC,EAAOC,MAAE,CAAA,CAAMC,cAAQ,IAAAC,CAAgB,GAAAH,EAAAA,IAAAA,CAAAA,gBAAAA,CAAAF,OAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAD,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GA8DvC,IAAMI,EAAW,IA1DjB,MAAMD,EAAaE,aAAA,CAAA,IAAA,CACVC,QAAQ,CAAG,IAAO,IAAA,CAElBC,OAAO,CAAG,CAAA,EAAK,IAAA,CAEfC,KAAK,CAAA,KAAA,CAAA,CAELC,YAAU,CACjB,IAAI,CAACC,SAAS,GACT,IAAI,CAACJ,QAAQ,EAGlB,CAAA,IAAI,CAACE,KAAK,CAAGG,WAAW,IAAM,IAAI,CAACC,UAAU,GAAI,IAAI,CAACN,QAAQ,CAAA,CAC/D,CAEQI,WAAS,CAChBG,aAAa,IAAI,CAACL,KAAK,CACxB,CAEQI,YAAU,CACjB,IAAME,EAASf,EAAOe,MAAM,GACxBA,GAAUA,AAAkB,YAAlBA,EAAOA,MAAM,EACtB,CAACf,EAAOgB,MAAM,IAAMf,AAAgD,CAAA,IAAhDA,EAASgB,GAAG,CAAC,gCACpCjB,EAAOa,UAAU,GAGnB,IAAI,CAACF,SAAS,EACf,CAEQO,SAAO,CACd,IAAMH,EAASf,EAAOe,MAAM,GACxBA,GAAUA,AAAkB,YAAlBA,EAAOA,MAAM,EAC1Bf,EAAOmB,SAAS,EAElB,CAEOC,OAAK,CACP,IAAI,CAACZ,OAAO,GAIhBa,OAAOC,gBAAgB,CAAC,QAAS,KAChC,IAAI,CAACX,SAAS,GACd,IAAI,CAACO,OAAO,EACb,GAEAG,OAAOC,gBAAgB,CAAC,OAAQ,KAC/B,IAAI,CAACZ,UAAU,EAChB,GAEKW,OAAOE,QAAQ,CAACC,QAAQ,IAC5B,IAAI,CAACd,UAAU,GAGhB,IAAI,CAACF,OAAO,CAAG,CAAA,EAChB,GAKDH,EAASe,KAAK"}