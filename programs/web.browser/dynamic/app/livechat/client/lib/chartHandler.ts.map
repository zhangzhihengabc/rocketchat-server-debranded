)]}'
{"version":3,"sources":["meteor://ðŸ’»app/app/livechat/client/lib/chartHandler.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { ChartItem, Chart as ChartType, ChartConfiguration } from 'chart.js';\n\nimport { t } from '../../../utils/lib/i18n';\n\ntype LineChartConfigOptions = Partial<{\n\tlegends: boolean;\n\tanim: boolean;\n\tdisplayColors: boolean;\n\ttooltipCallbacks: any;\n}>;\n\nconst lineChartConfiguration = ({\n\tlegends = false,\n\tanim = false,\n\ttooltipCallbacks = {},\n}: LineChartConfigOptions): Partial<ChartConfiguration<'line', number, string>['options']> => {\n\tconst config: ChartConfiguration<'line', number, string>['options'] = {\n\t\tlayout: {\n\t\t\tpadding: {\n\t\t\t\ttop: 10,\n\t\t\t\tbottom: 0,\n\t\t\t},\n\t\t},\n\t\tlegend: {\n\t\t\tdisplay: false,\n\t\t},\n\t\tplugins: {\n\t\t\ttooltip: {\n\t\t\t\tusePointStyle: true,\n\t\t\t\tenabled: true,\n\t\t\t\tmode: 'point',\n\t\t\t\tyAlign: 'bottom',\n\t\t\t\tdisplayColors: true,\n\t\t\t\t...tooltipCallbacks,\n\t\t\t},\n\t\t},\n\t\tscales: {\n\t\t\txAxis: {\n\t\t\t\ttitle: {\n\t\t\t\t\tdisplay: false,\n\t\t\t\t},\n\t\t\t\tgrid: {\n\t\t\t\t\tdisplay: true,\n\t\t\t\t\tcolor: 'rgba(0, 0, 0, 0.03)',\n\t\t\t\t},\n\t\t\t},\n\t\t\tyAxis: {\n\t\t\t\ttitle: {\n\t\t\t\t\tdisplay: false,\n\t\t\t\t},\n\t\t\t\tgrid: {\n\t\t\t\t\tdisplay: true,\n\t\t\t\t\tcolor: 'rgba(0, 0, 0, 0.03)',\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\thover: {\n\t\t\tintersect: false, // duration of animations when hovering an item\n\t\t\tmode: 'index',\n\t\t},\n\t\tresponsive: true,\n\t\tmaintainAspectRatio: false,\n\t\t...(!anim ? { animation: { duration: 0 } } : {}),\n\t\t...(legends ? { legend: { display: true, labels: { boxWidth: 20, fontSize: 8 } } } : {}),\n\t};\n\n\treturn config;\n};\n\nconst doughnutChartConfiguration = (\n\ttitle: string,\n\ttooltipCallbacks = {},\n): Partial<ChartConfiguration<'doughnut', number, string>['options']> => ({\n\tlayout: {\n\t\tpadding: {\n\t\t\ttop: 0,\n\t\t\tbottom: 0,\n\t\t},\n\t},\n\tplugins: {\n\t\tlegend: {\n\t\t\tdisplay: true,\n\t\t\tposition: 'right',\n\t\t\tlabels: {\n\t\t\t\tboxWidth: 20,\n\t\t\t},\n\t\t},\n\t\ttitle: {\n\t\t\tdisplay: true,\n\t\t\ttext: title,\n\t\t},\n\t\ttooltip: {\n\t\t\tenabled: true,\n\t\t\tmode: 'point',\n\t\t\tdisplayColors: true, // hide color box\n\t\t\t...tooltipCallbacks,\n\t\t},\n\t},\n\t// animation: {\n\t// \tduration: 0 // general animation time\n\t// },\n\thover: {\n\t\tintersect: true, // duration of animations when hovering an item\n\t},\n\tresponsive: true,\n\tmaintainAspectRatio: false,\n});\n\ntype ChartDataSet = {\n\tlabel: string;\n\tdata: number;\n\tbackgroundColor: string;\n\tborderColor: string;\n\tborderWidth: number;\n\tfill: boolean;\n};\n\n/**\n *\n * @param {Object} chart - chart element\n * @param {Object} chartContext - Context of chart\n * @param {Array(String)} chartLabel\n * @param {Array(String)} dataLabels\n * @param {Array(Array(Double))} dataPoints\n */\nexport const drawLineChart = async (\n\tchart: HTMLCanvasElement,\n\tchartContext: { destroy: () => void } | undefined,\n\tchartLabels: string[],\n\tdataLabels: string[],\n\tdataSets: number[],\n\toptions: LineChartConfigOptions = {},\n): Promise<ChartType<'line', number, string> | void> => {\n\tif (!chart) {\n\t\tconsole.error('No chart element');\n\t\treturn;\n\t}\n\tif (chartContext) {\n\t\tchartContext.destroy();\n\t}\n\tconst colors = ['#2de0a5', '#ffd21f', '#f5455c', '#cbced1'];\n\n\tconst datasets: ChartDataSet[] = [];\n\n\tchartLabels.forEach((chartLabel: string, index: number) => {\n\t\tdatasets.push({\n\t\t\tlabel: t(chartLabel), // chart label\n\t\t\tdata: dataSets[index], // data points corresponding to data labels, x-axis points\n\t\t\tbackgroundColor: colors[index],\n\t\t\tborderColor: colors[index],\n\t\t\tborderWidth: 3,\n\t\t\tfill: false,\n\t\t});\n\t});\n\tconst chartjs = await import('chart.js/auto');\n\tconst Chart = chartjs.default;\n\treturn new Chart(chart, {\n\t\ttype: 'line',\n\t\tdata: {\n\t\t\tlabels: dataLabels, // data labels, y-axis points\n\t\t\tdatasets,\n\t\t},\n\t\toptions: lineChartConfiguration(options),\n\t});\n};\n\n/**\n *\n * @param {Object} chart - chart element\n * @param {Object} chartContext - Context of chart\n * @param {Array(String)} dataLabels\n * @param {Array(Double)} dataPoints\n */\nexport const drawDoughnutChart = async (\n\tchart: ChartItem,\n\ttitle: string,\n\tchartContext: { destroy: () => void } | undefined,\n\tdataLabels: string[],\n\tdataPoints: number[],\n): Promise<ChartType<'doughnut', number[], string> | void> => {\n\tif (!chart) {\n\t\tconsole.error('No chart element');\n\t\treturn;\n\t}\n\tif (chartContext) {\n\t\tchartContext.destroy();\n\t}\n\tconst chartjs = await import('chart.js/auto');\n\tconst Chart = chartjs.default;\n\treturn new Chart(chart, {\n\t\ttype: 'doughnut',\n\t\tdata: {\n\t\t\tlabels: dataLabels, // data labels, y-axis points\n\t\t\tdatasets: [\n\t\t\t\t{\n\t\t\t\t\tdata: dataPoints, // data points corresponding to data labels, x-axis points\n\t\t\t\t\tbackgroundColor: ['#2de0a5', '#cbced1', '#f5455c', '#ffd21f'],\n\t\t\t\t\tborderWidth: 0,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\toptions: doughnutChartConfiguration(title),\n\t});\n};\n\n/**\n * Update chart\n * @param  {Object} chart [Chart context]\n * @param  {String} label [chart label]\n * @param  {Array(Double)} data  [updated data]\n */\nexport const updateChart = async (c: ChartType, label: string, data: { [x: string]: number }): Promise<void> => {\n\tconst chart = await c;\n\tif (chart.data?.labels?.indexOf(label) === -1) {\n\t\t// insert data\n\t\tchart.data.labels.push(label);\n\t\tchart.data.datasets.forEach((dataset: { data: any[] }, idx: string | number) => {\n\t\t\tdataset.data.push(data[idx]);\n\t\t});\n\t} else {\n\t\t// update data\n\t\tconst index = chart.data?.labels?.indexOf(label);\n\t\tif (typeof index === 'undefined') {\n\t\t\treturn;\n\t\t}\n\n\t\tchart.data.datasets.forEach((dataset: { data: { [x: string]: any } }, idx: string | number) => {\n\t\t\tdataset.data[index] = data[idx];\n\t\t});\n\t}\n\n\tchart.update();\n};\n",null],"names":["_objectSpread","t","module","default","export","drawLineChart","drawDoughnutChart","updateChart","lineChartConfiguration","_ref","legends","anim","tooltipCallbacks","config","layout","padding","top","bottom","legend","display","plugins","tooltip","usePointStyle","enabled","mode","yAlign","displayColors","scales","xAxis","title","grid","color","yAxis","hover","intersect","responsive","maintainAspectRatio","animation","duration","labels","boxWidth","fontSize","doughnutChartConfiguration","arguments","length","undefined","position","text","chart","chartContext","chartLabels","dataLabels","dataSets","options","console","error","destroy","colors","datasets","forEach","chartLabel","index","push","label","data","backgroundColor","borderColor","borderWidth","fill","chartjs","dynamicImport","Chart","type","dataPoints","c","_chart$data","_chart$data$labels","_chart$data2","_chart$data2$labels","indexOf","dataset","idx","update"],"mappings":"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"}