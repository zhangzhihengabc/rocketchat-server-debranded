)]}'
{"version":3,"sources":["meteor://ðŸ’»app/app/discussion/client/createDiscussionMessageAction.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { Tracker } from 'meteor/tracker';\n\nimport CreateDiscussion from '../../../client/components/CreateDiscussion/CreateDiscussion';\nimport { imperativeModal } from '../../../client/lib/imperativeModal';\nimport { roomCoordinator } from '../../../client/lib/rooms/roomCoordinator';\nimport { messageArgs } from '../../../client/lib/utils/messageArgs';\nimport { hasPermission } from '../../authorization/client';\nimport { settings } from '../../settings/client';\nimport { MessageAction } from '../../ui-utils/client';\n\nMeteor.startup(() => {\n\tTracker.autorun(() => {\n\t\tif (!settings.get('Discussion_enabled')) {\n\t\t\treturn MessageAction.removeButton('start-discussion');\n\t\t}\n\n\t\tMessageAction.addButton({\n\t\t\tid: 'start-discussion',\n\t\t\ticon: 'discussion',\n\t\t\tlabel: 'Discussion_start',\n\t\t\ttype: 'communication',\n\t\t\tcontext: ['message', 'message-mobile', 'videoconf'],\n\t\t\tasync action(_, props) {\n\t\t\t\tconst { message = messageArgs(this).msg, room } = props;\n\n\t\t\t\timperativeModal.open({\n\t\t\t\t\tcomponent: CreateDiscussion,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tdefaultParentRoom: room?.prid || room?._id,\n\t\t\t\t\t\tonClose: imperativeModal.close,\n\t\t\t\t\t\tparentMessageId: message._id,\n\t\t\t\t\t\tnameSuggestion: message?.msg?.substr(0, 140),\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t\tcondition({\n\t\t\t\tmessage: {\n\t\t\t\t\tu: { _id: uid },\n\t\t\t\t\tdrid,\n\t\t\t\t\tdcount,\n\t\t\t\t},\n\t\t\t\troom,\n\t\t\t\tsubscription,\n\t\t\t\tuser,\n\t\t\t}) {\n\t\t\t\tif (drid || !Number.isNaN(dcount)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (!subscription) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst isLivechatRoom = roomCoordinator.isLivechatRoom(room.t);\n\t\t\t\tif (isLivechatRoom) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (!user) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn uid !== user._id ? hasPermission('start-discussion-other-user', room._id) : hasPermission('start-discussion', room._id);\n\t\t\t},\n\t\t\torder: 1,\n\t\t\tgroup: 'menu',\n\t\t});\n\t});\n});\n",null],"names":["Meteor","Tracker","CreateDiscussion","imperativeModal","roomCoordinator","messageArgs","hasPermission","settings","MessageAction","module","link","default","startup","autorun","get","removeButton","addButton","id","icon","label","type","context","action","_","props","_message$msg","message","msg","room","open","component","defaultParentRoom","prid","_id","onClose","close","parentMessageId","nameSuggestion","substr","condition","_ref","u","uid","drid","dcount","subscription","user","Number","isNaN","isLivechatRoom","t","order","group"],"mappings":"2BAAAA,EAAuCC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA9BC,EAAQC,IAAA,CAAM,gBAAgB,CAAAV,OAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAS,EAAAA,IAAAA,CAAAA,iBAAAA,CAAAR,QAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAQ,EAAAA,IAAAA,CAAAA,+DAAAA,CAAAE,QAAAA,CAAAA,EAAAT,EAAAA,CAAA,CAAA,EAAA,GAAAO,EAAAA,IAAAA,CAAAA,sCAAAA,CAAAN,gBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,4CAAAA,CAAAL,gBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAK,EAAAA,IAAAA,CAAAA,wCAAAA,CAAAJ,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,6BAAAA,CAAAH,cAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAF,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAD,cAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAWvCR,EAAOY,OAAO,CAAC,KACdX,EAAQY,OAAO,CAAC,KACf,GAAI,CAACN,EAASO,GAAG,CAAC,sBACjB,OAAON,EAAcO,YAAY,CAAC,oBAGnCP,EAAcQ,SAAS,CAAC,CACvBC,GAAI,mBACJC,KAAM,aACNC,MAAO,mBACPC,KAAM,gBACNC,QAAS,CAAC,UAAW,iBAAkB,YAAY,CACnD,MAAMC,OAAOC,CAAC,CAAEC,CAAK,EAAA,IAAAC,EACpB,GAAM,CAAEC,QAAAA,EAAUrB,EAAY,IAAI,EAAEsB,GAAG,CAAEC,KAAAA,CAAAA,CAAM,CAAGJ,EAElDrB,EAAgB0B,IAAI,CAAC,CACpBC,UAAW5B,EACXsB,MAAO,CACNO,kBAAmB,AAAAH,CAAAA,MAAAA,EAAI,KAAA,EAAJA,EAAMI,IAAI,AAAJA,GAAQJ,CAAAA,MAAAA,EAAI,KAAA,EAAJA,EAAMK,GAAG,AAAHA,EACvCC,QAAS/B,EAAgBgC,KAAK,CAC9BC,gBAAiBV,EAAQO,GAAG,CAC5BI,eAAgBX,MAAAA,EAAO,KAAA,EAAA,AAAK,OAALD,CAAAA,EAAPC,EAASC,GAAG,AAAHA,GAAGF,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAZA,EAAca,MAAM,CAAC,EAAG,OAG3C,EACAC,UAASC,CAAA,EASR,GATS,CACTd,QAAS,CACRe,EAAG,CAAER,IAAKS,CAAAA,CAAK,CACfC,KAAAA,CAAI,CACJC,OAAAA,CAAAA,CACA,CACDhB,KAAAA,CAAI,CACJiB,aAAAA,CAAY,CACZC,KAAAA,CAAAA,CACA,CAAAN,EACA,GAAIG,GAAQ,CAACI,OAAOC,KAAK,CAACJ,IAGtB,CAACC,EAFJ,MAAO,CAAA,EAKR,IAAMI,EAAiB7C,EAAgB6C,cAAc,CAACrB,EAAKsB,CAAC,QAC5D,CAAID,IAIA,CAACH,GAIEJ,CAAAA,IAAQI,EAAKb,GAAG,CAAG3B,EAAc,8BAA+BsB,EAAKK,GAAG,EAAI3B,EAAc,mBAAoBsB,EAAKK,GAAG,CAAA,CAC9H,EACAkB,MAAO,EACPC,MAAO,QAET,EACD"}