)]}'
{"version":3,"sources":["meteor://ðŸ’»app/app/wordpress/client/lib.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { OauthConfig } from '@rocket.chat/core-typings';\nimport { Meteor } from 'meteor/meteor';\nimport { Tracker } from 'meteor/tracker';\nimport _ from 'underscore';\n\nimport { CustomOAuth } from '../../custom-oauth/client/custom_oauth_client';\nimport { settings } from '../../settings/client';\n\nconst config: OauthConfig = {\n\tserverURL: '',\n\tidentityPath: '/oauth/me',\n\n\taddAutopublishFields: {\n\t\tforLoggedInUser: ['services.wordpress'],\n\t\tforOtherUsers: ['services.wordpress.user_login'],\n\t},\n\taccessTokenParam: 'access_token',\n};\n\nconst WordPress = new CustomOAuth('wordpress', config);\n\nconst fillSettings = _.debounce(async (): Promise<void> => {\n\tconfig.serverURL = settings.get('API_Wordpress_URL');\n\tif (!config.serverURL) {\n\t\tif (config.serverURL === undefined) {\n\t\t\treturn fillSettings();\n\t\t}\n\t\treturn;\n\t}\n\n\tdelete config.identityPath;\n\tdelete config.identityTokenSentVia;\n\tdelete config.authorizePath;\n\tdelete config.tokenPath;\n\tdelete config.scope;\n\n\tconst serverType = settings.get('Accounts_OAuth_Wordpress_server_type');\n\tswitch (serverType) {\n\t\tcase 'custom':\n\t\t\tif (settings.get('Accounts_OAuth_Wordpress_identity_path')) {\n\t\t\t\tconfig.identityPath = settings.get('Accounts_OAuth_Wordpress_identity_path');\n\t\t\t}\n\n\t\t\tif (settings.get('Accounts_OAuth_Wordpress_identity_token_sent_via')) {\n\t\t\t\tconfig.identityTokenSentVia = settings.get('Accounts_OAuth_Wordpress_identity_token_sent_via');\n\t\t\t}\n\n\t\t\tif (settings.get('Accounts_OAuth_Wordpress_token_path')) {\n\t\t\t\tconfig.tokenPath = settings.get('Accounts_OAuth_Wordpress_token_path');\n\t\t\t}\n\n\t\t\tif (settings.get('Accounts_OAuth_Wordpress_authorize_path')) {\n\t\t\t\tconfig.authorizePath = settings.get('Accounts_OAuth_Wordpress_authorize_path');\n\t\t\t}\n\n\t\t\tif (settings.get('Accounts_OAuth_Wordpress_scope')) {\n\t\t\t\tconfig.scope = settings.get('Accounts_OAuth_Wordpress_scope');\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'wordpress-com':\n\t\t\tconfig.identityPath = 'https://public-api.wordpress.com/rest/v1/me';\n\t\t\tconfig.identityTokenSentVia = 'header';\n\t\t\tconfig.authorizePath = 'https://public-api.wordpress.com/oauth2/authorize';\n\t\t\tconfig.tokenPath = 'https://public-api.wordpress.com/oauth2/token';\n\t\t\tconfig.scope = 'auth';\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tconfig.identityPath = '/oauth/me';\n\t\t\tbreak;\n\t}\n\n\tconst result = WordPress.configure(config);\n\treturn result;\n}, 100);\n\nMeteor.startup(() => {\n\treturn Tracker.autorun(() => {\n\t\treturn fillSettings();\n\t});\n});\n",null],"names":["Meteor","Tracker","_","CustomOAuth","settings","module","link","default","config","serverURL","identityPath","addAutopublishFields","forLoggedInUser","forOtherUsers","accessTokenParam","WordPress","fillSettings","debounce","get","undefined","identityTokenSentVia","authorizePath","tokenPath","scope","serverType","result","configure","startup","autorun"],"mappings":"2BACAA,EAAuCC,EAAAC,EAAAC,EAAAC,EAA9BC,EAAQC,IAAA,CAAM,gBAAgB,CAAAN,OAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAK,EAAAA,IAAAA,CAAAA,iBAAAA,CAAAJ,QAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,aAAAA,CAAAE,QAAAA,CAAAA,EAAAL,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,gDAAAA,CAAAF,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAD,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAOvC,IAAMI,EAAsB,CAC3BC,UAAW,GACXC,aAAc,YAEdC,qBAAsB,CACrBC,gBAAiB,CAAC,qBAAqB,CACvCC,cAAe,CAAC,gCAA+B,EAEhDC,iBAAkB,gBAGbC,EAAY,IAAIZ,EAAY,YAAaK,GAEzCQ,EAAed,EAAEe,QAAQ,CAAC,UAE/B,GADAT,EAAOC,SAAS,CAAGL,EAASc,GAAG,CAAC,qBAC5B,CAACV,EAAOC,SAAS,QACpB,AAAID,AAAqBW,KAAAA,IAArBX,EAAOC,SAAS,CACZO,IAER,KAAA,CAGD,QAAOR,EAAOE,YAAY,CAC1B,OAAOF,EAAOY,oBAAoB,CAClC,OAAOZ,EAAOa,aAAa,CAC3B,OAAOb,EAAOc,SAAS,CACvB,OAAOd,EAAOe,KAAK,CAEnB,IAAMC,EAAapB,EAASc,GAAG,CAAC,wCAChC,OAAQM,GACP,IAAK,SACApB,EAASc,GAAG,CAAC,2CAChBV,CAAAA,EAAOE,YAAY,CAAGN,EAASc,GAAG,CAAC,yCAAwC,EAGxEd,EAASc,GAAG,CAAC,qDAChBV,CAAAA,EAAOY,oBAAoB,CAAGhB,EAASc,GAAG,CAAC,mDAAkD,EAG1Fd,EAASc,GAAG,CAAC,wCAChBV,CAAAA,EAAOc,SAAS,CAAGlB,EAASc,GAAG,CAAC,sCAAqC,EAGlEd,EAASc,GAAG,CAAC,4CAChBV,CAAAA,EAAOa,aAAa,CAAGjB,EAASc,GAAG,CAAC,0CAAyC,EAG1Ed,EAASc,GAAG,CAAC,mCAChBV,CAAAA,EAAOe,KAAK,CAAGnB,EAASc,GAAG,CAAC,iCAAgC,EAE7D,KACD,KAAK,gBACJV,EAAOE,YAAY,CAAG,8CACtBF,EAAOY,oBAAoB,CAAG,SAC9BZ,EAAOa,aAAa,CAAG,oDACvBb,EAAOc,SAAS,CAAG,gDACnBd,EAAOe,KAAK,CAAG,OACf,KACD,SACCf,EAAOE,YAAY,CAAG,WAChB,CAGR,IAAMe,EAASV,EAAUW,SAAS,CAAClB,GACnC,OAAOiB,CACR,EAAG,KAEHzB,EAAO2B,OAAO,CAAC,IACP1B,EAAQ2B,OAAO,CAAC,IACfZ"}