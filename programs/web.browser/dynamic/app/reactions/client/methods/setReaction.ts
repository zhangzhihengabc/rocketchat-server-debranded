function module(e,n,t){let i,r,s,a,o,c,l;t.link("meteor/meteor",{Meteor(e){i=e}},0),t.link("../../../../client/lib/rooms/roomCoordinator",{roomCoordinator(e){r=e}},1),t.link("../../../../lib/callbacks",{callbacks(e){s=e}},2),t.link("../../../emoji/client",{emoji(e){a=e}},3),t.link("../../../models/client",{Messages(e){o=e},ChatRoom(e){c=e},Subscriptions(e){l=e}},4),i.methods({async setReaction(e,n){var t;if(!i.userId())throw new i.Error(203,"User_logged_out");let u=i.user();if(!(null!=u&&u.username))return!1;let d=o.findOne({_id:n});if(!d)return!1;let m=c.findOne({_id:d.rid});if(!m||d.private||!a.list[e]||r.readOnly(m._id,u)||!l.findOne({rid:d.rid}))return!1;null!==(t=d.reactions)&&void 0!==t&&t[e]&&-1!==d.reactions[e].usernames.indexOf(u.username)?(d.reactions[e].usernames.splice(d.reactions[e].usernames.indexOf(u.username),1),0===d.reactions[e].usernames.length&&delete d.reactions[e],d.reactions&&"object"==typeof d.reactions&&0!==Object.keys(d.reactions).length?(o.update({_id:n},{$set:{reactions:d.reactions}}),await s.run("setReaction",n,e)):(delete d.reactions,o.update({_id:n},{$unset:{reactions:1}}),await s.run("unsetReaction",n,e))):(d.reactions||(d.reactions={}),d.reactions[e]||(d.reactions[e]={usernames:[]}),d.reactions[e].usernames.push(u.username),o.update({_id:n},{$set:{reactions:d.reactions}}),await s.run("setReaction",n,e))}})}
//# sourceMappingURL=/dynamic/app/reactions/client/methods/ad7739e1e6981215dcd0b15c4d826b51bcf42e09.map
