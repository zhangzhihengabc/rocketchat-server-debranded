)]}'
{"version":3,"sources":["meteor://ðŸ’»app/app/threads/client/messageAction/unfollow.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { Tracker } from 'meteor/tracker';\n\nimport { dispatchToastMessage } from '../../../../client/lib/toast';\nimport { callWithErrorHandling } from '../../../../client/lib/utils/callWithErrorHandling';\nimport { Messages } from '../../../models/client';\nimport { settings } from '../../../settings/client';\nimport { MessageAction } from '../../../ui-utils/client';\nimport { t } from '../../../utils/lib/i18n';\n\nMeteor.startup(() => {\n\tTracker.autorun(() => {\n\t\tif (!settings.get('Threads_enabled')) {\n\t\t\treturn MessageAction.removeButton('unfollow-message');\n\t\t}\n\t\tMessageAction.addButton({\n\t\t\tid: 'unfollow-message',\n\t\t\ticon: 'bell-off',\n\t\t\tlabel: 'Unfollow_message',\n\t\t\ttype: 'interaction',\n\t\t\tcontext: ['message', 'message-mobile', 'threads', 'federated', 'videoconf', 'videoconf-threads'],\n\t\t\tasync action(_, { message }) {\n\t\t\t\tif (!message) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tawait callWithErrorHandling('unfollowMessage', { mid: message._id });\n\t\t\t\tdispatchToastMessage({\n\t\t\t\t\ttype: 'success',\n\t\t\t\t\tmessage: t('You_unfollowed_this_message'),\n\t\t\t\t});\n\t\t\t},\n\t\t\tcondition({ message: { _id, tmid, replies = [] }, user, context }) {\n\t\t\t\tif (tmid || context) {\n\t\t\t\t\tconst parentMessage = Messages.findOne({ _id: tmid || _id }, { fields: { replies: 1 } });\n\t\t\t\t\tif (parentMessage) {\n\t\t\t\t\t\treplies = parentMessage.replies || [];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn user?._id ? replies.includes(user._id) : false;\n\t\t\t},\n\t\t\torder: 2,\n\t\t\tgroup: 'menu',\n\t\t});\n\t});\n});\n",null],"names":["Meteor","Tracker","dispatchToastMessage","callWithErrorHandling","Messages","settings","MessageAction","t","module","link","startup","autorun","get","removeButton","addButton","id","icon","label","type","context","action","_","_ref","message","mid","_id","condition","_ref2","tmid","replies","user","parentMessage","findOne","fields","includes","order","group"],"mappings":"2BAAAA,EAAuCC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA9BC,EAAQC,IAAA,CAAM,gBAAgB,CAAAT,OAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAQ,EAAAA,IAAAA,CAAAA,iBAAAA,CAAAP,QAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAO,EAAAA,IAAAA,CAAAA,+BAAAA,CAAAN,qBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,qDAAAA,CAAAL,sBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAK,EAAAA,IAAAA,CAAAA,yBAAAA,CAAAJ,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAH,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAF,cAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,0BAAAA,CAAAD,EAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAUvCP,EAAOU,OAAO,CAAC,KACdT,EAAQU,OAAO,CAAC,KACf,GAAI,CAACN,EAASO,GAAG,CAAC,mBACjB,OAAON,EAAcO,YAAY,CAAC,oBAEnCP,EAAcQ,SAAS,CAAC,CACvBC,GAAI,mBACJC,KAAM,WACNC,MAAO,mBACPC,KAAM,cACNC,QAAS,CAAC,UAAW,iBAAkB,UAAW,YAAa,YAAa,oBAAoB,CAChG,MAAMC,OAAOC,CAAC,CAAAC,CAAA,EAAa,GAAX,CAAEC,QAAAA,CAAAA,CAAS,CAAAD,EACrBC,IAIL,MAAMpB,EAAsB,kBAAmB,CAAEqB,IAAKD,EAAQE,GAAAA,AAAG,GACjEvB,EAAqB,CACpBgB,KAAM,UACNK,QAAShB,EAAE,iCAEb,EACAmB,UAASC,CAAA,EAAwD,GAAvD,CAAEJ,QAAS,CAAEE,IAAAA,CAAG,CAAEG,KAAAA,CAAI,CAAEC,QAAAA,EAAU,EAAA,CAAI,CAAEC,KAAAA,CAAI,CAAEX,QAAAA,CAAAA,CAAS,CAAAQ,EAChE,GAAIC,GAAQT,EAAS,CACpB,IAAMY,EAAgB3B,EAAS4B,OAAO,CAAC,CAAEP,IAAKG,GAAQH,CAAG,EAAI,CAAEQ,OAAQ,CAAEJ,QAAS,CAAC,CAAE,GACjFE,GACHF,CAAAA,EAAUE,EAAcF,OAAO,EAAI,EAAE,AAAF,EAGrC,OAAOC,MAAAA,KAAAA,EAAML,GAAG,EAAGI,EAAQK,QAAQ,CAACJ,EAAKL,GAAG,CAC7C,EACAU,MAAO,EACPC,MAAO,QAET,EACD"}