)]}'
{"version":3,"sources":["meteor://ðŸ’»app/app/ui/client/lib/userCard.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { ComponentProps } from 'react';\nimport React, { Suspense, createElement, lazy } from 'react';\nimport { createPortal } from 'react-dom';\nimport { useSyncExternalStore } from 'use-sync-external-store/shim';\n\nimport { registerPortal } from '../../../../client/lib/portals/portalsSubscription';\nimport { queueMicrotask } from '../../../../client/lib/utils/queueMicrotask';\n\nconst UserCard = lazy(() => import('../../../../client/views/room/UserCard'));\n\ntype UserCardProps = ComponentProps<typeof UserCard>;\n\nlet props: UserCardProps;\n\nconst subscribers = new Set<() => void>();\n\nconst updateProps = (newProps: Partial<UserCardProps>) => {\n\tprops = { ...props, ...newProps };\n\tsubscribers.forEach((subscriber) => subscriber());\n};\n\nconst getProps = () => props;\n\nconst subscribeToProps = (callback: () => void) => {\n\tsubscribers.add(callback);\n\n\treturn () => {\n\t\tsubscribers.delete(callback);\n\t};\n};\n\nconst UserCardWithProps = () => {\n\tconst props = useSyncExternalStore(subscribeToProps, getProps);\n\n\treturn (\n\t\t<Suspense fallback={null}>\n\t\t\t<UserCard {...props} />\n\t\t</Suspense>\n\t);\n};\n\nconst createContainer = () => {\n\tconst container = document.createElement('div');\n\tcontainer.id = 'react-user-card';\n\tdocument.body.appendChild(container);\n\n\treturn container;\n};\n\nlet container: HTMLDivElement | undefined;\nlet unregisterPortal: (() => void) | undefined;\n\nexport const closeUserCard = () => {\n\tqueueMicrotask(() => {\n\t\tif (unregisterPortal) {\n\t\t\tunregisterPortal();\n\t\t\tunregisterPortal = undefined;\n\t\t}\n\t});\n};\n\nexport const openUserCard = (params: Omit<UserCardProps, 'onClose'>) => {\n\tupdateProps({ ...params, onClose: closeUserCard });\n\n\tif (!container) {\n\t\tcontainer = createContainer();\n\t}\n\n\tif (!unregisterPortal) {\n\t\tconst children = createElement(UserCardWithProps);\n\t\tconst portal = <>{createPortal(children, container)}</>;\n\t\tunregisterPortal = registerPortal(container, portal);\n\t}\n\n\treturn closeUserCard;\n};\n",null],"names":["_objectSpread","React","Suspense","createElement","lazy","createPortal","useSyncExternalStore","registerPortal","queueMicrotask","props","container","unregisterPortal","module","link","default","export","closeUserCard","openUserCard","UserCard","dynamicImport","subscribers","Set","updateProps","newProps","forEach","subscriber","getProps","subscribeToProps","callback","add","delete","UserCardWithProps","fallback","createContainer","document","id","body","appendChild","undefined","params","onClose","children","portal","Fragment"],"mappings":"2BACAA,EAA6DC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAWzDC,EAqCAC,EACAC,EAjDYC,EAAQC,IAAE,CAAA,uCAAmC,CAAAC,QAAAA,CAAAA,EAAAd,EAAAA,CAAA,CAAA,EAAA,GAA7DY,EAAOG,MAAK,CAAE,CAAAC,cAAY,IAAAA,EAAqBC,aAAa,IAACA,CAAA,GAAAL,EAAAA,IAAAA,CAAAA,QAAAA,CAAAE,QAAAA,CAAAA,EAAAb,EAAAA,CAAA,EAAAC,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,cAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,KAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAQ,EAAAA,IAAAA,CAAAA,YAAAA,CAAAP,aAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAO,EAAAA,IAAAA,CAAAA,+BAAAA,CAAAN,qBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,qDAAAA,CAAAL,eAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAK,EAAAA,IAAAA,CAAAA,8CAAAA,CAAAJ,eAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAO7D,IAAMU,EAAWd,EAAK,IAAMQ,EAAAO,aAAA,CAAO,2CAM7BC,EAAc,IAAIC,IAElBC,EAAeC,IACpBd,EAAKT,EAAAA,EAAA,CAAA,EAAQS,GAAUc,GACvBH,EAAYI,OAAO,CAAEC,GAAeA,IACrC,EAEMC,EAAW,IAAMjB,EAEjBkB,EAAoBC,IACzBR,EAAYS,GAAG,CAACD,GAET,KACNR,EAAYU,MAAM,CAACF,EACpB,GAGKG,EAAoB,KACzB,IAAMtB,EAAQH,EAAqBqB,EAAkBD,GAErD,OACCzB,EAAAE,aAAA,CAACD,EAAQ,CAAC8B,SAAU,IAAK,EACxB/B,EAAAE,aAAA,CAACe,EAAaT,GAGjB,EAEMwB,EAAkB,KACvB,IAAMvB,EAAYwB,SAAS/B,aAAa,CAAC,OAIzC,OAHAO,EAAUyB,EAAE,CAAG,kBACfD,SAASE,IAAI,CAACC,WAAW,CAAC3B,GAEnBA,CACR,EAKaM,EAAgB,KAC5BR,EAAe,KACVG,IACHA,IACAA,EAAmB2B,KAAAA,EAErB,EACD,EAEarB,EAAgBsB,IAO5B,GANAjB,EAAWtB,EAAAA,EAAA,CAAA,EAAMuC,GAAM,CAAA,EAAA,CAAEC,QAASxB,CAAa,IAE1CN,GACJA,CAAAA,EAAYuB,GAAe,EAGxB,CAACtB,EAAkB,CACtB,IAAM8B,EAAWtC,EAAc4B,GACzBW,EAASzC,EAAAE,aAAA,CAAAF,EAAA0C,QAAA,CAAA,KAAGtC,EAAaoC,EAAU/B,IACzCC,EAAmBJ,EAAeG,EAAWgC,GAG9C,OAAO1B,CACR"}