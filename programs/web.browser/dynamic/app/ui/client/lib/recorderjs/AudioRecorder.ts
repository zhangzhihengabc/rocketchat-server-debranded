function module(t,e,o){let i,s;o.export({AudioRecorder:()=>r}),o.link("../../../../settings/client",{settings(t){i=t}},0),o.link("./AudioEncoder",{AudioEncoder(t){s=t}},1);class r{constructor(){this.audioContext=void 0,this.stream=void 0,this.encoder=void 0}isSupported(){var t;return!!(null===(t=navigator.mediaDevices)||void 0===t?void 0:t.getUserMedia)&&!!AudioContext}createAudioContext(){this.audioContext||(this.audioContext=new AudioContext)}destroyAudioContext(){this.audioContext&&(this.audioContext.close(),delete this.audioContext)}async createStream(){this.stream||(this.stream=await navigator.mediaDevices.getUserMedia({audio:!0}))}destroyStream(){this.stream&&(this.stream.getAudioTracks().forEach(t=>t.stop()),delete this.stream)}async createEncoder(){var t;if(this.encoder||!this.audioContext||!this.stream)return;let e=null===(t=this.audioContext)||void 0===t?void 0:t.createMediaStreamSource(this.stream);this.encoder=new s(e,{bitRate:i.get("Message_Audio_bitRate")||32})}destroyEncoder(){this.encoder&&(this.encoder.close(),delete this.encoder)}async start(t){try{this.createAudioContext(),await this.createStream(),await this.createEncoder(),null==t||t.call(this,!0)}catch(e){throw console.error(e),this.destroyEncoder(),this.destroyStream(),this.destroyAudioContext(),null==t||t.call(this,!1),e}}stop(t){var e,o;null===(e=this.encoder)||void 0===e||e.on("encoded",t),null===(o=this.encoder)||void 0===o||o.close(),this.destroyEncoder(),this.destroyStream(),this.destroyAudioContext()}}}
//# sourceMappingURL=/dynamic/app/ui/client/lib/recorderjs/24bf18ab453cd5a8bf7e2388aa365ebbb0d90357.map
