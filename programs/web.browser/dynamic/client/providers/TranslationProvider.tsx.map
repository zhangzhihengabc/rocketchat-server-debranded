)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/providers/TranslationProvider.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useLocalStorage, useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport languages from '@rocket.chat/i18n/dist/languages';\nimport en from '@rocket.chat/i18n/src/locales/en.i18n.json';\nimport { normalizeLanguage } from '@rocket.chat/tools';\nimport type { TranslationKey, TranslationContextValue } from '@rocket.chat/ui-contexts';\nimport { useMethod, useSetting, TranslationContext } from '@rocket.chat/ui-contexts';\nimport type i18next from 'i18next';\nimport I18NextHttpBackend from 'i18next-http-backend';\nimport sprintf from 'i18next-sprintf-postprocessor';\nimport moment from 'moment';\nimport type { ReactElement, ReactNode } from 'react';\nimport React, { useEffect, useMemo } from 'react';\nimport { I18nextProvider, initReactI18next, useTranslation } from 'react-i18next';\n\nimport { CachedCollectionManager } from '../../app/ui-cached-collection/client';\nimport { getURL } from '../../app/utils/client';\nimport { i18n, addSprinfToI18n } from '../../app/utils/lib/i18n';\nimport { AppClientOrchestratorInstance } from '../../ee/client/apps/orchestrator';\nimport { applyCustomTranslations } from '../lib/utils/applyCustomTranslations';\nimport { isRTLScriptLanguage } from '../lib/utils/isRTLScriptLanguage';\n\ni18n.use(I18NextHttpBackend).use(initReactI18next).use(sprintf);\n\ntype TranslationNamespace = Extract<TranslationKey, `${string}.${string}`> extends `${infer T}.${string}`\n\t? T extends Lowercase<T>\n\t\t? T\n\t\t: never\n\t: never;\n\nconst namespacesDefault = ['core', 'onboarding', 'registration', 'cloud'] as TranslationNamespace[];\n\nconst parseToJSON = (customTranslations: string): Record<string, Record<string, string>> | false => {\n\ttry {\n\t\treturn JSON.parse(customTranslations);\n\t} catch (e) {\n\t\treturn false;\n\t}\n};\n\nconst localeCache = new Map<string, Promise<string>>();\n\nconst useI18next = (lng: string): typeof i18next => {\n\tconst customTranslations = useSetting('Custom_Translations');\n\n\tconst parsedCustomTranslations = useMemo(() => {\n\t\tif (!customTranslations || typeof customTranslations !== 'string') {\n\t\t\treturn;\n\t\t}\n\n\t\treturn parseToJSON(customTranslations);\n\t}, [customTranslations]);\n\n\tconst extractKeys = useMutableCallback(\n\t\t(source: Record<string, string>, lngs?: string | string[], namespaces: string | string[] = []): { [key: string]: any } => {\n\t\t\tconst result: { [key: string]: any } = {};\n\n\t\t\tfor (const [key, value] of Object.entries(source)) {\n\t\t\t\tconst [prefix] = key.split('.');\n\n\t\t\t\tif (prefix && Array.isArray(namespaces) ? namespaces.includes(prefix) : prefix === namespaces) {\n\t\t\t\t\tresult[key.slice(prefix.length + 1)] = value;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (Array.isArray(namespaces) ? namespaces.includes('core') : namespaces === 'core') {\n\t\t\t\t\tresult[key] = value;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (lngs && parsedCustomTranslations) {\n\t\t\t\tfor (const language of Array.isArray(lngs) ? lngs : [lngs]) {\n\t\t\t\t\tif (!parsedCustomTranslations[language]) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (const [key, value] of Object.entries(parsedCustomTranslations[language])) {\n\t\t\t\t\t\tconst prefix = (Array.isArray(namespaces) ? namespaces : [namespaces]).find((namespace) => key.startsWith(`${namespace}.`));\n\n\t\t\t\t\t\tif (prefix) {\n\t\t\t\t\t\t\tresult[key.slice(prefix.length + 1)] = value;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (Array.isArray(namespaces) ? namespaces.includes('core') : namespaces === 'core') {\n\t\t\t\t\t\t\tresult[key] = value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t);\n\n\tif (!i18n.isInitialized) {\n\t\ti18n.init({\n\t\t\tlng,\n\t\t\tfallbackLng: 'en',\n\t\t\tns: namespacesDefault,\n\t\t\tnsSeparator: '.',\n\t\t\tresources: {\n\t\t\t\ten: extractKeys(en),\n\t\t\t},\n\t\t\tpartialBundledLanguages: true,\n\t\t\tdefaultNS: 'core',\n\t\t\tbackend: {\n\t\t\t\tloadPath: 'i18n/{{lng}}.json',\n\t\t\t\tparse: (data: string, lngs?: string | string[], namespaces: string | string[] = []) =>\n\t\t\t\t\textractKeys(JSON.parse(data), lngs, namespaces),\n\t\t\t\trequest: (_options, url, _payload, callback) => {\n\t\t\t\t\tconst params = url.split('/');\n\n\t\t\t\t\tconst lng = params[params.length - 1];\n\n\t\t\t\t\tlet promise = localeCache.get(lng);\n\n\t\t\t\t\tif (!promise) {\n\t\t\t\t\t\tpromise = fetch(getURL(url)).then((res) => res.text());\n\t\t\t\t\t\tlocaleCache.set(lng, promise);\n\t\t\t\t\t}\n\n\t\t\t\t\tpromise.then(\n\t\t\t\t\t\t(res) => callback(null, { data: res, status: 200 }),\n\t\t\t\t\t\t() => callback(null, { data: '', status: 500 }),\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t},\n\t\t\treact: {\n\t\t\t\tuseSuspense: true,\n\t\t\t\tbindI18n: 'languageChanged loaded',\n\t\t\t\tbindI18nStore: 'added removed',\n\t\t\t},\n\t\t\tinterpolation: {\n\t\t\t\tescapeValue: false,\n\t\t\t},\n\t\t});\n\t}\n\n\tuseEffect(() => {\n\t\tif (i18n.language !== lng) {\n\t\t\ti18n.changeLanguage(lng);\n\t\t}\n\t}, [lng]);\n\n\tuseEffect(() => {\n\t\tif (!parsedCustomTranslations) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const [ln, translations] of Object.entries(parsedCustomTranslations)) {\n\t\t\tif (!translations) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst namespaces = Object.entries(translations).reduce((acc, [key, value]): Record<string, Record<string, string>> => {\n\t\t\t\tconst namespace = key.split('.')[0];\n\n\t\t\t\tif (namespacesDefault.includes(namespace as unknown as TranslationNamespace)) {\n\t\t\t\t\tacc[namespace] = acc[namespace] ?? {};\n\t\t\t\t\tacc[namespace][key] = value;\n\t\t\t\t\tacc[namespace][key.slice(namespace.length + 1)] = value;\n\t\t\t\t\treturn acc;\n\t\t\t\t}\n\t\t\t\tacc.project = acc.project ?? {};\n\t\t\t\tacc.project[key] = value;\n\t\t\t\treturn acc;\n\t\t\t}, {} as Record<string, Record<string, string>>);\n\n\t\t\tfor (const [namespace, translations] of Object.entries(namespaces)) {\n\t\t\t\ti18n.addResourceBundle(ln, namespace, translations);\n\t\t\t}\n\t\t}\n\t}, [parsedCustomTranslations]);\n\n\treturn i18n;\n};\n\ntype TranslationProviderProps = {\n\tchildren: ReactNode;\n};\n\nconst useAutoLanguage = () => {\n\tconst serverLanguage = useSetting<string>('Language');\n\tconst browserLanguage = normalizeLanguage(window.navigator.userLanguage ?? window.navigator.language);\n\tconst defaultUserLanguage = browserLanguage || serverLanguage || 'en';\n\n\t// if the language is supported, if not remove the region\n\tconst suggestedLanguage = languages.includes(defaultUserLanguage) ? defaultUserLanguage : defaultUserLanguage.split('-').shift() ?? 'en';\n\n\t// usually that value is set based on the user's config language\n\tconst [language] = useLocalStorage('userLanguage', suggestedLanguage);\n\n\tdocument.documentElement.classList[isRTLScriptLanguage(language) ? 'add' : 'remove']('rtl');\n\tdocument.documentElement.setAttribute('dir', isRTLScriptLanguage(language) ? 'rtl' : 'ltr');\n\tdocument.documentElement.lang = language;\n\n\t// if user has no language set, we should set it to the default language\n\treturn language || suggestedLanguage;\n};\n\nconst getLanguageName = (code: string, lng: string): string => {\n\ttry {\n\t\tconst lang = new Intl.DisplayNames([lng], { type: 'language' });\n\t\treturn lang.of(code) ?? code;\n\t} catch (e) {\n\t\treturn code;\n\t}\n};\n\nconst TranslationProvider = ({ children }: TranslationProviderProps): ReactElement => {\n\tconst loadLocale = useMethod('loadLocale');\n\n\tconst language = useAutoLanguage();\n\tconst i18nextInstance = useI18next(language);\n\tconst availableLanguages = useMemo(\n\t\t() => [\n\t\t\t{\n\t\t\t\ten: 'Default',\n\t\t\t\tname: i18nextInstance.t('Default'),\n\t\t\t\togName: i18nextInstance.t('Default'),\n\t\t\t\tkey: '',\n\t\t\t},\n\t\t\t...[...new Set([...i18nextInstance.languages, ...languages])].map((key) => ({\n\t\t\t\ten: key,\n\t\t\t\tname: getLanguageName(key, language),\n\t\t\t\togName: getLanguageName(key, key),\n\t\t\t\tkey,\n\t\t\t})),\n\t\t],\n\t\t[language, i18nextInstance],\n\t);\n\n\tuseEffect(() => {\n\t\tif (moment.locales().includes(language.toLowerCase())) {\n\t\t\tmoment.locale(language);\n\t\t\treturn;\n\t\t}\n\n\t\tconst locale = !availableLanguages.find((lng) => lng.key === language) ? language.split('-').shift() : language;\n\n\t\tloadLocale(locale ?? language)\n\t\t\t.then((localeSrc) => {\n\t\t\t\tlocaleSrc && Function(localeSrc).call({ moment });\n\t\t\t\tmoment.locale(language);\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tmoment.locale('en');\n\t\t\t\tconsole.error('Error loading moment locale:', error);\n\t\t\t});\n\t}, [language, loadLocale, availableLanguages]);\n\n\tuseEffect(() => {\n\t\tconst cb = () => {\n\t\t\tAppClientOrchestratorInstance.getAppClientManager().initialize();\n\t\t\tAppClientOrchestratorInstance.load();\n\t\t};\n\t\tCachedCollectionManager.onLogin(cb);\n\t\treturn () => CachedCollectionManager.off('login', cb);\n\t}, []);\n\n\treturn (\n\t\t<I18nextProvider i18n={i18nextInstance}>\n\t\t\t<TranslationProviderInner children={children} availableLanguages={availableLanguages} />\n\t\t</I18nextProvider>\n\t);\n};\n\n/**\n * I was forced to create this component to keep the api useTranslation from rocketchat\n * rocketchat useTranslation invalidates the provider content, triggering all the places that use it\n * i18next triggers a re-render inside useTranslation, since now we are using 100% of the i18next\n * the only way to invalidate after changing the language in a safe way is using the useTranslation from i8next\n * and invalidating the provider content\n */\n// eslint-disable-next-line react/no-multi-comp\nconst TranslationProviderInner = ({\n\tchildren,\n\tavailableLanguages,\n}: {\n\tchildren: ReactNode;\n\tavailableLanguages: {\n\t\ten: string;\n\t\tname: string;\n\t\togName: string;\n\t\tkey: string;\n\t}[];\n}): ReactElement => {\n\tconst { t, i18n } = useTranslation();\n\n\tconst value: TranslationContextValue = useMemo(\n\t\t() => ({\n\t\t\tlanguage: i18n.language,\n\t\t\tlanguages: availableLanguages,\n\t\t\tloadLanguage: async (language: string): Promise<void> => {\n\t\t\t\ti18n.changeLanguage(language).then(() => applyCustomTranslations());\n\t\t\t},\n\t\t\ttranslate: Object.assign(addSprinfToI18n(t), {\n\t\t\t\thas: ((key, options) => key && i18n.exists(key, options)) as TranslationContextValue['translate']['has'],\n\t\t\t}),\n\t\t}),\n\t\t[availableLanguages, i18n, t],\n\t);\n\n\treturn <TranslationContext.Provider children={children} value={value} />;\n};\n\nexport default TranslationProvider;\n",null],"names":["useLocalStorage","useMutableCallback","languages","en","normalizeLanguage","useMethod","useSetting","TranslationContext","I18NextHttpBackend","sprintf","moment","React","useEffect","useMemo","I18nextProvider","initReactI18next","useTranslation","CachedCollectionManager","getURL","i18n","addSprinfToI18n","AppClientOrchestratorInstance","applyCustomTranslations","isRTLScriptLanguage","module","link","default","use","namespacesDefault","parseToJSON","customTranslations","JSON","parse","e","localeCache","Map","useI18next","lng","parsedCustomTranslations","extractKeys","source","lngs","namespaces","result","key","value","Object","entries","prefix","split","Array","isArray","includes","slice","length","language","find","namespace","startsWith","concat","isInitialized","init","fallbackLng","ns","nsSeparator","resources","partialBundledLanguages","defaultNS","backend","loadPath","data","request","_options","url","_payload","callback","params","promise","get","fetch","then","res","text","set","status","react","useSuspense","bindI18n","bindI18nStore","interpolation","escapeValue","changeLanguage","ln","translations","reduce","acc","_ref","_acc$project","_acc$namespace","project","addResourceBundle","useAutoLanguage","_window$navigator$use","_defaultUserLanguage$","serverLanguage","browserLanguage","window","navigator","userLanguage","defaultUserLanguage","suggestedLanguage","shift","document","documentElement","classList","setAttribute","lang","getLanguageName","code","_lang$of","Intl","DisplayNames","type","of","TranslationProviderInner","_ref3","children","availableLanguages","t","loadLanguage","translate","assign","has","options","exists","createElement","Provider","exportDefault","_ref2","loadLocale","i18nextInstance","name","ogName","Set","map","locales","toLowerCase","locale","localeSrc","Function","call","catch","error","console","cb","getAppClientManager","initialize","load","onLogin","off"],"mappings":"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"}