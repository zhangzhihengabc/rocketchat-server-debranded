)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/providers/VideoConfProvider.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IRoom } from '@rocket.chat/core-typings';\nimport type { ReactElement, ReactNode } from 'react';\nimport React, { useState, useMemo, useEffect } from 'react';\nimport type { Unsubscribe } from 'use-subscription';\n\nimport type { VideoConfPopupPayload } from '../contexts/VideoConfContext';\nimport { VideoConfContext } from '../contexts/VideoConfContext';\nimport type { DirectCallData, ProviderCapabilities, CallPreferences } from '../lib/VideoConfManager';\nimport { VideoConfManager } from '../lib/VideoConfManager';\nimport VideoConfPopups from '../views/room/contextualBar/VideoConference/VideoConfPopups';\nimport { useVideoConfOpenCall } from '../views/room/contextualBar/VideoConference/hooks/useVideoConfOpenCall';\n\nconst VideoConfContextProvider = ({ children }: { children: ReactNode }): ReactElement => {\n\tconst [outgoing, setOutgoing] = useState<VideoConfPopupPayload | undefined>();\n\tconst handleOpenCall = useVideoConfOpenCall();\n\n\tuseEffect(\n\t\t() =>\n\t\t\tVideoConfManager.on('call/join', (props) => {\n\t\t\t\thandleOpenCall(props.url, props.providerName);\n\t\t\t}),\n\t\t[handleOpenCall],\n\t);\n\n\tuseEffect(() => {\n\t\tVideoConfManager.on('direct/stopped', () => setOutgoing(undefined));\n\t\tVideoConfManager.on('calling/ended', () => setOutgoing(undefined));\n\t}, []);\n\n\tconst contextValue = useMemo(\n\t\t() => ({\n\t\t\tmanager: VideoConfManager,\n\t\t\tdispatchOutgoing: (option: Omit<VideoConfPopupPayload, 'id'>): void => setOutgoing({ ...option, id: option.rid }),\n\t\t\tdismissOutgoing: (): void => setOutgoing(undefined),\n\t\t\tstartCall: (rid: IRoom['_id'], confTitle?: string): Promise<void> => VideoConfManager.startCall(rid, confTitle),\n\t\t\tacceptCall: (callId: string): void => VideoConfManager.acceptIncomingCall(callId),\n\t\t\tjoinCall: (callId: string): Promise<void> => VideoConfManager.joinCall(callId),\n\t\t\tdismissCall: (callId: string): void => {\n\t\t\t\tVideoConfManager.dismissIncomingCall(callId);\n\t\t\t},\n\t\t\trejectIncomingCall: (callId: string): void => VideoConfManager.rejectIncomingCall(callId),\n\t\t\tabortCall: (): void => VideoConfManager.abortCall(),\n\t\t\tsetPreferences: (prefs: Partial<(typeof VideoConfManager)['preferences']>): void => VideoConfManager.setPreferences(prefs),\n\t\t\tqueryIncomingCalls: {\n\t\t\t\tgetCurrentValue: (): DirectCallData[] => VideoConfManager.getIncomingDirectCalls(),\n\t\t\t\tsubscribe: (cb: () => void): Unsubscribe => VideoConfManager.on('incoming/changed', cb),\n\t\t\t},\n\t\t\tqueryRinging: {\n\t\t\t\tgetCurrentValue: (): boolean => VideoConfManager.isRinging(),\n\t\t\t\tsubscribe: (cb: () => void): Unsubscribe => VideoConfManager.on('ringing/changed', cb),\n\t\t\t},\n\t\t\tqueryCalling: {\n\t\t\t\tgetCurrentValue: (): boolean => VideoConfManager.isCalling(),\n\t\t\t\tsubscribe: (cb: () => void): Unsubscribe => VideoConfManager.on('calling/changed', cb),\n\t\t\t},\n\t\t\tqueryCapabilities: {\n\t\t\t\tgetCurrentValue: (): ProviderCapabilities => VideoConfManager.capabilities,\n\t\t\t\tsubscribe: (cb: () => void): Unsubscribe => VideoConfManager.on('capabilities/changed', cb),\n\t\t\t},\n\t\t\tqueryPreferences: {\n\t\t\t\tgetCurrentValue: (): CallPreferences => VideoConfManager.preferences,\n\t\t\t\tsubscribe: (cb: () => void): Unsubscribe => VideoConfManager.on('preference/changed', cb),\n\t\t\t},\n\t\t}),\n\t\t[],\n\t);\n\n\treturn (\n\t\t<VideoConfContext.Provider value={contextValue}>\n\t\t\t{children}\n\t\t\t<VideoConfPopups>{outgoing}</VideoConfPopups>\n\t\t</VideoConfContext.Provider>\n\t);\n};\n\nexport default VideoConfContextProvider;\n",null],"names":["_objectSpread","React","useState","useMemo","useEffect","VideoConfContext","VideoConfManager","VideoConfPopups","useVideoConfOpenCall","module","link","default","v","exportDefault","_ref","children","outgoing","setOutgoing","handleOpenCall","on","props","url","providerName","undefined","contextValue","manager","dispatchOutgoing","option","id","rid","dismissOutgoing","startCall","confTitle","acceptCall","callId","acceptIncomingCall","joinCall","dismissCall","dismissIncomingCall","rejectIncomingCall","abortCall","setPreferences","prefs","queryIncomingCalls","getCurrentValue","getIncomingDirectCalls","subscribe","cb","queryRinging","isRinging","queryCalling","isCalling","queryCapabilities","capabilities","queryPreferences","preferences","createElement","Provider","value"],"mappings":"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"}