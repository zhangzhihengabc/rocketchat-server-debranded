)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/composer/RoomComposer/hooks/useAutoGrow.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useContentBoxSize } from '@rocket.chat/fuselage-hooks';\nimport type { CSSProperties, RefObject } from 'react';\nimport { useEffect, useState } from 'react';\n\nconst shadowStyleBase: CSSProperties = {\n\tposition: 'fixed',\n\ttop: '-10000px',\n\tleft: '-10000px',\n\tresize: 'none',\n\twhiteSpace: 'pre-wrap',\n\twordWrap: 'break-word',\n\twillChange: 'contents',\n};\n\nexport const useAutoGrow = (\n\tref: RefObject<HTMLTextAreaElement>,\n\tshadowRef: RefObject<HTMLTextAreaElement>,\n\thideTextArea?: boolean,\n): {\n\ttextAreaStyle: CSSProperties;\n\tshadowStyle: CSSProperties;\n} => {\n\tconst [style, setStyle] = useState(() => ref.current && window.getComputedStyle(ref.current));\n\n\tuseEffect(() => {\n\t\tconst { current: textarea } = ref;\n\n\t\tif (!textarea) {\n\t\t\treturn;\n\t\t}\n\t\tsetStyle(() => ref.current && window.getComputedStyle(ref.current));\n\t}, [ref]);\n\n\tuseEffect(() => {\n\t\tconst { current: textarea } = ref;\n\n\t\tif (!textarea) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst handleInput = () => {\n\t\t\tconst { value } = textarea;\n\t\t\tconst { current: shadow } = shadowRef;\n\t\t\tif (!shadow) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tshadow.innerHTML = value\n\t\t\t\t.replace(/&/g, '&amp;')\n\t\t\t\t.replace(/</g, '&lt;')\n\t\t\t\t.replace(/>/g, '&gt;')\n\t\t\t\t.replace(/\\n$/, '<br/>&nbsp;')\n\t\t\t\t.replace(/\\n/g, '<br/>');\n\t\t};\n\n\t\ttextarea.addEventListener('input', handleInput);\n\t\treturn () => {\n\t\t\ttextarea.removeEventListener('input', handleInput);\n\t\t};\n\t}, [ref, shadowRef]);\n\n\tconst shadowContentSize = useContentBoxSize(shadowRef);\n\n\tconst composerContentSize = useContentBoxSize(ref);\n\n\treturn {\n\t\ttextAreaStyle: {\n\t\t\t...(hideTextArea && {\n\t\t\t\tvisibility: 'hidden',\n\t\t\t}),\n\t\t\twhiteSpace: 'pre-wrap',\n\t\t\twordWrap: 'break-word',\n\t\t\toverflowWrap: 'break-word',\n\t\t\twillChange: 'contents',\n\t\t\twordBreak: 'normal',\n\t\t\toverflowY: shadowContentSize.blockSize > parseInt(style?.maxHeight || '0') ? 'scroll' : 'hidden',\n\t\t\t...(shadowContentSize.blockSize && {\n\t\t\t\theight: `${shadowContentSize.blockSize}px`,\n\t\t\t}),\n\t\t},\n\t\tshadowStyle: {\n\t\t\t...shadowStyleBase,\n\t\t\tfont: style?.font,\n\t\t\twidth: composerContentSize.inlineSize,\n\t\t\tminHeight: style?.lineHeight,\n\t\t\tlineHeight: style?.lineHeight,\n\t\t},\n\t};\n};\n",null],"names":["_objectSpread","useContentBoxSize","useEffect","useState","module","default","export","useAutoGrow","shadowStyleBase","position","top","left","resize","whiteSpace","wordWrap","willChange","ref","shadowRef","hideTextArea","style","setStyle","current","window","getComputedStyle","textarea","handleInput","value","shadow","innerHTML","replace","addEventListener","removeEventListener","shadowContentSize","composerContentSize","textAreaStyle","visibility","overflowWrap","wordBreak","overflowY","blockSize","parseInt","maxHeight","height","concat","shadowStyle","font","width","inlineSize","minHeight","lineHeight"],"mappings":"2BAAAA,EAAkCC,EAA8BC,EAAAC,EAAvDC,EAAAA,IAAmB,CAAA,uCAAoC,CAAAC,QAAAA,CAAAA,EAAAL,EAAAA,CAAA,CAAA,EAAA,GAAhEI,EAAOE,MAAE,CAAA,CAAAC,YAAiB,IAAEA,CAAM,GAA8BH,EAAAA,IAAAA,CAAAA,8BAAAA,CAAAH,kBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,QAAAA,CAAAF,UAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAIhE,IAAMK,EAAiC,CACtCC,SAAU,QACVC,IAAK,WACLC,KAAM,WACNC,OAAQ,OACRC,WAAY,WACZC,SAAU,aACVC,WAAY,YAGAR,EAAc,CAC1BS,EACAC,EACAC,KAKA,GAAM,CAACC,EAAOC,EAAS,CAAGjB,EAAS,IAAMa,EAAIK,OAAO,EAAIC,OAAOC,gBAAgB,CAACP,EAAIK,OAAO,GAE3FnB,EAAU,KACT,GAAM,CAAEmB,QAASG,CAAAA,CAAU,CAAGR,EAEzBQ,GAGLJ,EAAS,IAAMJ,EAAIK,OAAO,EAAIC,OAAOC,gBAAgB,CAACP,EAAIK,OAAO,EAClE,EAAG,CAACL,EAAI,EAERd,EAAU,KACT,GAAM,CAAEmB,QAASG,CAAAA,CAAU,CAAGR,EAE9B,GAAI,CAACQ,EACJ,OAGD,IAAMC,EAAc,KACnB,GAAM,CAAEC,MAAAA,CAAAA,CAAO,CAAGF,EACZ,CAAEH,QAASM,CAAAA,CAAQ,CAAGV,EACvBU,GAGLA,CAAAA,EAAOC,SAAS,CAAGF,EACjBG,OAAO,CAAC,KAAM,SACdA,OAAO,CAAC,KAAM,QACdA,OAAO,CAAC,KAAM,QACdA,OAAO,CAAC,MAAO,eACfA,OAAO,CAAC,MAAO,QAAO,CACzB,EAGA,OADAL,EAASM,gBAAgB,CAAC,QAASL,GAC5B,KACND,EAASO,mBAAmB,CAAC,QAASN,EACvC,CACD,EAAG,CAACT,EAAKC,EAAU,EAEnB,IAAMe,EAAoB/B,EAAkBgB,GAEtCgB,EAAsBhC,EAAkBe,GAE9C,MAAO,CACNkB,cAAalC,EAAAA,EAAA,CAAA,EACRkB,GAAgB,CACnBiB,WAAY,WACZ,CAAA,EAAA,CACDtB,WAAY,WACZC,SAAU,aACVsB,aAAc,aACdrB,WAAY,WACZsB,UAAW,SACXC,UAAWN,EAAkBO,SAAS,CAAGC,SAAS,AAAArB,CAAAA,MAAAA,EAAK,KAAA,EAALA,EAAOsB,SAAS,AAATA,GAAa,KAAO,SAAW,QAAQ,EAC5FT,EAAkBO,SAAS,EAAI,CAClCG,OAAM,GAAAC,MAAA,CAAKX,EAAkBO,SAAS,CAAA,QAGxCK,YAAW5C,EAAAA,EAAA,CAAA,EACPQ,GAAe,CAAA,EAAA,CAClBqC,KAAM1B,MAAAA,EAAK,KAAA,EAALA,EAAO0B,IAAI,CACjBC,MAAOb,EAAoBc,UAAU,CACrCC,UAAW7B,MAAAA,EAAK,KAAA,EAALA,EAAO8B,UAAU,CAC5BA,WAAY9B,MAAAA,EAAK,KAAA,EAALA,EAAO8B,UAAAA,AAAU,GAGhC"}