function module(e,o,t){let n,i,l,r,s,a,u,c,d,m,p,g,v,f,k,b,C,E,h,x,y,M,P,_,A,w,R,B,D,I,K,T,S,F,V,j,L,O,N,U,z,G,q,J,W,H;t.link("@rocket.chat/fuselage",{Button(e){n=e},Tag(e){i=e},Box(e){l=e}},0),t.link("@rocket.chat/fuselage-hooks",{useContentBoxSize(e){r=e},useMutableCallback(e){s=e}},1),t.link("@rocket.chat/ui-composer",{MessageComposerAction(e){a=e},MessageComposerToolbarActions(e){u=e},MessageComposer(e){c=e},MessageComposerInput(e){d=e},MessageComposerToolbar(e){m=e},MessageComposerActionsDivider(e){p=e},MessageComposerToolbarSubmit(e){g=e}},2),t.link("@rocket.chat/ui-contexts",{useTranslation(e){v=e},useUserPreference(e){f=e},useLayout(e){k=e}},3),t.link("@tanstack/react-query",{useMutation(e){b=e}},4),t.link("react",{default(e){C=e},memo(e){E=e},useRef(e){h=e},useReducer(e){x=e},useCallback(e){y=e}},5),t.link("use-subscription",{useSubscription(e){M=e}},6),t.link("../../../../../app/ui-message/client/messageBox/createComposerAPI",{createComposerAPI(e){P=e}},7),t.link("../../../../../app/ui-message/client/messageBox/messageBoxFormatting",{formattingButtons(e){_=e}},8),t.link("../../../../../app/ui-message/client/popup/ComposerBoxPopup",{default(e){A=e}},9),t.link("../../../../../app/ui-message/client/popup/components/composerBoxPopupPreview/ComposerBoxPopupPreview",{default(e){w=e}},10),t.link("../../../../../app/ui-message/client/popup/hooks/useComposerBoxPopup",{useComposerBoxPopup(e){R=e}},11),t.link("../../../../../app/ui-message/client/popup/hooks/useEnablePopupPreview",{useEnablePopupPreview(e){B=e}},12),t.link("../../../../../lib/getImageExtensionFromMime",{getImageExtensionFromMime(e){D=e}},13),t.link("../../../../hooks/useFormatDateAndTime",{useFormatDateAndTime(e){I=e}},14),t.link("../../../../hooks/useReactiveValue",{useReactiveValue(e){K=e}},15),t.link("../../../../lib/rooms/roomCoordinator",{roomCoordinator(e){T=e}},16),t.link("../../../../lib/utils/keyCodes",{keyCodes(e){S=e}},17),t.link("../../../composer/AudioMessageRecorder",{default(e){F=e}},18),t.link("../../../composer/VideoMessageRecorder",{default(e){V=e}},19),t.link("../../contexts/ChatContext",{useChat(e){j=e}},20),t.link("../../contexts/ComposerPopupContext",{useComposerPopup(e){L=e}},21),t.link("../../contexts/RoomContext",{useRoom(e){O=e}},22),t.link("../ComposerUserActionIndicator",{default(e){N=e}},23),t.link("../RoomComposer/hooks/useAutoGrow",{useAutoGrow(e){U=e}},24),t.link("../hooks/useMessageComposerMergedRefs",{useMessageComposerMergedRefs(e){z=e}},25),t.link("./MessageBoxActionsToolbar",{default(e){G=e}},26),t.link("./MessageBoxFormattingToolbar",{default(e){q=e}},27),t.link("./MessageBoxReplies",{default(e){J=e}},28),t.link("./hooks/useMessageBoxAutoFocus",{useMessageBoxAutoFocus(e){W=e}},29),t.link("./hooks/useMessageBoxPlaceholder",{useMessageBoxPlaceholder(e){H=e}},30);let Q=(e,o)=>{let t=o.target;return!!t.value.trim()},X=(e,o,t)=>{let n=-1!==navigator.platform.indexOf("Mac"),i=n&&e.metaKey||!n&&e.ctrlKey;if(!i)return!1;let l=e.key.toLowerCase(),r=o.find(e=>"command"in e&&e.command===l);return!!r&&"pattern"in r&&(t.wrapSelection(r.pattern),!0)},Y=()=>()=>void 0,Z=()=>!1,$=[],ee=()=>$;t.exportDefault(E(e=>{var o,t,E,$,eo,et,en,ei,el,er,es,ea,eu,ec,ed,em,ep,eg,ev,ef,ek;let{tmid:eb,onSend:eC,onJoin:eE,onNavigateToNextMessage:eh,onNavigateToPreviousMessage:ex,onUploadFiles:ey,onEscape:eM,onTyping:eP,readOnly:e_,tshow:eA,previewUrls:ew}=e,eR=j(),eB=O(),eD=v(),eI=H(eD("Message"),eB),[eK,eT]=x(Q,!1),{isMobile:eS}=k(),eF=f("sendOnEnter")||eS,eV=null==eF||"normal"===eF||"desktop"===eF&&!eS;if(!eR)throw Error("Chat context not found");let ej=h(null),eL=h(null),eO=h(null),eN="".concat(eB._id).concat(eb?"-".concat(eb):""),eU=y(e=>{null!==e&&eR.setComposerAPI(P(e,eN))},[eR,eN]),ez=W(!eS),eG=f("useEmojis"),eq=s(e=>{if(e.stopPropagation(),e.preventDefault(),!eG)return;let o=eL.current;eR.emojiPicker.open(o,e=>{var o;return null===(o=eR.composer)||void 0===o?void 0:o.insertText(" :".concat(e,": "))})}),eJ=s(()=>{var e,o,t;let n=null!==(e=null===(o=eR.composer)||void 0===o?void 0:o.text)&&void 0!==e?e:"";null===(t=eR.composer)||void 0===t||t.clear(),os(),null==eC||eC({value:n,tshow:eA,previewUrls:ew})}),eW=s(e=>{let{which:o}=e,t=e.target,n=o===S.CARRIAGE_RETURN||o===S.NEW_LINE;if(n){let o=e.shiftKey||e.ctrlKey||e.altKey||e.metaKey;if(e.preventDefault(),!(eV&&!o||!eV&&o)){var i;return null===(i=eR.composer)||void 0===i||i.insertNewLine(),!1}return eJ(),!1}if(!(eR.composer&&X(e,[..._],eR.composer))&&!e.shiftKey&&!e.ctrlKey&&!e.metaKey){switch(e.key){case"Escape":if(eR.currentEditing){e.preventDefault(),e.stopPropagation(),eR.currentEditing.reset().then(e=>{if(!e){var o;null===(o=eR.currentEditing)||void 0===o||o.cancel()}});return}t.value.trim()||null==eM||eM();return;case"ArrowUp":0===t.selectionEnd&&(e.preventDefault(),e.stopPropagation(),null==ex||ex(),e.altKey&&t.setSelectionRange(0,0));return;case"ArrowDown":t.selectionEnd===t.value.length&&(e.preventDefault(),e.stopPropagation(),null==eh||eh(),e.altKey&&t.setSelectionRange(t.value.length,t.value.length))}null==eP||eP()}}),eH=M({getCurrentValue:null!==(o=null===(t=eR.composer)||void 0===t?void 0:t.editing.get)&&void 0!==o?o:Z,subscribe:null!==(E=null===($=eR.composer)||void 0===$?void 0:$.editing.subscribe)&&void 0!==E?E:Y}),eQ=M({getCurrentValue:null!==(eo=null===(et=eR.composer)||void 0===et?void 0:et.recording.get)&&void 0!==eo?eo:Z,subscribe:null!==(en=null===(ei=eR.composer)||void 0===ei?void 0:ei.recording.subscribe)&&void 0!==en?en:Y}),eX=M({getCurrentValue:null!==(el=null===(er=eR.composer)||void 0===er?void 0:er.isMicrophoneDenied.get)&&void 0!==el?el:Z,subscribe:null!==(es=null===(ea=eR.composer)||void 0===ea?void 0:ea.isMicrophoneDenied.subscribe)&&void 0!==es?es:Y}),eY=M({getCurrentValue:null!==(eu=null===(ec=eR.composer)||void 0===ec?void 0:ec.recordingVideo.get)&&void 0!==eu?eu:Z,subscribe:null!==(ed=null===(em=eR.composer)||void 0===em?void 0:em.recordingVideo.subscribe)&&void 0!==ed?ed:Y}),eZ=M({getCurrentValue:null!==(ep=null===(eg=eR.composer)||void 0===eg?void 0:eg.formatters.get)&&void 0!==ep?ep:ee,subscribe:null!==(ev=null===(ef=eR.composer)||void 0===ef?void 0:ef.formatters.subscribe)&&void 0!==ev?ev:Y}),e$=eQ||eY,{textAreaStyle:e0,shadowStyle:e1}=U(ej,eO,eQ),e2=K(y(()=>T.verifyCanSendMessage(eB._id),[eB._id])),e4=r(ej),e8=I(),e3=b(async()=>null==eE?void 0:eE()),e5=s(e=>{let{clipboardData:o}=e;if(!o)return;let t=Array.from(o.items);if(t.some(e=>{let{kind:o,type:t}=e;return"string"===o&&"text/plain"===t}))return;let n=t.filter(e=>"file"===e.kind&&-1!==e.type.indexOf("image/")).map(e=>{let o=e.getAsFile();if(!o)return;let t=o?D(o.type):void 0,n=t?".".concat(t):"";return Object.defineProperty(o,"name",{writable:!0,value:"Clipboard - ".concat(e8(new Date)).concat(n)}),o}).filter(e=>!!e);n.length&&(e.preventDefault(),null==ey||ey(n))}),e6=L(),{popup:e7,focused:e9,items:oe,ariaActiveDescendant:oo,suspended:ot,select:on,commandsRef:oi,callbackRef:ol,filter:or,clearPopup:os}=R({configurations:e6}),oa=z(ol,ej,eU,ez),ou=B(or,e7);return C.createElement(C.Fragment,null,(null===(ek=eR.composer)||void 0===ek?void 0:ek.quotedMessages)&&C.createElement(J,null),ou&&e7&&C.createElement(A,{select:on,items:oe,focused:e9,title:e7.title,renderItem:e7.renderItem}),(null==e7?void 0:e7.preview)&&C.createElement(w,{select:on,items:oe,focused:e9,renderItem:e7.renderItem,ref:oi,rid:eB._id,tmid:eb,suspended:ot}),e_&&C.createElement(l,{mbe:4,display:"flex"},C.createElement(i,{title:eD("Only_people_with_permission_can_send_messages_here")},eD("This_room_is_read_only"))),eY&&C.createElement(V,{reference:eL,rid:eB._id,tmid:eb}),C.createElement(c,{ref:eL,variant:eH?"editing":void 0},eQ&&C.createElement(F,{rid:eB._id,isMicrophoneDenied:eX}),C.createElement(d,{ref:oa,"aria-label":eI,name:"msg",disabled:e$||!e2,onChange:eT,style:e0,placeholder:eI,onKeyDown:eW,onPaste:e5,"aria-activedescendant":oo}),C.createElement("div",{ref:eO,style:e1}),C.createElement(m,null,C.createElement(u,{"aria-label":eD("Message_composer_toolbox_primary_actions")},C.createElement(a,{icon:"emoji",disabled:!eG||e$||!e2,onClick:eq,title:eD("Emoji")}),C.createElement(p,null),eR.composer&&eZ.length>0&&C.createElement(q,{composer:eR.composer,variant:e4.inlineSize<480?"small":"large",items:eZ,disabled:e$||!e2}),C.createElement(p,null),C.createElement(G,{variant:e4.inlineSize<480?"small":"large",isRecording:e$,typing:eK,canSend:e2,rid:eB._id,tmid:eb,isMicrophoneDenied:eX})),C.createElement(g,null,!e2&&C.createElement(n,{small:!0,primary:!0,onClick:eE,loading:e3.isLoading},eD("Join")),e2&&C.createElement(a,{"aria-label":eD("Send"),icon:"send",disabled:!e2||!eK&&!eH,onClick:eJ,secondary:eK||eH,info:eK||eH})))),C.createElement(N,{rid:eB._id,tmid:eb}))}))}
//# sourceMappingURL=/dynamic/client/views/room/composer/messageBox/e62abc7fb66b3d5b2c3679581401f0275e372a53.map
