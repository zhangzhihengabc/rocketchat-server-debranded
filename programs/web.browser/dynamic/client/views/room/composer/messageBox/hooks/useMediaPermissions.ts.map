)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/composer/messageBox/hooks/useMediaPermissions.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useEffect, useState } from 'react';\n\ntype MediaDevices = 'camera' | 'microphone';\n\nconst getDeviceKind = (name: MediaDevices): MediaDeviceKind => {\n\tswitch (name) {\n\t\tcase 'camera':\n\t\t\treturn 'videoinput';\n\t\tcase 'microphone':\n\t\t\treturn 'audioinput';\n\t}\n};\n\nexport const useMediaPermissions = (name: MediaDevices): [isPermissionDenied: boolean, setIsPermissionDenied: (state: boolean) => void] => {\n\tconst [isPermissionDenied, setIsPermissionDenied] = useState(false);\n\n\tconst handleMount = useMutableCallback(async (): Promise<void> => {\n\t\tif (navigator.permissions) {\n\t\t\ttry {\n\t\t\t\tconst permissionStatus = await navigator.permissions.query({ name: name as PermissionName });\n\t\t\t\tsetIsPermissionDenied(permissionStatus.state === 'denied');\n\t\t\t\tpermissionStatus.onchange = (): void => {\n\t\t\t\t\tsetIsPermissionDenied(permissionStatus.state === 'denied');\n\t\t\t\t};\n\t\t\t\treturn;\n\t\t\t} catch (error) {\n\t\t\t\tconsole.warn(error);\n\t\t\t}\n\t\t}\n\n\t\tif (!navigator.mediaDevices?.enumerateDevices) {\n\t\t\tsetIsPermissionDenied(true);\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tif (!(await navigator.mediaDevices.enumerateDevices()).some(({ kind }) => kind === getDeviceKind(name))) {\n\t\t\t\tsetIsPermissionDenied(true);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.warn(error);\n\t\t}\n\t});\n\n\tuseEffect(() => {\n\t\thandleMount();\n\t}, [handleMount]);\n\n\treturn [isPermissionDenied, setIsPermissionDenied];\n};\n",null],"names":["useMutableCallback","useEffect","useState","module","export","useMediaPermissions","getDeviceKind","name","isPermissionDenied","setIsPermissionDenied","handleMount","_navigator$mediaDevic","navigator","permissions","permissionStatus","query","state","onchange","error","console","warn","mediaDevices","enumerateDevices","some","_ref","kind"],"mappings":"2BAAiEA,EAAAC,EAAAC,EAAjEC,EAAOC,MAAE,CAAA,CAAAC,oBAA0B,IAAAA,CAAA,GAA8BF,EAAAA,IAAAA,CAAAA,8BAAAA,CAAAH,mBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,QAAAA,CAAAF,UAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAKjE,IAAMI,EAAiBC,IACtB,OAAQA,GACP,IAAK,SACJ,MAAO,YACR,KAAK,aACJ,MAAO,YAAa,CAEvB,EAEaF,EAAuBE,IACnC,GAAM,CAACC,EAAoBC,EAAsB,CAAGP,EAAS,CAAA,GAEvDQ,EAAcV,EAAmB,UAA0B,IAAAW,EAChE,GAAIC,UAAUC,WAAW,CACxB,GAAI,CACH,IAAMC,EAAmB,MAAMF,UAAUC,WAAW,CAACE,KAAK,CAAC,CAAER,KAAMA,CAAsB,GACzFE,EAAsBK,AAA2B,WAA3BA,EAAiBE,KAAK,EAC5CF,EAAiBG,QAAQ,CAAG,KAC3BR,EAAsBK,AAA2B,WAA3BA,EAAiBE,KAAK,CAC7C,EACA,OACC,MAAOE,EAAO,CACfC,QAAQC,IAAI,CAACF,GAIf,GAAI,CAAA,CAAA,AAAuB,OAAvBP,CAAAA,EAACC,UAAUS,YAAY,AAAZA,GAAYV,AAAA,KAAA,IAAAA,GAAtBA,EAAwBW,gBAAgB,AAAhBA,EAAkB,CAC9Cb,EAAsB,CAAA,GACtB,OAGD,GAAI,CACE,AAAC,CAAA,MAAMG,UAAUS,YAAY,CAACC,gBAAgB,EAAA,EAAIC,IAAI,CAACC,IAAA,GAAC,CAAEC,KAAAA,CAAAA,CAAM,CAAAD,EAAA,OAAKC,IAASnB,EAAcC,EAAK,IACrGE,EAAsB,CAAA,GAEtB,MAAOS,EAAO,CACfC,QAAQC,IAAI,CAACF,GAEf,GAMA,OAJAjB,EAAU,KACTS,GACD,EAAG,CAACA,EAAY,EAET,CAACF,EAAoBC,EAAsB,AACnD"}