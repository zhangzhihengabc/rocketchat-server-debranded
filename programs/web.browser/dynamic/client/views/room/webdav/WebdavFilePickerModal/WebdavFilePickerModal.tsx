function module(e,t,l){let a,n,i,r,o,s,c,d,u,m,f,p,y,b,k,g,h,v,E,C,w,F;l.link("@rocket.chat/fuselage",{Modal(e){a=e},Box(e){n=e},IconButton(e){i=e},Select(e){r=e}},0),l.link("@rocket.chat/fuselage-hooks",{useMutableCallback(e){o=e},useDebouncedValue(e){s=e}},1),l.link("@rocket.chat/ui-contexts",{useMethod(e){c=e},useToastMessageDispatch(e){d=e},useTranslation(e){u=e},useSetModal(e){m=e}},2),l.link("react",{default(e){f=e},useState(e){p=e},useEffect(e){y=e},useCallback(e){b=e}},3),l.link("../../../../../app/utils/client",{fileUploadIsValidContentType(e){k=e}},4),l.link("../../../../components/FilterByText",{default(e){g=e}},5),l.link("../../../../components/GenericTable/hooks/useSort",{useSort(e){h=e}},6),l.link("../../modals/FileUploadModal",{default(e){v=e}},7),l.link("./FilePickerBreadcrumbs",{default(e){E=e}},8),l.link("./WebdavFilePickerGrid",{default(e){C=e}},9),l.link("./WebdavFilePickerTable",{default(e){w=e}},10),l.link("./lib/sortWebdavNodes",{sortWebdavNodes(e){F=e}},11),l.exportDefault(e=>{let{onUpload:t,onClose:l,account:B}=e,x=u(),N=m(),T=c("getWebdavFilePreview"),M=c("getWebdavFileList"),S=c("getFileFromWebdav"),W=d(),[_,D]=p("list"),{sortBy:L,sortDirection:P,setSort:U}=h("name"),[A,G]=p("/"),[I,R]=p([]),[j,z]=p([]),[O,V]=p(""),q=s(O,500),[H,J]=p(!1),K=o(async(e,t)=>{if(!Array.isArray(t)||!t.length)return;let l=t.map((l,a)=>{if("file"===l.type)return T(e,l.filename).then(e=>{if(!(null!=e&&e.data))return;let l=new Blob([null==e?void 0:e.data],{type:"image/png"}),n=URL.createObjectURL(l);t[a].preview=n}).catch(e=>e)}).filter(Boolean);return Promise.all(l).then(()=>t).catch(e=>e)}),Q=b(e=>{let t=RegExp("\\b".concat(q),"i"),l=e.filter(e=>{let{basename:l}=e;return l.match(t)});return z(l)},[q]),X=b(async()=>{let e;J(!0);try{e=await M(B._id,A),Q(e.data)}catch(e){W({type:"error",message:e}),l()}finally{var t;J(!1);let l=await K(B._id,null===(t=e)||void 0===t?void 0:t.data);Array.isArray(l)&&l.length&&Q(l)}},[B._id,A,W,M,l,K,Q]),Y=e=>"directory"===e.type?G(e.filename):Z(e),Z=async e=>{J(!0);let a=async(e,a)=>{try{await (null==t?void 0:t(e,a))}catch(e){return W({type:"error",message:e})}finally{J(!1),l()}};try{let{data:t}=await S(B._id,e),l=new Blob([t]),n=new File([l],e.basename,{type:e.mime});N(f.createElement(v,{fileName:e.basename,onSubmit:(e,t)=>a(n,t),file:n,onClose:()=>N(null),invalidContentType:!!(n.type&&!k(n.type))}))}catch(e){return W({type:"error",message:e})}};y(()=>{X()},[X]),y(()=>{R((null==A?void 0:A.split("/").filter(e=>e))||[])},[A]);let $=(e,t)=>{U(e);let l=F(j,e,t);return z(l)};return f.createElement(a,null,f.createElement(a.Header,null,f.createElement(a.Title,null,x("Upload_From",{name:B.name})),f.createElement(a.Close,{title:x("Close"),onClick:l})),f.createElement(a.Content,null,f.createElement(n,{display:"flex",justifyContent:"space-between"},f.createElement(E,{parentFolders:I,handleBreadcrumb:e=>{let{index:t}=e.currentTarget.dataset,l=A.split("/").filter(e=>e),a="/";for(let e=0;e<=Number(t);e++)a+=l[e]+"/";G(a)},handleBack:()=>{let e=A,t="/";e&&"/"!==e&&("/"===e[e.length-1]&&(e=e.slice(0,-1)),t=e.substr(0,e.lastIndexOf("/")+1)),G(t)}}),f.createElement(n,null,"list"===_&&f.createElement(i,{icon:"squares",small:!0,title:x("Grid_view"),onClick:()=>D("grid")}),"grid"===_&&f.createElement(i,{icon:"th-list",small:!0,title:x("List_view"),onClick:()=>D("list")}))),f.createElement(n,{display:"flex",flexDirection:"column"},f.createElement(g,{onChange:e=>{let{text:t}=e;return V(t)}},"grid"===_&&f.createElement(r,{value:L,onChange:e=>$(e),options:[["name","Name"],["size","Size"],["dataModified","Data Modified"]]}))),"list"===_&&f.createElement(w,{webdavNodes:j,sortBy:L,sortDirection:P,onSort:$,onNodeClick:Y,isLoading:H}),"grid"===_&&f.createElement(C,{webdavNodes:j,onNodeClick:Y,isLoading:H})),f.createElement(a.Footer,null))})}
//# sourceMappingURL=/dynamic/client/views/room/webdav/WebdavFilePickerModal/9c10ccbb0d623dd770a0ceb6310f85ccc406173a.map
