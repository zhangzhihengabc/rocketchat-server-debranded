function module(e,t,s){let r,n,o,i,a,l,p,m,c,u,d,g,x,h,_,f,k,y,E,$,C,R,I;s.link("@babel/runtime/helpers/objectSpread2",{default(e){r=e}},0),s.link("@rocket.chat/core-typings",{isOmnichannelRoom(e){n=e}},0),s.link("@rocket.chat/fuselage-hooks",{useLocalStorage(e){o=e}},1),s.link("@rocket.chat/string-helpers",{escapeRegExp(e){i=e}},2),s.link("@rocket.chat/ui-contexts",{useMethod(e){a=e},useSetting(e){l=e},useTranslation(e){p=e},useUserPreference(e){m=e}},3),s.link("react",{default(e){c=e},useMemo(e){u=e}},4),s.link("../../../../app/authorization/client",{hasAtLeastOnePermission(e){d=e}},5),s.link("../../../../app/emoji/client",{emoji(e){g=e}},6),s.link("../../../../app/models/client",{Subscriptions(e){x=e}},7),s.link("../../../../app/ui-message/client/popup/components/composerBoxPopup/ComposerBoxPopupCannedResponse",{default(e){h=e}},8),s.link("../../../../app/ui-message/client/popup/components/composerBoxPopup/ComposerBoxPopupEmoji",{default(e){_=e}},9),s.link("../../../../app/ui-message/client/popup/components/composerBoxPopup/ComposerBoxPopupRoom",{default(e){f=e}},10),s.link("../../../../app/ui-message/client/popup/components/composerBoxPopup/ComposerBoxPopupSlashCommand",{default(e){k=e}},11),s.link("../../../../app/ui-message/client/popup/components/composerBoxPopup/ComposerBoxPopupUser",{default(e){y=e}},12),s.link("../../../../app/ui-message/client/popup/messagePopupConfig",{usersFromRoomMessages(e){E=e}},13),s.link("../../../../app/utils/client",{slashCommands(e){$=e}},14),s.link("../../../../ee/app/canned-responses/client/collections/CannedResponse",{CannedResponse(e){C=e}},15),s.link("../contexts/ComposerPopupContext",{ComposerPopupContext(e){R=e},createMessageBoxPopupConfig(e){I=e}},16),s.exportDefault(e=>{let{children:t,room:s}=e,{_id:P}=s,v=a("spotlight"),F=l("Number_of_users_autocomplete_suggestions"),S=l("Canned_Responses_Enable"),[b]=o("emoji.recent",[]),B=n(s),j=m("useEmojis"),L=p(),O=a("getSlashCommandPreviews"),w=u(()=>[I({trigger:"@",title:L("People"),getItemsFromLocal:async e=>{let t=e&&RegExp(i(e),"i"),s=[],n=E.find(r({ts:{$exists:!0}},e&&{$or:[{username:t},{name:t}]}),{limit:null!=F?F:5,sort:{ts:-1}}).fetch().map(e=>(e.suggestion=!0,e));return(!t||t.test("all"))&&s.push({_id:"all",username:"all",system:!0,name:L("Notify_all_in_this_room"),sort:4}),(!t||t.test("here"))&&s.push({_id:"here",username:"here",system:!0,name:L("Notify_active_in_this_room"),sort:4}),[...n,...s]},getItemsFromServer:async e=>{let t=e&&RegExp(i(e),"i"),s=E.find(r({ts:{$exists:!0}},e&&{$or:[{username:t},{name:t}]}),{limit:null!=F?F:5,sort:{ts:-1}}).fetch().map(e=>e.username),{users:n=[]}=await v(e,s,{users:!0,mentions:!0},P);return n.map(e=>{let{_id:t,username:s,nickname:r,name:n,status:o,avatarETag:i,outside:a}=e;return{_id:t,username:s,nickname:r,name:n,status:o,avatarETag:i,outside:a,sort:3}})},getValue:e=>e.username,renderItem:e=>{let{item:t}=e;return c.createElement(y,t)}}),I({trigger:"#",title:L("Channels"),getItemsFromLocal:async e=>{let t=RegExp(i(e),"i"),s=x.find({name:t,$or:[{federated:{$exists:!1}},{federated:!1}],t:{$in:["c","p"]}},{limit:null!=F?F:5,sort:{ls:-1}}).fetch();return s},getItemsFromServer:async e=>{let{rooms:t=[]}=await v(e,[],{rooms:!0,mentions:!0},P);return t},getValue:e=>"".concat(e.name||e.fname),renderItem:e=>{let{item:t}=e;return c.createElement(f,t)}}),j&&I({trigger:":",title:L("Emoji"),triggerLength:2,getItemsFromLocal:async e=>{let t=RegExp("^tone[1-5]:*$"),s=RegExp("tone[1-5]:*$"),r=RegExp("_t(?:o|$)(?:n|$)(?:e|$)(?:[1-5]|$)(?::|$)$"),n=RegExp(i(e),"i"),o=":".concat(e),a=b.map(e=>":".concat(e,":")),l=g.list;return Object.keys(l).map(e=>{let t=l[o];return{_id:e,data:t}}).filter(e=>{let{_id:i}=e;return n.test(i)&&(t.test(i.substring(o.length))||r.test(o)||!s.test(i))}).sort((e,t)=>{let s=e._id===o?2:0,r=t._id===o?2:0,n=e._id.startsWith(o)?1:0,i=t._id.startsWith(o)?1:0,l=s+n,p=r+i;return(a.includes(e._id)&&(l+=a.indexOf(e._id)+1),a.includes(t._id)&&(p+=a.indexOf(t._id)+1),l>p)?-1:l<p?1:0}).slice(0,10)},getItemsFromServer:async()=>[],getValue:e=>"".concat(e._id.substring(1)),renderItem:e=>{let{item:t}=e;return c.createElement(_,t)}}),I({title:L("Emoji"),trigger:"\\+:",prefix:"+",suffix:" ",triggerAnywhere:!1,getItemsFromLocal:async e=>{let t=RegExp("^tone[1-5]:*$"),s=RegExp("tone[1-5]:*$"),r=RegExp("_t(?:o|$)(?:n|$)(?:e|$)(?:[1-5]|$)(?::|$)$"),n=RegExp(i(e),"i"),o=":".concat(e),a=b.map(e=>":".concat(e,":")),l=g.list;return Object.keys(l).map(e=>{let t=l[o];return{_id:e,data:t}}).filter(e=>{let{_id:i}=e;return n.test(i)&&(t.test(i.substring(o.length))||r.test(o)||!s.test(i))}).sort((e,t)=>{let s=e._id,r=e._id;return(a.includes(e._id)&&(s=a.indexOf(e._id)+s),a.includes(t._id)&&(r=a.indexOf(t._id)+r),s<r)?-1:s>r?1:0}).slice(0,10)},getItemsFromServer:async()=>[],getValue:e=>"".concat(e._id),renderItem:e=>{let{item:t}=e;return c.createElement(_,t)}}),I({title:L("Commands"),trigger:"/",suffix:" ",triggerAnywhere:!1,renderItem:e=>{let{item:t}=e;return c.createElement(k,t)},getItemsFromLocal:async e=>Object.keys($.commands).map(e=>{var t;let s=$.commands[e];return{_id:e,params:s.params&&L.has(s.params)?L(s.params):null!==(t=s.params)&&void 0!==t?t:"",description:s.description&&L.has(s.description)?L(s.description):s.description,permission:s.permission}}).filter(t=>{let s=t._id.indexOf(e)>-1;return!!s&&(!t.permission||d(t.permission,P))}).sort((e,t)=>e._id.localeCompare(t._id)).slice(0,11),getItemsFromServer:async()=>[]}),S&&B&&I({title:L("Canned_Responses"),trigger:"!",prefix:"",triggerAnywhere:!0,renderItem:e=>{let{item:t}=e;return c.createElement(h,t)},getItemsFromLocal:async e=>{let t=RegExp(e,"i");return C.find({shortcut:t},{limit:12,sort:{shortcut:-1}}).fetch().map(e=>({_id:e._id,text:e.text,shortcut:e.shortcut}))},getItemsFromServer:async()=>[],getValue:e=>e.text}),I({matchSelectorRegex:/(?:^)(\/[\w\d\S]+ )[^]*$/,preview:!0,getItemsFromLocal:async e=>{var t;let{cmd:s,params:r,tmid:n}=e,o=await O({cmd:s,params:r,msg:{rid:P,tmid:n}});return null!==(t=null==o?void 0:o.items.map(e=>({_id:e.id,value:e.value,type:e.type})))&&void 0!==t?t:[]}})].filter(Boolean),[L,S,B,b,F,v,P,O,j]);return c.createElement(R.Provider,{value:w,children:t})})}
//# sourceMappingURL=/dynamic/client/views/room/providers/385481f6994937ca005ff6a2737b05bc85aaff33.map
