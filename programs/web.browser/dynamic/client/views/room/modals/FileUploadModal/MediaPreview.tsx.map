)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/modals/FileUploadModal/MediaPreview.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { AudioPlayer, Box, Icon } from '@rocket.chat/fuselage';\nimport { useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useEffect, useState, memo } from 'react';\n\nimport { userAgentMIMETypeFallback } from '../../../../lib/utils/userAgentMIMETypeFallback';\nimport { FilePreviewType } from './FilePreview';\nimport ImagePreview from './ImagePreview';\nimport PreviewSkeleton from './PreviewSkeleton';\n\ntype ReaderOnloadCallback = (url: FileReader['result']) => void;\n\nconst readFileAsDataURL = (file: File, callback: ReaderOnloadCallback): void => {\n\tconst reader = new FileReader();\n\treader.onload = (e): void => callback(e?.target?.result || null);\n\n\treturn reader.readAsDataURL(file);\n};\n\nconst useFileAsDataURL = (file: File): [loaded: boolean, url: null | FileReader['result']] => {\n\tconst [loaded, setLoaded] = useState(false);\n\tconst [url, setUrl] = useState<FileReader['result']>(null);\n\n\tuseEffect(() => {\n\t\tsetLoaded(false);\n\t\treadFileAsDataURL(file, (url) => {\n\t\t\tsetUrl(url);\n\t\t\tsetLoaded(true);\n\t\t});\n\t}, [file]);\n\treturn [loaded, url];\n};\n\ntype MediaPreviewProps = {\n\tfile: File;\n\tfileType: FilePreviewType;\n};\n\nconst MediaPreview = ({ file, fileType }: MediaPreviewProps): ReactElement => {\n\tconst [loaded, url] = useFileAsDataURL(file);\n\tconst t = useTranslation();\n\n\tif (!loaded) {\n\t\treturn <PreviewSkeleton />;\n\t}\n\n\tif (typeof url !== 'string') {\n\t\treturn (\n\t\t\t<Box display='flex' alignItems='center' w='full'>\n\t\t\t\t<Icon name='image' size='x24' mie={4} />\n\t\t\t\t{t('FileUpload_Cannot_preview_file')}\n\t\t\t</Box>\n\t\t);\n\t}\n\n\tif (fileType === FilePreviewType.IMAGE) {\n\t\treturn <ImagePreview url={url} file={file} />;\n\t}\n\n\tif (fileType === FilePreviewType.VIDEO) {\n\t\treturn (\n\t\t\t<Box is='video' w='full' controls>\n\t\t\t\t<source src={url} type={userAgentMIMETypeFallback(file.type)} />\n\t\t\t\t{t('Browser_does_not_support_video_element')}\n\t\t\t</Box>\n\t\t);\n\t}\n\n\tif (fileType === FilePreviewType.AUDIO) {\n\t\treturn <AudioPlayer src={url} />;\n\t}\n\n\tthrow new Error('Wrong props provided for MediaPreview');\n};\n\nexport default memo(MediaPreview);\n",null],"names":["AudioPlayer","Box","Icon","useTranslation","React","useEffect","useState","memo","userAgentMIMETypeFallback","FilePreviewType","ImagePreview","PreviewSkeleton","module","link","v","default","readFileAsDataURL","file","callback","reader","FileReader","onload","e","_e$target","target","result","readAsDataURL","useFileAsDataURL","loaded","setLoaded","url","setUrl","exportDefault","_ref","fileType","t","createElement","display","alignItems","w","name","size","mie","IMAGE","VIDEO","is","controls","src","type","AUDIO","Error"],"mappings":"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"}