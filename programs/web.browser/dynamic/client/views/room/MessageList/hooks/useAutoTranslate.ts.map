)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/MessageList/hooks/useAutoTranslate.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IMessage, ISubscription, ITranslatedMessage } from '@rocket.chat/core-typings';\nimport { useSetting } from '@rocket.chat/ui-contexts';\nimport { useCallback, useMemo } from 'react';\n\nimport { AutoTranslate } from '../../../../../app/autotranslate/client';\nimport { roomCoordinator } from '../../../../lib/rooms/roomCoordinator';\nimport { hasTranslationLanguageInAttachments, hasTranslationLanguageInMessage } from '../lib/autoTranslate';\nimport { isOwnUserMessage } from '../lib/isOwnUserMessage';\n\nexport type AutoTranslateOptions = {\n\tautoTranslateEnabled: boolean;\n\tautoTranslateLanguage?: string;\n\tshowAutoTranslate: (message: IMessage & Partial<ITranslatedMessage>) => boolean;\n};\n\nexport const useAutoTranslate = (subscription?: ISubscription): AutoTranslateOptions => {\n\tconst autoTranslateSettingEnabled = Boolean(useSetting('AutoTranslate_Enabled'));\n\tconst isSubscriptionEnabled = autoTranslateSettingEnabled && subscription?.autoTranslateLanguage && subscription?.autoTranslate;\n\tconst isLivechatRoom = useMemo(() => subscription && roomCoordinator.isLivechatRoom(subscription?.t), [subscription]);\n\tconst autoTranslateEnabled = Boolean(isSubscriptionEnabled || isLivechatRoom);\n\tconst autoTranslateLanguage = autoTranslateEnabled && subscription ? AutoTranslate.getLanguage(subscription.rid) : undefined;\n\n\tconst showAutoTranslate = useCallback(\n\t\t(message: IMessage): boolean => {\n\t\t\tif (!autoTranslateEnabled || !autoTranslateLanguage) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn (\n\t\t\t\t!isOwnUserMessage(message, subscription) &&\n\t\t\t\t!(message as { autoTranslateShowInverse?: boolean }).autoTranslateShowInverse &&\n\t\t\t\t(hasTranslationLanguageInMessage(message, autoTranslateLanguage) ||\n\t\t\t\t\thasTranslationLanguageInAttachments(message.attachments, autoTranslateLanguage))\n\t\t\t);\n\t\t},\n\t\t[subscription, autoTranslateEnabled, autoTranslateLanguage],\n\t);\n\n\treturn useMemo(() => {\n\t\treturn { autoTranslateEnabled, autoTranslateLanguage, showAutoTranslate };\n\t}, [autoTranslateEnabled, autoTranslateLanguage, showAutoTranslate]);\n};\n",null],"names":["useSetting","useCallback","useMemo","AutoTranslate","roomCoordinator","hasTranslationLanguageInAttachments","hasTranslationLanguageInMessage","isOwnUserMessage","module","export","useAutoTranslate","subscription","autoTranslateSettingEnabled","Boolean","isSubscriptionEnabled","autoTranslateLanguage","autoTranslate","isLivechatRoom","t","autoTranslateEnabled","getLanguage","rid","undefined","showAutoTranslate","message","autoTranslateShowInverse","attachments"],"mappings":"2BACsDA,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAtDC,EAAOC,MAAE,CAAA,CAAAC,iBAAkB,IAAAA,CAAA,GAA2BF,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAR,WAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAQ,EAAAA,IAAAA,CAAAA,QAAAA,CAAAP,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,QAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,0CAAAA,CAAAL,cAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAK,EAAAA,IAAAA,CAAAA,wCAAAA,CAAAJ,gBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,uBAAAA,CAAAH,oCAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,gCAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,0BAAAA,CAAAD,iBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAc/C,IAAMG,EAAoBC,IAChC,IAAMC,EAA8BC,CAAAA,CAAQb,EAAW,yBACjDc,EAAwBF,GAA+BD,CAAAA,MAAAA,EAAY,KAAA,EAAZA,EAAcI,qBAAqB,AAArBA,GAAyBJ,CAAAA,MAAAA,EAAY,KAAA,EAAZA,EAAcK,aAAa,AAAbA,EAC5GC,EAAiBf,EAAQ,IAAMS,GAAgBP,EAAgBa,cAAc,CAACN,MAAAA,EAAY,KAAA,EAAZA,EAAcO,CAAC,EAAG,CAACP,EAAa,EAC9GQ,EAAuBN,CAAAA,CAAQC,CAAAA,GAAyBG,CAAAA,EACxDF,EAAwBI,GAAwBR,EAAeR,EAAciB,WAAW,CAACT,EAAaU,GAAG,EAAIC,KAAAA,EAE7GC,EAAoBtB,EACxBuB,GACA,EAAKL,KAAyBJ,GAK7B,CAACR,EAAiBiB,EAASb,IAC3B,CAAEa,EAAmDC,wBAAwB,EAC5EnB,CAAAA,EAAgCkB,EAAST,IACzCV,EAAoCmB,EAAQE,WAAW,CAAEX,EAAqB,EAGjF,CAACJ,EAAcQ,EAAsBJ,EAAsB,EAG5D,OAAOb,EAAQ,IACP,CAAA,CAAEiB,qBAAAA,EAAsBJ,sBAAAA,EAAuBQ,kBAAAA,CAAiB,CAAA,EACrE,CAACJ,EAAsBJ,EAAuBQ,EAAkB,CACpE"}