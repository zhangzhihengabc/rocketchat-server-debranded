)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/MessageListTab.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IMessage } from '@rocket.chat/core-typings';\nimport { Box, MessageDivider, Throbber } from '@rocket.chat/fuselage';\nimport type { Keys as IconName } from '@rocket.chat/icons';\nimport { useUserPreference } from '@rocket.chat/ui-contexts';\nimport type { UseQueryResult } from '@tanstack/react-query';\nimport type { ReactElement, ReactNode } from 'react';\nimport React, { useCallback } from 'react';\nimport { Virtuoso } from 'react-virtuoso';\n\nimport { MessageTypes } from '../../../../app/ui-utils/client';\nimport type { MessageActionContext } from '../../../../app/ui-utils/client/lib/MessageAction';\nimport {\n\tContextualbarContent,\n\tContextualbarHeader,\n\tContextualbarIcon,\n\tContextualbarTitle,\n\tContextualbarClose,\n\tContextualbarEmptyContent,\n} from '../../../components/Contextualbar';\nimport ScrollableContentWrapper from '../../../components/ScrollableContentWrapper';\nimport RoomMessage from '../../../components/message/variants/RoomMessage';\nimport SystemMessage from '../../../components/message/variants/SystemMessage';\nimport { useFormatDate } from '../../../hooks/useFormatDate';\nimport MessageListErrorBoundary from '../MessageList/MessageListErrorBoundary';\nimport { isMessageNewDay } from '../MessageList/lib/isMessageNewDay';\nimport MessageListProvider from '../MessageList/providers/MessageListProvider';\nimport { useRoomSubscription } from '../contexts/RoomContext';\nimport { useRoomToolbox } from '../contexts/RoomToolboxContext';\n\ntype MessageListTabProps = {\n\ticonName: IconName;\n\ttitle: ReactNode;\n\temptyResultMessage: string;\n\tcontext: MessageActionContext;\n\tqueryResult: UseQueryResult<IMessage[]>;\n};\n\nconst MessageListTab = ({ iconName, title, emptyResultMessage, context, queryResult }: MessageListTabProps): ReactElement => {\n\tconst formatDate = useFormatDate();\n\tconst showUserAvatar = !!useUserPreference<boolean>('displayAvatars');\n\n\tconst { closeTab } = useRoomToolbox();\n\tconst handleTabBarCloseButtonClick = useCallback(() => {\n\t\tcloseTab();\n\t}, [closeTab]);\n\n\tconst subscription = useRoomSubscription();\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarHeader>\n\t\t\t\t<ContextualbarIcon name={iconName} />\n\t\t\t\t<ContextualbarTitle>{title}</ContextualbarTitle>\n\t\t\t\t<ContextualbarClose onClick={handleTabBarCloseButtonClick} />\n\t\t\t</ContextualbarHeader>\n\t\t\t<ContextualbarContent flexShrink={1} flexGrow={1} paddingInline={0}>\n\t\t\t\t{queryResult.isLoading && (\n\t\t\t\t\t<Box paddingInline={24} paddingBlock={12}>\n\t\t\t\t\t\t<Throbber size='x12' />\n\t\t\t\t\t</Box>\n\t\t\t\t)}\n\t\t\t\t{queryResult.isSuccess && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t{queryResult.data.length === 0 && <ContextualbarEmptyContent title={emptyResultMessage} />}\n\n\t\t\t\t\t\t{queryResult.data.length > 0 && (\n\t\t\t\t\t\t\t<MessageListErrorBoundary>\n\t\t\t\t\t\t\t\t<MessageListProvider>\n\t\t\t\t\t\t\t\t\t<Box is='section' display='flex' flexDirection='column' flexGrow={1} flexShrink={1} flexBasis='auto' height='full'>\n\t\t\t\t\t\t\t\t\t\t<Virtuoso\n\t\t\t\t\t\t\t\t\t\t\ttotalCount={queryResult.data.length}\n\t\t\t\t\t\t\t\t\t\t\toverscan={25}\n\t\t\t\t\t\t\t\t\t\t\tdata={queryResult.data}\n\t\t\t\t\t\t\t\t\t\t\tcomponents={{ Scroller: ScrollableContentWrapper }}\n\t\t\t\t\t\t\t\t\t\t\titemContent={(index, message) => {\n\t\t\t\t\t\t\t\t\t\t\t\tconst previous = queryResult.data[index - 1];\n\n\t\t\t\t\t\t\t\t\t\t\t\tconst newDay = isMessageNewDay(message, previous);\n\n\t\t\t\t\t\t\t\t\t\t\t\tconst system = MessageTypes.isSystemMessage(message);\n\n\t\t\t\t\t\t\t\t\t\t\t\tconst unread = subscription?.tunread?.includes(message._id) ?? false;\n\t\t\t\t\t\t\t\t\t\t\t\tconst mention = subscription?.tunreadUser?.includes(message._id) ?? false;\n\t\t\t\t\t\t\t\t\t\t\t\tconst all = subscription?.tunreadGroup?.includes(message._id) ?? false;\n\n\t\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{newDay && <MessageDivider>{formatDate(message.ts)}</MessageDivider>}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{system ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<SystemMessage message={message} showUserAvatar={showUserAvatar} />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<RoomMessage\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmessage={message}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsequential={false}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tunread={unread}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmention={mention}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tall={all}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontext={context}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowUserAvatar={showUserAvatar}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t</MessageListProvider>\n\t\t\t\t\t\t\t</MessageListErrorBoundary>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</ContextualbarContent>\n\t\t</>\n\t);\n};\n\nexport default MessageListTab;\n",null],"names":["Box","MessageDivider","Throbber","useUserPreference","React","useCallback","Virtuoso","MessageTypes","ContextualbarContent","ContextualbarHeader","ContextualbarIcon","ContextualbarTitle","ContextualbarClose","ContextualbarEmptyContent","ScrollableContentWrapper","RoomMessage","SystemMessage","useFormatDate","MessageListErrorBoundary","isMessageNewDay","MessageListProvider","useRoomSubscription","useRoomToolbox","module","link","v","default","exportDefault","_ref","iconName","title","emptyResultMessage","context","queryResult","formatDate","showUserAvatar","closeTab","handleTabBarCloseButtonClick","subscription","createElement","Fragment","name","onClick","flexShrink","flexGrow","paddingInline","isLoading","paddingBlock","size","isSuccess","data","length","is","display","flexDirection","flexBasis","height","totalCount","overscan","components","Scroller","itemContent","index","message","_subscription$tunread","_subscription$tunread2","_subscription$tunread3","_subscription$tunread4","_subscription$tunread5","_subscription$tunread6","previous","newDay","system","isSystemMessage","unread","tunread","includes","_id","mention","tunreadUser","all","tunreadGroup","ts","sequential"],"mappings":"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"}