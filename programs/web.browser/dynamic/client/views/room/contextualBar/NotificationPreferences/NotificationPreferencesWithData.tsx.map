)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/NotificationPreferences/NotificationPreferencesWithData.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { SelectOption } from '@rocket.chat/fuselage';\nimport { useTranslation, useCustomSound } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { memo } from 'react';\nimport { useForm, FormProvider } from 'react-hook-form';\n\nimport { useEndpointAction } from '../../../../hooks/useEndpointAction';\nimport { useRoom, useRoomSubscription } from '../../contexts/RoomContext';\nimport { useRoomToolbox } from '../../contexts/RoomToolboxContext';\nimport NotificationPreferences from './NotificationPreferences';\n\nexport type NotificationFormValues = {\n\tturnOn: boolean;\n\tmuteGroupMentions: boolean;\n\tshowCounter: boolean;\n\tshowMentions: boolean;\n\tdesktopAlert: string;\n\tdesktopSound: string;\n\tmobileAlert: string;\n\temailAlert: string;\n};\n\nconst NotificationPreferencesWithData = (): ReactElement => {\n\tconst t = useTranslation();\n\tconst room = useRoom();\n\tconst subscription = useRoomSubscription();\n\tconst { closeTab } = useRoomToolbox();\n\tconst customSound = useCustomSound();\n\n\tconst saveSettings = useEndpointAction('POST', '/v1/rooms.saveNotification', {\n\t\tsuccessMessage: t('Room_updated_successfully'),\n\t});\n\n\tconst customSoundAsset: SelectOption[] | undefined = customSound?.getList()?.map((value) => [value._id, value.name]);\n\n\tconst defaultOption: SelectOption[] = [\n\t\t['default', t('Default')],\n\t\t['all', t('All_messages')],\n\t\t['mentions', t('Mentions')],\n\t\t['nothing', t('Nothing')],\n\t];\n\n\tconst defaultSoundOption: SelectOption[] = [\n\t\t['none', t('None')],\n\t\t['default', t('Default')],\n\t];\n\n\tconst notificationOptions = {\n\t\talerts: defaultOption,\n\t\tsounds: customSoundAsset ? [...defaultSoundOption, ...customSoundAsset] : defaultSoundOption,\n\t};\n\n\tconst methods = useForm({\n\t\tdefaultValues: {\n\t\t\tturnOn: !subscription?.disableNotifications,\n\t\t\tmuteGroupMentions: !!subscription?.muteGroupMentions,\n\t\t\tshowCounter: !subscription?.hideUnreadStatus,\n\t\t\tshowMentions: !subscription?.hideMentionStatus,\n\t\t\tdesktopAlert: (subscription?.desktopPrefOrigin === 'subscription' && subscription.desktopNotifications) || 'default',\n\t\t\tdesktopSound: subscription?.audioNotificationValue || 'default',\n\t\t\tmobileAlert: (subscription?.mobilePrefOrigin === 'subscription' && subscription.mobilePushNotifications) || 'default',\n\t\t\temailAlert: (subscription?.emailPrefOrigin === 'subscription' && subscription.emailNotifications) || 'default',\n\t\t},\n\t});\n\n\tconst { desktopSound } = methods.watch();\n\n\tconst handlePlaySound = (): void => {\n\t\tcustomSound.play(desktopSound);\n\t};\n\n\tconst handleSave = methods.handleSubmit(\n\t\t({ turnOn, muteGroupMentions, showCounter, showMentions, desktopAlert, desktopSound, mobileAlert, emailAlert }) => {\n\t\t\tconst notifications = {\n\t\t\t\tdisableNotifications: turnOn ? '0' : '1',\n\t\t\t\tmuteGroupMentions: muteGroupMentions ? '1' : '0',\n\t\t\t\thideUnreadStatus: showCounter ? '0' : '1',\n\t\t\t\thideMentionStatus: showMentions ? '0' : '1',\n\t\t\t\tdesktopNotifications: desktopAlert,\n\t\t\t\taudioNotificationValue: desktopSound,\n\t\t\t\tmobilePushNotifications: mobileAlert,\n\t\t\t\temailNotifications: emailAlert,\n\t\t\t};\n\n\t\t\tsaveSettings({\n\t\t\t\troomId: room._id,\n\t\t\t\tnotifications,\n\t\t\t});\n\t\t},\n\t);\n\n\treturn (\n\t\t<FormProvider {...methods}>\n\t\t\t<NotificationPreferences\n\t\t\t\thandleClose={closeTab}\n\t\t\t\thandleSave={handleSave}\n\t\t\t\thandlePlaySound={handlePlaySound}\n\t\t\t\tnotificationOptions={notificationOptions}\n\t\t\t/>\n\t\t</FormProvider>\n\t);\n};\n\nexport default memo(NotificationPreferencesWithData);\n",null],"names":["useTranslation","useCustomSound","React","memo","useForm","FormProvider","useEndpointAction","useRoom","useRoomSubscription","useRoomToolbox","NotificationPreferences","module","link","default","exportDefault","_customSound$getList","t","room","subscription","closeTab","customSound","saveSettings","successMessage","customSoundAsset","getList","map","value","_id","name","defaultOption","defaultSoundOption","notificationOptions","alerts","sounds","methods","defaultValues","turnOn","disableNotifications","muteGroupMentions","showCounter","hideUnreadStatus","showMentions","hideMentionStatus","desktopAlert","desktopPrefOrigin","desktopNotifications","desktopSound","audioNotificationValue","mobileAlert","mobilePrefOrigin","mobilePushNotifications","emailAlert","emailPrefOrigin","emailNotifications","watch","handleSave","handleSubmit","_ref","roomId","notifications","createElement","handleClose","handlePlaySound","play"],"mappings":"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"}