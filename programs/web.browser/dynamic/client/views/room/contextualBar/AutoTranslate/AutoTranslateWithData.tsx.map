)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/AutoTranslate/AutoTranslateWithData.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useLanguage } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useMemo, useEffect, useState, memo } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport { useEndpointAction } from '../../../../hooks/useEndpointAction';\nimport { useEndpointData } from '../../../../hooks/useEndpointData';\nimport { dispatchToastMessage } from '../../../../lib/toast';\nimport { useRoom, useRoomSubscription } from '../../contexts/RoomContext';\nimport { useRoomToolbox } from '../../contexts/RoomToolboxContext';\nimport AutoTranslate from './AutoTranslate';\n\nconst AutoTranslateWithData = (): ReactElement => {\n\tconst room = useRoom();\n\tconst subscription = useRoomSubscription();\n\tconst { closeTab } = useRoomToolbox();\n\tconst userLanguage = useLanguage();\n\tconst [currentLanguage, setCurrentLanguage] = useState(subscription?.autoTranslateLanguage ?? '');\n\tconst saveSettings = useEndpointAction('POST', '/v1/autotranslate.saveSettings');\n\tconst { t } = useTranslation();\n\n\tconst { value: translateData } = useEndpointData('/v1/autotranslate.getSupportedLanguages', {\n\t\tparams: useMemo(() => ({ targetLanguage: userLanguage }), [userLanguage]),\n\t});\n\tconst languagesDict = translateData ? Object.fromEntries(translateData.languages.map((lang) => [lang.language, lang.name])) : {};\n\n\tconst handleChangeLanguage = useMutableCallback((value) => {\n\t\tsetCurrentLanguage(value);\n\n\t\tsaveSettings({\n\t\t\troomId: room._id,\n\t\t\tfield: 'autoTranslateLanguage',\n\t\t\tvalue,\n\t\t});\n\t\tdispatchToastMessage({\n\t\t\ttype: 'success',\n\t\t\tmessage: t('AutoTranslate_language_set_to', { language: languagesDict[value] }),\n\t\t});\n\t});\n\n\tconst handleSwitch = useMutableCallback((event) => {\n\t\tsaveSettings({\n\t\t\troomId: room._id,\n\t\t\tfield: 'autoTranslate',\n\t\t\tvalue: event.target.checked,\n\t\t});\n\t\tdispatchToastMessage({\n\t\t\ttype: 'success',\n\t\t\tmessage: event.target.checked\n\t\t\t\t? t('AutoTranslate_Enabled_for_room', { roomName: room.name })\n\t\t\t\t: t('AutoTranslate_Disabled_for_room', { roomName: room.name }),\n\t\t});\n\t\tif (event.target.checked && currentLanguage) {\n\t\t\tdispatchToastMessage({\n\t\t\t\ttype: 'success',\n\t\t\t\tmessage: t('AutoTranslate_language_set_to', { language: languagesDict[currentLanguage] }),\n\t\t\t});\n\t\t}\n\t});\n\n\tuseEffect(() => {\n\t\tif (!subscription?.autoTranslate) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!subscription?.autoTranslateLanguage) {\n\t\t\thandleChangeLanguage(userLanguage);\n\t\t}\n\t}, [subscription?.autoTranslate, subscription?.autoTranslateLanguage, handleChangeLanguage, userLanguage]);\n\n\treturn (\n\t\t<AutoTranslate\n\t\t\tlanguage={currentLanguage}\n\t\t\tlanguages={translateData ? translateData.languages.map((language) => [language.language, language.name]) : []}\n\t\t\thandleSwitch={handleSwitch}\n\t\t\thandleChangeLanguage={handleChangeLanguage}\n\t\t\ttranslateEnable={!!subscription?.autoTranslate}\n\t\t\thandleClose={closeTab}\n\t\t/>\n\t);\n};\n\nexport default memo(AutoTranslateWithData);\n",null],"names":["useMutableCallback","useLanguage","React","useMemo","useEffect","useState","memo","useTranslation","useEndpointAction","useEndpointData","dispatchToastMessage","useRoom","useRoomSubscription","useRoomToolbox","AutoTranslate","module","link","default","exportDefault","_subscription$autoTra","room","subscription","closeTab","userLanguage","currentLanguage","setCurrentLanguage","autoTranslateLanguage","saveSettings","t","value","translateData","params","targetLanguage","languagesDict","Object","fromEntries","languages","map","lang","language","name","handleChangeLanguage","roomId","_id","field","type","message","handleSwitch","event","target","checked","roomName","autoTranslate","createElement","translateEnable","handleClose"],"mappings":"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"}