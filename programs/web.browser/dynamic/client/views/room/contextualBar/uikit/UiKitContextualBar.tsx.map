)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/uikit/UiKitContextualBar.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { UiKit } from '@rocket.chat/core-typings';\nimport { Avatar, Box, Button, ButtonGroup, ContextualbarFooter, ContextualbarHeader, ContextualbarTitle } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport {\n\tUiKitComponent,\n\tUiKitContextualBar as UiKitContextualBarSurfaceRender,\n\tcontextualBarParser,\n\tUiKitContext,\n} from '@rocket.chat/fuselage-ui-kit';\nimport { BlockContext } from '@rocket.chat/ui-kit';\nimport type { FormEvent, UIEvent } from 'react';\nimport React, { memo } from 'react';\n\nimport { getURL } from '../../../../../app/utils/client';\nimport { ContextualbarClose, ContextualbarScrollableContent } from '../../../../components/Contextualbar';\nimport { preventSyntheticEvent } from '../../../../lib/utils/preventSyntheticEvent';\nimport { useContextualBarContextValue } from '../../../../uikit/hooks/useContextualBarContextValue';\nimport { useUiKitActionManager } from '../../../../uikit/hooks/useUiKitActionManager';\nimport { useUiKitView } from '../../../../uikit/hooks/useUiKitView';\nimport { getButtonStyle } from '../../../modal/uikit/getButtonStyle';\nimport { useRoomToolbox } from '../../contexts/RoomToolboxContext';\n\ntype UiKitContextualBarProps = {\n\tkey: UiKit.ContextualBarView['id']; // force re-mount when viewId changes\n\tinitialView: UiKit.ContextualBarView;\n};\n\nconst UiKitContextualBar = ({ initialView }: UiKitContextualBarProps): JSX.Element => {\n\tconst actionManager = useUiKitActionManager();\n\tconst { view, values, updateValues, state } = useUiKitView(initialView);\n\tconst contextValue = useContextualBarContextValue({ view, values, updateValues });\n\n\tconst { closeTab } = useRoomToolbox();\n\n\tconst handleSubmit = useMutableCallback((e: FormEvent) => {\n\t\tpreventSyntheticEvent(e);\n\t\tcloseTab();\n\t\tvoid actionManager\n\t\t\t.emitInteraction(view.appId, {\n\t\t\t\ttype: 'viewSubmit',\n\t\t\t\tpayload: {\n\t\t\t\t\tview: {\n\t\t\t\t\t\t...view,\n\t\t\t\t\t\tstate,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tviewId: view.id,\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tactionManager.disposeView(view.id);\n\t\t\t});\n\t});\n\n\tconst handleCancel = useMutableCallback((e: UIEvent) => {\n\t\tpreventSyntheticEvent(e);\n\t\tcloseTab();\n\t\tvoid actionManager\n\t\t\t.emitInteraction(view.appId, {\n\t\t\t\ttype: 'viewClosed',\n\t\t\t\tpayload: {\n\t\t\t\t\tviewId: view.id,\n\t\t\t\t\tview: {\n\t\t\t\t\t\t...view,\n\t\t\t\t\t\tstate,\n\t\t\t\t\t},\n\t\t\t\t\tisCleared: false,\n\t\t\t\t},\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tactionManager.disposeView(view.id);\n\t\t\t});\n\t});\n\n\tconst handleClose = useMutableCallback((e: UIEvent) => {\n\t\tpreventSyntheticEvent(e);\n\t\tcloseTab();\n\t\tvoid actionManager\n\t\t\t.emitInteraction(view.appId, {\n\t\t\t\ttype: 'viewClosed',\n\t\t\t\tpayload: {\n\t\t\t\t\tviewId: view.id,\n\t\t\t\t\tview: {\n\t\t\t\t\t\t...view,\n\t\t\t\t\t\tstate,\n\t\t\t\t\t},\n\t\t\t\t\tisCleared: true,\n\t\t\t\t},\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tactionManager.disposeView(view.id);\n\t\t\t});\n\t});\n\n\treturn (\n\t\t<UiKitContext.Provider value={contextValue}>\n\t\t\t<ContextualbarHeader>\n\t\t\t\t<Avatar url={getURL(`/api/apps/${view.appId}/icon`)} />\n\t\t\t\t<ContextualbarTitle>{contextualBarParser.text(view.title, BlockContext.NONE, 0)}</ContextualbarTitle>\n\t\t\t\t{handleClose && <ContextualbarClose onClick={handleClose} />}\n\t\t\t</ContextualbarHeader>\n\t\t\t<ContextualbarScrollableContent>\n\t\t\t\t<Box is='form' method='post' action='#' onSubmit={handleSubmit}>\n\t\t\t\t\t<UiKitComponent render={UiKitContextualBarSurfaceRender} blocks={view.blocks} />\n\t\t\t\t</Box>\n\t\t\t</ContextualbarScrollableContent>\n\t\t\t<ContextualbarFooter>\n\t\t\t\t<ButtonGroup stretch>\n\t\t\t\t\t{view.close && (\n\t\t\t\t\t\t<Button danger={view.close.style === 'danger'} onClick={handleCancel}>\n\t\t\t\t\t\t\t{contextualBarParser.text(view.close.text, BlockContext.NONE, 0)}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\n\t\t\t\t\t{view.submit && (\n\t\t\t\t\t\t<Button {...getButtonStyle(view.submit)} onClick={handleSubmit}>\n\t\t\t\t\t\t\t{contextualBarParser.text(view.submit.text, BlockContext.NONE, 1)}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t</ButtonGroup>\n\t\t\t</ContextualbarFooter>\n\t\t</UiKitContext.Provider>\n\t);\n};\n\nexport default memo(UiKitContextualBar);\n",null],"names":["_extends","_objectSpread","Avatar","Box","Button","ButtonGroup","ContextualbarFooter","ContextualbarHeader","ContextualbarTitle","useMutableCallback","UiKitComponent","UiKitContextualBarSurfaceRender","contextualBarParser","UiKitContext","BlockContext","React","memo","getURL","ContextualbarClose","ContextualbarScrollableContent","preventSyntheticEvent","useContextualBarContextValue","useUiKitActionManager","useUiKitView","getButtonStyle","useRoomToolbox","module","link","default","v","UiKitContextualBar","exportDefault","_ref","initialView","actionManager","view","values","updateValues","state","contextValue","closeTab","handleSubmit","e","emitInteraction","appId","type","payload","viewId","id","finally","disposeView","handleCancel","isCleared","handleClose","createElement","Provider","value","url","concat","text","title","NONE","onClick","is","method","action","onSubmit","render","blocks","stretch","close","danger","style","submit"],"mappings":"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"}