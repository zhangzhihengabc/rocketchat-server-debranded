)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/RoomFiles/RoomFilesWithData.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useMutableCallback, useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport { useSetModal, useToastMessageDispatch, useUserId, useMethod, useTranslation } from '@rocket.chat/ui-contexts';\nimport React, { useState, useCallback, useMemo } from 'react';\n\nimport GenericModal from '../../../../components/GenericModal';\nimport { useRecordList } from '../../../../hooks/lists/useRecordList';\nimport { AsyncStatePhase } from '../../../../hooks/useAsyncState';\nimport { useRoom } from '../../contexts/RoomContext';\nimport { useRoomToolbox } from '../../contexts/RoomToolboxContext';\nimport RoomFiles from './RoomFiles';\nimport { useFilesList } from './hooks/useFilesList';\nimport { useMessageDeletionIsAllowed } from './hooks/useMessageDeletionIsAllowed';\n\nconst RoomFilesWithData = () => {\n\tconst uid = useUserId();\n\tconst room = useRoom();\n\tconst { closeTab } = useRoomToolbox();\n\tconst t = useTranslation();\n\tconst setModal = useSetModal();\n\tconst closeModal = useMutableCallback(() => setModal());\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst deleteFile = useMethod('deleteFileMessage');\n\n\tconst [type, setType] = useLocalStorage('file-list-type', 'all');\n\tconst [text, setText] = useState('');\n\n\tconst handleTextChange = useCallback((event) => {\n\t\tsetText(event.currentTarget.value);\n\t}, []);\n\n\tconst { filesList, loadMoreItems, reload } = useFilesList(useMemo(() => ({ rid: room._id, type, text }), [room._id, type, text]));\n\tconst { phase, items: filesItems, itemCount: totalItemCount } = useRecordList(filesList);\n\n\tconst handleDelete = useMutableCallback((_id) => {\n\t\tconst onConfirm = async () => {\n\t\t\ttry {\n\t\t\t\tawait deleteFile(_id);\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Deleted') });\n\t\t\t\treload();\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t\tcloseModal();\n\t\t};\n\n\t\tsetModal(\n\t\t\t<GenericModal variant='danger' onConfirm={onConfirm} onCancel={closeModal} confirmText={t('Delete')}>\n\t\t\t\t{t('Delete_File_Warning')}\n\t\t\t</GenericModal>,\n\t\t);\n\t}, []);\n\n\tconst isDeletionAllowed = useMessageDeletionIsAllowed(room._id, uid);\n\n\treturn (\n\t\t<RoomFiles\n\t\t\trid={room._id}\n\t\t\tloading={phase === AsyncStatePhase.LOADING}\n\t\t\ttype={type}\n\t\t\ttext={text}\n\t\t\tloadMoreItems={loadMoreItems}\n\t\t\tsetType={setType}\n\t\t\tsetText={handleTextChange}\n\t\t\tfilesItems={filesItems}\n\t\t\ttotal={totalItemCount}\n\t\t\tonClickClose={closeTab}\n\t\t\tonClickDelete={handleDelete}\n\t\t\tisDeletionAllowed={isDeletionAllowed}\n\t\t/>\n\t);\n};\n\nexport default RoomFilesWithData;\n",null],"names":["useMutableCallback","useLocalStorage","useSetModal","useToastMessageDispatch","useUserId","useMethod","useTranslation","React","useState","useCallback","useMemo","GenericModal","useRecordList","AsyncStatePhase","useRoom","useRoomToolbox","RoomFiles","useFilesList","useMessageDeletionIsAllowed","module","link","v","default","exportDefault","uid","room","closeTab","t","setModal","closeModal","dispatchToastMessage","deleteFile","type","setType","text","setText","handleTextChange","event","currentTarget","value","filesList","loadMoreItems","reload","rid","_id","phase","items","filesItems","itemCount","totalItemCount","handleDelete","onConfirm","message","error","createElement","variant","onCancel","confirmText","isDeletionAllowed","loading","LOADING","total","onClickClose","onClickDelete"],"mappings":"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"}