)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/Threads/hooks/useToggleFollowingThreadMutation.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IMessage } from '@rocket.chat/core-typings';\nimport { useEndpoint } from '@rocket.chat/ui-contexts';\nimport type { UseMutationOptions, UseMutationResult } from '@tanstack/react-query';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\n\n// TODO: its core should be moved to the ChatContext\n\ntype UseToggleFollowingThreadMutationVariables = {\n\trid: IMessage['rid'];\n\ttmid: IMessage['_id'];\n\tfollow: boolean;\n};\n\nexport const useToggleFollowingThreadMutation = (\n\toptions?: Omit<UseMutationOptions<void, Error, UseToggleFollowingThreadMutationVariables>, 'mutationFn'>,\n): UseMutationResult<void, Error, UseToggleFollowingThreadMutationVariables> => {\n\tconst followMessage = useEndpoint('POST', '/v1/chat.followMessage');\n\tconst unfollowMessage = useEndpoint('POST', '/v1/chat.unfollowMessage');\n\n\tconst queryClient = useQueryClient();\n\n\treturn useMutation(\n\t\tasync ({ tmid, follow }) => {\n\t\t\tif (follow) {\n\t\t\t\tawait followMessage({ mid: tmid });\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait unfollowMessage({ mid: tmid });\n\t\t},\n\t\t{\n\t\t\t...options,\n\t\t\tonSuccess: async (data, variables, context) => {\n\t\t\t\tawait queryClient.invalidateQueries(['rooms', variables.rid, 'threads']);\n\t\t\t\treturn options?.onSuccess?.(data, variables, context);\n\t\t\t},\n\t\t},\n\t);\n};\n",null],"names":["_objectSpread","useEndpoint","useMutation","useQueryClient","module","link","default","export","useToggleFollowingThreadMutation","options","followMessage","unfollowMessage","queryClient","_ref","tmid","follow","mid","onSuccess","data","variables","context","_options$onSuccess","invalidateQueries","rid","call"],"mappings":"2BACAA,EAAuDC,EAAAC,EAAAC,EAA9CC,EAAaC,IAAM,CAAA,uCAA2B,CAAAC,QAAAA,CAAAA,EAAAN,EAAAA,CAAA,CAAA,EAAA,GAAvDI,EAAOG,MAAE,CAAA,CAAAC,iCAAmB,IAAAA,CAA2B,GAAAJ,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAH,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAF,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAYhD,IAAMK,EACZC,IAEA,IAAMC,EAAgBT,EAAY,OAAQ,0BACpCU,EAAkBV,EAAY,OAAQ,4BAEtCW,EAAcT,IAEpB,OAAOD,EACN,MAAAW,IAA2B,GAApB,CAAEC,KAAAA,CAAI,CAAEC,OAAAA,CAAAA,CAAQ,CAAAF,EACtB,GAAIE,EAAQ,CACX,MAAML,EAAc,CAAEM,IAAKF,CAAI,GAC/B,OAGD,MAAMH,EAAgB,CAAEK,IAAKF,CAAI,EAClC,EAACd,EAAAA,EAAA,CAAA,EAEGS,GAAO,CAAA,EAAA,CACVQ,UAAW,MAAOC,EAAMC,EAAWC,KAAW,IAAAC,EAE7C,OADA,MAAMT,EAAYU,iBAAiB,CAAC,CAAC,QAASH,EAAUI,GAAG,CAAE,UAAU,EAChEd,MAAAA,EAAO,KAAA,EAAA,AAAW,OAAXY,CAAAA,EAAPZ,EAASQ,SAAS,AAATA,GAASI,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAlBA,EAAAG,IAAA,CAAAf,EAAqBS,EAAMC,EAAWC,EAC9C,CAAC,GAGJ"}