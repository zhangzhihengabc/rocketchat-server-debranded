)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/Threads/Thread.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IMessage } from '@rocket.chat/core-typings';\nimport { css } from '@rocket.chat/css-in-js';\nimport { Box, Modal, Skeleton } from '@rocket.chat/fuselage';\nimport { useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport { useLayoutContextualBarExpanded, useToastMessageDispatch, useTranslation, useUserId } from '@rocket.chat/ui-contexts';\nimport type { VFC } from 'react';\nimport React from 'react';\n\nimport {\n\tContextualbar,\n\tContextualbarHeader,\n\tContextualbarAction,\n\tContextualbarActions,\n\tContextualbarClose,\n\tContextualbarBack,\n\tContextualbarInnerContent,\n} from '../../../../components/Contextualbar';\nimport { useRoomToolbox } from '../../contexts/RoomToolboxContext';\nimport { useGoToThreadList } from '../../hooks/useGoToThreadList';\nimport ChatProvider from '../../providers/ChatProvider';\nimport ThreadChat from './components/ThreadChat';\nimport ThreadSkeleton from './components/ThreadSkeleton';\nimport ThreadTitle from './components/ThreadTitle';\nimport { useThreadMainMessageQuery } from './hooks/useThreadMainMessageQuery';\nimport { useToggleFollowingThreadMutation } from './hooks/useToggleFollowingThreadMutation';\n\ntype ThreadProps = {\n\ttmid: IMessage['_id'];\n};\n\nconst Thread: VFC<ThreadProps> = ({ tmid }) => {\n\tconst goToThreadList = useGoToThreadList({ replace: true });\n\tconst { closeTab } = useRoomToolbox();\n\n\tconst mainMessageQueryResult = useThreadMainMessageQuery(tmid, {\n\t\tonDelete: () => {\n\t\t\tcloseTab();\n\t\t},\n\t});\n\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst canExpand = useLayoutContextualBarExpanded();\n\tconst [expanded, setExpanded] = useLocalStorage('expand-threads', false);\n\n\tconst uid = useUserId();\n\tconst following = uid ? mainMessageQueryResult.data?.replies?.includes(uid) ?? false : false;\n\tconst toggleFollowingMutation = useToggleFollowingThreadMutation({\n\t\tonError: (error) => {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t},\n\t});\n\n\tconst handleBackdropClick = () => {\n\t\tcloseTab();\n\t};\n\n\tconst handleGoBack = () => {\n\t\tgoToThreadList();\n\t};\n\n\tconst handleToggleExpand = () => {\n\t\tsetExpanded((expanded) => !expanded);\n\t};\n\n\tconst handleToggleFollowing = () => {\n\t\tconst rid = mainMessageQueryResult.data?.rid;\n\n\t\tif (!rid) {\n\t\t\treturn;\n\t\t}\n\n\t\ttoggleFollowingMutation.mutate({ rid, tmid, follow: !following });\n\t};\n\n\tconst handleClose = () => {\n\t\tcloseTab();\n\t};\n\n\treturn (\n\t\t<ContextualbarInnerContent>\n\t\t\t{canExpand && expanded && <Modal.Backdrop onClick={handleBackdropClick} />}\n\t\t\t<Box flexGrow={1} position={expanded ? 'static' : 'relative'}>\n\t\t\t\t<Contextualbar\n\t\t\t\t\trcx-thread-view\n\t\t\t\t\tclassName={\n\t\t\t\t\t\tcanExpand && expanded\n\t\t\t\t\t\t\t? css`\n\t\t\t\t\t\t\t\t\tmax-width: 855px !important;\n\t\t\t\t\t\t\t\t\t@media (min-width: 780px) and (max-width: 1135px) {\n\t\t\t\t\t\t\t\t\t\tmax-width: calc(100% - var(--sidebar-width)) !important;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t  `\n\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t}\n\t\t\t\t\tposition={expanded ? 'fixed' : 'absolute'}\n\t\t\t\t\tdisplay='flex'\n\t\t\t\t\tflexDirection='column'\n\t\t\t\t\twidth='full'\n\t\t\t\t\toverflow='hidden'\n\t\t\t\t\tzIndex={100}\n\t\t\t\t\tinsetBlock={0}\n\t\t\t\t\tborder='none'\n\t\t\t\t>\n\t\t\t\t\t<ContextualbarHeader expanded={expanded}>\n\t\t\t\t\t\t<ContextualbarBack onClick={handleGoBack} />\n\t\t\t\t\t\t{(mainMessageQueryResult.isLoading && <Skeleton width='100%' />) ||\n\t\t\t\t\t\t\t(mainMessageQueryResult.isSuccess && <ThreadTitle mainMessage={mainMessageQueryResult.data} />) ||\n\t\t\t\t\t\t\tnull}\n\t\t\t\t\t\t<ContextualbarActions>\n\t\t\t\t\t\t\t{canExpand && (\n\t\t\t\t\t\t\t\t<ContextualbarAction\n\t\t\t\t\t\t\t\t\tname={expanded ? 'arrow-collapse' : 'arrow-expand'}\n\t\t\t\t\t\t\t\t\ttitle={expanded ? t('Collapse') : t('Expand')}\n\t\t\t\t\t\t\t\t\tonClick={handleToggleExpand}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<ContextualbarAction\n\t\t\t\t\t\t\t\tname={following ? 'bell' : 'bell-off'}\n\t\t\t\t\t\t\t\ttitle={following ? t('Following') : t('Not_Following')}\n\t\t\t\t\t\t\t\tdisabled={!mainMessageQueryResult.isSuccess || toggleFollowingMutation.isLoading}\n\t\t\t\t\t\t\t\tonClick={handleToggleFollowing}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<ContextualbarClose onClick={handleClose} />\n\t\t\t\t\t\t</ContextualbarActions>\n\t\t\t\t\t</ContextualbarHeader>\n\n\t\t\t\t\t{(mainMessageQueryResult.isLoading && <ThreadSkeleton />) ||\n\t\t\t\t\t\t(mainMessageQueryResult.isSuccess && (\n\t\t\t\t\t\t\t<ChatProvider tmid={tmid}>\n\t\t\t\t\t\t\t\t<ThreadChat mainMessage={mainMessageQueryResult.data} />\n\t\t\t\t\t\t\t</ChatProvider>\n\t\t\t\t\t\t)) ||\n\t\t\t\t\t\tnull}\n\t\t\t\t</Contextualbar>\n\t\t\t</Box>\n\t\t</ContextualbarInnerContent>\n\t);\n};\n\nexport default Thread;\n",null],"names":["_taggedTemplateLiteral","css","Box","Modal","Skeleton","useLocalStorage","useLayoutContextualBarExpanded","useToastMessageDispatch","useTranslation","useUserId","React","Contextualbar","ContextualbarHeader","ContextualbarAction","ContextualbarActions","ContextualbarClose","ContextualbarBack","ContextualbarInnerContent","useRoomToolbox","useGoToThreadList","ChatProvider","ThreadChat","ThreadSkeleton","ThreadTitle","useThreadMainMessageQuery","useToggleFollowingThreadMutation","module","default","link","exportDefault","_ref","_mainMessageQueryResu","_mainMessageQueryResu2","_mainMessageQueryResu3","tmid","goToThreadList","replace","closeTab","mainMessageQueryResult","onDelete","t","dispatchToastMessage","canExpand","expanded","setExpanded","uid","following","data","replies","includes","toggleFollowingMutation","onError","error","type","message","createElement","Backdrop","onClick","flexGrow","position","className","_templateObject","undefined","display","flexDirection","width","overflow","zIndex","insetBlock","border","isLoading","isSuccess","mainMessage","name","title","disabled","_mainMessageQueryResu4","rid","mutate","follow"],"mappings":"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"}