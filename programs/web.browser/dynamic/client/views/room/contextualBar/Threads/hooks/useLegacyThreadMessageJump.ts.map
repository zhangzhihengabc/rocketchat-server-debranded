)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/Threads/hooks/useLegacyThreadMessageJump.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useRouter, useSearchParameter } from '@rocket.chat/ui-contexts';\nimport { useRef, useEffect } from 'react';\n\nimport { waitForElement } from '../../../../../lib/utils/waitForElement';\nimport { clearHighlightMessage, setHighlightMessage } from '../../../MessageList/providers/messageHighlightSubscription';\n\nexport const useLegacyThreadMessageJump = ({ enabled = true }: { enabled?: boolean }) => {\n\tconst router = useRouter();\n\tconst mid = useSearchParameter('msg');\n\n\tconst clearQueryStringParameter = () => {\n\t\tconst name = router.getRouteName();\n\n\t\tif (!name) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { msg: _, ...search } = router.getSearchParameters();\n\n\t\trouter.navigate(\n\t\t\t{\n\t\t\t\tname,\n\t\t\t\tparams: router.getRouteParameters(),\n\t\t\t\tsearch,\n\t\t\t},\n\t\t\t{ replace: true },\n\t\t);\n\t};\n\n\tconst parentRef = useRef<HTMLElement>(null);\n\tconst clearQueryStringParameterRef = useRef(clearQueryStringParameter);\n\tclearQueryStringParameterRef.current = clearQueryStringParameter;\n\n\tuseEffect(() => {\n\t\tconst parent = parentRef.current;\n\n\t\tif (!enabled || !mid || !parent) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst abortController = new AbortController();\n\n\t\twaitForElement<HTMLElement>(`[data-id='${mid}']`, { parent, signal: abortController.signal }).then((messageElement) => {\n\t\t\tif (abortController.signal.aborted) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsetHighlightMessage(mid);\n\t\t\tclearQueryStringParameterRef.current?.();\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tclearHighlightMessage();\n\t\t\t}, 1000);\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (abortController.signal.aborted) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tmessageElement.scrollIntoView({\n\t\t\t\t\tbehavior: 'smooth',\n\t\t\t\t\tblock: 'nearest',\n\t\t\t\t});\n\t\t\t}, 300);\n\t\t});\n\n\t\treturn () => {\n\t\t\tabortController.abort();\n\t\t};\n\t}, [enabled, mid]);\n\n\treturn { parentRef };\n};\n",null],"names":["_objectWithoutProperties","useRouter","useSearchParameter","useRef","useEffect","waitForElement","clearHighlightMessage","setHighlightMessage","module","default","export","useLegacyThreadMessageJump","_ref","enabled","router","mid","clearQueryStringParameter","name","getRouteName","_router$getSearchPara","getSearchParameters","msg","_","search","_excluded","navigate","params","getRouteParameters","replace","parentRef","clearQueryStringParameterRef","current","parent","abortController","AbortController","concat","signal","then","messageElement","_clearQueryStringPara","aborted","call","setTimeout","scrollIntoView","behavior","block","abort"],"mappings":"2BAAAA,EAAyEC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,gBAArDC,EAAAA,IAAoB,CAAA,iDAAiC,CAAAC,QAAAA,CAAAA,EAAAT,EAAAA,CAAA,CAAA,EAAA,GAAzEQ,EAAOE,MAAE,CAAA,CAAAC,2BAA+B,IAAMA,CAA0B,GAACH,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAP,UAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,mBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,QAAAA,CAAAL,OAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,UAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,0CAAAA,CAAAH,eAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,8DAAAA,CAAAF,sBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,oBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAMlE,IAAMI,EAA6BC,IAA8C,GAA7C,CAAEC,QAAAA,EAAU,CAAA,CAAA,CAA6B,CAAAD,EAC7EE,EAASb,IACTc,EAAMb,EAAmB,OAEzBc,EAA4B,KACjC,IAAMC,EAAOH,EAAOI,YAAY,GAEhC,GAAI,CAACD,EACJ,OAGD,IAAAE,EAA8BL,EAAOM,mBAAmB,GAAlD,CAAEC,IAAKC,CAAAA,CAAc,CAAAH,EAARI,EAAMvB,EAAAmB,EAAAK,GAEzBV,EAAOW,QAAQ,CACd,CACCR,KAAAA,EACAS,OAAQZ,EAAOa,kBAAkB,GACjCJ,OAAAA,GAED,CAAEK,QAAS,CAAA,CAAI,EAEjB,EAEMC,EAAY1B,EAAoB,MAChC2B,EAA+B3B,EAAOa,GAyC5C,OAxCAc,EAA6BC,OAAO,CAAGf,EAEvCZ,EAAU,KACT,IAAM4B,EAASH,EAAUE,OAAO,CAEhC,GAAI,CAAClB,GAAW,CAACE,GAAO,CAACiB,EACxB,OAGD,IAAMC,EAAkB,IAAIC,gBA0B5B,OAxBA7B,EAAc,aAAA8B,MAAA,CAA2BpB,EAAG,MAAM,CAAEiB,OAAAA,EAAQI,OAAQH,EAAgBG,MAAAA,AAAM,GAAIC,IAAI,CAAEC,IAAkB,IAAAC,CACjHN,CAAAA,EAAgBG,MAAM,CAACI,OAAO,GAIlCjC,EAAoBQ,GACpB,AAAoC,OAApCwB,CAAAA,EAAAT,EAA6BC,OAAO,AAAPA,GAAOQ,AAAA,KAAA,IAAAA,GAApCA,EAAAE,IAAA,CAAAX,GAEAY,WAAW,KACVpC,GACD,EAAG,KAEHoC,WAAW,KACNT,EAAgBG,MAAM,CAACI,OAAO,EAIlCF,EAAeK,cAAc,CAAC,CAC7BC,SAAU,SACVC,MAAO,WAET,EAAG,KACJ,GAEO,KACNZ,EAAgBa,KAAK,EACtB,CACD,EAAG,CAACjC,EAASE,EAAI,EAEV,CAAEc,UAAAA,CAAS,CACnB"}