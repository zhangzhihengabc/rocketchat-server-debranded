)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/RoomMembers/InviteUsers/InviteUsersWithData.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IRoom } from '@rocket.chat/core-typings';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useEndpoint, useTranslation, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useState, useEffect } from 'react';\n\nimport { useFormatDateAndTime } from '../../../../../hooks/useFormatDateAndTime';\nimport { useRoomToolbox } from '../../../contexts/RoomToolboxContext';\nimport InviteUsers from './InviteUsers';\n\ntype InviteUsersWithDataProps = {\n\trid: IRoom['_id'];\n\tonClickBack: () => void;\n};\n\nconst InviteUsersWithData = ({ rid, onClickBack }: InviteUsersWithDataProps): ReactElement => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst [\n\t\t{\n\t\t\tisEditing,\n\t\t\turl,\n\t\t\tcaption,\n\t\t\terror,\n\t\t\tdaysAndMaxUses: { days, maxUses },\n\t\t},\n\t\tsetInviteState,\n\t] = useState({\n\t\tisEditing: false,\n\t\tdaysAndMaxUses: { days: '1', maxUses: '0' },\n\t\turl: '',\n\t\tcaption: '',\n\t\terror: undefined as Error | undefined,\n\t});\n\n\tconst { closeTab } = useRoomToolbox();\n\tconst format = useFormatDateAndTime();\n\tconst findOrCreateInvite = useEndpoint('POST', '/v1/findOrCreateInvite');\n\n\tconst handleEdit = useMutableCallback(() => setInviteState((prevState) => ({ ...prevState, isEditing: true })));\n\tconst handleBackToLink = useMutableCallback(() => setInviteState((prevState) => ({ ...prevState, isEditing: false })));\n\n\tconst linkExpirationText = useMutableCallback((data) => {\n\t\tif (!data) {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (data.expires) {\n\t\t\tconst expiration = new Date(data.expires);\n\t\t\tif (data.maxUses) {\n\t\t\t\tconst usesLeft = data.maxUses - data.uses;\n\t\t\t\treturn t('Your_invite_link_will_expire_on__date__or_after__usesLeft__uses', {\n\t\t\t\t\tdate: format(expiration),\n\t\t\t\t\tusesLeft,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn t('Your_invite_link_will_expire_on__date__', { date: format(expiration) });\n\t\t}\n\n\t\tif (data.maxUses) {\n\t\t\tconst usesLeft = data.maxUses - data.uses;\n\t\t\treturn t('Your_invite_link_will_expire_after__usesLeft__uses', { usesLeft });\n\t\t}\n\n\t\treturn t('Your_invite_link_will_never_expire');\n\t});\n\n\tuseEffect(() => {\n\t\t(async (): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tconst data = await findOrCreateInvite({ rid, days: Number(days), maxUses: Number(maxUses) });\n\t\t\t\tsetInviteState((prevState) => ({ ...prevState, url: data?.url, caption: linkExpirationText(data) }));\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Invite_link_generated') });\n\t\t\t} catch (error) {\n\t\t\t\tsetInviteState((prevState) => ({ ...prevState, error: error as Error }));\n\t\t\t}\n\t\t})();\n\t}, [dispatchToastMessage, t, findOrCreateInvite, linkExpirationText, rid, days, maxUses]);\n\n\tconst handleGenerateLink = useMutableCallback((daysAndMaxUses) => {\n\t\tsetInviteState((prevState) => ({ ...prevState, daysAndMaxUses, isEditing: false }));\n\t});\n\n\treturn (\n\t\t<InviteUsers\n\t\t\tisEditing={isEditing}\n\t\t\terror={error}\n\t\t\tlinkText={url}\n\t\t\tcaptionText={caption}\n\t\t\tdaysAndMaxUses={{ days, maxUses }}\n\t\t\tonClose={closeTab}\n\t\t\tonClickBackMembers={onClickBack}\n\t\t\tonClickBackLink={handleBackToLink}\n\t\t\tonClickEdit={handleEdit}\n\t\t\tonClickNewLink={handleGenerateLink}\n\t\t/>\n\t);\n};\n\nexport default InviteUsersWithData;\n",null],"names":["_objectSpread","useMutableCallback","useEndpoint","useTranslation","useToastMessageDispatch","React","useState","useEffect","useFormatDateAndTime","useRoomToolbox","InviteUsers","module","default","link","exportDefault","_ref","rid","onClickBack","t","dispatchToastMessage","isEditing","url","caption","error","daysAndMaxUses","days","maxUses","setInviteState","undefined","closeTab","format","findOrCreateInvite","handleEdit","prevState","handleBackToLink","linkExpirationText","data","expires","expiration","Date","usesLeft","uses","date","Number","type","message","handleGenerateLink","createElement","linkText","captionText","onClose","onClickBackMembers","onClickBackLink","onClickEdit","onClickNewLink"],"mappings":"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"}