)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/Info/hooks/actions/useRoomLeave.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IRoom } from '@rocket.chat/core-typings';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\nimport { useRouter, useSetModal, useToastMessageDispatch, useMethod, useTranslation, usePermission } from '@rocket.chat/ui-contexts';\nimport React from 'react';\n\nimport { LegacyRoomManager } from '../../../../../../../app/ui-utils/client';\nimport { UiTextContext } from '../../../../../../../definition/IRoomTypeConfig';\nimport WarningModal from '../../../../../../components/WarningModal';\nimport { roomCoordinator } from '../../../../../../lib/rooms/roomCoordinator';\n\n// TODO implement joined\nexport const useRoomLeave = (room: IRoom, joined = true) => {\n\tconst t = useTranslation();\n\tconst setModal = useSetModal();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst leaveRoom = useMethod('leaveRoom');\n\tconst router = useRouter();\n\n\tconst canLeave = usePermission(room.t === 'c' ? 'leave-c' : 'leave-p') && room.cl !== false && joined;\n\n\tconst handleLeave = useMutableCallback(() => {\n\t\tconst leaveAction = async () => {\n\t\t\ttry {\n\t\t\t\tawait leaveRoom(room._id);\n\t\t\t\trouter.navigate('/home');\n\t\t\t\tLegacyRoomManager.close(room._id);\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t\tsetModal(null);\n\t\t};\n\n\t\tconst warnText = roomCoordinator.getRoomDirectives(room.t).getUiText(UiTextContext.LEAVE_WARNING);\n\n\t\tsetModal(\n\t\t\t<WarningModal\n\t\t\t\ttext={t(warnText as TranslationKey, room.fname || room.name)}\n\t\t\t\tconfirmText={t('Leave_room')}\n\t\t\t\tclose={() => setModal(null)}\n\t\t\t\tcancel={() => setModal(null)}\n\t\t\t\tcancelText={t('Cancel')}\n\t\t\t\tconfirm={leaveAction}\n\t\t\t/>,\n\t\t);\n\t});\n\n\treturn canLeave ? handleLeave : null;\n};\n",null],"names":["useMutableCallback","useRouter","useSetModal","useToastMessageDispatch","useMethod","useTranslation","usePermission","React","LegacyRoomManager","UiTextContext","WarningModal","roomCoordinator","module","export","useRoomLeave","default","room","joined","arguments","length","undefined","t","setModal","dispatchToastMessage","leaveRoom","router","canLeave","cl","handleLeave","leaveAction","_id","navigate","close","error","type","message","warnText","getRoomDirectives","getUiText","LEAVE_WARNING","createElement","text","fname","name","confirmText","cancel","cancelText","confirm"],"mappings":"2BACmCA,EAA8BC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAjEC,EAAOC,MAAE,CAAA,CAAAC,aAAkB,IAAEA,CAAM,GAA8BF,EAAAA,IAAAA,CAAAA,8BAAAA,CAAAZ,mBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAY,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAX,UAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,wBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,UAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,cAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,QAAAA,CAAAG,QAAAA,CAAAA,EAAAR,EAAAA,CAAA,CAAA,EAAA,GAAAK,EAAAA,IAAAA,CAAAA,2CAAAA,CAAAJ,kBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,kDAAAA,CAAAH,cAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,4CAAAA,CAAAG,QAAAA,CAAAA,EAAAL,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,8CAAAA,CAAAD,gBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAW1D,IAAMG,EAAe,SAACE,CAAW,EAAmB,IAAjBC,EAAMC,CAAAA,CAAAA,UAAAC,MAAA,CAAA,CAAA,GAAAD,AAAAE,KAAAA,IAAAF,SAAA,CAAA,EAAA,EAAAA,SAAA,CAAA,EAAA,CACzCG,EAAIhB,IACJiB,EAAWpB,IACXqB,EAAuBpB,IACvBqB,EAAYpB,EAAU,aACtBqB,EAASxB,IAETyB,EAAWpB,EAAcU,AAAW,MAAXA,EAAKK,CAAC,CAAW,UAAY,YAAcL,AAAY,CAAA,IAAZA,EAAKW,EAAE,EAAcV,EAEzFW,EAAc5B,EAAmB,KACtC,IAAM6B,EAAc,UACnB,GAAI,CACH,MAAML,EAAUR,EAAKc,GAAG,EACxBL,EAAOM,QAAQ,CAAC,SAChBvB,EAAkBwB,KAAK,CAAChB,EAAKc,GAAG,EAC/B,MAAOG,EAAO,CACfV,EAAqB,CAAEW,KAAM,QAASC,QAASF,CAAK,GAErDX,EAAS,KACV,EAEMc,EAAWzB,EAAgB0B,iBAAiB,CAACrB,EAAKK,CAAC,EAAEiB,SAAS,CAAC7B,EAAc8B,aAAa,EAEhGjB,EACCf,EAAAiC,aAAA,CAAC9B,EAAY,CACZ+B,KAAMpB,EAAEe,EAA4BpB,EAAK0B,KAAK,EAAI1B,EAAK2B,IAAI,EAC3DC,YAAavB,EAAE,cACfW,MAAO,IAAMV,EAAS,MACtBuB,OAAQ,IAAMvB,EAAS,MACvBwB,WAAYzB,EAAE,UACd0B,QAASlB,CAAY,GAGxB,GAEA,OAAOH,EAAWE,EAAc,IACjC"}