)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/contextualBar/Info/EditRoomInfo/useEditRoomPermissions.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IRoom, IRoomWithRetentionPolicy } from '@rocket.chat/core-typings';\nimport { usePermission, useAtLeastOnePermission, useRole } from '@rocket.chat/ui-contexts';\nimport { useMemo } from 'react';\n\nimport { e2e } from '../../../../../../app/e2e/client/rocketchat.e2e';\nimport { RoomSettingsEnum } from '../../../../../../definition/IRoomTypeConfig';\nimport { roomCoordinator } from '../../../../../lib/rooms/roomCoordinator';\n\nconst getCanChangeType = (room: IRoom | IRoomWithRetentionPolicy, canCreateChannel: boolean, canCreateGroup: boolean, isAdmin: boolean) =>\n\t(!room.default || isAdmin) && ((room.t === 'p' && canCreateChannel) || (room.t === 'c' && canCreateGroup));\n\nexport const useEditRoomPermissions = (room: IRoom | IRoomWithRetentionPolicy) => {\n\tconst isAdmin = useRole('admin');\n\tconst canCreateChannel = usePermission('create-c');\n\tconst canCreateGroup = usePermission('create-p');\n\n\tconst canChangeType = getCanChangeType(room, canCreateChannel, canCreateGroup, isAdmin);\n\tconst canSetReadOnly = usePermission('set-readonly', room._id);\n\tconst canSetReactWhenReadOnly = usePermission('set-react-when-readonly', room._id);\n\tconst canEditRoomRetentionPolicy = usePermission('edit-room-retention-policy', room._id);\n\tconst canArchiveOrUnarchive = useAtLeastOnePermission(\n\t\tuseMemo(() => ['archive-room', 'unarchive-room'], []),\n\t\troom._id,\n\t);\n\tconst canToggleEncryption = usePermission('toggle-room-e2e-encryption', room._id) && (room.encrypted || e2e.isReady());\n\n\tconst [\n\t\tcanViewName,\n\t\tcanViewTopic,\n\t\tcanViewAnnouncement,\n\t\tcanViewArchived,\n\t\tcanViewDescription,\n\t\tcanViewType,\n\t\tcanViewReadOnly,\n\t\tcanViewHideSysMes,\n\t\tcanViewJoinCode,\n\t\tcanViewEncrypted,\n\t] = useMemo(() => {\n\t\tconst isAllowed =\n\t\t\troomCoordinator.getRoomDirectives(room.t)?.allowRoomSettingChange ||\n\t\t\t(() => {\n\t\t\t\tundefined;\n\t\t\t});\n\t\treturn [\n\t\t\tisAllowed(room, RoomSettingsEnum.NAME),\n\t\t\tisAllowed(room, RoomSettingsEnum.TOPIC),\n\t\t\tisAllowed(room, RoomSettingsEnum.ANNOUNCEMENT),\n\t\t\tisAllowed(room, RoomSettingsEnum.ARCHIVE_OR_UNARCHIVE),\n\t\t\tisAllowed(room, RoomSettingsEnum.DESCRIPTION),\n\t\t\tisAllowed(room, RoomSettingsEnum.TYPE),\n\t\t\tisAllowed(room, RoomSettingsEnum.READ_ONLY),\n\t\t\tisAllowed(room, RoomSettingsEnum.SYSTEM_MESSAGES),\n\t\t\tisAllowed(room, RoomSettingsEnum.JOIN_CODE),\n\t\t\tisAllowed(room, RoomSettingsEnum.REACT_WHEN_READ_ONLY),\n\t\t\tisAllowed(room, RoomSettingsEnum.E2E),\n\t\t];\n\t}, [room]);\n\n\treturn {\n\t\tcanChangeType,\n\t\tcanSetReadOnly,\n\t\tcanSetReactWhenReadOnly,\n\t\tcanEditRoomRetentionPolicy,\n\t\tcanArchiveOrUnarchive,\n\t\tcanToggleEncryption,\n\t\tcanViewName,\n\t\tcanViewTopic,\n\t\tcanViewAnnouncement,\n\t\tcanViewArchived,\n\t\tcanViewDescription,\n\t\tcanViewType,\n\t\tcanViewReadOnly,\n\t\tcanViewHideSysMes,\n\t\tcanViewJoinCode,\n\t\tcanViewEncrypted,\n\t};\n};\n",null],"names":["usePermission","useAtLeastOnePermission","useRole","useMemo","e2e","RoomSettingsEnum","roomCoordinator","module","export","useEditRoomPermissions","getCanChangeType","room","canCreateChannel","canCreateGroup","isAdmin","default","t","canChangeType","canSetReadOnly","_id","canSetReactWhenReadOnly","canEditRoomRetentionPolicy","canArchiveOrUnarchive","canToggleEncryption","encrypted","isReady","canViewName","canViewTopic","canViewAnnouncement","canViewArchived","canViewDescription","canViewType","canViewReadOnly","canViewHideSysMes","canViewJoinCode","canViewEncrypted","_roomCoordinator$getR","isAllowed","getRoomDirectives","allowRoomSettingChange","NAME","TOPIC","ANNOUNCEMENT","ARCHIVE_OR_UNARCHIVE","DESCRIPTION","TYPE","READ_ONLY","SYSTEM_MESSAGES","JOIN_CODE","REACT_WHEN_READ_ONLY","E2E"],"mappings":"2BACgEA,EAAAC,EAA2BC,EAAAC,EAAAC,EAAAC,EAAAC,EAA3FC,EAAOC,MAAE,CAAA,CAAAC,uBAAe,IAAAA,CAAwC,GAA2BF,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAP,cAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,wBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,QAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAK,EAAAA,IAAAA,CAAAA,QAAAA,CAAAJ,QAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,kDAAAA,CAAAH,IAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,+CAAAA,CAAAF,iBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,2CAAAA,CAAAD,gBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAO3F,IAAMI,EAAmB,CAACC,EAAwCC,EAA2BC,EAAyBC,IACrH,AAAC,CAAA,CAACH,EAAKI,OAAO,EAAID,CAAAA,GAAcH,CAAAA,AAAW,MAAXA,EAAKK,CAAC,EAAYJ,GAAsBD,AAAW,MAAXA,EAAKK,CAAC,EAAYH,CAAAA,EAE9EJ,EAA0BE,IACtC,IAAMG,EAAUZ,EAAQ,SAClBU,EAAmBZ,EAAc,YACjCa,EAAiBb,EAAc,YAE/BiB,EAAgBP,EAAiBC,EAAMC,EAAkBC,EAAgBC,GACzEI,EAAiBlB,EAAc,eAAgBW,EAAKQ,GAAG,EACvDC,EAA0BpB,EAAc,0BAA2BW,EAAKQ,GAAG,EAC3EE,EAA6BrB,EAAc,6BAA8BW,EAAKQ,GAAG,EACjFG,EAAwBrB,EAC7BE,EAAQ,IAAM,CAAC,eAAgB,iBAAiB,CAAE,EAAE,EACpDQ,EAAKQ,GAAG,EAEHI,EAAsBvB,EAAc,6BAA8BW,EAAKQ,GAAG,GAAMR,CAAAA,EAAKa,SAAS,EAAIpB,EAAIqB,OAAO,EAAA,EAE7G,CACLC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACA,CAAGhC,EAAQ,KAAK,IAAAiC,EAChB,IAAMC,EACL,CAAA,AAAyC,OAAzCD,CAAAA,EAAA9B,EAAgBgC,iBAAiB,CAAC3B,EAAKK,CAAC,CAAA,GAACoB,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAzCA,EAA2CG,sBAAsB,AAAtBA,GAC1C,CAAA,KAED,CAAA,EACD,MAAO,CACNF,EAAU1B,EAAMN,EAAiBmC,IAAI,EACrCH,EAAU1B,EAAMN,EAAiBoC,KAAK,EACtCJ,EAAU1B,EAAMN,EAAiBqC,YAAY,EAC7CL,EAAU1B,EAAMN,EAAiBsC,oBAAoB,EACrDN,EAAU1B,EAAMN,EAAiBuC,WAAW,EAC5CP,EAAU1B,EAAMN,EAAiBwC,IAAI,EACrCR,EAAU1B,EAAMN,EAAiByC,SAAS,EAC1CT,EAAU1B,EAAMN,EAAiB0C,eAAe,EAChDV,EAAU1B,EAAMN,EAAiB2C,SAAS,EAC1CX,EAAU1B,EAAMN,EAAiB4C,oBAAoB,EACrDZ,EAAU1B,EAAMN,EAAiB6C,GAAG,EACpC,AACF,EAAG,CAACvC,EAAK,EAET,MAAO,CACNM,cAAAA,EACAC,eAAAA,EACAE,wBAAAA,EACAC,2BAAAA,EACAC,sBAAAA,EACAC,oBAAAA,EACAG,YAAAA,EACAC,aAAAA,EACAC,oBAAAA,EACAC,gBAAAA,EACAC,mBAAAA,EACAC,YAAAA,EACAC,gBAAAA,EACAC,kBAAAA,EACAC,gBAAAA,EACAC,iBAAAA,EAEF"}