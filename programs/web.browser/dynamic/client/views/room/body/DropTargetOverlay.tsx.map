)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/body/DropTargetOverlay.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { css } from '@rocket.chat/css-in-js';\nimport { Box } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation } from '@rocket.chat/ui-contexts';\nimport type { DragEvent, ReactElement, ReactNode } from 'react';\nimport React, { memo } from 'react';\n\nimport { useFormatDateAndTime } from '../../../hooks/useFormatDateAndTime';\n\ntype DropTargetOverlayProps = {\n\tenabled: boolean;\n\treason?: ReactNode;\n\tonFileDrop?: (files: File[]) => void;\n\tvisible?: boolean;\n\tonDismiss?: () => void;\n};\n\nfunction DropTargetOverlay({ enabled, reason, onFileDrop, visible = true, onDismiss }: DropTargetOverlayProps): ReactElement | null {\n\tconst t = useTranslation();\n\n\tconst handleDragLeave = useMutableCallback((event: DragEvent) => {\n\t\tevent.stopPropagation();\n\t\tonDismiss?.();\n\t});\n\n\tconst handleDragOver = useMutableCallback((event: DragEvent) => {\n\t\tevent.stopPropagation();\n\n\t\tevent.preventDefault();\n\t\tevent.dataTransfer.dropEffect = ['move', 'linkMove'].includes(event.dataTransfer.effectAllowed) ? 'move' : 'copy';\n\t});\n\n\tconst formatDateAndTime = useFormatDateAndTime();\n\n\tconst handleDrop = useMutableCallback(async (event: DragEvent) => {\n\t\tevent.stopPropagation();\n\t\tonDismiss?.();\n\n\t\tevent.preventDefault();\n\n\t\tconst files = Array.from(event.dataTransfer.files);\n\n\t\tif (event.dataTransfer.types.includes('text/uri-list') && event.dataTransfer.types.includes('text/html')) {\n\t\t\tconst fragment = document.createRange().createContextualFragment(event.dataTransfer.getData('text/html'));\n\t\t\tfor await (const { src } of Array.from(fragment.querySelectorAll('img'))) {\n\t\t\t\ttry {\n\t\t\t\t\tconst response = await fetch(src);\n\t\t\t\t\tconst data = await response.blob();\n\t\t\t\t\tconst extension = (await import('../../../../app/utils/lib/mimeTypes')).mime.extension(data.type);\n\t\t\t\t\tconst filename = `File - ${formatDateAndTime(new Date())}.${extension}`;\n\t\t\t\t\tconst file = new File([data], filename, { type: data.type });\n\t\t\t\t\tfiles.push(file);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.warn(error);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tonFileDrop?.(files);\n\t});\n\n\tif (!visible) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<Box\n\t\t\trole='dialog'\n\t\t\tdata-qa='DropTargetOverlay'\n\t\t\tposition='absolute'\n\t\t\tzIndex={1_000_000}\n\t\t\tinset={0}\n\t\t\tdisplay='flex'\n\t\t\talignItems='center'\n\t\t\tjustifyContent='center'\n\t\t\tfontScale='hero'\n\t\t\ttextAlign='center'\n\t\t\tbackgroundColor='rgba(255, 255, 255, 0.8)'\n\t\t\tborderWidth={4}\n\t\t\tborderStyle='dashed'\n\t\t\tborderColor='currentColor'\n\t\t\tcolor={enabled ? 'primary' : 'danger'}\n\t\t\tclassName={css`\n\t\t\t\tanimation-name: zoomIn;\n\t\t\t\tanimation-duration: 0.1s;\n\t\t\t`}\n\t\t\tonDragLeave={handleDragLeave}\n\t\t\tonDragOver={handleDragOver}\n\t\t\tonDrop={handleDrop}\n\t\t>\n\t\t\t{enabled ? t('Drop_to_upload_file') : reason}\n\t\t</Box>\n\t);\n}\n\nexport default memo(DropTargetOverlay);\n",null],"names":["_taggedTemplateLiteral","_asyncIterator","css","Box","useMutableCallback","useTranslation","React","memo","useFormatDateAndTime","module","default","link","exportDefault","_ref","enabled","reason","onFileDrop","visible","onDismiss","t","handleDragLeave","event","stopPropagation","handleDragOver","preventDefault","dataTransfer","dropEffect","includes","effectAllowed","formatDateAndTime","handleDrop","files","Array","from","types","fragment","document","createRange","createContextualFragment","getData","_iteratorAbruptCompletion","_didIteratorError","_iteratorError","_step","_iterator","querySelectorAll","next","done","src","value","response","fetch","data","blob","extension","dynamicImport","mime","type","filename","concat","Date","file","File","push","error","console","warn","err","return","createElement","role","position","zIndex","inset","display","alignItems","justifyContent","fontScale","textAlign","backgroundColor","borderWidth","borderStyle","borderColor","color","className","_templateObject","onDragLeave","onDragOver","onDrop"],"mappings":"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"}