)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/hooks/useUserInfoActions/actions/useCallAction.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IUser } from '@rocket.chat/core-typings';\nimport { isRoomFederated } from '@rocket.chat/core-typings';\nimport { useTranslation, useUserRoom, useUserId, useUserSubscriptionByName } from '@rocket.chat/ui-contexts';\nimport { useMemo } from 'react';\n\nimport { closeUserCard } from '../../../../../../app/ui/client/lib/userCard';\nimport { useVideoConfDispatchOutgoing, useVideoConfIsCalling, useVideoConfIsRinging } from '../../../../../contexts/VideoConfContext';\nimport { VideoConfManager } from '../../../../../lib/VideoConfManager';\nimport { useVideoConfWarning } from '../../../contextualBar/VideoConference/hooks/useVideoConfWarning';\nimport type { UserInfoAction, UserInfoActionType } from '../useUserInfoActions';\n\nexport const useCallAction = (user: Pick<IUser, '_id' | 'username'>): UserInfoAction | undefined => {\n\tconst t = useTranslation();\n\tconst usernameSubscription = useUserSubscriptionByName(user.username ?? '');\n\tconst room = useUserRoom(usernameSubscription?.rid || '');\n\n\tconst dispatchWarning = useVideoConfWarning();\n\tconst dispatchPopup = useVideoConfDispatchOutgoing();\n\tconst isCalling = useVideoConfIsCalling();\n\tconst isRinging = useVideoConfIsRinging();\n\tconst ownUserId = useUserId();\n\n\tconst videoCallOption = useMemo(() => {\n\t\tconst action = async (): Promise<void> => {\n\t\t\tif (isCalling || isRinging || !room) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tawait VideoConfManager.loadCapabilities();\n\t\t\t\tcloseUserCard();\n\t\t\t\tdispatchPopup({ rid: room._id });\n\t\t\t} catch (error: any) {\n\t\t\t\tdispatchWarning(error.error);\n\t\t\t}\n\t\t};\n\n\t\treturn room && !isRoomFederated(room) && user._id !== ownUserId\n\t\t\t? {\n\t\t\t\t\tcontent: t('Start_call'),\n\t\t\t\t\ticon: 'phone' as const,\n\t\t\t\t\tonClick: action,\n\t\t\t\t\ttype: 'communication' as UserInfoActionType,\n\t\t\t  }\n\t\t\t: undefined;\n\t}, [t, room, dispatchPopup, dispatchWarning, isCalling, isRinging, ownUserId, user._id]);\n\n\treturn videoCallOption;\n};\n",null],"names":["isRoomFederated","useTranslation","useUserRoom","useUserId","useUserSubscriptionByName","useMemo","closeUserCard","useVideoConfDispatchOutgoing","useVideoConfIsCalling","useVideoConfIsRinging","VideoConfManager","useVideoConfWarning","module","export","useCallAction","user","_user$username","t","usernameSubscription","username","room","rid","dispatchWarning","dispatchPopup","isCalling","isRinging","ownUserId","videoCallOption","action","loadCapabilities","_id","error","content","icon","onClick","type","undefined"],"mappings":"2BACgCA,EAA4BC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA5DC,EAAOC,MAAE,CAAA,CAAAC,cAAiB,IAAMA,CAAA,GAA4BF,EAAAA,IAAAA,CAAAA,4BAAAA,CAAAZ,gBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAY,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAX,eAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,UAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,0BAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAQ,EAAAA,IAAAA,CAAAA,QAAAA,CAAAP,QAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAO,EAAAA,IAAAA,CAAAA,+CAAAA,CAAAN,cAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,2CAAAA,CAAAL,6BAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,sBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,sBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,sCAAAA,CAAAF,iBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,mEAAAA,CAAAD,oBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAUrD,IAAMG,EAAiBC,IAAqE,IAAAC,EAClG,IAAMC,EAAIhB,IACJiB,EAAuBd,EAAyB,AAAc,OAAdY,CAAAA,EAACD,EAAKI,QAAQ,AAARA,GAAQH,AAAA,KAAA,IAAAA,EAAAA,EAAI,IAClEI,EAAOlB,EAAY,AAAAgB,CAAAA,MAAAA,EAAoB,KAAA,EAApBA,EAAsBG,GAAG,AAAHA,GAAO,IAEhDC,EAAkBX,IAClBY,EAAgBhB,IAChBiB,EAAYhB,IACZiB,EAAYhB,IACZiB,EAAYvB,IAEZwB,EAAkBtB,EAAQ,KAC/B,IAAMuB,EAAS,UACd,GAAIJ,CAAAA,IAAaC,GAAcL,EAI/B,GAAI,CACH,MAAMV,EAAiBmB,gBAAgB,GACvCvB,IACAiB,EAAc,CAAEF,IAAKD,EAAKU,GAAAA,AAAG,GAC5B,MAAOC,EAAY,CACpBT,EAAgBS,EAAMA,KAAK,EAE7B,EAEA,OAAOX,GAAQ,CAACpB,EAAgBoB,IAASL,EAAKe,GAAG,GAAKJ,EACnD,CACAM,QAASf,EAAE,cACXgB,KAAM,QACNC,QAASN,EACTO,KAAM,iBAENC,KAAAA,CACJ,EAAG,CAACnB,EAAGG,EAAMG,EAAeD,EAAiBE,EAAWC,EAAWC,EAAWX,EAAKe,GAAG,CAAC,EAEvF,OAAOH,CACR"}