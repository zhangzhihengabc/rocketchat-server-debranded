)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/room/hooks/useUserInfoActions/actions/useIgnoreUserAction.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IRoom, IUser } from '@rocket.chat/core-typings';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport {\n\tuseTranslation,\n\tuseUserSubscription,\n\tuseUserRoom,\n\tuseUserId,\n\tuseToastMessageDispatch,\n\tuseEndpoint,\n} from '@rocket.chat/ui-contexts';\nimport { useMemo } from 'react';\n\nimport { getRoomDirectives } from '../../../lib/getRoomDirectives';\nimport type { UserInfoAction, UserInfoActionType } from '../useUserInfoActions';\n\nexport const useIgnoreUserAction = (user: Pick<IUser, '_id' | 'username'>, rid: IRoom['_id']): UserInfoAction | undefined => {\n\tconst t = useTranslation();\n\tconst room = useUserRoom(rid);\n\tconst { _id: uid } = user;\n\tconst ownUserId = useUserId();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst currentSubscription = useUserSubscription(rid);\n\tconst ignoreUser = useEndpoint('GET', '/v1/chat.ignoreUser');\n\n\tconst isIgnored = currentSubscription?.ignored && currentSubscription.ignored.indexOf(uid) > -1;\n\n\tif (!room) {\n\t\tthrow Error('Room not provided');\n\t}\n\n\tconst { roomCanIgnore } = getRoomDirectives({ room, showingUserId: uid, userSubscription: currentSubscription });\n\n\tconst ignoreUserAction = useMutableCallback(async () => {\n\t\ttry {\n\t\t\tawait ignoreUser({ rid, userId: uid, ignore: String(!isIgnored) });\n\t\t\tif (isIgnored) {\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('User_has_been_unignored') });\n\t\t\t} else {\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('User_has_been_ignored') });\n\t\t\t}\n\t\t} catch (error: unknown) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst ignoreUserOption = useMemo(\n\t\t() =>\n\t\t\troomCanIgnore && uid !== ownUserId\n\t\t\t\t? {\n\t\t\t\t\t\tcontent: t(isIgnored ? 'Unignore' : 'Ignore'),\n\t\t\t\t\t\ticon: 'ban' as const,\n\t\t\t\t\t\tonClick: ignoreUserAction,\n\t\t\t\t\t\ttype: 'management' as UserInfoActionType,\n\t\t\t\t  }\n\t\t\t\t: undefined,\n\t\t[ignoreUserAction, isIgnored, ownUserId, roomCanIgnore, t, uid],\n\t);\n\n\treturn ignoreUserOption;\n};\n",null],"names":["useMutableCallback","useTranslation","useUserSubscription","useUserRoom","useUserId","useToastMessageDispatch","useEndpoint","useMemo","getRoomDirectives","module","export","useIgnoreUserAction","user","rid","t","room","_id","uid","ownUserId","dispatchToastMessage","currentSubscription","ignoreUser","isIgnored","ignored","indexOf","Error","roomCanIgnore","showingUserId","userSubscription","ignoreUserAction","userId","ignore","String","type","message","error","ignoreUserOption","content","icon","onClick","undefined"],"mappings":"2BACiEA,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAjEC,EAAOC,MAAE,CAAA,CAAAC,oBAA0B,IAAAA,CAAA,GAA8BF,EAAAA,IAAAA,CAAAA,8BAAAA,CAAAT,mBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAS,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAR,eAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,oBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,UAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,wBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,QAAAA,CAAAF,QAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,iCAAAA,CAAAD,kBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAc1D,IAAMG,EAAsB,CAACC,EAAuCC,KAC1E,IAAMC,EAAIb,IACJc,EAAOZ,EAAYU,GACnB,CAAEG,IAAKC,CAAAA,CAAK,CAAGL,EACfM,EAAYd,IACZe,EAAuBd,IACvBe,EAAsBlB,EAAoBW,GAC1CQ,EAAaf,EAAY,MAAO,uBAEhCgB,EAAY,AAAAF,CAAAA,MAAAA,EAAmB,KAAA,EAAnBA,EAAqBG,OAAO,AAAPA,GAAWH,EAAoBG,OAAO,CAACC,OAAO,CAACP,GAAO,GAE7F,GAAI,CAACF,EACJ,MAAMU,MAAM,qBAGb,GAAM,CAAEC,cAAAA,CAAAA,CAAe,CAAGlB,EAAkB,CAAEO,KAAAA,EAAMY,cAAeV,EAAKW,iBAAkBR,CAAmB,GAEvGS,EAAmB7B,EAAmB,UAC3C,GAAI,CACH,MAAMqB,EAAW,CAAER,IAAAA,EAAKiB,OAAQb,EAAKc,OAAQC,OAAO,CAACV,EAAU,GAC3DA,EACHH,EAAqB,CAAEc,KAAM,UAAWC,QAASpB,EAAE,0BAA0B,GAE7EK,EAAqB,CAAEc,KAAM,UAAWC,QAASpB,EAAE,wBAAwB,GAE3E,MAAOqB,EAAgB,CACxBhB,EAAqB,CAAEc,KAAM,QAASC,QAASC,CAAK,GAEtD,GAEMC,EAAmB7B,EACxB,IACCmB,GAAiBT,IAAQC,EACtB,CACAmB,QAASvB,EAAEQ,EAAY,WAAa,UACpCgB,KAAM,MACNC,QAASV,EACTI,KAAM,cAENO,KAAAA,EACJ,CAACX,EAAkBP,EAAWJ,EAAWQ,EAAeZ,EAAGG,EAAI,EAGhE,OAAOmB,CACR"}