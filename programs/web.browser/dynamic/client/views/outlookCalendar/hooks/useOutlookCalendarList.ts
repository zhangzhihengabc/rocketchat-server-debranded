function module(t,e,a){let n,o,s,u,l,i,r,c;a.export({useOutlookCalendarListForToday:()=>k,useOutlookCalendarList:()=>y,useMutationOutlookCalendarSync:()=>d}),a.link("@rocket.chat/ui-contexts",{useToastMessageDispatch(t){n=t},useTranslation(t){o=t},useEndpoint(t){s=t}},0),a.link("@tanstack/react-query",{useMutation(t){u=t},useQuery(t){l=t},useQueryClient(t){i=t}},1),a.link("../lib/syncOutlookEvents",{syncOutlookEvents(t){r=t}},2),a.link("./useOutlookAuthentication",{useOutlookAuthenticationMutation(t){c=t}},3);let k=()=>y(new Date),y=t=>{let e=s("GET","/v1/calendar-events.list");return l(["outlook","calendar","list"],async()=>{let{data:a}=await e({date:t.toISOString()});return a})},d=()=>{let t=o(),e=i(),a=c(),s=n(),l=u({mutationFn:async()=>{await r(),await e.invalidateQueries(["outlook","calendar","list"]),await a.mutateAsync()},onSuccess:()=>{s({type:"success",message:t("Outlook_Sync_Success")})},onError:e=>{e instanceof Error&&"abort"===e.message||s({type:"error",message:t("Outlook_Sync_Failed")})}});return l}}
//# sourceMappingURL=/dynamic/client/views/outlookCalendar/hooks/49eb03c75a0fa50085ce4c5f8388dfdad52f230e.map
