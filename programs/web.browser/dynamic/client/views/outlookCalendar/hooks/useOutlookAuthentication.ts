function module(t,e,o){let n,a,u,l,i,r;o.export({useOutlookAuthentication:()=>s,useOutlookAuthenticationMutation:()=>c,useOutlookAuthenticationMutationLogout:()=>k}),o.link("@rocket.chat/ui-contexts",{useToastMessageDispatch(t){n=t},useTranslation(t){a=t}},0),o.link("@tanstack/react-query",{useMutation(t){u=t},useQuery(t){l=t},useQueryClient(t){i=t}},1),o.link("../lib/NotOnDesktopError",{NotOnDesktopError(t){r=t}},2);let s=()=>{let{data:t,isError:e,error:o}=l(["outlook","auth"],async()=>{var t;let e=window.RocketChatDesktop;if(!(null!=e&&e.hasOutlookCredentials))throw new r;return!!await (null==e?void 0:null===(t=e.hasOutlookCredentials)||void 0===t?void 0:t.call(e))},{onError:t=>{console.error(t)}});return{authEnabled:!!t,isError:e,error:o}},c=()=>{let t=i();return u({mutationFn:async()=>{await t.invalidateQueries(["outlook","auth"])}})},k=()=>{let t=a(),e=n(),o=c();return u({mutationFn:async()=>{let t=window.RocketChatDesktop;if(!(null!=t&&t.clearOutlookCredentials))throw new r;return await t.clearOutlookCredentials(),o.mutateAsync()},onSuccess:()=>{e({type:"success",message:t("Outlook_authentication_disabled")})}})}}
//# sourceMappingURL=/dynamic/client/views/outlookCalendar/hooks/57002ee6d1721c5f8a8c305b10f4f51621d78407.map
