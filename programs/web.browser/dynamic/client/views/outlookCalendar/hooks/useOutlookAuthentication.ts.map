)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/outlookCalendar/hooks/useOutlookAuthentication.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useToastMessageDispatch, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\n\nimport { NotOnDesktopError } from '../lib/NotOnDesktopError';\n\nexport const useOutlookAuthentication = () => {\n\tconst {\n\t\tdata: authEnabled,\n\t\tisError,\n\t\terror,\n\t} = useQuery(\n\t\t['outlook', 'auth'],\n\t\tasync () => {\n\t\t\tconst desktopApp = window.RocketChatDesktop;\n\t\t\tif (!desktopApp?.hasOutlookCredentials) {\n\t\t\t\tthrow new NotOnDesktopError();\n\t\t\t}\n\n\t\t\treturn Boolean(await desktopApp?.hasOutlookCredentials?.()) || false;\n\t\t},\n\t\t{\n\t\t\tonError: (error) => {\n\t\t\t\tconsole.error(error);\n\t\t\t},\n\t\t},\n\t);\n\n\treturn { authEnabled: Boolean(authEnabled), isError, error };\n};\n\nexport const useOutlookAuthenticationMutation = () => {\n\tconst queryClient = useQueryClient();\n\treturn useMutation({\n\t\tmutationFn: async () => {\n\t\t\tawait queryClient.invalidateQueries(['outlook', 'auth']);\n\t\t},\n\t});\n};\n\nexport const useOutlookAuthenticationMutationLogout = () => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst mutation = useOutlookAuthenticationMutation();\n\treturn useMutation({\n\t\tmutationFn: async () => {\n\t\t\tconst desktopApp = window.RocketChatDesktop;\n\t\t\tif (!desktopApp?.clearOutlookCredentials) {\n\t\t\t\tthrow new NotOnDesktopError();\n\t\t\t}\n\n\t\t\tawait desktopApp.clearOutlookCredentials();\n\n\t\t\treturn mutation.mutateAsync();\n\t\t},\n\t\tonSuccess: () => {\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Outlook_authentication_disabled') });\n\t\t},\n\t});\n};\n",null],"names":["useToastMessageDispatch","useTranslation","useMutation","useQuery","useQueryClient","NotOnDesktopError","module","export","useOutlookAuthentication","useOutlookAuthenticationMutation","useOutlookAuthenticationMutationLogout","data","authEnabled","isError","error","_desktopApp$hasOutloo","desktopApp","window","RocketChatDesktop","hasOutlookCredentials","Boolean","call","onError","console","queryClient","mutationFn","invalidateQueries","t","dispatchToastMessage","mutation","clearOutlookCredentials","mutateAsync","onSuccess","type","message"],"mappings":"2BAAmFA,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAnFC,EAAOC,MAAE,CAAA,CAAAC,yBAAyB,IAAAA,EAAsBC,iCAA2B,IAAAA,EAAAC,uCAAAA,IAAAA,CAAA,GAAAJ,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAN,wBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAK,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAJ,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAD,kBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAK5E,IAAMG,EAA2B,KACvC,GAAM,CACLG,KAAMC,CAAW,CACjBC,QAAAA,CAAO,CACPC,MAAAA,CAAAA,CACA,CAAGX,EACH,CAAC,UAAW,OAAO,CACnB,UAAW,IAAAY,EACV,IAAMC,EAAaC,OAAOC,iBAAiB,CAC3C,GAAI,CAACF,CAAAA,MAAAA,GAAAA,EAAYG,qBAAqB,AAArBA,EAChB,MAAM,IAAId,EAGX,MAAOe,CAAAA,CAAQ,MAAMJ,CAAAA,MAAAA,EAAU,KAAA,EAAA,AAAuB,OAAvBD,CAAAA,EAAVC,EAAYG,qBAAqB,AAArBA,GAAqBJ,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAjCA,EAAAM,IAAA,CAAAL,EAAU,CAChC,EACA,CACCM,QAAUR,IACTS,QAAQT,KAAK,CAACA,EACf,IAIF,MAAO,CAAEF,YAAaQ,CAAAA,CAAQR,EAAcC,QAAAA,EAASC,MAAAA,CAAK,CAC3D,EAEaL,EAAmC,KAC/C,IAAMe,EAAcpB,IACpB,OAAOF,EAAY,CAClBuB,WAAY,UACX,MAAMD,EAAYE,iBAAiB,CAAC,CAAC,UAAW,OAAO,CACxD,GAEF,EAEahB,EAAyC,KACrD,IAAMiB,EAAI1B,IACJ2B,EAAuB5B,IACvB6B,EAAWpB,IACjB,OAAOP,EAAY,CAClBuB,WAAY,UACX,IAAMT,EAAaC,OAAOC,iBAAiB,CAC3C,GAAI,CAACF,CAAAA,MAAAA,GAAAA,EAAYc,uBAAuB,AAAvBA,EAChB,MAAM,IAAIzB,EAKX,OAFA,MAAMW,EAAWc,uBAAuB,GAEjCD,EAASE,WAAW,EAC5B,EACAC,UAAW,KACVJ,EAAqB,CAAEK,KAAM,UAAWC,QAASP,EAAE,kCAAkC,EACtF,GAEF"}