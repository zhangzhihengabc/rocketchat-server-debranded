)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/outlookCalendar/hooks/useOutlookCalendarList.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useToastMessageDispatch, useTranslation, useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\n\nimport { syncOutlookEvents } from '../lib/syncOutlookEvents';\nimport { useOutlookAuthenticationMutation } from './useOutlookAuthentication';\n\nexport const useOutlookCalendarListForToday = () => {\n\treturn useOutlookCalendarList(new Date());\n};\n\nexport const useOutlookCalendarList = (date: Date) => {\n\tconst calendarData = useEndpoint('GET', '/v1/calendar-events.list');\n\n\treturn useQuery(['outlook', 'calendar', 'list'], async () => {\n\t\tconst { data } = await calendarData({ date: date.toISOString() });\n\t\treturn data;\n\t});\n};\n\nexport const useMutationOutlookCalendarSync = () => {\n\tconst t = useTranslation();\n\tconst queryClient = useQueryClient();\n\n\tconst checkOutlookCredentials = useOutlookAuthenticationMutation();\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst syncMutation = useMutation({\n\t\tmutationFn: async () => {\n\t\t\tawait syncOutlookEvents();\n\n\t\t\tawait queryClient.invalidateQueries(['outlook', 'calendar', 'list']);\n\n\t\t\tawait checkOutlookCredentials.mutateAsync();\n\t\t},\n\t\tonSuccess: () => {\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Outlook_Sync_Success') });\n\t\t},\n\t\tonError: (error) => {\n\t\t\tif (error instanceof Error && error.message === 'abort') {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdispatchToastMessage({ type: 'error', message: t('Outlook_Sync_Failed') });\n\t\t},\n\t});\n\treturn syncMutation;\n};\n",null],"names":["useToastMessageDispatch","useTranslation","useEndpoint","useMutation","useQuery","useQueryClient","syncOutlookEvents","useOutlookAuthenticationMutation","module","export","useOutlookCalendarListForToday","useOutlookCalendarList","useMutationOutlookCalendarSync","Date","date","calendarData","data","toISOString","t","queryClient","checkOutlookCredentials","dispatchToastMessage","syncMutation","mutationFn","invalidateQueries","mutateAsync","onSuccess","type","message","onError","error","Error"],"mappings":"2BAAgGA,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAhGC,EAAOC,MAAE,CAAA,CAAAC,+BAAyB,IAAgBA,EAAmBC,uBAA2B,IAAAA,EAAAC,+BAAAA,IAAAA,CAAA,GAAAJ,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAR,wBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAL,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAF,kBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,6BAAAA,CAAAD,iCAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAMzF,IAAMG,EAAiC,IACtCC,EAAuB,IAAIE,MAGtBF,EAA0BG,IACtC,IAAMC,EAAeb,EAAY,MAAO,4BAExC,OAAOE,EAAS,CAAC,UAAW,WAAY,OAAO,CAAE,UAChD,GAAM,CAAEY,KAAAA,CAAAA,CAAM,CAAG,MAAMD,EAAa,CAAED,KAAMA,EAAKG,WAAW,EAAE,GAC9D,OAAOD,CACR,EACD,EAEaJ,EAAiC,KAC7C,IAAMM,EAAIjB,IACJkB,EAAcd,IAEde,EAA0Bb,IAE1Bc,EAAuBrB,IAEvBsB,EAAenB,EAAY,CAChCoB,WAAY,UACX,MAAMjB,IAEN,MAAMa,EAAYK,iBAAiB,CAAC,CAAC,UAAW,WAAY,OAAO,EAEnE,MAAMJ,EAAwBK,WAAW,EAC1C,EACAC,UAAW,KACVL,EAAqB,CAAEM,KAAM,UAAWC,QAASV,EAAE,uBAAuB,EAC3E,EACAW,QAAUC,IACLA,aAAiBC,OAASD,AAAkB,UAAlBA,EAAMF,OAAO,EAG3CP,EAAqB,CAAEM,KAAM,QAASC,QAASV,EAAE,sBAAsB,EACxE,IAED,OAAOI,CACR"}