)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/outlookCalendar/OutlookEventsList/OutlookEventsList.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Box, States, StatesIcon, StatesTitle, StatesSubtitle, ButtonGroup, Button } from '@rocket.chat/fuselage';\nimport { useResizeObserver } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation, useSetting } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React from 'react';\nimport { Virtuoso } from 'react-virtuoso';\n\nimport {\n\tContextualbarHeader,\n\tContextualbarIcon,\n\tContextualbarTitle,\n\tContextualbarClose,\n\tContextualbarContent,\n\tContextualbarFooter,\n\tContextualbarSkeleton,\n} from '../../../components/Contextualbar';\nimport ScrollableContentWrapper from '../../../components/ScrollableContentWrapper';\nimport { getErrorMessage } from '../../../lib/errorHandling';\nimport { useOutlookAuthentication } from '../hooks/useOutlookAuthentication';\nimport { useMutationOutlookCalendarSync, useOutlookCalendarListForToday } from '../hooks/useOutlookCalendarList';\nimport { NotOnDesktopError } from '../lib/NotOnDesktopError';\nimport OutlookEventItem from './OutlookEventItem';\n\ntype OutlookEventsListProps = {\n\tonClose: () => void;\n\tchangeRoute: () => void;\n};\n\nconst OutlookEventsList = ({ onClose, changeRoute }: OutlookEventsListProps): ReactElement => {\n\tconst t = useTranslation();\n\tconst outlookUrl = useSetting<string>('Outlook_Calendar_Outlook_Url');\n\tconst { authEnabled, isError, error } = useOutlookAuthentication();\n\n\tconst hasOutlookMethods = !(isError && error instanceof NotOnDesktopError);\n\n\tconst syncOutlookCalendar = useMutationOutlookCalendarSync();\n\n\tconst calendarListResult = useOutlookCalendarListForToday();\n\n\tconst { ref, contentBoxSize: { inlineSize = 378, blockSize = 1 } = {} } = useResizeObserver<HTMLElement>({\n\t\tdebounceDelay: 200,\n\t});\n\n\tif (calendarListResult.isLoading) {\n\t\treturn <ContextualbarSkeleton />;\n\t}\n\n\tconst calendarEvents = calendarListResult.data;\n\tconst total = calendarEvents?.length || 0;\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarHeader>\n\t\t\t\t<ContextualbarIcon name='calendar' />\n\t\t\t\t<ContextualbarTitle>{t('Outlook_calendar')}</ContextualbarTitle>\n\t\t\t\t<ContextualbarClose onClick={onClose} />\n\t\t\t</ContextualbarHeader>\n\n\t\t\t{hasOutlookMethods && !authEnabled && total === 0 && (\n\t\t\t\t<>\n\t\t\t\t\t<ContextualbarContent paddingInline={0} ref={ref} color='default'>\n\t\t\t\t\t\t<Box display='flex' flexDirection='column' justifyContent='center' height='100%'>\n\t\t\t\t\t\t\t<States>\n\t\t\t\t\t\t\t\t<StatesIcon name='user' />\n\t\t\t\t\t\t\t\t<StatesTitle>{t('Log_in_to_sync')}</StatesTitle>\n\t\t\t\t\t\t\t</States>\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t</ContextualbarContent>\n\t\t\t\t\t<ContextualbarFooter>\n\t\t\t\t\t\t<ButtonGroup mbs={8} stretch>\n\t\t\t\t\t\t\t<Button primary loading={syncOutlookCalendar.isLoading} onClick={() => syncOutlookCalendar.mutate()}>\n\t\t\t\t\t\t\t\t{t('Login')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</ButtonGroup>\n\t\t\t\t\t</ContextualbarFooter>\n\t\t\t\t</>\n\t\t\t)}\n\n\t\t\t{(authEnabled || !hasOutlookMethods) && (\n\t\t\t\t<>\n\t\t\t\t\t<ContextualbarContent paddingInline={0} ref={ref} color='default'>\n\t\t\t\t\t\t{(total === 0 || calendarListResult.isError) && (\n\t\t\t\t\t\t\t<Box display='flex' flexDirection='column' justifyContent='center' height='100%'>\n\t\t\t\t\t\t\t\t{calendarListResult.isError && (\n\t\t\t\t\t\t\t\t\t<States>\n\t\t\t\t\t\t\t\t\t\t<StatesIcon name='circle-exclamation' variation='danger' />\n\t\t\t\t\t\t\t\t\t\t<StatesTitle>{t('Something_went_wrong')}</StatesTitle>\n\t\t\t\t\t\t\t\t\t\t<StatesSubtitle>{getErrorMessage(calendarListResult.error)}</StatesSubtitle>\n\t\t\t\t\t\t\t\t\t</States>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t{!calendarListResult.isError && total === 0 && (\n\t\t\t\t\t\t\t\t\t<States>\n\t\t\t\t\t\t\t\t\t\t<StatesIcon name='calendar' />\n\t\t\t\t\t\t\t\t\t\t<StatesTitle>{t('No_history')}</StatesTitle>\n\t\t\t\t\t\t\t\t\t</States>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{calendarListResult.isSuccess && calendarListResult.data.length > 0 && (\n\t\t\t\t\t\t\t<Box flexGrow={1} flexShrink={1} overflow='hidden' display='flex'>\n\t\t\t\t\t\t\t\t<Virtuoso\n\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\theight: blockSize,\n\t\t\t\t\t\t\t\t\t\twidth: inlineSize,\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\ttotalCount={total}\n\t\t\t\t\t\t\t\t\toverscan={25}\n\t\t\t\t\t\t\t\t\tdata={calendarEvents}\n\t\t\t\t\t\t\t\t\tcomponents={{ Scroller: ScrollableContentWrapper }}\n\t\t\t\t\t\t\t\t\titemContent={(_index, calendarData): ReactElement => <OutlookEventItem {...calendarData} />}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</ContextualbarContent>\n\t\t\t\t\t<ContextualbarFooter>\n\t\t\t\t\t\t<ButtonGroup stretch>\n\t\t\t\t\t\t\t{authEnabled && <Button onClick={changeRoute}>{t('Calendar_settings')}</Button>}\n\t\t\t\t\t\t\t{outlookUrl && (\n\t\t\t\t\t\t\t\t<Button icon='new-window' onClick={() => window.open(outlookUrl, '_blank')}>\n\t\t\t\t\t\t\t\t\t{t('Open_Outlook')}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</ButtonGroup>\n\t\t\t\t\t\t{hasOutlookMethods && (\n\t\t\t\t\t\t\t<ButtonGroup mbs={8} stretch>\n\t\t\t\t\t\t\t\t<Button primary loading={syncOutlookCalendar.isLoading} onClick={() => syncOutlookCalendar.mutate()}>\n\t\t\t\t\t\t\t\t\t{t('Sync')}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</ButtonGroup>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</ContextualbarFooter>\n\t\t\t\t</>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default OutlookEventsList;\n",null],"names":["Box","States","StatesIcon","StatesTitle","StatesSubtitle","ButtonGroup","Button","useResizeObserver","useTranslation","useSetting","React","Virtuoso","ContextualbarHeader","ContextualbarIcon","ContextualbarTitle","ContextualbarClose","ContextualbarContent","ContextualbarFooter","ContextualbarSkeleton","ScrollableContentWrapper","getErrorMessage","useOutlookAuthentication","useMutationOutlookCalendarSync","useOutlookCalendarListForToday","NotOnDesktopError","OutlookEventItem","module","link","v","default","exportDefault","_ref","onClose","changeRoute","t","outlookUrl","authEnabled","isError","error","hasOutlookMethods","syncOutlookCalendar","calendarListResult","ref","contentBoxSize","inlineSize","blockSize","debounceDelay","isLoading","createElement","calendarEvents","data","total","length","Fragment","name","onClick","paddingInline","color","display","flexDirection","justifyContent","height","mbs","stretch","primary","loading","mutate","variation","isSuccess","flexGrow","flexShrink","overflow","style","width","totalCount","overscan","components","Scroller","itemContent","_index","calendarData","icon","window","open"],"mappings":"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"}