function module(e,t,l){var n;let i,r,a,o,s,c,d,u,p,m,g,v,h,f,E,k,b,y;l.link("@babel/runtime/helpers/taggedTemplateLiteral",{default(e){i=e}},0),l.link("@rocket.chat/css-in-js",{css(e){r=e}},0),l.link("@rocket.chat/fuselage",{Box(e){a=e},ButtonGroup(e){o=e},Button(e){s=e},Icon(e){c=e},PositionAnimated(e){d=e}},1),l.link("@rocket.chat/fuselage-hooks",{useMutableCallback(e){u=e}},2),l.link("@rocket.chat/ui-contexts",{useTranslation(e){p=e},useToastMessageDispatch(e){m=e}},3),l.link("react",{default(e){g=e},useRef(e){v=e},useEffect(e){h=e},useState(e){f=e}},4),l.link("../../../../app/ui/client/lib/UserAction",{UserAction(e){E=e},USER_ACTIVITIES(e){k=e}},5),l.link("../../../../app/ui/client/lib/recorderjs/videoRecorder",{VideoRecorder(e){b=e}},6),l.link("../../room/contexts/ChatContext",{useChat(e){y=e}},7);let R=r(n||(n=i(["\n	transform: scaleX(-1);\n	filter: FlipH;\n\n	@media (max-width: 500px) {\n		& > video {\n			width: 100%;\n			height: 100%;\n		}\n	}\n"]))),S=()=>{let e=b.getSupportedMimeTypes();return e.match(/video\/webm/)?"webm":"mp4"};l.exportDefault(e=>{var t;let{rid:l,tmid:n,chatContext:i,reference:r}=e,w=p(),C=v(null),x=m(),[I,T]=f(),[_,M]=f("idle"),[D,U]=f(null),V=!(b.cameraStarted.get()&&"recording"!==_),A=null!==(t=y())&&void 0!==t?t:i,B=async(e,t)=>{D&&clearInterval(D),U(null),b.stopRecording(),E.stop(e,k.USER_RECORDING,{tmid:t}),M("idle")},j=async()=>{if("recording"===_)B(l,n);else{b.record(),M("recording"),E.performContinuously(l,k.USER_RECORDING,{tmid:n}),T("00:00");let e=new Date;U(setInterval(()=>{let t=new Date,l=(t.getTime()-e.getTime())/1e3;T("".concat(String(Math.floor(l/60)).padStart(2,"0"),":").concat(String(Math.floor(l%60)).padStart(2,"0")))},1e3))}},F=async()=>{let e=async e=>{var t;let l="".concat(w("Video_record"),".").concat(S()),n=new File([e],l,{type:b.getSupportedMimeTypes().split(";")[0]});await (null==A?void 0:A.flows.uploadFiles([n])),null==A||null===(t=A.composer)||void 0===t||t.setRecordingVideo(!1)};b.stop(e),T(void 0),B(l,n)},G=u(()=>{var e;b.stop(),null==A||null===(e=A.composer)||void 0===e||e.setRecordingVideo(!1),T(void 0),B(l,n)});return h(()=>{var e;return b.getSupportedMimeTypes()?(b.start(null!==(e=C.current)&&void 0!==e?e:void 0,e=>e?void 0:G()),()=>{b.stop()}):x({type:"error",message:w("Browser_does_not_support_recording_video")})},[x,G,w]),g.createElement(d,{visible:"visible",anchor:r,placement:"top-end"},g.createElement(a,{bg:"light",padding:4,borderRadius:4,elevation:"2"},g.createElement(a,{className:R,overflow:"hidden",height:240,borderRadius:4},g.createElement("video",{muted:!0,autoPlay:!0,playsInline:!0,ref:C,width:320,height:240})),g.createElement(a,{mbs:4,display:"flex",justifyContent:"space-between"},g.createElement(s,{small:!0,onClick:j},g.createElement(a,{is:"span",display:"flex",alignItems:"center"},g.createElement(c,{size:"x16",mie:I?4:void 0,name:"recording"===_?"stop-unfilled":"rec"}),I&&g.createElement("span",null,I))),g.createElement(o,null,g.createElement(s,{small:!0,onClick:G},w("Cancel")),g.createElement(s,{primary:!0,small:!0,disabled:V,onClick:F},w("Send"))))))})}
//# sourceMappingURL=/dynamic/client/views/composer/VideoMessageRecorder/f42f763394e41b9a7e8cf33a054a34adff814c6e.map
