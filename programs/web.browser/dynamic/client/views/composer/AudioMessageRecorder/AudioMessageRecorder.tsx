function module(e,a,o){let t,c,s,l,n,r,i,m,u,d,g;o.link("@rocket.chat/fuselage",{Box(e){t=e},Throbber(e){c=e}},0),o.link("@rocket.chat/fuselage-hooks",{useMutableCallback(e){s=e}},1),o.link("@rocket.chat/ui-composer",{MessageComposerAction(e){l=e}},2),o.link("@rocket.chat/ui-contexts",{useTranslation(e){n=e}},3),o.link("react",{default(e){r=e},useEffect(e){i=e},useMemo(e){m=e},useState(e){u=e}},4),o.link("../../../../app/ui/client/lib/recorderjs/AudioRecorder",{AudioRecorder(e){d=e}},5),o.link("../../room/contexts/ChatContext",{useChat(e){g=e}},6);let _=new d;o.exportDefault(e=>{var a;let{rid:o,chatContext:d,isMicrophoneDenied:p}=e,b=n(),[x,k]=u("recording"),[f,h]=u("00:00"),[w,v]=u(null),[E,y]=u(null),C=s(async()=>{var e;w&&clearInterval(w),v(null),y(null),h("00:00"),null==A||A.action.stop("recording"),null==A||null===(e=A.composer)||void 0===e||e.setRecordingMode(!1);let a=await new Promise(e=>_.stop(e));return a}),M=s(async()=>{"recording"===x&&await C()}),N=s(async()=>{if(!E||E===o)try{await _.start(),null==A||A.action.performContinuously("recording");let e=new Date;v(setInterval(()=>{let a=new Date,o=(a.getTime()-e.getTime())/1e3;h("".concat(String(Math.floor(o/60)).padStart(2,"0"),":").concat(String(Math.floor(o%60)).padStart(2,"0")))},1e3)),y(o)}catch(a){var e;console.log(a),null==A||null===(e=A.composer)||void 0===e||e.setRecordingMode(!1)}}),S=s(async()=>{await C()}),A=null!==(a=g())&&void 0!==a?a:d,R=s(async()=>{k("loading");let e=await C(),a="".concat(b("Audio_record"),".mp3"),o=new File([e],a,{type:"audio/mpeg"});await (null==A?void 0:A.flows.uploadFiles([o]))});i(()=>(N(),()=>{M()}),[M,N]);let T=m(()=>E&&E!==o?"rc-message-box__audio-message--busy":x&&"rc-message-box__audio-message--".concat(x),[E,o,x]);return p?null:r.createElement(t,{position:"absolute",pi:4,pb:12,className:"rc-message-box__audio-message ".concat(T)},"recording"===x&&r.createElement(r.Fragment,null,r.createElement(l,{icon:"circle-cross",className:"rc-message-box__icon rc-message-box__audio-message-cancel",onClick:S}),r.createElement(t,{className:"rc-message-box__audio-message-timer",color:"default"},r.createElement("span",{className:"rc-message-box__audio-message-timer-dot"}),r.createElement("span",{className:"rc-message-box__audio-message-timer-text"},f)),r.createElement(l,{icon:"circle-check",className:"rc-message-box__icon rc-message-box__audio-message-done",onClick:R})),"loading"===x&&r.createElement("div",{className:"rc-message-box__icon"},r.createElement(c,{inheritColor:!0,size:"x12"})))})}
//# sourceMappingURL=/dynamic/client/views/composer/AudioMessageRecorder/c89aac85ef645ed84e0d8269257670927f602ae0.map
