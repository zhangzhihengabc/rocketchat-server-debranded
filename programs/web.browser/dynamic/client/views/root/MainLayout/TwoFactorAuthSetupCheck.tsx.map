)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/root/MainLayout/TwoFactorAuthSetupCheck.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useLayout, useUser, useSetting } from '@rocket.chat/ui-contexts';\nimport type { ReactElement, ReactNode } from 'react';\nimport React, { lazy, useCallback } from 'react';\n\nimport { Roles } from '../../../../app/models/client';\nimport { useReactiveValue } from '../../../hooks/useReactiveValue';\nimport LayoutWithSidebar from './LayoutWithSidebar';\n\nconst AccountSecurityPage = lazy(() => import('../../account/security/AccountSecurityPage'));\n\nconst TwoFactorAuthSetupCheck = ({ children }: { children: ReactNode }): ReactElement => {\n\tconst { isEmbedded: embeddedLayout } = useLayout();\n\tconst user = useUser();\n\tconst tfaEnabled = useSetting('Accounts_TwoFactorAuthentication_Enabled');\n\tconst require2faSetup = useReactiveValue(\n\t\tuseCallback(() => {\n\t\t\t// User is already using 2fa\n\t\t\tif (!user || user?.services?.totp?.enabled || user?.services?.email2fa?.enabled) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst mandatoryRole = Roles.findOne({ _id: { $in: user.roles ?? [] }, mandatory2fa: true });\n\t\t\treturn mandatoryRole !== undefined && tfaEnabled;\n\t\t}, [tfaEnabled, user]),\n\t);\n\n\tif (require2faSetup) {\n\t\treturn (\n\t\t\t<main id='rocket-chat' className={embeddedLayout ? 'embedded-view' : undefined}>\n\t\t\t\t<div className='rc-old main-content content-background-color'>\n\t\t\t\t\t<AccountSecurityPage />\n\t\t\t\t</div>\n\t\t\t</main>\n\t\t);\n\t}\n\n\treturn <LayoutWithSidebar>{children}</LayoutWithSidebar>;\n};\n\nexport default TwoFactorAuthSetupCheck;\n",null],"names":["useLayout","useUser","useSetting","React","lazy","useCallback","Roles","useReactiveValue","LayoutWithSidebar","module","link","v","default","AccountSecurityPage","dynamicImport","exportDefault","_ref","children","isEmbedded","embeddedLayout","user","tfaEnabled","require2faSetup","_user$services","_user$services$totp","_user$services2","_user$services2$email","_user$roles","services","totp","enabled","email2fa","mandatoryRole","findOne","_id","$in","roles","mandatory2fa","undefined","createElement","id","className"],"mappings":"2BAAAA,EAASC,EAAWC,EAAsDC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA7CC,EAAUC,IAAE,CAAA,2BAAM,CAA0BV,UAACW,CAAA,EAAAX,EAAAA,CAAA,EAAAC,QAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,WAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAO,EAAAA,IAAAA,CAAAA,QAAAA,CAAAG,QAAAA,CAAAA,EAAAT,EAAAA,CAAA,EAAAC,KAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,gCAAAA,CAAAH,MAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,kCAAAA,CAAAF,iBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,sBAAAA,CAAAG,QAAAA,CAAAA,EAAAJ,EAAAA,CAAA,CAAA,EAAA,GAQ1E,IAAMK,EAAsBT,EAAK,IAAMK,EAAAK,aAAA,CAAO,+CAR9CL,EAAOM,aAAa,CAUYC,IAAwD,GAAvD,CAAEC,SAAAA,CAAAA,CAAmC,CAAAD,EAC/D,CAAEE,WAAYC,CAAAA,CAAgB,CAAGnB,IACjCoB,EAAOnB,IACPoB,EAAanB,EAAW,4CACxBoB,EAAkBf,EACvBF,EAAY,KAAK,IAAAkB,EAAAC,EAAAC,EAAAC,EAAAC,EAEhB,GAAI,CAACP,GAAQA,MAAAA,GAAI,AAAU,OAAVG,CAAAA,EAAJH,EAAMQ,QAAQ,AAARA,GAAQL,AAAA,KAAA,IAAAA,GAAA,AAAM,OAANC,CAAAA,EAAdD,EAAgBM,IAAI,AAAJA,GAAIL,AAAA,KAAA,IAAAA,GAApBA,EAAsBM,OAAO,EAAIV,MAAAA,GAAI,AAAU,OAAVK,CAAAA,EAAJL,EAAMQ,QAAQ,AAARA,GAAQH,AAAA,KAAA,IAAAA,GAAA,AAAU,OAAVC,CAAAA,EAAdD,EAAgBM,QAAQ,AAARA,GAAQL,AAAA,KAAA,IAAAA,GAAxBA,EAA0BI,OAAO,CAC9E,MAAO,CAAA,EAGR,IAAME,EAAgB1B,EAAM2B,OAAO,CAAC,CAAEC,IAAK,CAAEC,IAAG,AAAY,OAAZR,CAAAA,EAAEP,EAAKgB,KAAK,AAALA,GAAKT,AAAA,KAAA,IAAAA,EAAAA,EAAI,EAAA,AAAE,EAAIU,aAAc,CAAA,CAAI,GACxF,OAAOL,AAAkBM,KAAAA,IAAlBN,GAA+BX,CACvC,EAAG,CAACA,EAAYD,EAAK,UAGtB,AAAIE,EAEFnB,EAAAoC,aAAA,CAAA,OAAA,CAAMC,GAAG,cAAcC,UAAWtB,EAAiB,gBAAkBmB,KAAAA,CAAU,EAC9EnC,EAAAoC,aAAA,CAAA,MAAA,CAAKE,UAAU,8CAA8C,EAC5DtC,EAAAoC,aAAA,CAAC1B,EAAmB,QAMjBV,EAAAoC,aAAA,CAAC/B,EAAiB,KAAES,EAC5B"}