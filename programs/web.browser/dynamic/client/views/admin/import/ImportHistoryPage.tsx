function module(e,t,a){let r,n,l,o,i,s,d,m,c,u,p,g,_,E,y,w,S,f,h,k,v;a.link("@babel/runtime/helpers/extends",{default(e){r=e}},0),a.link("@rocket.chat/fuselage",{Button(e){n=e},ButtonGroup(e){l=e},Table(e){o=e},TableHead(e){i=e},TableCell(e){s=e},TableRow(e){d=e},TableBody(e){m=e}},0),a.link("@rocket.chat/fuselage-hooks",{useMediaQuery(e){c=e}},1),a.link("@rocket.chat/ui-contexts",{useToastMessageDispatch(e){u=e},useEndpoint(e){p=e},useTranslation(e){g=e},useRouter(e){_=e}},2),a.link("@tanstack/react-query",{useQuery(e){E=e},useMutation(e){y=e},useQueryClient(e){w=e}},3),a.link("react",{default(e){S=e},useMemo(e){f=e}},4),a.link("../../../../app/importer/lib/ImporterProgressStep",{ProgressStep(e){h=e}},5),a.link("../../../components/Page",{default(e){k=e}},6),a.link("./ImportOperationSummary",{default(e){v=e}},7),a.exportDefault(function(){var e;let t=w(),a=g(),T=u(),F=p("POST","/v1/downloadPendingFiles"),I=p("POST","/v1/downloadPendingAvatars"),P=p("GET","/v1/getCurrentImportOperation"),b=p("GET","/v1/getLatestImportOperations"),O=_(),L=E(["ImportHistoryPage","currentOperation"],async()=>{let{operation:e={valid:!1}}=await P();return e},{onError:()=>T({type:"error",message:a("Failed_To_Load_Import_Operation")})}),C=E(["ImportHistoryPage","latestOperations"],async()=>{let e=await b();return e},{onError:()=>T({type:"error",message:a("Failed_To_Load_Import_History")})}),D=L.isLoading||C.isLoading,H=f(()=>C.isSuccess&&C.data.some(e=>{let{status:t}=e;return t===h.DONE}),[C.isSuccess,C.data]),x=y({mutationFn:async()=>F(),onError:e=>{console.error(e),T({type:"error",message:a("Failed_To_Download_Files")})},onSuccess:e=>{let{count:r}=e;if(t.invalidateQueries(["ImportHistoryPage","currentOperation"]),t.invalidateQueries(["ImportHistoryPage","latestOperations"]),!r){T({type:"info",message:a("No_files_left_to_download")});return}T({type:"info",message:a("File_Downloads_Started")}),O.navigate("/admin/import/progress")}}),Q=y({mutationFn:async()=>I(),onError:e=>{console.error(e),T({type:"error",message:a("Failed_To_Download_Files")})},onSuccess:e=>{let{count:r}=e;if(t.invalidateQueries(["ImportHistoryPage","currentOperation"]),t.invalidateQueries(["ImportHistoryPage","latestOperations"]),!r){T({type:"info",message:a("No_files_left_to_download")});return}T({type:"info",message:a("File_Downloads_Started")}),O.navigate("/admin/import/progress")}}),M=c("(max-width: 768px)");return S.createElement(k,null,S.createElement(k.Header,{title:a("Import")},S.createElement(l,null,S.createElement(n,{primary:!0,disabled:D,onClick:()=>{O.navigate("/admin/import/new")}},a("Import_New_File")),H&&S.createElement(n,{loading:x.isLoading,disabled:Q.isLoading,onClick:()=>x.mutate()},a("Download_Pending_Files")),H&&S.createElement(n,{loading:Q.isLoading,disabled:x.isLoading,onClick:()=>Q.mutate()},a("Download_Pending_Avatars")))),S.createElement(k.ScrollableContentWithShadow,null,S.createElement(o,{fixed:!0,"data-qa-id":"ImportTable"},S.createElement(i,null,S.createElement(d,null,S.createElement(s,{is:"th",rowSpan:2,width:"x140"},a("Import_Type")),S.createElement(s,{is:"th",rowSpan:2},a("Last_Updated")),!M&&S.createElement(S.Fragment,null,S.createElement(s,{is:"th",rowSpan:2},a("Last_Status")),S.createElement(s,{is:"th",rowSpan:2},a("File")),S.createElement(s,{is:"th",align:"center",colSpan:4,width:"x320"},a("Counters")))),!M&&S.createElement(d,null,S.createElement(s,{is:"th",align:"center"},a("Users")),S.createElement(s,{is:"th",align:"center"},a("Channels")),S.createElement(s,{is:"th",align:"center"},a("Messages")),S.createElement(s,{is:"th",align:"center"},a("Total")))),S.createElement(m,null,D&&S.createElement(S.Fragment,null,Array.from({length:20},(e,t)=>S.createElement(v.Skeleton,{small:M,key:t}))),L.isSuccess&&L.data.valid&&S.createElement(v,r({},L.data,{small:M})),L.isSuccess&&C.isSuccess&&S.createElement(S.Fragment,null,null===(e=C.data.filter(e=>{let{_id:t}=e;return!L.data.valid||L.data._id!==t}))||void 0===e?void 0:e.map(e=>S.createElement(v,r({key:e._id},e,{valid:!1,small:M}))))))))})}
//# sourceMappingURL=/dynamic/client/views/admin/import/6524424bb31ea84d47e35721eea5e7324a208e2a.map
