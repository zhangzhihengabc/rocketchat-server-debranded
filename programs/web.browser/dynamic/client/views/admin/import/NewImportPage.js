function module(e,t,l){let a,n,r,o,i,m,c,u,p,s,d,g,_,h,E,y,f,F,S,k,I,w,v,b,x,T,C;l.link("@rocket.chat/fuselage",{Box(e){a=e},Button(e){n=e},ButtonGroup(e){r=e},Callout(e){o=e},Chip(e){i=e},Field(e){m=e},Margins(e){c=e},Select(e){u=e},InputBox(e){p=e},TextInput(e){s=e},UrlInput(e){d=e}},0),l.link("@rocket.chat/fuselage-hooks",{useUniqueId(e){g=e},useSafely(e){_=e}},1),l.link("@rocket.chat/ui-contexts",{useToastMessageDispatch(e){h=e},useRouter(e){E=e},useRouteParameter(e){y=e},useSetting(e){f=e},useEndpoint(e){F=e},useTranslation(e){S=e}},2),l.link("react",{default(e){k=e},useState(e){I=e},useMemo(e){w=e},useEffect(e){v=e}},3),l.link("../../../../app/importer/client/index",{Importers(e){b=e}},4),l.link("../../../components/Page",{default(e){x=e}},5),l.link("../../../hooks/useFormatMemorySize",{useFormatMemorySize(e){T=e}},6),l.link("./useErrorHandler",{useErrorHandler(e){C=e}},7),l.exportDefault(function(){let e=S(),t=h(),l=C(),[R,P]=_(I(!1)),[U,B]=_(I("upload")),L=y("importerKey"),M=w(()=>b.get(L),[L]),z=f("FileUpload_MaxFileSize"),D=E(),H=F("POST","/v1/uploadImportFile"),A=F("POST","/v1/downloadPublicImportFile");v(()=>{L&&!M&&D.navigate("/admin/import/new",{replace:!0})},[M,L,D]);let q=T(),[N,K]=I([]),O=async e=>{let{files:t}=(e=e.originalEvent||e).target;t&&0!==t.length||(t=(null!=e.dataTransfer?e.dataTransfer.files:void 0)||[]),K(Array.from(t))},V=e=>()=>{K(t=>t.filter(t=>t!==e))},W=async()=>{P(!0);try{await Promise.all(Array.from(N,t=>new Promise(a=>{let n=new FileReader;n.readAsDataURL(t),n.onloadend=async()=>{try{await H({binaryContent:n.result.split(";base64,")[1],contentType:t.type,fileName:t.name,importerKey:L})}catch(t){l(t,e("Failed_To_upload_Import_File"))}finally{a()}},n.onerror=()=>a()}))),D.navigate("/admin/import/prepare")}finally{P(!1)}},[G,j]=_(I("")),J=async()=>{P(!0);try{await A({importerKey:L,fileUrl:G}),t({type:"success",message:e("Import_requested_successfully")}),D.navigate("/admin/import/prepare")}catch(t){l(t,e("Failed_To_upload_Import_File"))}finally{P(!1)}},[Q,X]=_(I("")),Y=async()=>{P(!0);try{await A({importerKey:L,fileUrl:Q}),t({type:"success",message:e("Import_requested_successfully")}),D.navigate("/admin/import/prepare")}catch(t){l(t,e("Failed_To_upload_Import_File"))}finally{P(!1)}},Z=g(),$=g(),ee=g(),et="upload"===U&&W||"url"===U&&J||"path"===U&&Y;return k.createElement(x,{className:"page-settings"},k.createElement(x.Header,{title:e("Import_New_File")},k.createElement(r,null,k.createElement(n,{icon:"back",secondary:!0,onClick:()=>{D.navigate("/admin/import")}},e("Back_to_imports")),M&&k.createElement(n,{primary:!0,minHeight:"x40",loading:R,onClick:et},e("Import")))),k.createElement(x.ScrollableContentWithShadow,null,k.createElement(a,{marginInline:"auto",marginBlock:"neg-x24",width:"full",maxWidth:"x580"},k.createElement(c,{block:"x24"},k.createElement(m,null,k.createElement(m.Label,{alignSelf:"stretch",htmlFor:Z},e("Import_Type")),k.createElement(m.Row,null,k.createElement(u,{id:Z,value:L,disabled:R,placeholder:e("Select_an_option"),onChange:e=>{D.navigate(D.buildRoutePath({pattern:"/admin/import/new/:importerKey",params:{importerKey:e}}),{replace:!0})},options:b.getAll().map(t=>{let{key:l,name:a}=t;return[l,e(a)]})})),M&&k.createElement(m.Hint,null,"CSV"===M.name?e("Importer_From_Description_CSV"):e("Importer_From_Description",{from:e(M.name)}))),M&&k.createElement(m,null,k.createElement(m.Label,{alignSelf:"stretch",htmlFor:$},e("File_Type")),k.createElement(m.Row,null,k.createElement(u,{id:$,value:U,disabled:R,placeholder:e("Select_an_option"),onChange:e=>{B(e)},options:[["upload",e("Upload")],["url",e("Public_URL")],["path",e("Server_File_Path")]]}))),M&&k.createElement(k.Fragment,null,"upload"===U&&k.createElement(k.Fragment,null,z>0?k.createElement(o,{type:"warning",marginBlock:"x16"},e("Importer_Upload_FileSize_Message",{maxFileSize:q(z)})):k.createElement(o,{type:"info",marginBlock:"x16"},e("Importer_Upload_Unlimited_FileSize")),k.createElement(m,null,k.createElement(m.Label,{alignSelf:"stretch",htmlFor:ee},e("Importer_Source_File")),k.createElement(m.Row,null,k.createElement(p,{type:"file",id:ee,onChange:O})),(null==N?void 0:N.length)>0&&k.createElement(m.Row,null,N.map((e,t)=>k.createElement(i,{key:t,onClick:V(e)},e.name))))),"url"===U&&k.createElement(m,null,k.createElement(m.Label,{alignSelf:"stretch",htmlFor:ee},e("File_URL")),k.createElement(m.Row,null,k.createElement(d,{id:ee,value:G,onChange:e=>{j(e.currentTarget.value)}}))),"path"===U&&k.createElement(m,null,k.createElement(m.Label,{alignSelf:"stretch",htmlFor:ee},e("File_Path")),k.createElement(m.Row,null,k.createElement(s,{id:ee,value:Q,onChange:e=>{X(e.currentTarget.value)}}))))))))})}
//# sourceMappingURL=/dynamic/client/views/admin/import/073af2e63407043fefa28d288621158e6ce6f2fc.map
