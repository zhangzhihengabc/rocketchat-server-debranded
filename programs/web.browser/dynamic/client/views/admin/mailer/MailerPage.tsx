function module(e,r,t){let a,l,i,n,o,c,m,u,d,s,E,y,b,f,h,v,_,g,k,p,q,F,S,x;t.link("@babel/runtime/helpers/extends",{default(e){a=e}},0),t.link("@rocket.chat/fuselage",{TextInput(e){l=e},TextAreaInput(e){i=e},Field(e){n=e},FieldGroup(e){o=e},FieldLabel(e){c=e},FieldRow(e){m=e},FieldError(e){u=e},FieldHint(e){d=e},CheckBox(e){s=e},Button(e){E=e},ButtonGroup(e){y=e},Box(e){b=e}},0),t.link("@rocket.chat/fuselage-hooks",{useUniqueId(e){f=e}},1),t.link("@rocket.chat/ui-contexts",{useEndpoint(e){h=e},useToastMessageDispatch(e){v=e},useTranslation(e){_=e}},2),t.link("@tanstack/react-query",{useMutation(e){g=e}},3),t.link("react",{default(e){k=e}},4),t.link("react-hook-form",{Controller(e){p=e},useForm(e){q=e}},5),t.link("../../../../lib/emailValidator",{validateEmail(e){F=e}},6),t.link("../../../../lib/utils/isJSON",{isJSON(e){S=e}},7),t.link("../../../components/Page",{default(e){x=e}},8);let B={fromEmail:"",query:"",dryRun:!1,subject:"",emailBody:""};t.exportDefault(()=>{var e,r,t,j;let T=_(),C=v(),{register:D,formState:{errors:I,isDirty:M},handleSubmit:O,reset:w,control:H}=q({defaultValues:B,mode:"onBlur"}),J=h("POST","/v1/mailer"),N=g({mutationFn:J,onSuccess:()=>{C({type:"success",message:T("The_emails_are_being_sent")})},onError:e=>{C({type:"error",message:e})}}),Q=async e=>{let{fromEmail:r,subject:t,emailBody:a,dryRun:l,query:i}=e;N.mutateAsync({from:r,subject:t,body:a,dryrun:l,query:i})},R=f(),A=f(),G=f(),L=f(),P=f(),V=f();return k.createElement(x,null,k.createElement(x.Header,{title:T("Mailer")}),k.createElement(x.ScrollableContentWithShadow,{alignSelf:"center",w:"100%",display:"flex",flexDirection:"column",alignItems:"center"},k.createElement(b,{id:R,is:"form",autoComplete:"off",maxWidth:"x600",onSubmit:O(Q)},k.createElement(o,null,k.createElement(n,null,k.createElement(c,{required:!0,htmlFor:A},T("From")),k.createElement(m,null,k.createElement(l,a({id:A,placeholder:T("Type_your_email")},D("fromEmail",{validate:e=>!!F(e)||T("Invalid_email")}),{error:null===(e=I.fromEmail)||void 0===e?void 0:e.message,"aria-required":"true","aria-invalid":I.fromEmail?"true":"false","aria-describedby":"".concat(A,"-error")}))),I.fromEmail&&k.createElement(u,{"aria-live":"assertive",id:"".concat(A,"-error")},I.fromEmail.message)),k.createElement(n,null,k.createElement(m,null,k.createElement(p,{control:H,name:"dryRun",render:e=>{let{field:{ref:r,value:t,onChange:a}}=e;return k.createElement(s,{"aria-describedby":"".concat(L,"-hint"),ref:r,id:L,checked:t,onChange:a})}}),k.createElement(c,{htmlFor:L},T("Dry_run"))),k.createElement(d,{id:"".concat(L,"-hint")},T("Dry_run_description"))),k.createElement(n,null,k.createElement(c,{htmlFor:G},T("Query")),k.createElement(m,null,k.createElement(l,a({id:G},D("query",{validate:e=>!e||""===e||!!S(e)||T("Query_is_not_valid_JSON")}),{error:null===(r=I.query)||void 0===r?void 0:r.message,"aria-describedby":"".concat(G,"-error ").concat(G,"-hint"),"aria-invalid":I.query?"true":"false"}))),I.query&&k.createElement(u,{id:"".concat(G,"-error"),"aria-live":"assertive"},I.query.message),k.createElement(d,{id:"".concat(G,"-hint")},T("Query_description"))),k.createElement(n,null,k.createElement(c,{required:!0,htmlFor:P},T("Subject")),k.createElement(m,null,k.createElement(l,a({id:P},D("subject",{required:T("error-the-field-is-required",{field:T("Subject")})}),{"aria-describedby":"".concat(P,"-error"),error:null===(t=I.subject)||void 0===t?void 0:t.message,"aria-required":"true","aria-invalid":I.subject?"true":"false"}))),I.subject&&k.createElement(u,{"aria-live":"assertive",id:"".concat(P,"-error")},I.subject.message)),k.createElement(n,null,k.createElement(c,{required:!0,htmlFor:V},T("Email_body")),k.createElement(m,null,k.createElement(i,a({id:V},D("emailBody",{required:T("error-the-field-is-required",{field:T("Email_body")}),validate:e=>(null==e?void 0:e.indexOf("[unsubscribe]"))!==-1||T("error-missing-unsubscribe-link")}),{rows:10,"aria-describedby":"".concat(V,"-error ").concat(V,"-hint"),error:null===(j=I.emailBody)||void 0===j?void 0:j.message,"aria-required":"true","aria-invalid":I.emailBody?"true":"false"}))),I.emailBody&&k.createElement(u,{"aria-live":"assertive",id:"".concat(V,"-error")},I.emailBody.message),k.createElement(d,{id:"".concat(V,"-hint"),dangerouslySetInnerHTML:{__html:T("Mailer_body_tags")}}))))),k.createElement(x.Footer,{isDirty:M},k.createElement(y,null,k.createElement(E,{onClick:()=>w(B)},T("Cancel")),k.createElement(E,{form:R,primary:!0,type:"submit"},T("Send_email")))))})}
//# sourceMappingURL=/dynamic/client/views/admin/mailer/50aa660253afe60d447c8cf962ea6cc645d5a6b8.map
