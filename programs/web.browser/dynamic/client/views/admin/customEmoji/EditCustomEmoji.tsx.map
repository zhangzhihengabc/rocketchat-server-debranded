)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/customEmoji/EditCustomEmoji.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import {\n\tBox,\n\tButton,\n\tButtonGroup,\n\tMargins,\n\tTextInput,\n\tField,\n\tFieldGroup,\n\tFieldLabel,\n\tFieldRow,\n\tFieldError,\n\tIconButton,\n} from '@rocket.chat/fuselage';\nimport { useSetModal, useToastMessageDispatch, useAbsoluteUrl, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { FC, ChangeEvent } from 'react';\nimport React, { useCallback, useState, useMemo, useEffect } from 'react';\n\nimport { ContextualbarScrollableContent, ContextualbarFooter } from '../../../components/Contextualbar';\nimport GenericModal from '../../../components/GenericModal';\nimport { useEndpointAction } from '../../../hooks/useEndpointAction';\nimport { useEndpointUpload } from '../../../hooks/useEndpointUpload';\nimport { useFileInput } from '../../../hooks/useFileInput';\n\ntype EditCustomEmojiProps = {\n\tclose: () => void;\n\tonChange: () => void;\n\tdata: {\n\t\t_id: string;\n\t\tname: string;\n\t\taliases: string[];\n\t\textension: string;\n\t};\n};\n\nconst EditCustomEmoji: FC<EditCustomEmojiProps> = ({ close, onChange, data, ...props }) => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst setModal = useSetModal();\n\tconst absoluteUrl = useAbsoluteUrl();\n\tconst [errors, setErrors] = useState({ name: false, aliases: false });\n\n\tconst { _id, name: previousName, aliases: previousAliases } = data || {};\n\n\tconst [name, setName] = useState(() => data?.name ?? '');\n\tconst [aliases, setAliases] = useState(() => data?.aliases?.join(', ') ?? '');\n\tconst [emojiFile, setEmojiFile] = useState<Blob>();\n\tconst newEmojiPreview = useMemo(() => {\n\t\tif (emojiFile) {\n\t\t\treturn URL.createObjectURL(emojiFile);\n\t\t}\n\n\t\tif (data) {\n\t\t\treturn absoluteUrl(`/emoji-custom/${encodeURIComponent(data.name)}.${data.extension}`);\n\t\t}\n\n\t\treturn null;\n\t}, [absoluteUrl, data, emojiFile]);\n\n\tuseEffect(() => {\n\t\tsetName(previousName || '');\n\t\tsetAliases(previousAliases?.join(', ') || '');\n\t}, [previousName, previousAliases, _id]);\n\n\tconst hasUnsavedChanges = useMemo(\n\t\t() => previousName !== name || aliases !== previousAliases.join(', ') || !!emojiFile,\n\t\t[previousName, name, aliases, previousAliases, emojiFile],\n\t);\n\n\tconst saveAction = useEndpointUpload('/v1/emoji-custom.update', t('Custom_Emoji_Updated_Successfully'));\n\n\tconst handleSave = useCallback(async () => {\n\t\tif (!name) {\n\t\t\treturn setErrors((prevState) => ({ ...prevState, name: true }));\n\t\t}\n\n\t\tif (name === aliases) {\n\t\t\treturn setErrors((prevState) => ({ ...prevState, aliases: true }));\n\t\t}\n\n\t\tif (!emojiFile && !newEmojiPreview) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst formData = new FormData();\n\t\temojiFile && formData.append('emoji', emojiFile);\n\t\tformData.append('_id', _id);\n\t\tformData.append('name', name);\n\t\tformData.append('aliases', aliases);\n\t\tconst result = (await saveAction(formData)) as { success: boolean };\n\t\tif (result.success) {\n\t\t\tonChange();\n\t\t\tclose();\n\t\t}\n\t}, [emojiFile, _id, name, aliases, saveAction, onChange, close, newEmojiPreview]);\n\n\tconst deleteAction = useEndpointAction('POST', '/v1/emoji-custom.delete');\n\n\tconst handleDeleteButtonClick = useCallback(() => {\n\t\tconst handleDelete = async (): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tawait deleteAction({ emojiId: _id });\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Custom_Emoji_Has_Been_Deleted') });\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t} finally {\n\t\t\t\tonChange();\n\t\t\t\tsetModal(null);\n\t\t\t\tclose();\n\t\t\t}\n\t\t};\n\n\t\tconst handleCancel = (): void => {\n\t\t\tsetModal(null);\n\t\t};\n\n\t\tsetModal(() => (\n\t\t\t<GenericModal variant='danger' onConfirm={handleDelete} onCancel={handleCancel} onClose={handleCancel} confirmText={t('Delete')}>\n\t\t\t\t{t('Custom_Emoji_Delete_Warning')}\n\t\t\t</GenericModal>\n\t\t));\n\t}, [setModal, deleteAction, _id, dispatchToastMessage, t, onChange, close]);\n\n\tconst handleChangeAliases = useCallback(\n\t\t(e) => {\n\t\t\tif (e.currentTarget.value !== name) {\n\t\t\t\tsetErrors((prevState) => ({ ...prevState, aliases: false }));\n\t\t\t}\n\n\t\t\treturn setAliases(e.currentTarget.value);\n\t\t},\n\t\t[setAliases, name],\n\t);\n\n\tconst [clickUpload] = useFileInput(setEmojiFile, 'emoji');\n\n\tconst handleChangeName = (e: ChangeEvent<HTMLInputElement>): void => {\n\t\tif (e.currentTarget.value !== '') {\n\t\t\tsetErrors((prevState) => ({ ...prevState, name: false }));\n\t\t}\n\n\t\treturn setName(e.currentTarget.value);\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarScrollableContent {...props}>\n\t\t\t\t<FieldGroup>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<FieldLabel>{t('Name')}</FieldLabel>\n\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t<TextInput value={name} onChange={handleChangeName} placeholder={t('Name')} />\n\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t{errors.name && <FieldError>{t('error-the-field-is-required', { field: t('Name') })}</FieldError>}\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<FieldLabel>{t('Aliases')}</FieldLabel>\n\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t<TextInput value={aliases} onChange={handleChangeAliases} placeholder={t('Aliases')} />\n\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t{errors.aliases && <FieldError>{t('Custom_Emoji_Error_Same_Name_And_Alias')}</FieldError>}\n\t\t\t\t\t</Field>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<FieldLabel alignSelf='stretch' display='flex' justifyContent='space-between' alignItems='center'>\n\t\t\t\t\t\t\t{t('Custom_Emoji')}\n\t\t\t\t\t\t\t<IconButton icon='upload' secondary onClick={clickUpload} />\n\t\t\t\t\t\t</FieldLabel>\n\t\t\t\t\t\t{newEmojiPreview && (\n\t\t\t\t\t\t\t<Box display='flex' flexDirection='row' mbs='none' justifyContent='center'>\n\t\t\t\t\t\t\t\t<Margins inline={4}>\n\t\t\t\t\t\t\t\t\t<Box is='img' style={{ objectFit: 'contain' }} w='x120' h='x120' src={newEmojiPreview} />\n\t\t\t\t\t\t\t\t</Margins>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Field>\n\t\t\t\t</FieldGroup>\n\t\t\t</ContextualbarScrollableContent>\n\t\t\t<ContextualbarFooter>\n\t\t\t\t<ButtonGroup stretch>\n\t\t\t\t\t<Button onClick={close}>{t('Cancel')}</Button>\n\t\t\t\t\t<Button primary onClick={handleSave} disabled={!hasUnsavedChanges}>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t\t<ButtonGroup mbs={8} stretch>\n\t\t\t\t\t<Button icon='trash' danger onClick={handleDeleteButtonClick}>\n\t\t\t\t\t\t{t('Delete')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</ContextualbarFooter>\n\t\t</>\n\t);\n};\n\nexport default EditCustomEmoji;\n",null],"names":["_objectSpread","_objectWithoutProperties","Box","Button","ButtonGroup","Margins","TextInput","Field","FieldGroup","FieldLabel","FieldRow","FieldError","IconButton","useSetModal","useToastMessageDispatch","useAbsoluteUrl","useTranslation","React","useCallback","useState","useMemo","useEffect","ContextualbarScrollableContent","ContextualbarFooter","GenericModal","useEndpointAction","useEndpointUpload","useFileInput","module","link","default","v","exportDefault","_ref","close","onChange","data","props","_excluded","t","dispatchToastMessage","setModal","absoluteUrl","errors","setErrors","name","aliases","_id","previousName","previousAliases","setName","_data$name","setAliases","_data$aliases$join","_data$aliases","join","emojiFile","setEmojiFile","newEmojiPreview","URL","createObjectURL","concat","encodeURIComponent","extension","hasUnsavedChanges","saveAction","handleSave","prevState","formData","FormData","append","result","success","deleteAction","handleDeleteButtonClick","handleDelete","emojiId","type","message","error","handleCancel","createElement","variant","onConfirm","onCancel","onClose","confirmText","handleChangeAliases","e","currentTarget","value","clickUpload","Fragment","placeholder","field","alignSelf","display","justifyContent","alignItems","icon","secondary","onClick","flexDirection","mbs","inline","is","style","objectFit","w","h","src","stretch","primary","disabled","danger"],"mappings":"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"}