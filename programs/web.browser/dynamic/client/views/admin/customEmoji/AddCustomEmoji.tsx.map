)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/customEmoji/AddCustomEmoji.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Box, Button, ButtonGroup, Margins, TextInput, Field, FieldLabel, FieldRow, FieldError, Icon } from '@rocket.chat/fuselage';\nimport { useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement, ChangeEvent } from 'react';\nimport React, { useCallback, useState } from 'react';\n\nimport { ContextualbarScrollableContent, ContextualbarFooter } from '../../../components/Contextualbar';\nimport { useEndpointUpload } from '../../../hooks/useEndpointUpload';\nimport { useFileInput } from '../../../hooks/useFileInput';\n\ntype AddCustomEmojiProps = {\n\tclose: () => void;\n\tonChange: () => void;\n};\n\nconst AddCustomEmoji = ({ close, onChange, ...props }: AddCustomEmojiProps): ReactElement => {\n\tconst t = useTranslation();\n\tconst [name, setName] = useState('');\n\tconst [aliases, setAliases] = useState('');\n\tconst [emojiFile, setEmojiFile] = useState<Blob>();\n\tconst [newEmojiPreview, setNewEmojiPreview] = useState('');\n\tconst [errors, setErrors] = useState({ name: false, emoji: false, aliases: false });\n\n\tconst setEmojiPreview = useCallback(\n\t\tasync (file) => {\n\t\t\tsetEmojiFile(file);\n\t\t\tsetNewEmojiPreview(URL.createObjectURL(file));\n\t\t\tsetErrors((prevState) => ({ ...prevState, emoji: false }));\n\t\t},\n\t\t[setEmojiFile],\n\t);\n\n\tconst saveAction = useEndpointUpload('/v1/emoji-custom.create', t('Custom_Emoji_Added_Successfully'));\n\n\tconst handleSave = useCallback(async () => {\n\t\tif (!name) {\n\t\t\treturn setErrors((prevState) => ({ ...prevState, name: true }));\n\t\t}\n\n\t\tif (name === aliases) {\n\t\t\treturn setErrors((prevState) => ({ ...prevState, aliases: true }));\n\t\t}\n\n\t\tif (!emojiFile) {\n\t\t\treturn setErrors((prevState) => ({ ...prevState, emoji: true }));\n\t\t}\n\n\t\tconst formData = new FormData();\n\t\tformData.append('emoji', emojiFile);\n\t\tformData.append('name', name);\n\t\tformData.append('aliases', aliases);\n\t\tconst result = (await saveAction(formData)) as { success: boolean };\n\n\t\tif (result.success) {\n\t\t\tonChange();\n\t\t\tclose();\n\t\t}\n\t}, [emojiFile, name, aliases, saveAction, onChange, close]);\n\n\tconst [clickUpload] = useFileInput(setEmojiPreview, 'emoji');\n\n\tconst handleChangeName = (e: ChangeEvent<HTMLInputElement>): void => {\n\t\tif (e.currentTarget.value !== '') {\n\t\t\tsetErrors((prevState) => ({ ...prevState, name: false }));\n\t\t}\n\n\t\treturn setName(e.currentTarget.value);\n\t};\n\n\tconst handleChangeAliases = (e: ChangeEvent<HTMLInputElement>): void => {\n\t\tif (e.currentTarget.value !== name) {\n\t\t\tsetErrors((prevState) => ({ ...prevState, aliases: false }));\n\t\t}\n\n\t\treturn setAliases(e.currentTarget.value);\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarScrollableContent {...props}>\n\t\t\t\t<Field>\n\t\t\t\t\t<FieldLabel>{t('Name')}</FieldLabel>\n\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t<TextInput value={name} onChange={handleChangeName} placeholder={t('Name')} />\n\t\t\t\t\t</FieldRow>\n\t\t\t\t\t{errors.name && <FieldError>{t('error-the-field-is-required', { field: t('Name') })}</FieldError>}\n\t\t\t\t</Field>\n\t\t\t\t<Field>\n\t\t\t\t\t<FieldLabel>{t('Aliases')}</FieldLabel>\n\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t<TextInput value={aliases} onChange={handleChangeAliases} placeholder={t('Aliases')} />\n\t\t\t\t\t</FieldRow>\n\t\t\t\t\t{errors.aliases && <FieldError>{t('Custom_Emoji_Error_Same_Name_And_Alias')}</FieldError>}\n\t\t\t\t</Field>\n\t\t\t\t<Field>\n\t\t\t\t\t<FieldLabel alignSelf='stretch' display='flex' justifyContent='space-between' alignItems='center'>\n\t\t\t\t\t\t{t('Custom_Emoji')}\n\t\t\t\t\t\t{/* FIXME: replace to IconButton */}\n\t\t\t\t\t\t<Button square onClick={clickUpload}>\n\t\t\t\t\t\t\t<Icon name='upload' size='x20' />\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</FieldLabel>\n\t\t\t\t\t{errors.emoji && <FieldError>{t('error-the-field-is-required', { field: t('Custom_Emoji') })}</FieldError>}\n\t\t\t\t\t{newEmojiPreview && (\n\t\t\t\t\t\t<Box display='flex' flexDirection='row' mi='neg-x4' justifyContent='center'>\n\t\t\t\t\t\t\t<Margins inline={4}>\n\t\t\t\t\t\t\t\t<Box is='img' style={{ objectFit: 'contain' }} w='x120' h='x120' src={newEmojiPreview} />\n\t\t\t\t\t\t\t</Margins>\n\t\t\t\t\t\t</Box>\n\t\t\t\t\t)}\n\t\t\t\t</Field>\n\t\t\t</ContextualbarScrollableContent>\n\t\t\t<ContextualbarFooter>\n\t\t\t\t<ButtonGroup stretch>\n\t\t\t\t\t<Button onClick={close}>{t('Cancel')}</Button>\n\t\t\t\t\t<Button primary onClick={handleSave}>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</ContextualbarFooter>\n\t\t</>\n\t);\n};\n\nexport default AddCustomEmoji;\n",null],"names":["_objectSpread","_objectWithoutProperties","Box","Button","ButtonGroup","Margins","TextInput","Field","FieldLabel","FieldRow","Icon","useTranslation","React","useCallback","useState","ContextualbarScrollableContent","ContextualbarFooter","useEndpointUpload","useFileInput","module","link","default","v","FieldError","exportDefault","_ref","close","onChange","props","_excluded","t","name","setName","aliases","setAliases","emojiFile","setEmojiFile","newEmojiPreview","setNewEmojiPreview","errors","setErrors","emoji","setEmojiPreview","file","URL","createObjectURL","prevState","saveAction","handleSave","formData","FormData","append","result","success","clickUpload","createElement","Fragment","value","e","currentTarget","placeholder","field","alignSelf","display","justifyContent","alignItems","square","onClick","size","flexDirection","mi","inline","is","style","objectFit","w","h","src","stretch","primary"],"mappings":"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"}