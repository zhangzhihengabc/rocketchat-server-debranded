)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/workspace/VersionCard/getVersionStatus.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { SupportedVersions } from '@rocket.chat/server-cloud-communication';\nimport semver from 'semver';\n\nimport type { VersionStatus } from './components/VersionTag';\n\nexport const getVersionStatus = (\n\tserverVersion: string,\n\tversions: SupportedVersions['versions'],\n): { label: VersionStatus; expiration: Date | undefined; version: string } => {\n\tconst highestVersion = versions\n\t\t.sort((prev, current) => semver.compare(current.version, prev.version))\n\t\t.filter((v) => {\n\t\t\tconst [prerelease] = semver.prerelease(v.version) || [];\n\t\t\tconst [currentPrerelease] = semver.prerelease(serverVersion) || [];\n\n\t\t\treturn !prerelease || prerelease === currentPrerelease;\n\t\t})[0];\n\n\tconst currentVersionData =\n\t\tversions.find((v) => v.version === serverVersion) ||\n\t\tversions.find((v) =>\n\t\t\tsemver.satisfies(String(semver.coerce(v.version)), `=${semver.major(serverVersion)}.${semver.minor(serverVersion)}.x`),\n\t\t);\n\n\tconst currentVersionIsExpired = currentVersionData?.expiration && new Date(currentVersionData.expiration) < new Date();\n\n\tconst isSupported = !currentVersionIsExpired && !!currentVersionData;\n\n\treturn {\n\t\tlabel: 'outdated',\n\t\tversion: serverVersion,\n\t\t...(isSupported && semver.gte(currentVersionData?.version, highestVersion.version) && { label: 'latest' }),\n\t\t...(isSupported &&\n\t\t\tsemver.gt(highestVersion.version, currentVersionData?.version) && { label: 'available_version', version: highestVersion.version }),\n\t\texpiration: currentVersionData?.expiration,\n\t};\n};\n",null],"names":["_objectSpread","semver","module","link","default","export","getVersionStatus","serverVersion","versions","highestVersion","sort","prev","current","compare","version","filter","v","prerelease","currentPrerelease","currentVersionData","find","satisfies","String","coerce","concat","major","minor","currentVersionIsExpired","expiration","Date","isSupported","label","gte","gt"],"mappings":"2BACAA,EAA4BC,EAAfC,EAAMC,IAAS,CAAA,uCAAA,CAAAC,QAAAA,CAAAA,EAAAJ,EAAAA,CAAA,CAAA,EAAA,GAA5BE,EAAOG,MAAM,CAAA,CAAAC,iBAAe,IAAAA,CAAA,GAAAJ,EAAAA,IAAAA,CAAAA,SAAAA,CAAAE,QAAAA,CAAAA,EAAAH,EAAAA,CAAA,CAAA,EAAA,GAIrB,IAAMK,EAAmB,CAC/BC,EACAC,KAEA,IAAMC,EAAiBD,EACrBE,IAAI,CAAC,CAACC,EAAMC,IAAYX,EAAOY,OAAO,CAACD,EAAQE,OAAO,CAAEH,EAAKG,OAAO,GACpEC,MAAM,CAAEC,IACR,GAAM,CAACC,EAAW,CAAGhB,EAAOgB,UAAU,CAACD,EAAEF,OAAO,GAAK,EAAE,CACjD,CAACI,EAAkB,CAAGjB,EAAOgB,UAAU,CAACV,IAAkB,EAAE,CAElE,MAAO,CAACU,GAAcA,IAAeC,CACtC,EAAE,CAAC,EAAE,CAEAC,EACLX,EAASY,IAAI,CAAEJ,GAAMA,EAAEF,OAAO,GAAKP,IACnCC,EAASY,IAAI,CAAEJ,GACdf,EAAOoB,SAAS,CAACC,OAAOrB,EAAOsB,MAAM,CAACP,EAAEF,OAAO,GAAE,IAAAU,MAAA,CAAMvB,EAAOwB,KAAK,CAAClB,GAAc,KAAAiB,MAAA,CAAIvB,EAAOyB,KAAK,CAACnB,GAAc,QAG7GoB,EAA0B,AAAAR,CAAAA,MAAAA,EAAkB,KAAA,EAAlBA,EAAoBS,UAAU,AAAVA,GAAc,IAAIC,KAAKV,EAAmBS,UAAU,EAAI,IAAIC,KAE1GC,EAAc,CAACH,GAA2B,CAAC,CAACR,EAElD,OAAAnB,EAAAA,EAAAA,EAAA,CACC+B,MAAO,WACPjB,QAASP,CAAa,EAClBuB,GAAe7B,EAAO+B,GAAG,CAACb,MAAAA,EAAkB,KAAA,EAAlBA,EAAoBL,OAAO,CAAEL,EAAeK,OAAO,GAAK,CAAEiB,MAAO,QAAQ,GACnGD,GACH7B,EAAOgC,EAAE,CAACxB,EAAeK,OAAO,CAAEK,MAAAA,EAAkB,KAAA,EAAlBA,EAAoBL,OAAO,GAAK,CAAEiB,MAAO,oBAAqBjB,QAASL,EAAeK,OAAAA,AAAO,GAAE,CAAA,EAAA,CAClIc,WAAYT,MAAAA,EAAkB,KAAA,EAAlBA,EAAoBS,UAAAA,AAAU,EAE5C"}