)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/workspace/VersionCard/modals/RegisterWorkspaceSetupModal/RegisterWorkspaceSetupStepTwoModal.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Modal, Box, Field, FieldLabel, FieldRow, TextInput } from '@rocket.chat/fuselage';\nimport { useEndpoint, useToastMessageDispatch, useTranslation } from '@rocket.chat/ui-contexts';\nimport React, { useCallback, useEffect } from 'react';\nimport { Trans } from 'react-i18next';\n\ntype Props = {\n\temail: string;\n\tstep: number;\n\tsetStep: (step: number) => void;\n\tonClose: () => void;\n\tintentData: {\n\t\tdevice_code: string;\n\t\tinterval: number;\n\t\tuser_code: string;\n\t};\n\tonSuccess: () => void;\n};\n\nconst setIntervalTime = (interval?: number): number => (interval ? interval * 1000 : 0);\n\nconst RegisterWorkspaceSetupStepTwoModal = ({ email, step, setStep, onClose, intentData, onSuccess, ...props }: Props) => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst cloudConfirmationPoll = useEndpoint('GET', '/v1/cloud.confirmationPoll');\n\tconst createRegistrationIntent = useEndpoint('POST', '/v1/cloud.createRegistrationIntent');\n\n\tconst handleBackFromConfirmation = (): void => setStep(step - 1);\n\n\tconst handleResendRegistrationEmail = async () => {\n\t\ttry {\n\t\t\tawait createRegistrationIntent({ resend: true, email });\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Email_sent') });\n\t\t} catch (error: unknown) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t};\n\n\tconst getConfirmation = useCallback(async () => {\n\t\ttry {\n\t\t\tconst { pollData } = await cloudConfirmationPoll({\n\t\t\t\tdeviceCode: intentData.device_code,\n\t\t\t});\n\n\t\t\tif ('successful' in pollData && pollData.successful) {\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Workspace_registered') });\n\t\t\t\tonSuccess();\n\t\t\t}\n\t\t} catch (error: any) {\n\t\t\tconsole.log(error);\n\t\t}\n\t}, [cloudConfirmationPoll, intentData.device_code, dispatchToastMessage, t]);\n\n\tuseEffect(() => {\n\t\tconst pollInterval = setInterval(() => getConfirmation(), setIntervalTime(intentData.interval));\n\n\t\treturn (): void => clearInterval(pollInterval);\n\t}, [getConfirmation, intentData]);\n\n\treturn (\n\t\t<Modal {...props}>\n\t\t\t<Modal.Header>\n\t\t\t\t<Modal.HeaderText>\n\t\t\t\t\t<Modal.Tagline>{t('RegisterWorkspace_Setup_Steps', { step, numberOfSteps: 2 })}</Modal.Tagline>\n\t\t\t\t\t<Modal.Title>{t('Awaiting_confirmation')}</Modal.Title>\n\t\t\t\t</Modal.HeaderText>\n\t\t\t\t<Modal.Close onClick={onClose} />\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Content>\n\t\t\t\t<Box fontSize='p2'>\n\t\t\t\t\t<Box>\n\t\t\t\t\t\t<Trans i18nKey='RegisterWorkspace_Setup_Email_Confirmation'>\n\t\t\t\t\t\t\t<Box is='p'>\n\t\t\t\t\t\t\t\tEmail sent to{' '}\n\t\t\t\t\t\t\t\t<Box is='span' fontScale='p2b'>\n\t\t\t\t\t\t\t\t\t{email}{' '}\n\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\twith a confirmation link.\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Trans>\n\t\t\t\t\t</Box>\n\t\t\t\t\t<Box is='p'>{t('RegisterWorkspace_Setup_Email_Verification')}</Box>\n\t\t\t\t\t<Field pbs={10}>\n\t\t\t\t\t\t<FieldLabel>{t('Security_code')}</FieldLabel>\n\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t<TextInput defaultValue={intentData.user_code} disabled />\n\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t</Field>\n\t\t\t\t</Box>\n\t\t\t</Modal.Content>\n\t\t\t<Modal.Footer>\n\t\t\t\t<Box is='div' display='flex' justifyContent='start' fontSize='c1' w='full'>\n\t\t\t\t\tDidnâ€™t receive email?{' '}\n\t\t\t\t\t<Box is='a' pi={4} onClick={handleResendRegistrationEmail}>\n\t\t\t\t\t\tResend\n\t\t\t\t\t</Box>{' '}\n\t\t\t\t\tor{' '}\n\t\t\t\t\t<Box is='a' pi={4} onClick={handleBackFromConfirmation}>\n\t\t\t\t\t\tchange email\n\t\t\t\t\t</Box>\n\t\t\t\t</Box>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n};\n\nexport default RegisterWorkspaceSetupStepTwoModal;\n",null],"names":["_objectWithoutProperties","Modal","Box","Field","FieldLabel","FieldRow","TextInput","useEndpoint","useToastMessageDispatch","useTranslation","React","useCallback","useEffect","Trans","module","default","v","setIntervalTime","interval","exportDefault","_ref","email","step","setStep","onClose","intentData","onSuccess","props","_excluded","t","dispatchToastMessage","cloudConfirmationPoll","createRegistrationIntent","handleResendRegistrationEmail","resend","type","message","error","getConfirmation","pollData","deviceCode","device_code","successful","console","log","pollInterval","setInterval","clearInterval","createElement","Header","HeaderText","Tagline","numberOfSteps","Title","Close","onClick","Content","fontSize","i18nKey","is","fontScale","pbs","defaultValue","user_code","disabled","Footer","display","justifyContent","w","pi"],"mappings":"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"}