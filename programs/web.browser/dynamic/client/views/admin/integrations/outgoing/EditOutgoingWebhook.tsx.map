)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/integrations/outgoing/EditOutgoingWebhook.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IOutgoingIntegration, Serialized } from '@rocket.chat/core-typings';\nimport { Button, ButtonGroup, Tabs, TabsItem } from '@rocket.chat/fuselage';\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport { useSetModal, useTranslation, useRouter, useRouteParameter } from '@rocket.chat/ui-contexts';\nimport React, { useCallback } from 'react';\nimport { FormProvider, useForm } from 'react-hook-form';\n\nimport GenericModal from '../../../../components/GenericModal';\nimport Page from '../../../../components/Page';\nimport { triggerWordsToArray, triggerWordsToString } from '../helpers/triggerWords';\nimport { useCreateIntegration } from '../hooks/useCreateIntegration';\nimport { useDeleteIntegration } from '../hooks/useDeleteIntegration';\nimport { useUpdateIntegration } from '../hooks/useUpdateIntegration';\nimport OutgoingWebhookForm from './OutgoingWebhookForm';\n\nconst getInitialValue = (webhookData: Serialized<IOutgoingIntegration> | undefined, defaultToken: string) => ({\n\tenabled: webhookData?.enabled || true,\n\timpersonateUser: webhookData?.impersonateUser || false,\n\tevent: webhookData?.event || 'sendMessage',\n\turls: webhookData?.urls?.join('\\n') ?? '',\n\ttoken: webhookData?.token || defaultToken,\n\ttriggerWords: triggerWordsToString(webhookData?.triggerWords) || '',\n\ttargetRoom: webhookData?.targetRoom || '',\n\tchannel: webhookData?.channel.join(', ') || '',\n\tusername: webhookData?.username || '',\n\tname: webhookData?.name || '',\n\talias: webhookData?.alias || '',\n\tavatar: webhookData?.avatar || '',\n\temoji: webhookData?.emoji || '',\n\tscriptEnabled: webhookData?.scriptEnabled || false,\n\tscriptEngine: webhookData?.scriptEngine || 'isolated-vm',\n\tscript: webhookData?.script || '',\n\tretryFailedCalls: webhookData?.retryFailedCalls || true,\n\tretryCount: webhookData?.retryCount || 6,\n\tretryDelay: webhookData?.retryDelay || 'powers-of-ten',\n\ttriggerWordAnywhere: webhookData?.triggerWordAnywhere || false,\n\trunOnEdits: webhookData?.runOnEdits || true,\n});\n\nconst OUTGOING_TYPE = 'webhook-outgoing';\n\nconst EditOutgoingWebhook = ({ webhookData }: { webhookData?: Serialized<IOutgoingIntegration> }) => {\n\tconst t = useTranslation();\n\tconst setModal = useSetModal();\n\tconst router = useRouter();\n\n\tconst tab = useRouteParameter('type');\n\n\tconst defaultToken = useUniqueId();\n\n\tconst methods = useForm({ mode: 'onBlur', values: getInitialValue(webhookData, defaultToken) });\n\tconst {\n\t\treset,\n\t\thandleSubmit,\n\t\tformState: { isDirty },\n\t\twatch,\n\t} = methods;\n\n\tconst deleteIntegration = useDeleteIntegration(OUTGOING_TYPE);\n\tconst createIntegration = useCreateIntegration(OUTGOING_TYPE);\n\tconst updateIntegration = useUpdateIntegration(OUTGOING_TYPE);\n\n\tconst handleDeleteIntegration = useCallback(() => {\n\t\tconst onDelete = async () => {\n\t\t\tdeleteIntegration.mutate({ type: OUTGOING_TYPE, integrationId: webhookData?._id });\n\t\t};\n\n\t\tsetModal(\n\t\t\t<GenericModal variant='danger' onConfirm={onDelete} onCancel={() => setModal(null)} confirmText={t('Delete')}>\n\t\t\t\t{t('Integration_Delete_Warning')}\n\t\t\t</GenericModal>,\n\t\t);\n\t}, [webhookData?._id, deleteIntegration, setModal, t]);\n\n\tconst { urls, triggerWords } = watch();\n\n\tconst handleSave = useCallback(\n\t\tasync ({ ...formValues }) => {\n\t\t\tif (webhookData?._id) {\n\t\t\t\treturn updateIntegration.mutate({\n\t\t\t\t\ttype: OUTGOING_TYPE,\n\t\t\t\t\tintegrationId: webhookData?._id,\n\t\t\t\t\t...formValues,\n\t\t\t\t\ttriggerWords: triggerWordsToArray(triggerWords),\n\t\t\t\t\turls: urls.split('\\n'),\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn createIntegration.mutate({\n\t\t\t\ttype: OUTGOING_TYPE,\n\t\t\t\t...formValues,\n\t\t\t\ttriggerWords: triggerWordsToArray(triggerWords),\n\t\t\t\turls: urls.split('\\n'),\n\t\t\t});\n\t\t},\n\t\t[webhookData?._id, createIntegration, updateIntegration, triggerWords, urls],\n\t);\n\n\tconst formId = useUniqueId();\n\n\treturn (\n\t\t<Page flexDirection='column'>\n\t\t\t<Page.Header title={t('Integration_Outgoing_WebHook')}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t<Button icon='back' onClick={() => router.navigate('/admin/integrations/webhook-outgoing')}>\n\t\t\t\t\t\t{t('Back')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t{webhookData?._id && (\n\t\t\t\t\t\t<Button onClick={() => router.navigate(`/admin/integrations/history/outgoing/${webhookData._id}`)}>{t('History')}</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t{webhookData?._id && (\n\t\t\t\t\t\t<Button danger onClick={handleDeleteIntegration}>\n\t\t\t\t\t\t\t{t('Delete')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Header>\n\t\t\t{!webhookData?._id && (\n\t\t\t\t<Tabs>\n\t\t\t\t\t<TabsItem selected={tab === 'incoming'} onClick={() => router.navigate('/admin/integrations/new/incoming')}>\n\t\t\t\t\t\t{t('Incoming')}\n\t\t\t\t\t</TabsItem>\n\t\t\t\t\t<TabsItem selected={tab === 'outgoing'} onClick={() => router.navigate('/admin/integrations/new/outgoing')}>\n\t\t\t\t\t\t{t('Outgoing')}\n\t\t\t\t\t</TabsItem>\n\t\t\t\t</Tabs>\n\t\t\t)}\n\t\t\t<Page.ScrollableContentWithShadow is='form' id={formId} onSubmit={handleSubmit(handleSave)}>\n\t\t\t\t<FormProvider {...methods}>\n\t\t\t\t\t<OutgoingWebhookForm />\n\t\t\t\t</FormProvider>\n\t\t\t</Page.ScrollableContentWithShadow>\n\t\t\t<Page.Footer isDirty={isDirty}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t<Button type='reset' onClick={() => reset()}>\n\t\t\t\t\t\t{t('Cancel')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button form={formId} primary type='submit'>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Footer>\n\t\t</Page>\n\t);\n};\n\nexport default EditOutgoingWebhook;\n",null],"names":["_objectSpread","_objectDestructuringEmpty","_extends","Button","ButtonGroup","Tabs","TabsItem","useUniqueId","useSetModal","useTranslation","useRouter","useRouteParameter","React","useCallback","FormProvider","useForm","GenericModal","Page","triggerWordsToArray","triggerWordsToString","useCreateIntegration","useDeleteIntegration","useUpdateIntegration","OutgoingWebhookForm","module","default","v","link","getInitialValue","webhookData","defaultToken","_webhookData$urls$joi","_webhookData$urls","enabled","impersonateUser","event","urls","join","token","triggerWords","targetRoom","channel","username","name","alias","avatar","emoji","scriptEnabled","scriptEngine","script","retryFailedCalls","retryCount","retryDelay","triggerWordAnywhere","runOnEdits","OUTGOING_TYPE","exportDefault","_ref","t","setModal","router","tab","methods","mode","values","reset","handleSubmit","formState","isDirty","watch","deleteIntegration","createIntegration","updateIntegration","handleDeleteIntegration","onDelete","mutate","type","integrationId","_id","createElement","variant","onConfirm","onCancel","confirmText","handleSave","_ref2","formValues","split","formId","flexDirection","Header","title","icon","onClick","navigate","concat","danger","selected","ScrollableContentWithShadow","is","id","onSubmit","Footer","form","primary"],"mappings":"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"}