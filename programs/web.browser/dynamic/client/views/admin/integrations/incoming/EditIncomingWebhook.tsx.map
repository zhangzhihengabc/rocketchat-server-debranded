)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/integrations/incoming/EditIncomingWebhook.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IIncomingIntegration, Serialized } from '@rocket.chat/core-typings';\nimport { Button, ButtonGroup, Tabs, TabsItem } from '@rocket.chat/fuselage';\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport { useSetModal, useTranslation, useRouter, useRouteParameter } from '@rocket.chat/ui-contexts';\nimport React, { useCallback } from 'react';\nimport { FormProvider, useForm } from 'react-hook-form';\n\nimport GenericModal from '../../../../components/GenericModal';\nimport Page from '../../../../components/Page';\nimport { useCreateIntegration } from '../hooks/useCreateIntegration';\nimport { useDeleteIntegration } from '../hooks/useDeleteIntegration';\nimport { useUpdateIntegration } from '../hooks/useUpdateIntegration';\nimport IncomingWebhookForm from './IncomingWebhookForm';\n\nconst getInitialValue = (webhookData: Serialized<IIncomingIntegration> | undefined) => ({\n\tenabled: webhookData?.enabled || false,\n\tchannel: webhookData?.channel.join(', ') || '',\n\tusername: webhookData?.username || '',\n\tname: webhookData?.name || '',\n\talias: webhookData?.alias || '',\n\tavatar: webhookData?.avatar || '',\n\temoji: webhookData?.emoji || '',\n\tscriptEnabled: webhookData?.scriptEnabled || false,\n\tscriptEngine: webhookData?.scriptEngine || 'isolated-vm',\n\toverrideDestinationChannelEnabled: webhookData?.overrideDestinationChannelEnabled || false,\n\tscript: webhookData?.script || '',\n});\n\nconst INCOMING_TYPE = 'webhook-incoming';\n\nconst EditIncomingWebhook = ({ webhookData }: { webhookData?: Serialized<IIncomingIntegration> }) => {\n\tconst t = useTranslation();\n\tconst router = useRouter();\n\tconst setModal = useSetModal();\n\tconst tab = useRouteParameter('type');\n\n\tconst deleteIntegration = useDeleteIntegration(INCOMING_TYPE);\n\tconst updateIntegration = useUpdateIntegration(INCOMING_TYPE);\n\tconst createIntegration = useCreateIntegration(INCOMING_TYPE);\n\n\tconst methods = useForm({ mode: 'onBlur', values: getInitialValue(webhookData) });\n\n\tconst {\n\t\treset,\n\t\thandleSubmit,\n\t\tformState: { isDirty },\n\t} = methods;\n\n\tconst handleDeleteIntegration = useCallback(() => {\n\t\tconst onDelete = async () => {\n\t\t\tif (!webhookData?._id) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdeleteIntegration.mutate({ integrationId: webhookData._id, type: INCOMING_TYPE });\n\t\t};\n\n\t\tsetModal(\n\t\t\t<GenericModal variant='danger' onConfirm={onDelete} onCancel={() => setModal(null)} confirmText={t('Delete')}>\n\t\t\t\t{t('Integration_Delete_Warning')}\n\t\t\t</GenericModal>,\n\t\t);\n\t}, [webhookData?._id, deleteIntegration, setModal, t]);\n\n\tconst handleSave = useCallback(\n\t\tasync (formValues) => {\n\t\t\tif (webhookData?._id) {\n\t\t\t\treturn updateIntegration.mutate({ integrationId: webhookData?._id, type: INCOMING_TYPE, ...formValues });\n\t\t\t}\n\n\t\t\treturn createIntegration.mutate({ type: INCOMING_TYPE, ...formValues });\n\t\t},\n\t\t[webhookData?._id, updateIntegration, createIntegration],\n\t);\n\n\tconst formId = useUniqueId();\n\n\treturn (\n\t\t<Page flexDirection='column'>\n\t\t\t<Page.Header title={t('Integration_Incoming_WebHook')}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t<Button icon='back' onClick={() => router.navigate('/admin/integrations/webhook-incoming')}>\n\t\t\t\t\t\t{t('Back')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t{webhookData?._id && (\n\t\t\t\t\t\t<Button danger onClick={handleDeleteIntegration}>\n\t\t\t\t\t\t\t{t('Delete')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Header>\n\t\t\t{!webhookData?._id && (\n\t\t\t\t<Tabs>\n\t\t\t\t\t<TabsItem selected={tab === 'incoming'} onClick={() => router.navigate('/admin/integrations/new/incoming')}>\n\t\t\t\t\t\t{t('Incoming')}\n\t\t\t\t\t</TabsItem>\n\t\t\t\t\t<TabsItem selected={tab === 'outgoing'} onClick={() => router.navigate('/admin/integrations/new/outgoing')}>\n\t\t\t\t\t\t{t('Outgoing')}\n\t\t\t\t\t</TabsItem>\n\t\t\t\t</Tabs>\n\t\t\t)}\n\t\t\t<Page.ScrollableContentWithShadow id={formId} is='form' onSubmit={handleSubmit(handleSave)}>\n\t\t\t\t<FormProvider {...methods}>\n\t\t\t\t\t<IncomingWebhookForm webhookData={webhookData} />\n\t\t\t\t</FormProvider>\n\t\t\t</Page.ScrollableContentWithShadow>\n\t\t\t<Page.Footer isDirty={isDirty}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t<Button type='reset' onClick={() => reset()}>\n\t\t\t\t\t\t{t('Cancel')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button form={formId} primary type='submit'>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Footer>\n\t\t</Page>\n\t);\n};\n\nexport default EditIncomingWebhook;\n",null],"names":["_objectSpread","Button","ButtonGroup","Tabs","TabsItem","useUniqueId","useSetModal","useTranslation","useRouter","useRouteParameter","React","useCallback","FormProvider","useForm","GenericModal","Page","useCreateIntegration","useDeleteIntegration","useUpdateIntegration","IncomingWebhookForm","module","default","v","link","getInitialValue","webhookData","enabled","channel","join","username","name","alias","avatar","emoji","scriptEnabled","scriptEngine","overrideDestinationChannelEnabled","script","INCOMING_TYPE","exportDefault","_ref","t","router","setModal","tab","deleteIntegration","updateIntegration","createIntegration","methods","mode","values","reset","handleSubmit","formState","isDirty","handleDeleteIntegration","onDelete","_id","mutate","integrationId","type","createElement","variant","onConfirm","onCancel","confirmText","handleSave","formValues","formId","flexDirection","Header","title","icon","onClick","navigate","danger","selected","ScrollableContentWithShadow","id","is","onSubmit","Footer","form","primary"],"mappings":"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"}