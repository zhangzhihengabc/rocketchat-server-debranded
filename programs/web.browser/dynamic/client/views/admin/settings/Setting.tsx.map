)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/settings/Setting.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { ISettingColor, SettingEditor, SettingValue } from '@rocket.chat/core-typings';\nimport { isSettingColor, isSetting } from '@rocket.chat/core-typings';\nimport { Button } from '@rocket.chat/fuselage';\nimport { useDebouncedCallback } from '@rocket.chat/fuselage-hooks';\nimport { ExternalLink } from '@rocket.chat/ui-client';\nimport { useSettingStructure, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useEffect, useMemo, useState, useCallback } from 'react';\n\nimport MarkdownText from '../../../components/MarkdownText';\nimport { useEditableSetting, useEditableSettingsDispatch, useIsEnterprise } from '../EditableSettingsContext';\nimport MemoizedSetting from './MemoizedSetting';\nimport SettingSkeleton from './SettingSkeleton';\n\ntype SettingProps = {\n\tclassName?: string;\n\tsettingId: string;\n\tsectionChanged?: boolean;\n};\n\nfunction Setting({ className = undefined, settingId, sectionChanged }: SettingProps): ReactElement {\n\tconst setting = useEditableSetting(settingId);\n\tconst persistedSetting = useSettingStructure(settingId);\n\tconst isEnterprise = useIsEnterprise();\n\n\tif (!setting || !persistedSetting) {\n\t\tthrow new Error(`Setting ${settingId} not found`);\n\t}\n\n\t// Checks if setting has at least required fields before doing anything\n\tif (!isSetting(setting)) {\n\t\tthrow new Error(`Setting ${settingId} is not valid`);\n\t}\n\n\tconst dispatch = useEditableSettingsDispatch();\n\n\tconst update = useDebouncedCallback(\n\t\t({ value, editor }: { value?: SettingValue; editor?: SettingEditor }) => {\n\t\t\tif (!persistedSetting) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdispatch([\n\t\t\t\t{\n\t\t\t\t\t_id: persistedSetting._id,\n\t\t\t\t\t...(value !== undefined && { value }),\n\t\t\t\t\t...(editor !== undefined && { editor }),\n\t\t\t\t\tchanged:\n\t\t\t\t\t\tJSON.stringify(persistedSetting.value) !== JSON.stringify(value) ||\n\t\t\t\t\t\t(isSettingColor(persistedSetting) && JSON.stringify(persistedSetting.editor) !== JSON.stringify(editor)),\n\t\t\t\t},\n\t\t\t]);\n\t\t},\n\t\t230,\n\t\t[persistedSetting, dispatch],\n\t);\n\n\tconst t = useTranslation();\n\n\tconst [value, setValue] = useState(setting.value);\n\tconst [editor, setEditor] = useState(isSettingColor(setting) ? setting.editor : undefined);\n\n\tuseEffect(() => {\n\t\tsetValue(setting.value);\n\t}, [setting.value]);\n\n\tuseEffect(() => {\n\t\tsetEditor(isSettingColor(setting) ? setting.editor : undefined);\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [(setting as ISettingColor).editor]);\n\n\tconst onChangeValue = useCallback(\n\t\t(value) => {\n\t\t\tsetValue(value);\n\t\t\tupdate({ value });\n\t\t},\n\t\t[update],\n\t);\n\n\tconst onChangeEditor = useCallback(\n\t\t(editor) => {\n\t\t\tsetEditor(editor);\n\t\t\tupdate({ editor });\n\t\t},\n\t\t[update],\n\t);\n\n\tconst onResetButtonClick = useCallback(() => {\n\t\tsetValue(setting.value);\n\t\tsetEditor(isSettingColor(setting) ? setting.editor : undefined);\n\t\tupdate({\n\t\t\tvalue: persistedSetting.packageValue,\n\t\t\t...(isSettingColor(persistedSetting) && { editor: persistedSetting.packageEditor }),\n\t\t});\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [setting.value, (setting as ISettingColor).editor, update, persistedSetting]);\n\n\tconst { _id, disabled, readonly, type, packageValue, i18nLabel, i18nDescription, alert, invisible } = setting;\n\n\tconst label = (t.has(i18nLabel) && t(i18nLabel)) || (t.has(_id) && t(_id)) || i18nLabel || _id;\n\n\tconst hint = useMemo(\n\t\t() =>\n\t\t\ti18nDescription && t.has(i18nDescription) ? <MarkdownText variant='inline' preserveHtml content={t(i18nDescription)} /> : undefined,\n\t\t[i18nDescription, t],\n\t);\n\tconst callout = useMemo(() => alert && <span dangerouslySetInnerHTML={{ __html: t.has(alert) ? t(alert) : alert }} />, [alert, t]);\n\n\tconst shouldDisableEnterprise = setting.enterprise && !isEnterprise;\n\n\tconst PRICING_URL = 'https://go.rocket.chat/i/see-paid-plan-customize-homepage';\n\n\tconst showUpgradeButton = useMemo(\n\t\t() =>\n\t\t\tshouldDisableEnterprise ? (\n\t\t\t\t<ExternalLink to={PRICING_URL}>\n\t\t\t\t\t<Button>{t('See_Paid_Plan')}</Button>\n\t\t\t\t</ExternalLink>\n\t\t\t) : undefined,\n\t\t[shouldDisableEnterprise, t],\n\t);\n\n\tconst hasResetButton =\n\t\t!shouldDisableEnterprise &&\n\t\t!readonly &&\n\t\ttype !== 'asset' &&\n\t\t((isSettingColor(setting) && JSON.stringify(setting.packageEditor) !== JSON.stringify(editor)) ||\n\t\t\tJSON.stringify(value) !== JSON.stringify(packageValue)) &&\n\t\t!disabled;\n\n\t// @todo: type check props based on setting type\n\n\treturn (\n\t\t<MemoizedSetting\n\t\t\tclassName={className}\n\t\t\tlabel={label || undefined}\n\t\t\thint={hint}\n\t\t\tcallout={callout}\n\t\t\tshowUpgradeButton={showUpgradeButton}\n\t\t\tsectionChanged={sectionChanged}\n\t\t\t{...setting}\n\t\t\tdisabled={setting.disabled || shouldDisableEnterprise}\n\t\t\tvalue={value}\n\t\t\teditor={editor}\n\t\t\thasResetButton={hasResetButton}\n\t\t\tonChangeValue={onChangeValue}\n\t\t\tonChangeEditor={onChangeEditor}\n\t\t\tonResetButtonClick={onResetButtonClick}\n\t\t\tinvisible={invisible}\n\t\t/>\n\t);\n}\n\nexport default Object.assign(Setting, {\n\tMemoized: MemoizedSetting,\n\tSkeleton: SettingSkeleton,\n});\n",null],"names":["_extends","_objectSpread","isSettingColor","isSetting","Button","useDebouncedCallback","ExternalLink","useSettingStructure","useTranslation","React","useEffect","useMemo","useState","useCallback","MarkdownText","useEditableSetting","useEditableSettingsDispatch","useIsEnterprise","MemoizedSetting","SettingSkeleton","module","default","link","exportDefault","Object","assign","_ref","className","settingId","sectionChanged","setting","persistedSetting","isEnterprise","Error","concat","dispatch","update","_ref2","value","editor","_id","undefined","changed","JSON","stringify","t","setValue","setEditor","onChangeValue","onChangeEditor","onResetButtonClick","packageValue","packageEditor","disabled","readonly","type","i18nLabel","i18nDescription","alert","invisible","label","has","hint","createElement","variant","preserveHtml","content","callout","dangerouslySetInnerHTML","__html","shouldDisableEnterprise","enterprise","showUpgradeButton","to","hasResetButton","Memoized","Skeleton"],"mappings":"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"}