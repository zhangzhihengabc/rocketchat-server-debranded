)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/settings/groups/OAuthGroupPage.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { ISetting } from '@rocket.chat/core-typings';\nimport { Button } from '@rocket.chat/fuselage';\nimport { capitalize } from '@rocket.chat/string-helpers';\nimport { useToastMessageDispatch, useAbsoluteUrl, useMethod, useTranslation, useSetModal } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { memo, useEffect, useState } from 'react';\n\nimport { strRight } from '../../../../../lib/utils/stringUtils';\nimport GenericModal from '../../../../components/GenericModal';\nimport { useEditableSettingsGroupSections } from '../../EditableSettingsContext';\nimport GroupPage from '../GroupPage';\nimport Section from '../Section';\nimport CreateOAuthModal from './CreateOAuthModal';\n\ntype OAuthGroupPageProps = ISetting;\n\nfunction OAuthGroupPage({ _id, ...group }: OAuthGroupPageProps): ReactElement {\n\tconst sections = useEditableSettingsGroupSections(_id);\n\tconst solo = sections.length === 1;\n\tconst t = useTranslation();\n\n\tconst [settingSections, setSettingSections] = useState(sections);\n\n\tconst sectionIsCustomOAuth = (sectionName: string): string | boolean => sectionName && /^Custom OAuth:\\s.+/.test(sectionName);\n\n\tconst getAbsoluteUrl = useAbsoluteUrl();\n\n\tconst callbackURL = (sectionName: string): string => {\n\t\tconst id = strRight(sectionName, 'Custom OAuth: ').toLowerCase();\n\t\treturn getAbsoluteUrl(`_oauth/${id}`);\n\t};\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst refreshOAuthService = useMethod('refreshOAuthService');\n\tconst addOAuthService = useMethod('addOAuthService');\n\tconst removeOAuthService = useMethod('removeOAuthService');\n\tconst setModal = useSetModal();\n\n\tconst handleRefreshOAuthServicesButtonClick = async (): Promise<void> => {\n\t\tdispatchToastMessage({ type: 'info', message: t('Refreshing') });\n\t\ttry {\n\t\t\tawait refreshOAuthService();\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Done') });\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t};\n\n\tconst handleAddCustomOAuthButtonClick = (): void => {\n\t\tconst onConfirm = async (text: string): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tawait addOAuthService(text);\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Custom_OAuth_has_been_added') });\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t} finally {\n\t\t\t\tsetModal(null);\n\t\t\t}\n\t\t};\n\t\tsetModal(<CreateOAuthModal onConfirm={onConfirm} onClose={(): void => setModal(null)} />);\n\t};\n\n\tuseEffect(() => {\n\t\tsetSettingSections(sections);\n\t}, [sections]);\n\n\tconst removeCustomOauthFactory =\n\t\t(id: string): (() => void) =>\n\t\t(): void => {\n\t\t\tconst handleConfirm = async (): Promise<void> => {\n\t\t\t\ttry {\n\t\t\t\t\tawait removeOAuthService(id);\n\t\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Custom_OAuth_has_been_removed') });\n\t\t\t\t\tsetSettingSections(settingSections.filter((section) => section !== `Custom OAuth: ${capitalize(id)}`));\n\t\t\t\t} catch (error) {\n\t\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t\t} finally {\n\t\t\t\t\tsetModal(null);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tsetModal(\n\t\t\t\t<GenericModal\n\t\t\t\t\tonClose={() => setModal(null)}\n\t\t\t\t\tonCancel={() => setModal(null)}\n\t\t\t\t\ttitle={t('Are_you_sure')}\n\t\t\t\t\tvariant='danger'\n\t\t\t\t\tconfirmText={t('Yes_delete_it')}\n\t\t\t\t\tonConfirm={handleConfirm}\n\t\t\t\t/>,\n\t\t\t);\n\t\t};\n\n\treturn (\n\t\t<GroupPage\n\t\t\t_id={_id}\n\t\t\t{...group}\n\t\t\theaderButtons={\n\t\t\t\t<>\n\t\t\t\t\t<Button onClick={handleRefreshOAuthServicesButtonClick}>{t('Refresh_oauth_services')}</Button>\n\t\t\t\t\t<Button onClick={handleAddCustomOAuthButtonClick}>{t('Add_custom_oauth')}</Button>\n\t\t\t\t</>\n\t\t\t}\n\t\t>\n\t\t\t{settingSections.map((sectionName) => {\n\t\t\t\tif (sectionIsCustomOAuth(sectionName)) {\n\t\t\t\t\tconst id = strRight(sectionName, 'Custom OAuth: ').toLowerCase();\n\n\t\t\t\t\tconst handleRemoveCustomOAuthButtonClick = removeCustomOauthFactory(id);\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<Section\n\t\t\t\t\t\t\tkey={sectionName}\n\t\t\t\t\t\t\tgroupId={_id}\n\t\t\t\t\t\t\thelp={\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tdangerouslySetInnerHTML={{\n\t\t\t\t\t\t\t\t\t\t__html: t('Custom_oauth_helper', callbackURL(sectionName)),\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsectionName={sectionName}\n\t\t\t\t\t\t\tsolo={solo}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div className='submit'>\n\t\t\t\t\t\t\t\t<Button secondary danger onClick={handleRemoveCustomOAuthButtonClick}>\n\t\t\t\t\t\t\t\t\t{t('Remove_custom_oauth')}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Section>\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\treturn <Section key={sectionName} groupId={_id} sectionName={sectionName} solo={solo} />;\n\t\t\t})}\n\t\t</GroupPage>\n\t);\n}\n\nexport default memo(OAuthGroupPage);\n",null],"names":["_extends","_objectWithoutProperties","Button","capitalize","useToastMessageDispatch","useAbsoluteUrl","useMethod","useTranslation","useSetModal","React","memo","useEffect","useState","strRight","GenericModal","useEditableSettingsGroupSections","GroupPage","Section","CreateOAuthModal","module","link","default","exportDefault","_ref","_id","group","_excluded","sections","solo","length","t","settingSections","setSettingSections","sectionIsCustomOAuth","sectionName","test","getAbsoluteUrl","callbackURL","id","toLowerCase","concat","dispatchToastMessage","refreshOAuthService","addOAuthService","removeOAuthService","setModal","handleRefreshOAuthServicesButtonClick","type","message","error","removeCustomOauthFactory","handleConfirm","filter","section","createElement","onClose","onCancel","title","variant","confirmText","onConfirm","headerButtons","Fragment","onClick","text","map","handleRemoveCustomOAuthButtonClick","key","groupId","help","dangerouslySetInnerHTML","__html","className","secondary","danger"],"mappings":"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"}