)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/settings/inputs/CodeMirror/CodeMirror.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { Editor, EditorFromTextArea } from 'codemirror';\nimport type { ReactElement } from 'react';\nimport React, { useEffect, useRef, useState } from 'react';\n\nconst defaultGutters = ['CodeMirror-linenumbers', 'CodeMirror-foldgutter'];\n\ntype CodeMirrorProps = {\n\tid: string;\n\tplaceholder?: string;\n\tdisabled?: boolean;\n\tautoComplete?: string | undefined;\n\tlineNumbers?: boolean;\n\tlineWrapping?: boolean;\n\tmode?: string;\n\tgutters?: string[];\n\tfoldGutter?: boolean;\n\tmatchBrackets?: boolean;\n\tautoCloseBrackets?: boolean;\n\tmatchTags?: boolean;\n\tshowTrailingSpace?: boolean;\n\thighlightSelectionMatches?: boolean;\n\treadOnly: boolean;\n\tvalue: string;\n\tdefaultValue?: string;\n\tonChange: (value: string) => void;\n};\n\nfunction CodeMirror({\n\tlineNumbers = true,\n\tlineWrapping = true,\n\tmode = 'javascript',\n\tgutters = defaultGutters,\n\tfoldGutter = true,\n\tmatchBrackets = true,\n\tautoCloseBrackets = true,\n\tmatchTags = true,\n\tshowTrailingSpace = true,\n\thighlightSelectionMatches = true,\n\treadOnly,\n\tvalue: valueProp,\n\tdefaultValue,\n\tonChange,\n\t...props\n}: CodeMirrorProps): ReactElement {\n\tconst [value, setValue] = useState(valueProp || defaultValue);\n\n\tconst textAreaRef = useRef<HTMLTextAreaElement>(null);\n\tconst editorRef = useRef<EditorFromTextArea | null>(null);\n\tconst handleChange = useMutableCallback(onChange);\n\n\tuseEffect(() => {\n\t\tif (editorRef.current) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst setupCodeMirror = async (): Promise<void> => {\n\t\t\tconst CodeMirror = await import('codemirror');\n\t\t\tawait Promise.all([\n\t\t\t\timport('../../../../../../app/ui/client/lib/codeMirror/codeMirror'),\n\t\t\t\timport('codemirror/addon/edit/matchbrackets'),\n\t\t\t\timport('codemirror/addon/edit/closebrackets'),\n\t\t\t\timport('codemirror/addon/edit/matchtags'),\n\t\t\t\timport('codemirror/addon/edit/trailingspace'),\n\t\t\t\timport('codemirror/addon/search/match-highlighter'),\n\t\t\t\timport('codemirror/lib/codemirror.css'),\n\t\t\t]);\n\n\t\t\tif (!textAreaRef.current) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\teditorRef.current = CodeMirror.fromTextArea(textAreaRef.current, {\n\t\t\t\tlineNumbers,\n\t\t\t\tlineWrapping,\n\t\t\t\tmode,\n\t\t\t\tgutters,\n\t\t\t\tfoldGutter,\n\t\t\t\tmatchBrackets,\n\t\t\t\tautoCloseBrackets,\n\t\t\t\tmatchTags,\n\t\t\t\tshowTrailingSpace,\n\t\t\t\thighlightSelectionMatches,\n\t\t\t\treadOnly,\n\t\t\t});\n\n\t\t\teditorRef.current.on('change', (doc: Editor) => {\n\t\t\t\tconst value = doc.getValue();\n\t\t\t\tsetValue(value);\n\t\t\t\thandleChange(value);\n\t\t\t});\n\t\t};\n\n\t\tsetupCodeMirror();\n\n\t\treturn (): void => {\n\t\t\tif (!editorRef.current) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\teditorRef.current.toTextArea();\n\t\t};\n\t}, [\n\t\tautoCloseBrackets,\n\t\tfoldGutter,\n\t\tgutters,\n\t\thighlightSelectionMatches,\n\t\tlineNumbers,\n\t\tlineWrapping,\n\t\tmatchBrackets,\n\t\tmatchTags,\n\t\tmode,\n\t\thandleChange,\n\t\treadOnly,\n\t\ttextAreaRef,\n\t\tshowTrailingSpace,\n\t]);\n\n\tuseEffect(() => {\n\t\tsetValue(valueProp);\n\t}, [valueProp]);\n\n\tuseEffect(() => {\n\t\tif (!editorRef.current) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (value !== editorRef.current.getValue()) {\n\t\t\teditorRef.current.setValue(value ?? '');\n\t\t}\n\t}, [textAreaRef, value]);\n\n\treturn <textarea readOnly ref={textAreaRef} style={{ display: 'none' }} value={value} {...props} />;\n}\n\nexport default CodeMirror;\n",null],"names":["_extends","_objectWithoutProperties","useMutableCallback","React","useEffect","useRef","useState","module","default","v","link","defaultGutters","exportDefault","_ref","lineNumbers","lineWrapping","mode","gutters","foldGutter","matchBrackets","autoCloseBrackets","matchTags","showTrailingSpace","highlightSelectionMatches","readOnly","value","valueProp","defaultValue","onChange","props","_excluded","setValue","textAreaRef","editorRef","handleChange","current","setupCodeMirror","CodeMirror","dynamicImport","Promise","all","fromTextArea","on","doc","getValue","toTextArea","createElement","ref","style","display"],"mappings":"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"}