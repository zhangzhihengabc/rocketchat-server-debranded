)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/settings/inputs/AssetSettingInput.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Button, FieldLabel, FieldRow, Icon } from '@rocket.chat/fuselage';\nimport { Random } from '@rocket.chat/random';\nimport { useToastMessageDispatch, useEndpoint, useTranslation, useUpload } from '@rocket.chat/ui-contexts';\nimport type { ChangeEventHandler, DragEvent, ReactElement, SyntheticEvent } from 'react';\nimport React from 'react';\n\nimport './AssetSettingInput.styles.css';\n\ntype AssetSettingInputProps = {\n\t_id: string;\n\tlabel: string;\n\tvalue?: { url: string };\n\tasset?: any;\n\tfileConstraints?: { extensions: string[] };\n};\n\nfunction AssetSettingInput({ _id, label, value, asset, fileConstraints }: AssetSettingInputProps): ReactElement {\n\tconst t = useTranslation();\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst setAsset = useUpload('/v1/assets.setAsset');\n\tconst unsetAsset = useEndpoint('POST', '/v1/assets.unsetAsset');\n\n\tconst isDataTransferEvent = <T extends SyntheticEvent>(event: T): event is T & DragEvent<HTMLInputElement> =>\n\t\tBoolean('dataTransfer' in event && (event as any).dataTransfer.files);\n\n\tconst handleUpload: ChangeEventHandler<HTMLInputElement> = (event): void => {\n\t\tlet { files } = event.target;\n\n\t\tif (!files || files.length === 0) {\n\t\t\tif (isDataTransferEvent(event)) {\n\t\t\t\tfiles = event.dataTransfer.files;\n\t\t\t}\n\t\t}\n\n\t\tObject.values(files ?? []).forEach(async (blob) => {\n\t\t\tdispatchToastMessage({ type: 'info', message: t('Uploading_file') });\n\n\t\t\tconst fileData = new FormData();\n\t\t\tfileData.append('asset', blob, asset);\n\t\t\tfileData.append('assetName', asset);\n\n\t\t\ttry {\n\t\t\t\tawait setAsset(fileData);\n\t\t\t} catch (e) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: e });\n\t\t\t}\n\t\t});\n\t};\n\n\tconst handleDeleteButtonClick = async (): Promise<void> => {\n\t\ttry {\n\t\t\tawait unsetAsset({ assetName: asset });\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<FieldLabel htmlFor={_id} title={_id}>\n\t\t\t\t{label}\n\t\t\t</FieldLabel>\n\t\t\t<FieldRow>\n\t\t\t\t<div className='settings-file-preview'>\n\t\t\t\t\t{value?.url ? (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName='preview'\n\t\t\t\t\t\t\tstyle={{ backgroundImage: `url(${value.url}?_dc=${Random.id()})` }}\n\t\t\t\t\t\t\trole='img'\n\t\t\t\t\t\t\taria-label={t('Asset_preview')}\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className='preview no-file background-transparent-light secondary-font-color'>\n\t\t\t\t\t\t\t<Icon size='x16' name='upload' />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t\t<div className='action'>\n\t\t\t\t\t\t{value?.url ? (\n\t\t\t\t\t\t\t<Button icon='trash' onClick={handleDeleteButtonClick}>\n\t\t\t\t\t\t\t\t{t('Delete')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<div className='rc-button rc-button--primary'>\n\t\t\t\t\t\t\t\t{t('Select_file')}\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tclassName='AssetSettingInput__input'\n\t\t\t\t\t\t\t\t\ttype='file'\n\t\t\t\t\t\t\t\t\taccept={`.${fileConstraints?.extensions?.join(', .')}`}\n\t\t\t\t\t\t\t\t\tonChange={handleUpload}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</FieldRow>\n\t\t</>\n\t);\n}\n\nexport default AssetSettingInput;\n",null],"names":["Button","FieldLabel","FieldRow","Icon","Random","useToastMessageDispatch","useEndpoint","useTranslation","useUpload","React","module","link","v","default","exportDefault","_ref","_fileConstraints$exte","_id","label","value","asset","fileConstraints","t","dispatchToastMessage","setAsset","unsetAsset","isDataTransferEvent","event","Boolean","dataTransfer","files","handleDeleteButtonClick","assetName","error","type","message","createElement","Fragment","htmlFor","title","className","url","style","backgroundImage","concat","id","role","size","name","icon","onClick","accept","extensions","join","onChange","_files","target","length","Object","values","forEach","blob","fileData","FormData","append","e"],"mappings":"2BAAAA,EAASC,EAAQC,EAAYC,EAA8CC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA9CC,EAAcC,IAAE,CAAA,wBAAM,CAAAX,OAAwBY,CAAA,EAAAZ,EAAAA,CAAA,EAAAC,WAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,KAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAO,EAAAA,IAAAA,CAAAA,sBAAAA,CAAAN,OAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAL,wBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,UAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,QAAAA,CAAAG,QAAAA,CAAAA,EAAAJ,EAAAA,CAAA,CAAA,EAAA,GAAAC,EAAAA,IAAAA,CAAAA,kCAA3EA,EAAOI,aAAU,CAgBjB,SAA0BC,CAAA,EAAsE,IAAAC,EAAA,GAArE,CAAEC,IAAAA,CAAG,CAAEC,MAAAA,CAAK,CAAEC,MAAAA,CAAK,CAAEC,MAAAA,CAAK,CAAEC,gBAAAA,CAAAA,CAAyC,CAAAN,EACzFO,EAAIf,IAEJgB,EAAuBlB,IACvBmB,EAAWhB,EAAU,uBACrBiB,EAAanB,EAAY,OAAQ,yBAEjCoB,EAAiDC,GACtDC,CAAAA,CAAQ,CAAA,iBAAkBD,GAAUA,EAAcE,YAAY,CAACC,KAAK,AAALA,EA0B1DC,EAA0B,UAC/B,GAAI,CACH,MAAMN,EAAW,CAAEO,UAAWZ,CAAK,GAClC,MAAOa,EAAO,CACfV,EAAqB,CAAEW,KAAM,QAASC,QAASF,CAAK,GAEtD,EAEA,OACCxB,EAAA2B,aAAA,CAAA3B,EAAA4B,QAAA,CAAA,KACC5B,EAAA2B,aAAA,CAACnC,EAAU,CAACqC,QAASrB,EAAKsB,MAAOtB,CAAI,EACnCC,GAEFT,EAAA2B,aAAA,CAAClC,EAAQ,KACRO,EAAA2B,aAAA,CAAA,MAAA,CAAKI,UAAU,uBAAuB,EACpCrB,MAAAA,GAAAA,EAAOsB,GAAG,CACVhC,EAAA2B,aAAA,CAAA,MAAA,CACCI,UAAU,UACVE,MAAO,CAAEC,gBAAe,OAAAC,MAAA,CAASzB,EAAMsB,GAAG,CAAA,SAAAG,MAAA,CAAQxC,EAAOyC,EAAE,GAAE,IAAG,EAChEC,KAAK,MACL,aAAYxB,EAAE,gBAAiB,GAGhCb,EAAA2B,aAAA,CAAA,MAAA,CAAKI,UAAU,mEAAmE,EACjF/B,EAAA2B,aAAA,CAACjC,EAAI,CAAC4C,KAAK,MAAMC,KAAK,QAAQ,IAGhCvC,EAAA2B,aAAA,CAAA,MAAA,CAAKI,UAAU,QAAQ,EACrBrB,MAAAA,GAAAA,EAAOsB,GAAG,CACVhC,EAAA2B,aAAA,CAACpC,EAAM,CAACiD,KAAK,QAAQC,QAASnB,CAAwB,EACpDT,EAAE,WAGJb,EAAA2B,aAAA,CAAA,MAAA,CAAKI,UAAU,8BAA8B,EAC3ClB,EAAE,eACHb,EAAA2B,aAAA,CAAA,QAAA,CACCI,UAAU,2BACVN,KAAK,OACLiB,OAAM,IAAAP,MAAA,CAAMvB,MAAAA,EAAe,KAAA,EAAA,AAAY,OAAZL,CAAAA,EAAfK,EAAiB+B,UAAU,AAAVA,GAAUpC,AAAA,KAAA,IAAAA,EAAA,KAAA,EAA3BA,EAA6BqC,IAAI,CAAC,QAC9CC,SA/DoD3B,IAAe,IAAA4B,EAC1E,GAAI,CAAEzB,MAAAA,CAAAA,CAAO,CAAGH,EAAM6B,MAAM,CAExB,CAAA,CAAC1B,GAASA,AAAiB,IAAjBA,EAAM2B,MAAM,AAAK,GAC1B/B,EAAoBC,IACvBG,CAAAA,EAAQH,EAAME,YAAY,CAACC,KAAK,AAALA,EAI7B4B,OAAOC,MAAM,CAAA,AAAM,OAANJ,CAAAA,EAACzB,CAAAA,GAAKyB,AAAA,KAAA,IAAAA,EAAAA,EAAI,EAAE,EAAEK,OAAO,CAAC,MAAOC,IACzCtC,EAAqB,CAAEW,KAAM,OAAQC,QAASb,EAAE,iBAAiB,GAEjE,IAAMwC,EAAW,IAAIC,SACrBD,EAASE,MAAM,CAAC,QAASH,EAAMzC,GAC/B0C,EAASE,MAAM,CAAC,YAAa5C,GAE7B,GAAI,CACH,MAAMI,EAASsC,GACd,MAAOG,EAAG,CACX1C,EAAqB,CAAEW,KAAM,QAASC,QAAS8B,CAAC,GAElD,EACD,CAyC+B,OAShC"}