)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/moderation/hooks/useDeleteMessage.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useEndpoint, useSetModal, useToastMessageDispatch, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport React from 'react';\n\nimport GenericModal from '../../../../components/GenericModal';\n\nconst useDeleteMessage = (mid: string, rid: string, onChange: () => void) => {\n\tconst t = useTranslation();\n\tconst deleteMessage = useEndpoint('POST', '/v1/chat.delete');\n\tconst dismissMessage = useEndpoint('POST', '/v1/moderation.dismissReports');\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst setModal = useSetModal();\n\tconst queryClient = useQueryClient();\n\n\tconst handleDeleteMessages = useMutation({\n\t\tmutationFn: deleteMessage,\n\t\tonError: (error) => {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\tsetModal();\n\t\t},\n\t\tonSuccess: async () => {\n\t\t\tawait handleDismissMessage.mutateAsync({ msgId: mid });\n\t\t},\n\t});\n\n\tconst handleDismissMessage = useMutation({\n\t\tmutationFn: dismissMessage,\n\t\tonError: (error) => {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t},\n\t\tonSuccess: () => {\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Moderation_Message_deleted') });\n\t\t},\n\t\tonSettled: () => {\n\t\t\tonChange();\n\t\t\tqueryClient.invalidateQueries({ queryKey: ['moderation.reports'] });\n\t\t\tsetModal();\n\t\t},\n\t});\n\n\tconst onDeleteAll = async () => {\n\t\tawait handleDeleteMessages.mutateAsync({ msgId: mid, roomId: rid, asUser: true });\n\t};\n\n\tconst confirmDeletMessage = (): void => {\n\t\tsetModal(\n\t\t\t<GenericModal\n\t\t\t\tconfirmText={t('Moderation_Dismiss_and_delete')}\n\t\t\t\ttitle={t('Moderation_Delete_this_message')}\n\t\t\t\tvariant='danger'\n\t\t\t\tonConfirm={() => onDeleteAll()}\n\t\t\t\tonCancel={() => setModal()}\n\t\t\t>\n\t\t\t\t{t('Moderation_Are_you_sure_you_want_to_delete_this_message')}\n\t\t\t</GenericModal>,\n\t\t);\n\t};\n\n\treturn confirmDeletMessage;\n};\n\nexport default useDeleteMessage;\n",null],"names":["useEndpoint","useSetModal","useToastMessageDispatch","useTranslation","useMutation","useQueryClient","React","GenericModal","module","link","v","default","exportDefault","mid","rid","onChange","t","deleteMessage","dismissMessage","dispatchToastMessage","setModal","queryClient","handleDeleteMessages","mutationFn","onError","error","type","message","onSuccess","handleDismissMessage","mutateAsync","msgId","onSettled","invalidateQueries","queryKey","onDeleteAll","roomId","asUser","createElement","confirmText","title","variant","onConfirm","onCancel"],"mappings":"2BAAAA,EAASC,EAAaC,EAAaC,EAA0EC,EAAAC,EAAAC,EAAAC,EAAjDC,EAAcC,IAAE,CAAA,2BAAM,CAAAT,YAA2BU,CAAA,EAAAV,EAAAA,CAAA,EAAAC,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,wBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAK,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAJ,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,QAAAA,CAAAG,QAAAA,CAAAA,EAAAL,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,sCAAAA,CAAAG,QAAAA,CAAAA,EAAAJ,EAAAA,CAAA,CAAA,EAAA,GAA7GC,EAAOI,aAAa,CAMK,CAACC,EAAaC,EAAaC,KACnD,IAAMC,EAAIb,IACJc,EAAgBjB,EAAY,OAAQ,mBACpCkB,EAAiBlB,EAAY,OAAQ,iCACrCmB,EAAuBjB,IACvBkB,EAAWnB,IACXoB,EAAchB,IAEdiB,EAAuBlB,EAAY,CACxCmB,WAAYN,EACZO,QAAUC,IACTN,EAAqB,CAAEO,KAAM,QAASC,QAASF,CAAK,GACpDL,GACD,EACAQ,UAAW,UACV,MAAMC,EAAqBC,WAAW,CAAC,CAAEC,MAAOlB,CAAG,EACpD,IAGKgB,EAAuBzB,EAAY,CACxCmB,WAAYL,EACZM,QAAUC,IACTN,EAAqB,CAAEO,KAAM,QAASC,QAASF,CAAK,EACrD,EACAG,UAAW,KACVT,EAAqB,CAAEO,KAAM,UAAWC,QAASX,EAAE,6BAA6B,EACjF,EACAgB,UAAW,KACVjB,IACAM,EAAYY,iBAAiB,CAAC,CAAEC,SAAU,CAAC,qBAAoB,AAAC,GAChEd,GACD,IAGKe,EAAc,UACnB,MAAMb,EAAqBQ,WAAW,CAAC,CAAEC,MAAOlB,EAAKuB,OAAQtB,EAAKuB,OAAQ,CAAA,CAAI,EAC/E,EAgBA,MAd4B,KAC3BjB,EACCd,EAAAgC,aAAA,CAAC/B,EAAY,CACZgC,YAAavB,EAAE,iCACfwB,MAAOxB,EAAE,kCACTyB,QAAQ,SACRC,UAAW,IAAMP,IACjBQ,SAAU,IAAMvB,GAAW,EAE1BJ,EAAE,4DAGN,CAGD"}