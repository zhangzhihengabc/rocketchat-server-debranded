)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/permissions/hooks/usePermissionsAndRoles.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IRole, IPermission } from '@rocket.chat/core-typings';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { escapeRegExp } from '@rocket.chat/string-helpers';\nimport type { Mongo } from 'meteor/mongo';\nimport { useCallback } from 'react';\n\nimport { CONSTANTS } from '../../../../../app/authorization/lib';\nimport { ChatPermissions, Roles } from '../../../../../app/models/client';\nimport { useReactiveValue } from '../../../../hooks/useReactiveValue';\n\nexport const usePermissionsAndRoles = (\n\ttype = 'permissions',\n\tfilter = '',\n\tlimit = 25,\n\tskip = 0,\n): { permissions: IPermission[]; total: number; roleList: IRole[]; reload: () => void } => {\n\tconst getFilter = useCallback((): Mongo.Selector<IPermission> => {\n\t\tconst filterRegExp = new RegExp(escapeRegExp(filter), 'i');\n\n\t\treturn {\n\t\t\tlevel: type === 'permissions' ? { $ne: CONSTANTS.SETTINGS_LEVEL } : CONSTANTS.SETTINGS_LEVEL,\n\t\t\t_id: filterRegExp,\n\t\t};\n\t}, [type, filter]);\n\n\tconst getPermissions = useCallback(\n\t\t() =>\n\t\t\tChatPermissions.find(getFilter(), {\n\t\t\t\tsort: {\n\t\t\t\t\t_id: 1,\n\t\t\t\t},\n\t\t\t\tskip,\n\t\t\t\tlimit,\n\t\t\t}),\n\t\t[limit, skip, getFilter],\n\t);\n\tconst getTotalPermissions = useCallback(() => ChatPermissions.find(getFilter()).count(), [getFilter]);\n\n\tconst permissions = useReactiveValue(getPermissions);\n\tconst permissionsTotal = useReactiveValue(getTotalPermissions);\n\tconst getRoles = useMutableCallback(() => Roles.find().fetch());\n\tconst roles = useReactiveValue(getRoles);\n\n\treturn { permissions: permissions.fetch(), total: permissionsTotal, roleList: roles, reload: getRoles };\n};\n",null],"names":["useMutableCallback","escapeRegExp","useCallback","CONSTANTS","ChatPermissions","Roles","useReactiveValue","module","export","usePermissionsAndRoles","type","arguments","length","undefined","filter","limit","skip","getFilter","filterRegExp","RegExp","level","$ne","SETTINGS_LEVEL","_id","getPermissions","find","sort","getTotalPermissions","count","permissions","permissionsTotal","getRoles","fetch","roles","total","roleList","reload"],"mappings":"2BACiEA,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAjEC,EAAOC,MAAE,CAAA,CAAAC,uBAA0B,IAAAA,CAA6B,GAACF,EAAAA,IAAAA,CAAAA,8BAAAA,CAAAP,mBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAO,EAAAA,IAAAA,CAAAA,8BAAAA,CAAAN,aAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,QAAAA,CAAAL,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAK,EAAAA,IAAAA,CAAAA,uCAAAA,CAAAJ,UAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,mCAAAA,CAAAH,gBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,MAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,qCAAAA,CAAAD,iBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAS1D,IAAMG,EAAyB,WAKoD,IAJzFC,EAAIC,UAAAC,MAAA,CAAA,GAAAD,AAAAE,KAAAA,IAAAF,SAAA,CAAA,EAAA,CAAAA,SAAA,CAAA,EAAA,CAAG,cACPG,EAAMH,UAAAC,MAAA,CAAA,GAAAD,AAAAE,KAAAA,IAAAF,SAAA,CAAA,EAAA,CAAAA,SAAA,CAAA,EAAA,CAAG,GACTI,EAAKJ,UAAAC,MAAA,CAAA,GAAAD,AAAAE,KAAAA,IAAAF,SAAA,CAAA,EAAA,CAAAA,SAAA,CAAA,EAAA,CAAG,GACRK,EAAIL,UAAAC,MAAA,CAAA,GAAAD,AAAAE,KAAAA,IAAAF,SAAA,CAAA,EAAA,CAAAA,SAAA,CAAA,EAAA,CAAG,EAEDM,EAAYf,EAAY,KAC7B,IAAMgB,EAAe,AAAIC,OAAOlB,EAAaa,GAAS,KAEtD,MAAO,CACNM,MAAOV,AAAS,gBAATA,EAAyB,CAAEW,IAAKlB,EAAUmB,cAAAA,AAAc,EAAKnB,EAAUmB,cAAc,CAC5FC,IAAKL,EAEP,EAAG,CAACR,EAAMI,EAAO,EAEXU,EAAiBtB,EACtB,IACCE,EAAgBqB,IAAI,CAACR,IAAa,CACjCS,KAAM,CACLH,IAAK,GAENP,KAAAA,EACAD,MAAAA,IAEF,CAACA,EAAOC,EAAMC,EAAU,EAEnBU,EAAsBzB,EAAY,IAAME,EAAgBqB,IAAI,CAACR,KAAaW,KAAK,GAAI,CAACX,EAAU,EAE9FY,EAAcvB,EAAiBkB,GAC/BM,EAAmBxB,EAAiBqB,GACpCI,EAAW/B,EAAmB,IAAMK,EAAMoB,IAAI,GAAGO,KAAK,IACtDC,EAAQ3B,EAAiByB,GAE/B,MAAO,CAAEF,YAAaA,EAAYG,KAAK,GAAIE,MAAOJ,EAAkBK,SAAUF,EAAOG,OAAQL,CAAQ,CACtG"}