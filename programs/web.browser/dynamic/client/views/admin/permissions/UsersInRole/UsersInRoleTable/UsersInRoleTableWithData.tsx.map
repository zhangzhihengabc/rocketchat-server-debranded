)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/permissions/UsersInRole/UsersInRoleTable/UsersInRoleTableWithData.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IRole, IRoom, IUserInRole } from '@rocket.chat/core-typings';\nimport { useEndpoint, useToastMessageDispatch, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useQuery } from '@tanstack/react-query';\nimport type { ReactElement, MutableRefObject } from 'react';\nimport React, { useEffect, useMemo } from 'react';\n\nimport { usePagination } from '../../../../../components/GenericTable/hooks/usePagination';\nimport UsersInRoleTable from './UsersInRoleTable';\n\ntype UsersInRoleTableWithDataProps = {\n\trid?: IRoom['_id'];\n\troleId: IRole['_id'];\n\troleName: IRole['name'];\n\tdescription: IRole['description'];\n\treloadRef: MutableRefObject<() => void>;\n};\n\nconst UsersInRoleTableWithData = ({\n\trid,\n\troleId,\n\troleName,\n\tdescription,\n\treloadRef,\n}: UsersInRoleTableWithDataProps): ReactElement | null => {\n\tconst { itemsPerPage, current, ...paginationData } = usePagination();\n\tconst t = useTranslation();\n\n\tconst query = useMemo(\n\t\t() => ({\n\t\t\trole: roleId,\n\t\t\t...(rid && { roomId: rid }),\n\t\t\t...(itemsPerPage && { count: itemsPerPage }),\n\t\t\t...(current && { offset: current }),\n\t\t}),\n\t\t[itemsPerPage, current, rid, roleId],\n\t);\n\n\tconst getUsersInRole = useEndpoint('GET', '/v1/roles.getUsersInRole');\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst { refetch, ...result } = useQuery(\n\t\t['roles', roleId, 'users', query],\n\t\tasync () => {\n\t\t\tconst { users } = await getUsersInRole(query);\n\n\t\t\tif (users.length === 0) {\n\t\t\t\tthrow new Error(t('No_results_found'));\n\t\t\t}\n\t\t\treturn users;\n\t\t},\n\t\t{\n\t\t\tonError: (error) => {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t},\n\t\t},\n\t);\n\n\tuseEffect(() => {\n\t\treloadRef.current = refetch;\n\t}, [refetch, reloadRef]);\n\n\tif (result.isLoading || result.error || !result.data) {\n\t\treturn null;\n\t}\n\n\tconst users: IUserInRole[] = result.data.map((user) => ({\n\t\t...user,\n\t\tcreatedAt: new Date(user.createdAt),\n\t\t_updatedAt: new Date(user._updatedAt),\n\t}));\n\n\treturn (\n\t\t<UsersInRoleTable\n\t\t\tusers={users}\n\t\t\ttotal={result.data.length}\n\t\t\treload={refetch}\n\t\t\troleName={roleName}\n\t\t\troleId={roleId}\n\t\t\tdescription={description}\n\t\t\trid={rid}\n\t\t\tpaginationData={{ itemsPerPage, current, ...paginationData }}\n\t\t/>\n\t);\n};\n\nexport default UsersInRoleTableWithData;\n",null],"names":["_objectSpread","_objectWithoutProperties","useEndpoint","useToastMessageDispatch","useTranslation","useQuery","React","useEffect","useMemo","usePagination","UsersInRoleTable","module","link","default","v","exportDefault","_ref","rid","roleId","roleName","description","reloadRef","_usePagination","itemsPerPage","current","paginationData","_excluded","t","query","role","roomId","count","offset","getUsersInRole","dispatchToastMessage","_useQuery","users","length","Error","onError","error","type","message","refetch","result","_excluded2","isLoading","data","map","user","createdAt","Date","_updatedAt","createElement","total","reload"],"mappings":"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"}