)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/permissions/PermissionsTable/PermissionsTable.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Margins, Tabs, Button, Pagination } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useRoute, usePermission, useMethod, useTranslation, useSetModal } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useState } from 'react';\n\nimport GenericNoResults from '../../../../components/GenericNoResults';\nimport { GenericTable, GenericTableHeader, GenericTableHeaderCell, GenericTableBody } from '../../../../components/GenericTable';\nimport { usePagination } from '../../../../components/GenericTable/hooks/usePagination';\nimport Page from '../../../../components/Page';\nimport CustomRoleUpsellModal from '../CustomRoleUpsellModal';\nimport PermissionsContextBar from '../PermissionsContextBar';\nimport { usePermissionsAndRoles } from '../hooks/usePermissionsAndRoles';\nimport PermissionRow from './PermissionRow';\nimport PermissionsTableFilter from './PermissionsTableFilter';\nimport RoleHeader from './RoleHeader';\n\nconst PermissionsTable = ({ isEnterprise }: { isEnterprise: boolean }): ReactElement => {\n\tconst t = useTranslation();\n\tconst [filter, setFilter] = useState('');\n\tconst canViewPermission = usePermission('access-permissions');\n\tconst canViewSettingPermission = usePermission('access-setting-permissions');\n\tconst defaultType = canViewPermission ? 'permissions' : 'settings';\n\tconst [type, setType] = useState(defaultType);\n\tconst router = useRoute('admin-permissions');\n\tconst setModal = useSetModal();\n\n\tconst grantRole = useMethod('authorization:addPermissionToRole');\n\tconst removeRole = useMethod('authorization:removeRoleFromPermission');\n\n\tconst { current, itemsPerPage, setItemsPerPage: onSetItemsPerPage, setCurrent: onSetCurrent, ...paginationProps } = usePagination();\n\tconst { permissions, total, roleList } = usePermissionsAndRoles(type, filter, itemsPerPage, current);\n\n\tconst handlePermissionsTab = useMutableCallback(() => {\n\t\tif (type === 'permissions') {\n\t\t\treturn;\n\t\t}\n\t\tsetType('permissions');\n\t});\n\n\tconst handleSettingsTab = useMutableCallback(() => {\n\t\tif (type === 'settings') {\n\t\t\treturn;\n\t\t}\n\t\tsetType('settings');\n\t});\n\n\tconst handleAdd = useMutableCallback(() => {\n\t\tif (!isEnterprise) {\n\t\t\tsetModal(<CustomRoleUpsellModal onClose={() => setModal(null)} />);\n\t\t\treturn;\n\t\t}\n\t\trouter.push({\n\t\t\tcontext: 'new',\n\t\t});\n\t});\n\n\treturn (\n\t\t<Page flexDirection='row'>\n\t\t\t<Page>\n\t\t\t\t<Page.Header title={t('Permissions')}>\n\t\t\t\t\t<Button primary onClick={handleAdd} aria-label={t('New')} name={t('New_role')}>\n\t\t\t\t\t\t{t('New_role')}\n\t\t\t\t\t</Button>\n\t\t\t\t</Page.Header>\n\t\t\t\t<Margins blockEnd={16}>\n\t\t\t\t\t<Tabs>\n\t\t\t\t\t\t<Tabs.Item\n\t\t\t\t\t\t\tdata-qa='PermissionTable-Permissions'\n\t\t\t\t\t\t\tselected={type === 'permissions'}\n\t\t\t\t\t\t\tonClick={handlePermissionsTab}\n\t\t\t\t\t\t\tdisabled={!canViewPermission}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{t('Permissions')}\n\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t\t<Tabs.Item\n\t\t\t\t\t\t\tdata-qa='PermissionTable-Settings'\n\t\t\t\t\t\t\tselected={type === 'settings'}\n\t\t\t\t\t\t\tonClick={handleSettingsTab}\n\t\t\t\t\t\t\tdisabled={!canViewSettingPermission}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{t('Settings')}\n\t\t\t\t\t\t</Tabs.Item>\n\t\t\t\t\t</Tabs>\n\t\t\t\t</Margins>\n\t\t\t\t<Page.Content mb='neg-x8'>\n\t\t\t\t\t<Margins block={8}>\n\t\t\t\t\t\t<PermissionsTableFilter onChange={setFilter} />\n\t\t\t\t\t\t{permissions?.length === 0 && <GenericNoResults />}\n\t\t\t\t\t\t{permissions?.length > 0 && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<GenericTable fixed={false}>\n\t\t\t\t\t\t\t\t\t<GenericTableHeader>\n\t\t\t\t\t\t\t\t\t\t<GenericTableHeaderCell width='x120'>{t('Name')}</GenericTableHeaderCell>\n\t\t\t\t\t\t\t\t\t\t{roleList?.map(({ _id, name, description }) => (\n\t\t\t\t\t\t\t\t\t\t\t<RoleHeader key={_id} _id={_id} name={name} description={description} />\n\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t</GenericTableHeader>\n\t\t\t\t\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t\t\t\t\t{permissions?.map((permission) => (\n\t\t\t\t\t\t\t\t\t\t\t<PermissionRow\n\t\t\t\t\t\t\t\t\t\t\t\tkey={permission._id}\n\t\t\t\t\t\t\t\t\t\t\t\tpermission={permission}\n\t\t\t\t\t\t\t\t\t\t\t\troleList={roleList}\n\t\t\t\t\t\t\t\t\t\t\t\tonGrant={grantRole}\n\t\t\t\t\t\t\t\t\t\t\t\tonRemove={removeRole}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t</GenericTableBody>\n\t\t\t\t\t\t\t\t</GenericTable>\n\t\t\t\t\t\t\t\t<Pagination\n\t\t\t\t\t\t\t\t\tdivider\n\t\t\t\t\t\t\t\t\tcurrent={current}\n\t\t\t\t\t\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\t\t\t\t\t\tcount={total}\n\t\t\t\t\t\t\t\t\tonSetItemsPerPage={onSetItemsPerPage}\n\t\t\t\t\t\t\t\t\tonSetCurrent={onSetCurrent}\n\t\t\t\t\t\t\t\t\t{...paginationProps}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Margins>\n\t\t\t\t</Page.Content>\n\t\t\t</Page>\n\t\t\t<PermissionsContextBar />\n\t\t</Page>\n\t);\n};\n\nexport default PermissionsTable;\n",null],"names":["_extends","_objectWithoutProperties","Margins","Tabs","Button","Pagination","useMutableCallback","useRoute","usePermission","useMethod","useTranslation","useSetModal","React","useState","GenericNoResults","GenericTable","GenericTableHeader","GenericTableHeaderCell","GenericTableBody","usePagination","Page","CustomRoleUpsellModal","PermissionsContextBar","usePermissionsAndRoles","PermissionRow","PermissionsTableFilter","RoleHeader","module","link","default","v","exportDefault","_ref","isEnterprise","t","filter","setFilter","canViewPermission","canViewSettingPermission","type","setType","router","setModal","grantRole","removeRole","_usePagination","current","itemsPerPage","setItemsPerPage","onSetItemsPerPage","setCurrent","onSetCurrent","paginationProps","_excluded","permissions","total","roleList","handlePermissionsTab","handleSettingsTab","handleAdd","createElement","onClose","push","context","flexDirection","Header","title","primary","onClick","name","blockEnd","Item","selected","disabled","Content","mb","block","onChange","length","Fragment","fixed","width","map","_ref2","_id","description","key","permission","onGrant","onRemove","divider","count"],"mappings":"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"}