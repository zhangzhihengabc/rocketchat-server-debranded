)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/rooms/RoomsTable.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Pagination, States, StatesIcon, StatesTitle, StatesActions, StatesAction } from '@rocket.chat/fuselage';\nimport { useMediaQuery, useDebouncedValue } from '@rocket.chat/fuselage-hooks';\nimport type { OptionProp } from '@rocket.chat/ui-client';\nimport { useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useQuery } from '@tanstack/react-query';\nimport type { ReactElement, MutableRefObject } from 'react';\nimport React, { useRef, useState, useEffect, useMemo } from 'react';\n\nimport GenericNoResults from '../../../components/GenericNoResults';\nimport {\n\tGenericTable,\n\tGenericTableBody,\n\tGenericTableHeader,\n\tGenericTableHeaderCell,\n\tGenericTableLoadingTable,\n} from '../../../components/GenericTable';\nimport { usePagination } from '../../../components/GenericTable/hooks/usePagination';\nimport { useSort } from '../../../components/GenericTable/hooks/useSort';\nimport RoomRow from './RoomRow';\nimport RoomsTableFilters from './RoomsTableFilters';\n\ntype RoomFilters = {\n\tsearchText: string;\n\ttypes: OptionProp[];\n};\n\nconst DEFAULT_TYPES = ['d', 'p', 'c', 'l', 'discussions', 'teams'];\n\nconst RoomsTable = ({ reload }: { reload: MutableRefObject<() => void> }): ReactElement => {\n\tconst t = useTranslation();\n\tconst mediaQuery = useMediaQuery('(min-width: 1024px)');\n\n\tconst [roomFilters, setRoomFilters] = useState<RoomFilters>({ searchText: '', types: [] });\n\n\tconst prevRoomFilterText = useRef<string>(roomFilters.searchText);\n\n\tconst { sortBy, sortDirection, setSort } = useSort<'name' | 't' | 'usersCount' | 'msgs' | 'default' | 'featured'>('name');\n\tconst { current, itemsPerPage, setItemsPerPage, setCurrent, ...paginationProps } = usePagination();\n\tconst searchText = useDebouncedValue(roomFilters.searchText, 500);\n\n\tconst query = useDebouncedValue(\n\t\tuseMemo(() => {\n\t\t\tif (searchText !== prevRoomFilterText.current) {\n\t\t\t\tsetCurrent(0);\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tfilter: searchText || '',\n\t\t\t\tsort: `{ \"${sortBy}\": ${sortDirection === 'asc' ? 1 : -1} }`,\n\t\t\t\tcount: itemsPerPage,\n\t\t\t\toffset: searchText === prevRoomFilterText.current ? current : 0,\n\t\t\t\ttypes: roomFilters.types.length ? [...roomFilters.types.map((roomType) => roomType.id)] : DEFAULT_TYPES,\n\t\t\t};\n\t\t}, [searchText, sortBy, sortDirection, itemsPerPage, current, roomFilters.types, setCurrent]),\n\t\t500,\n\t);\n\n\tconst getAdminRooms = useEndpoint('GET', '/v1/rooms.adminRooms');\n\n\tconst { data, refetch, isSuccess, isLoading, isError } = useQuery(['rooms', query, 'admin'], async () => getAdminRooms(query));\n\n\tuseEffect(() => {\n\t\treload.current = refetch;\n\t}, [reload, refetch]);\n\n\tuseEffect(() => {\n\t\tprevRoomFilterText.current = searchText;\n\t}, [searchText]);\n\n\tconst headers = (\n\t\t<>\n\t\t\t<GenericTableHeaderCell key='name' direction={sortDirection} active={sortBy === 'name'} onClick={setSort} sort='name' w='x200'>\n\t\t\t\t{t('Name')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell key='type' direction={sortDirection} active={sortBy === 't'} onClick={setSort} sort='t' w='x100'>\n\t\t\t\t{t('Type')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell\n\t\t\t\tkey='users'\n\t\t\t\tdirection={sortDirection}\n\t\t\t\tactive={sortBy === 'usersCount'}\n\t\t\t\tonClick={setSort}\n\t\t\t\tsort='usersCount'\n\t\t\t\tw='x80'\n\t\t\t>\n\t\t\t\t{t('Users')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t{mediaQuery && (\n\t\t\t\t<>\n\t\t\t\t\t<GenericTableHeaderCell key='messages' direction={sortDirection} active={sortBy === 'msgs'} onClick={setSort} sort='msgs' w='x80'>\n\t\t\t\t\t\t{t('Msgs')}\n\t\t\t\t\t</GenericTableHeaderCell>\n\t\t\t\t\t<GenericTableHeaderCell\n\t\t\t\t\t\tkey='default'\n\t\t\t\t\t\tdirection={sortDirection}\n\t\t\t\t\t\tactive={sortBy === 'default'}\n\t\t\t\t\t\tonClick={setSort}\n\t\t\t\t\t\tsort='default'\n\t\t\t\t\t\tw='x80'\n\t\t\t\t\t>\n\t\t\t\t\t\t{t('Default')}\n\t\t\t\t\t</GenericTableHeaderCell>\n\t\t\t\t\t<GenericTableHeaderCell\n\t\t\t\t\t\tkey='featured'\n\t\t\t\t\t\tdirection={sortDirection}\n\t\t\t\t\t\tactive={sortBy === 'featured'}\n\t\t\t\t\t\tonClick={setSort}\n\t\t\t\t\t\tsort='featured'\n\t\t\t\t\t\tw='x80'\n\t\t\t\t\t>\n\t\t\t\t\t\t{t('Featured')}\n\t\t\t\t\t</GenericTableHeaderCell>\n\t\t\t\t</>\n\t\t\t)}\n\t\t</>\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t<RoomsTableFilters setFilters={setRoomFilters} />\n\t\t\t{isLoading && (\n\t\t\t\t<GenericTable>\n\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t<GenericTableLoadingTable headerCells={mediaQuery ? 6 : 3} />\n\t\t\t\t\t</GenericTableBody>\n\t\t\t\t</GenericTable>\n\t\t\t)}\n\t\t\t{isSuccess && data.rooms.length === 0 && <GenericNoResults />}\n\t\t\t{isSuccess && data.rooms.length > 0 && (\n\t\t\t\t<>\n\t\t\t\t\t<GenericTable>\n\t\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t\t{data.rooms?.map((room) => (\n\t\t\t\t\t\t\t\t<RoomRow key={room._id} room={room} />\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</GenericTableBody>\n\t\t\t\t\t</GenericTable>\n\t\t\t\t\t<Pagination\n\t\t\t\t\t\tdivider\n\t\t\t\t\t\tcurrent={current}\n\t\t\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\t\t\tcount={data?.total || 0}\n\t\t\t\t\t\tonSetItemsPerPage={setItemsPerPage}\n\t\t\t\t\t\tonSetCurrent={setCurrent}\n\t\t\t\t\t\t{...paginationProps}\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t)}\n\t\t\t{isError && (\n\t\t\t\t<States>\n\t\t\t\t\t<StatesIcon name='warning' variation='danger' />\n\t\t\t\t\t<StatesTitle>{t('Something_went_wrong')}</StatesTitle>\n\t\t\t\t\t<StatesActions>\n\t\t\t\t\t\t<StatesAction onClick={() => refetch()}>{t('Reload_page')}</StatesAction>\n\t\t\t\t\t</StatesActions>\n\t\t\t\t</States>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default RoomsTable;\n",null],"names":["_extends","_objectWithoutProperties","Pagination","States","StatesIcon","StatesTitle","StatesActions","StatesAction","useMediaQuery","useDebouncedValue","useEndpoint","useTranslation","useQuery","React","useRef","useState","useEffect","useMemo","GenericNoResults","GenericTable","GenericTableBody","GenericTableHeader","GenericTableHeaderCell","GenericTableLoadingTable","usePagination","useSort","RoomRow","RoomsTableFilters","module","link","default","v","DEFAULT_TYPES","exportDefault","_ref","_data$rooms","reload","t","mediaQuery","roomFilters","setRoomFilters","searchText","types","prevRoomFilterText","sortBy","sortDirection","setSort","_usePagination","current","itemsPerPage","setItemsPerPage","setCurrent","paginationProps","_excluded","query","filter","sort","concat","count","offset","length","map","roomType","id","getAdminRooms","data","refetch","isSuccess","isLoading","isError","headers","createElement","Fragment","key","direction","active","onClick","w","setFilters","headerCells","rooms","room","_id","divider","total","onSetItemsPerPage","onSetCurrent","name","variation"],"mappings":"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"}