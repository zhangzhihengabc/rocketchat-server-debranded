)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/users/AdminUserInfoWithData.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { isUserFederated } from '@rocket.chat/core-typings';\nimport type { IUser } from '@rocket.chat/core-typings';\nimport { Callout } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useSetting, useRolesDescription, useTranslation, useEndpoint, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\nimport { useQuery } from '@tanstack/react-query';\nimport type { ReactElement } from 'react';\nimport React, { useMemo } from 'react';\n\nimport { getUserEmailAddress } from '../../../../lib/getUserEmailAddress';\nimport { ContextualbarContent } from '../../../components/Contextualbar';\nimport { FormSkeleton } from '../../../components/Skeleton';\nimport UserCard from '../../../components/UserCard';\nimport UserInfo from '../../../components/UserInfo';\nimport { UserStatus } from '../../../components/UserStatus';\nimport { getUserEmailVerified } from '../../../lib/utils/getUserEmailVerified';\nimport AdminUserInfoActions from './AdminUserInfoActions';\n\ntype AdminUserInfoWithDataProps = {\n\tuid: IUser['_id'];\n\tonReload: () => void;\n};\n\nconst AdminUserInfoWithData = ({ uid, onReload }: AdminUserInfoWithDataProps): ReactElement => {\n\tconst t = useTranslation();\n\tconst getRoles = useRolesDescription();\n\tconst approveManuallyUsers = useSetting('Accounts_ManuallyApproveNewUsers');\n\n\tconst getUsersInfo = useEndpoint('GET', '/v1/users.info');\n\n\tconst query = useMemo(() => ({ userId: uid }), [uid]);\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst { data, isLoading, error, refetch } = useQuery(\n\t\t['users', query, 'admin'],\n\t\tasync () => {\n\t\t\tconst usersInfo = await getUsersInfo(query);\n\t\t\treturn usersInfo;\n\t\t},\n\t\t{\n\t\t\tonError: (error) => {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t},\n\t\t},\n\t);\n\n\tconst onChange = useMutableCallback(() => {\n\t\tonReload();\n\t\trefetch();\n\t});\n\n\tconst user = useMemo(() => {\n\t\tif (!data?.user) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst {\n\t\t\tavatarETag,\n\t\t\tname,\n\t\t\tusername,\n\t\t\tphone,\n\t\t\tcreatedAt,\n\t\t\troles = [],\n\t\t\tstatus,\n\t\t\tstatusText,\n\t\t\tbio,\n\t\t\tutcOffset,\n\t\t\tlastLogin,\n\t\t\tnickname,\n\t\t\tcanViewAllInfo,\n\t\t} = data.user;\n\n\t\treturn {\n\t\t\tavatarETag,\n\t\t\tname,\n\t\t\tusername,\n\t\t\tlastLogin,\n\t\t\troles: getRoles(roles).map((role, index) => <UserCard.Role key={index}>{role}</UserCard.Role>),\n\t\t\tbio,\n\t\t\tcanViewAllInfo,\n\t\t\tphone,\n\t\t\tutcOffset,\n\t\t\tcustomFields: {\n\t\t\t\t...data.user.customFields,\n\t\t\t\t...(approveManuallyUsers && !data.user.active && data.user.reason ? { Reason: data.user.reason } : undefined),\n\t\t\t},\n\t\t\tverified: getUserEmailVerified(data.user),\n\t\t\temail: getUserEmailAddress(data.user),\n\t\t\tcreatedAt,\n\t\t\tstatus: <UserStatus status={status} />,\n\t\t\tstatusText,\n\t\t\tnickname,\n\t\t};\n\t}, [approveManuallyUsers, data, getRoles]);\n\n\tif (isLoading) {\n\t\treturn (\n\t\t\t<ContextualbarContent>\n\t\t\t\t<FormSkeleton />\n\t\t\t</ContextualbarContent>\n\t\t);\n\t}\n\n\tif (error || !user || !data?.user) {\n\t\treturn (\n\t\t\t<ContextualbarContent pb={16}>\n\t\t\t\t<Callout type='danger'>{t('User_not_found')}</Callout>\n\t\t\t</ContextualbarContent>\n\t\t);\n\t}\n\n\treturn (\n\t\t<UserInfo\n\t\t\t{...user}\n\t\t\tactions={\n\t\t\t\t<AdminUserInfoActions\n\t\t\t\t\tisActive={data?.user.active}\n\t\t\t\t\tisAdmin={data?.user.roles?.includes('admin')}\n\t\t\t\t\tuserId={data?.user._id}\n\t\t\t\t\tusername={user.username}\n\t\t\t\t\tisFederatedUser={isUserFederated(data?.user as unknown as IUser)}\n\t\t\t\t\tonChange={onChange}\n\t\t\t\t\tonReload={onReload}\n\t\t\t\t/>\n\t\t\t}\n\t\t/>\n\t);\n};\n\nexport default AdminUserInfoWithData;\n",null],"names":["_extends","_objectSpread","isUserFederated","Callout","useMutableCallback","useSetting","useRolesDescription","useTranslation","useEndpoint","useToastMessageDispatch","useQuery","React","useMemo","getUserEmailAddress","ContextualbarContent","FormSkeleton","UserCard","UserInfo","UserStatus","getUserEmailVerified","AdminUserInfoActions","module","default","v","link","exportDefault","_ref","_data$user$roles","uid","onReload","t","getRoles","approveManuallyUsers","getUsersInfo","query","userId","dispatchToastMessage","data","isLoading","error","refetch","usersInfo","onError","type","message","onChange","user","avatarETag","name","username","phone","createdAt","roles","status","statusText","bio","utcOffset","lastLogin","nickname","canViewAllInfo","map","role","index","createElement","Role","key","customFields","active","reason","Reason","undefined","verified","email","actions","isActive","isAdmin","includes","_id","isFederatedUser","pb"],"mappings":"2BAAAA,EAA4DC,EAA5DC,EAA4DC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAnDC,EAAAA,IAAe,CAAA,iCAAQ,CAA2BC,QAACC,CAAA,EAAAvB,EAAAA,CAAA,CAAA,EAAA,GAAAqB,EAAAA,IAAAA,CAAAA,uCAAAA,CAAAC,QAAAA,CAAAA,EAAArB,EAAAA,CAAA,CAAA,EAAA,GAAnDoB,EAAiBG,IAAA,CAAM,4BAA4B,CAAAtB,gBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAmB,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAlB,QAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAkB,EAAAA,IAAAA,CAAAA,8BAAAA,CAAAjB,mBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAiB,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAhB,WAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,oBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,wBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAY,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAX,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAW,EAAAA,IAAAA,CAAAA,QAAAA,CAAAC,QAAAA,CAAAA,EAAAX,EAAAA,CAAA,EAAAC,QAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAS,EAAAA,IAAAA,CAAAA,sCAAAA,CAAAR,oBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAQ,EAAAA,IAAAA,CAAAA,oCAAAA,CAAAP,qBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAO,EAAAA,IAAAA,CAAAA,+BAAAA,CAAAN,aAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,+BAAAA,CAAAC,QAAAA,CAAAA,EAAAN,EAAAA,CAAA,CAAA,EAAA,GAAAK,EAAAA,IAAAA,CAAAA,+BAAAA,CAAAC,QAAAA,CAAAA,EAAAL,EAAAA,CAAA,CAAA,EAAA,IAAAI,EAAAA,IAAAA,CAAAA,iCAAAA,CAAAH,WAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,IAAAG,EAAAA,IAAAA,CAAAA,0CAAAA,CAAAF,qBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,IAAAE,EAAAA,IAAAA,CAAAA,yBAAAA,CAAAC,QAAAA,CAAAA,EAAAF,EAAAA,CAAA,CAAA,EAAA,IAA5DC,EAAOI,aAAE,CAuBqBC,IAAgE,IAAAC,EAAA,GAA/D,CAAEC,IAAAA,CAAG,CAAEC,SAAAA,CAAAA,CAAsC,CAAAH,EACrEI,EAAIvB,IACJwB,EAAWzB,IACX0B,EAAuB3B,EAAW,oCAElC4B,EAAezB,EAAY,MAAO,kBAElC0B,EAAQtB,EAAQ,IAAO,CAAA,CAAEuB,OAAQP,CAAG,CAAA,EAAK,CAACA,EAAI,EAE9CQ,EAAuB3B,IAEvB,CAAE4B,KAAAA,CAAI,CAAEC,UAAAA,CAAS,CAAEC,MAAAA,CAAK,CAAEC,QAAAA,CAAAA,CAAS,CAAG9B,EAC3C,CAAC,QAASwB,EAAO,QAAQ,CACzB,UACC,IAAMO,EAAY,MAAMR,EAAaC,GACrC,OAAOO,CACR,EACA,CACCC,QAAUH,IACTH,EAAqB,CAAEO,KAAM,QAASC,QAASL,CAAK,EACrD,IAIIM,EAAWzC,EAAmB,KACnCyB,IACAW,GACD,GAEMM,EAAOlC,EAAQ,KACpB,GAAI,CAACyB,CAAAA,MAAAA,GAAAA,EAAMS,IAAI,AAAJA,EACV,OAGD,GAAM,CACLC,WAAAA,CAAU,CACVC,KAAAA,CAAI,CACJC,SAAAA,CAAQ,CACRC,MAAAA,CAAK,CACLC,UAAAA,CAAS,CACTC,MAAAA,EAAQ,EAAE,CACVC,OAAAA,CAAM,CACNC,WAAAA,CAAU,CACVC,IAAAA,CAAG,CACHC,UAAAA,CAAS,CACTC,UAAAA,CAAS,CACTC,SAAAA,CAAQ,CACRC,eAAAA,CAAAA,CACA,CAAGtB,EAAKS,IAAI,CAEb,MAAO,CACNC,WAAAA,EACAC,KAAAA,EACAC,SAAAA,EACAQ,UAAAA,EACAL,MAAOrB,EAASqB,GAAOQ,GAAG,CAAC,CAACC,EAAMC,IAAUnD,EAAAoD,aAAA,CAAC/C,EAASgD,IAAI,CAAA,CAACC,IAAKH,CAAM,EAAED,IACxEN,IAAAA,EACAI,eAAAA,EACAT,MAAAA,EACAM,UAAAA,EACAU,aAAYjE,EAAAA,EAAA,CAAA,EACRoC,EAAKS,IAAI,CAACoB,YAAY,EACrBlC,GAAwB,CAACK,EAAKS,IAAI,CAACqB,MAAM,EAAI9B,EAAKS,IAAI,CAACsB,MAAM,CAAG,CAAEC,OAAQhC,EAAKS,IAAI,CAACsB,MAAAA,AAAM,EAAKE,KAAAA,GAEpGC,SAAUpD,EAAqBkB,EAAKS,IAAI,EACxC0B,MAAO3D,EAAoBwB,EAAKS,IAAI,EACpCK,UAAAA,EACAE,OAAQ1C,EAAAoD,aAAA,CAAC7C,EAAU,CAACmC,OAAQA,CAAO,GACnCC,WAAAA,EACAI,SAAAA,EAEF,EAAG,CAAC1B,EAAsBK,EAAMN,EAAS,SAEzC,AAAIO,EAEF3B,EAAAoD,aAAA,CAACjD,EAAoB,KACpBH,EAAAoD,aAAA,CAAChD,EAAY,OAKZwB,CAAAA,GAAUO,GAAST,MAAAA,GAAAA,EAAMS,IAAI,CAShCnC,EAAAoD,aAAA,CAAC9C,EAAQjB,EAAA,CAAA,EACJ8C,EAAI,CACR2B,QACC9D,EAAAoD,aAAA,CAAC3C,EAAoB,CACpBsD,SAAUrC,MAAAA,EAAI,KAAA,EAAJA,EAAMS,IAAI,CAACqB,MAAO,CAC5BQ,QAAStC,MAAAA,EAAI,KAAA,EAAA,AAAY,OAAZV,CAAAA,EAAJU,EAAMS,IAAI,CAACM,KAAK,AAALA,GAAKzB,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAhBA,EAAkBiD,QAAQ,CAAC,SACpCzC,OAAQE,MAAAA,EAAI,KAAA,EAAJA,EAAMS,IAAI,CAAC+B,GAAI,CACvB5B,SAAUH,EAAKG,QAAS,CACxB6B,gBAAiB5E,EAAgBmC,MAAAA,EAAI,KAAA,EAAJA,EAAMS,IAAwB,EAC/DD,SAAUA,EACVhB,SAAUA,CAAS,EAEpB,IAnBDlB,EAAAoD,aAAA,CAACjD,EAAoB,CAACiE,GAAI,EAAG,EAC5BpE,EAAAoD,aAAA,CAAC5D,EAAO,CAACwC,KAAK,QAAQ,EAAEb,EAAE,mBAqB9B"}