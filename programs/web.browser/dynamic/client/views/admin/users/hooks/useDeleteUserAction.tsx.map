)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/users/hooks/useDeleteUserAction.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IUser } from '@rocket.chat/core-typings';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\nimport {\n\tuseSetModal,\n\tuseToastMessageDispatch,\n\tuseRoute,\n\tuseSetting,\n\tusePermission,\n\tuseEndpoint,\n\tuseTranslation,\n} from '@rocket.chat/ui-contexts';\nimport React, { useMemo } from 'react';\n\nimport GenericModal from '../../../../components/GenericModal';\nimport type { Action } from '../../../hooks/useActionSpread';\nimport { useConfirmOwnerChanges } from './useConfirmOwnerChanges';\n\nexport const useDeleteUserAction = (userId: IUser['_id'], onChange: () => void, onReload: () => void): Action | undefined => {\n\tconst t = useTranslation();\n\tconst setModal = useSetModal();\n\tconst userRoute = useRoute('admin-users');\n\tconst canDeleteUser = usePermission('delete-user');\n\tconst erasureType = useSetting('Message_ErasureType');\n\tconst confirmOwnerChanges = useConfirmOwnerChanges();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst handleDeletedUser = (): void => {\n\t\tsetModal();\n\t\tuserRoute.push({});\n\t\tonReload();\n\t};\n\n\tconst deleteUserQuery = useMemo(() => ({ userId, confirmRelinquish: false }), [userId]);\n\tconst deleteUserEndpoint = useEndpoint('POST', '/v1/users.delete');\n\n\tconst deleteUser = (): Promise<void> =>\n\t\tconfirmOwnerChanges(\n\t\t\tasync (confirm = false) => {\n\t\t\t\tif (confirm) {\n\t\t\t\t\tdeleteUserQuery.confirmRelinquish = confirm;\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tawait deleteUserEndpoint(deleteUserQuery);\n\t\t\t\t\tdispatchToastMessage({ type: 'success', message: t('User_has_been_deleted') });\n\t\t\t\t\thandleDeletedUser();\n\t\t\t\t} catch (error) {\n\t\t\t\t\tthrow error;\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tcontentTitle: t(`Delete_User_Warning_${erasureType}` as TranslationKey),\n\t\t\t\tconfirmText: t('Delete'),\n\t\t\t},\n\t\t\tonChange,\n\t\t);\n\n\tconst confirmDeleteUser = useMutableCallback(() => {\n\t\tsetModal(\n\t\t\t<GenericModal variant='danger' onConfirm={deleteUser} onCancel={(): void => setModal()} confirmText={t('Delete')}>\n\t\t\t\t{t(`Delete_User_Warning_${erasureType}` as TranslationKey)}\n\t\t\t</GenericModal>,\n\t\t);\n\t});\n\n\treturn canDeleteUser\n\t\t? {\n\t\t\t\ticon: 'trash',\n\t\t\t\tlabel: t('Delete'),\n\t\t\t\taction: confirmDeleteUser,\n\t\t  }\n\t\t: undefined;\n};\n",null],"names":["useMutableCallback","useSetModal","useToastMessageDispatch","useRoute","useSetting","usePermission","useEndpoint","useTranslation","React","useMemo","GenericModal","useConfirmOwnerChanges","module","export","useDeleteUserAction","default","userId","onChange","onReload","t","setModal","userRoute","canDeleteUser","erasureType","confirmOwnerChanges","dispatchToastMessage","handleDeletedUser","push","deleteUserQuery","confirmRelinquish","deleteUserEndpoint","deleteUser","confirm","arguments","length","undefined","type","message","error","contentTitle","concat","confirmText","confirmDeleteUser","createElement","variant","onConfirm","onCancel","icon","label","action"],"mappings":"2BACiEA,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAjEC,EAAOC,MAAE,CAAA,CAAAC,oBAA0B,IAAAA,CAAA,GAA8BF,EAAAA,IAAAA,CAAAA,8BAAAA,CAAAZ,mBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAY,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAX,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,wBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,WAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,cAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAK,EAAAA,IAAAA,CAAAA,QAAAA,CAAAG,QAAAA,CAAAA,EAAAP,EAAAA,CAAA,EAAAC,QAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,sCAAAA,CAAAG,QAAAA,CAAAA,EAAAL,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAD,uBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAiB1D,IAAMG,EAAsB,CAACE,EAAsBC,EAAsBC,KAC/E,IAAMC,EAAIZ,IACJa,EAAWnB,IACXoB,EAAYlB,EAAS,eACrBmB,EAAgBjB,EAAc,eAC9BkB,EAAcnB,EAAW,uBACzBoB,EAAsBb,IACtBc,EAAuBvB,IAEvBwB,EAAoB,KACzBN,IACAC,EAAUM,IAAI,CAAC,CAAA,GACfT,GACD,EAEMU,EAAkBnB,EAAQ,IAAO,CAAA,CAAEO,OAAAA,EAAQa,kBAAmB,CAAA,CAAK,CAAA,EAAK,CAACb,EAAO,EAChFc,EAAqBxB,EAAY,OAAQ,oBAEzCyB,EAAa,IAClBP,EACC,iBAA0B,IAAnBQ,EAAOC,UAAAC,MAAA,CAAA,GAAAD,AAAAE,KAAAA,IAAAF,SAAA,CAAA,EAAA,EAAAA,SAAA,CAAA,EAAA,CACTD,GACHJ,CAAAA,EAAgBC,iBAAiB,CAAGG,CAAAA,EAGrC,GAAI,CACH,MAAMF,EAAmBF,GACzBH,EAAqB,CAAEW,KAAM,UAAWC,QAASlB,EAAE,wBAAwB,GAC3EO,IACC,MAAOY,EAAO,CACf,MAAMA,EAER,EACA,CACCC,aAAcpB,EAAC,uBAAAqB,MAAA,CAAwBjB,IACvCkB,YAAatB,EAAE,WAEhBF,GAGIyB,EAAoB1C,EAAmB,KAC5CoB,EACCZ,EAAAmC,aAAA,CAACjC,EAAY,CAACkC,QAAQ,SAASC,UAAWd,EAAYe,SAAU,IAAY1B,IAAYqB,YAAatB,EAAE,SAAU,EAC/GA,EAAC,uBAAAqB,MAAA,CAAwBjB,KAG7B,GAEA,OAAOD,EACJ,CACAyB,KAAM,QACNC,MAAO7B,EAAE,UACT8B,OAAQP,GAERP,KAAAA,CACJ"}