)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/customUserStatus/CustomUserStatusService.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import {\n\tBox,\n\tButton,\n\tButtonGroup,\n\tCallout,\n\tMargins,\n\tProgressBar,\n\tSkeleton,\n\tStatesAction,\n\tStatesIcon,\n\tStatesSubtitle,\n\tToggleSwitch,\n} from '@rocket.chat/fuselage';\nimport { useEndpoint, useSetting } from '@rocket.chat/ui-contexts';\nimport { useMutation } from '@tanstack/react-query';\nimport React from 'react';\nimport { Trans, useTranslation } from 'react-i18next';\n\nimport { ContextualbarContent, ContextualbarFooter } from '../../../components/Contextualbar';\nimport { useIsEnterprise } from '../../../hooks/useIsEnterprise';\nimport { useActiveConnections } from '../../hooks/useActiveConnections';\n\nconst CustomUserStatusService = () => {\n\tconst { t } = useTranslation();\n\tconst result = useActiveConnections();\n\tconst presenceDisabled = useSetting<boolean>('Presence_broadcast_disabled');\n\tconst togglePresenceServiceEndpoint = useEndpoint('POST', '/v1/presence.enableBroadcast');\n\tconst disablePresenceService = useMutation(() => togglePresenceServiceEndpoint());\n\tconst { data: license, isLoading: licenseIsLoading } = useIsEnterprise();\n\n\tif (result.isLoading || disablePresenceService.isLoading || licenseIsLoading) {\n\t\treturn (\n\t\t\t<Box pi={16} pb={8}>\n\t\t\t\t<Skeleton />\n\t\t\t\t<Skeleton />\n\t\t\t\t<Skeleton />\n\t\t\t\t<Skeleton />\n\t\t\t\t<Skeleton />\n\t\t\t</Box>\n\t\t);\n\t}\n\tif (result.isError || disablePresenceService.isError) {\n\t\treturn (\n\t\t\t<Box display='flex' flexDirection='column' alignItems='center' pb={20} color='default'>\n\t\t\t\t<StatesIcon name='circle-exclamation' />\n\t\t\t\t<StatesSubtitle>{t('Unable_to_load_active_connections')}</StatesSubtitle>\n\t\t\t\t<StatesAction icon='reload' onClick={() => result.refetch()}>\n\t\t\t\t\t{t('Retry')}\n\t\t\t\t</StatesAction>\n\t\t\t</Box>\n\t\t);\n\t}\n\n\tconst { current, max, percentage } = result.data;\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarContent display='flex' flexDirection='column' justifyContent='space-between' color='default'>\n\t\t\t\t<div>\n\t\t\t\t\t<Box display='flex' justifyContent='space-between' mb={16}>\n\t\t\t\t\t\t<Box fontScale='p1'>{t('Service_status')}</Box>\n\t\t\t\t\t\t<ToggleSwitch\n\t\t\t\t\t\t\tdisabled={disablePresenceService.isLoading || !presenceDisabled || percentage === 100}\n\t\t\t\t\t\t\tchecked={!presenceDisabled}\n\t\t\t\t\t\t\tonChange={() => disablePresenceService.mutate()}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Box>\n\t\t\t\t\t<Box display='flex' fontScale='c1' justifyContent='space-between' mb={16}>\n\t\t\t\t\t\t<Box>{t('Active_connections')}</Box>\n\t\t\t\t\t\t<Box>{license?.isEnterprise ? current : `${current}/${max}`}</Box>\n\t\t\t\t\t</Box>\n\t\t\t\t\t{!license?.isEnterprise && <ProgressBar percentage={percentage} variant={percentage > 80 ? 'danger' : 'success'} />}\n\t\t\t\t\t{presenceDisabled && (\n\t\t\t\t\t\t<Margins block={16}>\n\t\t\t\t\t\t\t<Callout type='danger' title={t('Service_disabled')}>\n\t\t\t\t\t\t\t\t{t('Service_disabled_description')}\n\t\t\t\t\t\t\t</Callout>\n\t\t\t\t\t\t</Margins>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t\t<Box display='flex' flexDirection='column' mb={16}>\n\t\t\t\t\t{license?.isEnterprise ? (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<Box fontScale='p2' mb={8}>\n\t\t\t\t\t\t\t\t{t('Premium_cap_description')}\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t<Box fontScale='p2' mb={8}>\n\t\t\t\t\t\t\t\t<Trans i18nKey='Larger_amounts_of_active_connections'>\n\t\t\t\t\t\t\t\t\tFor larger amounts of active connections you can consider our\n\t\t\t\t\t\t\t\t\t<Box is='a' href='https://docs.rocket.chat/deploy/scaling-rocket.chat' target='_blank' color='info'>\n\t\t\t\t\t\t\t\t\t\tmultiple instance solutions\n\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t.\n\t\t\t\t\t\t\t\t</Trans>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<Box fontScale='p2' mb={8}>\n\t\t\t\t\t\t\t\t{t('Community_cap_description')}\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t<Box fontScale='p2' mb={8}>\n\t\t\t\t\t\t\t\t{t('Premium_cap_description')}\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t</Box>\n\t\t\t</ContextualbarContent>\n\t\t\t{!license?.isEnterprise && (\n\t\t\t\t<ContextualbarFooter borderBlockStartWidth='default' borderBlockColor='extra-light'>\n\t\t\t\t\t<ButtonGroup stretch vertical>\n\t\t\t\t\t\t<Button primary width='100%' is='a' href='https://www.rocket.chat/enterprise' target='_blank'>\n\t\t\t\t\t\t\t{t('More_about_Premium_plans')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</ButtonGroup>\n\t\t\t\t</ContextualbarFooter>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default CustomUserStatusService;\n",null],"names":["Box","Button","ButtonGroup","Callout","Margins","ProgressBar","Skeleton","StatesAction","StatesIcon","StatesSubtitle","ToggleSwitch","useEndpoint","useSetting","useMutation","React","Trans","useTranslation","ContextualbarContent","ContextualbarFooter","useIsEnterprise","useActiveConnections","module","link","v","default","exportDefault","t","result","presenceDisabled","togglePresenceServiceEndpoint","disablePresenceService","data","license","isLoading","licenseIsLoading","createElement","pi","pb","isError","display","flexDirection","alignItems","color","name","icon","onClick","refetch","current","max","percentage","Fragment","justifyContent","mb","fontScale","disabled","checked","onChange","mutate","isEnterprise","concat","variant","block","type","title","i18nKey","is","href","target","borderBlockStartWidth","borderBlockColor","stretch","vertical","primary","width"],"mappings":"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"}