)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/admin/customUserStatus/CustomUserStatusTable/CustomUserStatusTable.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Pagination } from '@rocket.chat/fuselage';\nimport { useDebouncedValue } from '@rocket.chat/fuselage-hooks';\nimport { escapeRegExp } from '@rocket.chat/string-helpers';\nimport { useEndpoint, useToastMessageDispatch, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useQuery } from '@tanstack/react-query';\nimport type { ReactElement, MutableRefObject } from 'react';\nimport React, { useState, useMemo, useEffect } from 'react';\n\nimport FilterByText from '../../../../components/FilterByText';\nimport GenericNoResult from '../../../../components/GenericNoResults';\nimport {\n\tGenericTable,\n\tGenericTableHeader,\n\tGenericTableHeaderCell,\n\tGenericTableBody,\n\tGenericTableLoadingTable,\n} from '../../../../components/GenericTable';\nimport { usePagination } from '../../../../components/GenericTable/hooks/usePagination';\nimport { useSort } from '../../../../components/GenericTable/hooks/useSort';\nimport CustomUserStatusRow from './CustomUserStatusRow';\n\ntype CustomUserStatusProps = {\n\treload: MutableRefObject<() => void>;\n\tonClick: (id: string) => void;\n};\n\n// TODO: Missing error state\nconst CustomUserStatus = ({ reload, onClick }: CustomUserStatusProps): ReactElement | null => {\n\tconst t = useTranslation();\n\tconst [text, setText] = useState('');\n\tconst { current, itemsPerPage, setItemsPerPage: onSetItemsPerPage, setCurrent: onSetCurrent, ...paginationProps } = usePagination();\n\tconst { sortBy, sortDirection, setSort } = useSort<'name' | 'statusType'>('name');\n\n\tconst query = useDebouncedValue(\n\t\tuseMemo(\n\t\t\t() => ({\n\t\t\t\tquery: JSON.stringify({ name: { $regex: escapeRegExp(text), $options: 'i' } }),\n\t\t\t\tsort: `{ \"${sortBy}\": ${sortDirection === 'asc' ? 1 : -1} }`,\n\t\t\t\tcount: itemsPerPage,\n\t\t\t\toffset: current,\n\t\t\t}),\n\t\t\t[text, itemsPerPage, current, sortBy, sortDirection],\n\t\t),\n\t\t500,\n\t);\n\n\tconst getCustomUserStatus = useEndpoint('GET', '/v1/custom-user-status.list');\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst { data, isLoading, refetch, isFetched } = useQuery(\n\t\t['custom-user-statuses', query],\n\t\tasync () => {\n\t\t\tconst { statuses } = await getCustomUserStatus(query);\n\t\t\treturn statuses;\n\t\t},\n\t\t{\n\t\t\tonError: (error) => {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t},\n\t\t},\n\t);\n\n\tuseEffect(() => {\n\t\treload.current = refetch;\n\t}, [reload, refetch]);\n\n\tif (!data) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<FilterByText onChange={({ text }): void => setText(text)} />\n\t\t\t{data.length === 0 && <GenericNoResult />}\n\t\t\t{data && data.length > 0 && (\n\t\t\t\t<>\n\t\t\t\t\t<GenericTable>\n\t\t\t\t\t\t<GenericTableHeader>\n\t\t\t\t\t\t\t<GenericTableHeaderCell key='name' direction={sortDirection} active={sortBy === 'name'} onClick={setSort} sort='name'>\n\t\t\t\t\t\t\t\t{t('Name')}\n\t\t\t\t\t\t\t</GenericTableHeaderCell>\n\t\t\t\t\t\t\t<GenericTableHeaderCell\n\t\t\t\t\t\t\t\tkey='presence'\n\t\t\t\t\t\t\t\tdirection={sortDirection}\n\t\t\t\t\t\t\t\tactive={sortBy === 'statusType'}\n\t\t\t\t\t\t\t\tonClick={setSort}\n\t\t\t\t\t\t\t\tsort='statusType'\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{t('Presence')}\n\t\t\t\t\t\t\t</GenericTableHeaderCell>\n\t\t\t\t\t\t</GenericTableHeader>\n\t\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t\t{isLoading && <GenericTableLoadingTable headerCells={2} />}\n\t\t\t\t\t\t\t{data?.map((status) => (\n\t\t\t\t\t\t\t\t<CustomUserStatusRow key={status._id} status={status} onClick={onClick} />\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</GenericTableBody>\n\t\t\t\t\t</GenericTable>\n\t\t\t\t\t{isFetched && (\n\t\t\t\t\t\t<Pagination\n\t\t\t\t\t\t\tcurrent={current}\n\t\t\t\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\t\t\t\tcount={data.length}\n\t\t\t\t\t\t\tonSetItemsPerPage={onSetItemsPerPage}\n\t\t\t\t\t\t\tonSetCurrent={onSetCurrent}\n\t\t\t\t\t\t\t{...paginationProps}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t</>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default CustomUserStatus;\n",null],"names":["_extends","_objectWithoutProperties","Pagination","useDebouncedValue","escapeRegExp","useEndpoint","useToastMessageDispatch","useTranslation","useQuery","React","useState","useMemo","useEffect","FilterByText","GenericNoResult","GenericTable","GenericTableHeader","GenericTableHeaderCell","GenericTableBody","GenericTableLoadingTable","usePagination","useSort","CustomUserStatusRow","module","link","default","exportDefault","_ref","reload","onClick","t","text","setText","_usePagination","current","itemsPerPage","setItemsPerPage","onSetItemsPerPage","setCurrent","onSetCurrent","paginationProps","_excluded","sortBy","sortDirection","setSort","query","JSON","stringify","name","$regex","$options","sort","concat","count","offset","getCustomUserStatus","dispatchToastMessage","data","isLoading","refetch","isFetched","statuses","onError","error","type","message","createElement","Fragment","onChange","_ref2","length","key","direction","active","headerCells","map","status","_id"],"mappings":"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"}