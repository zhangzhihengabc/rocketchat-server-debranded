)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/customFields/NewCustomFieldsPage.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Box, Button, FieldGroup, ButtonGroup } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useToastMessageDispatch, useRoute, useMethod, useTranslation } from '@rocket.chat/ui-contexts';\nimport React, { useCallback, useState } from 'react';\n\nimport Page from '../../../components/Page';\nimport { useForm } from '../../../hooks/useForm';\nimport { CustomFieldsAdditionalFormContainer } from '../additionalForms';\nimport NewCustomFieldsForm from './NewCustomFieldsForm';\n\nconst initialValues = {\n\tfield: '',\n\tlabel: '',\n\tscope: 'visitor',\n\tvisibility: true,\n\tregexp: '',\n\tsearchable: true,\n};\n\nconst NewCustomFieldsPage = ({ reload }) => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst [additionalValues, setAdditionalValues] = useState({});\n\n\tconst router = useRoute('omnichannel-customfields');\n\n\tconst handleReturn = useCallback(() => {\n\t\trouter.push({});\n\t}, [router]);\n\n\tconst { values, handlers, hasUnsavedChanges } = useForm(initialValues);\n\n\tconst save = useMethod('livechat:saveCustomField');\n\n\tconst { hasError, data: additionalData, hasUnsavedChanges: additionalFormChanged } = additionalValues;\n\n\tconst { label, field } = values;\n\n\tconst canSave = !hasError && label && field && (additionalFormChanged || hasUnsavedChanges);\n\n\tconst handleSave = useMutableCallback(async () => {\n\t\ttry {\n\t\t\tawait save(undefined, {\n\t\t\t\t...values,\n\t\t\t\tvisibility: values.visibility ? 'visible' : 'hidden',\n\t\t\t\t...additionalData,\n\t\t\t});\n\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\treload();\n\t\t\trouter.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst handleAdditionalForm = useMutableCallback((val) => {\n\t\tsetAdditionalValues({ ...additionalValues, ...val });\n\t});\n\n\treturn (\n\t\t<Page>\n\t\t\t<Page.Header title={t('New_Custom_Field')}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t<Button icon='back' onClick={handleReturn}>\n\t\t\t\t\t\t{t('Back')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button data-qa-id='NewCustomFieldsPageButtonSave' primary onClick={handleSave} disabled={!canSave}>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Header>\n\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t<Box maxWidth='x600' w='full' alignSelf='center'>\n\t\t\t\t\t<FieldGroup>\n\t\t\t\t\t\t<NewCustomFieldsForm values={values} handlers={handlers} />\n\t\t\t\t\t\t<CustomFieldsAdditionalFormContainer onChange={handleAdditionalForm} state={values} />\n\t\t\t\t\t</FieldGroup>\n\t\t\t\t</Box>\n\t\t\t</Page.ScrollableContentWithShadow>\n\t\t</Page>\n\t);\n};\n\nexport default NewCustomFieldsPage;\n",null],"names":["_objectSpread","Box","Button","FieldGroup","ButtonGroup","useMutableCallback","useToastMessageDispatch","useRoute","useMethod","useTranslation","React","useCallback","useState","Page","useForm","CustomFieldsAdditionalFormContainer","NewCustomFieldsForm","module","link","default","v","initialValues","field","label","scope","visibility","regexp","searchable","exportDefault","_ref","reload","t","dispatchToastMessage","additionalValues","setAdditionalValues","router","handleReturn","push","values","handlers","hasUnsavedChanges","save","hasError","data","additionalData","additionalFormChanged","handleSave","undefined","type","message","error","handleAdditionalForm","val","createElement","Header","title","icon","onClick","primary","disabled","ScrollableContentWithShadow","maxWidth","w","alignSelf","onChange","state"],"mappings":"2BAAIA,EAAAC,EAAIC,EAAOC,EAAWC,EAAqJC,EAAkHC,EAAwBC,EAASC,EAAUC,EAA2MC,EAAMC,EAAYC,EAAgHC,EAAwEC,EAA4EC,EAA4JC,EAAv7BC,EAAOC,IAAI,CAAC,uCAAuC,CAACC,QAAQC,CAAC,EAAEpB,EAAcoB,CAAC,CAAC,EAAE,GAA7DH,EAAOC,IAAI,CAAC,wBAAwB,CAACjB,IAAImB,CAAC,EAAEnB,EAAImB,CAAC,EAAElB,OAAOkB,CAAC,EAAElB,EAAOkB,CAAC,EAAEjB,WAAWiB,CAAC,EAAEjB,EAAWiB,CAAC,EAAEhB,YAAYgB,CAAC,EAAEhB,EAAYgB,CAAC,CAAC,EAAE,GAA0BH,EAAOC,IAAI,CAAC,8BAA8B,CAACb,mBAAmBe,CAAC,EAAEf,EAAmBe,CAAC,CAAC,EAAE,GAAiEH,EAAOC,IAAI,CAAC,2BAA2B,CAACZ,wBAAwBc,CAAC,EAAEd,EAAwBc,CAAC,EAAEb,SAASa,CAAC,EAAEb,EAASa,CAAC,EAAEZ,UAAUY,CAAC,EAAEZ,EAAUY,CAAC,EAAEX,eAAeW,CAAC,EAAEX,EAAeW,CAAC,CAAC,EAAE,GAAkCH,EAAOC,IAAI,CAAC,QAAQ,CAACC,QAAQC,CAAC,EAAEV,EAAMU,CAAC,EAAET,YAAYS,CAAC,EAAET,EAAYS,CAAC,EAAER,SAASQ,CAAC,EAAER,EAASQ,CAAC,CAAC,EAAE,GAAYH,EAAOC,IAAI,CAAC,2BAA2B,CAACC,QAAQC,CAAC,EAAEP,EAAKO,CAAC,CAAC,EAAE,GAAeH,EAAOC,IAAI,CAAC,yBAAyB,CAACJ,QAAQM,CAAC,EAAEN,EAAQM,CAAC,CAAC,EAAE,GAA2CH,EAAOC,IAAI,CAAC,qBAAqB,CAACH,oCAAoCK,CAAC,EAAEL,EAAoCK,CAAC,CAAC,EAAE,GAA2BH,EAAOC,IAAI,CAAC,wBAAwB,CAACC,QAAQC,CAAC,EAAEJ,EAAoBI,CAAC,CAAC,EAAE,GAUriC,IAAMC,EAAgB,CACrBC,MAAO,GACPC,MAAO,GACPC,MAAO,UACPC,WAAY,CAAA,EACZC,OAAQ,GACRC,WAAY,CAAA,CACb,EAjBAV,EAAOW,aAAa,CAmBQC,IAAgB,GAAf,CAAEC,OAAAA,CAAAA,CAAQ,CAAAD,EAChCE,EAAItB,IACJuB,EAAuB1B,IAEvB,CAAC2B,EAAkBC,EAAoB,CAAGtB,EAAS,CAAC,GAEpDuB,EAAS5B,EAAS,4BAElB6B,EAAezB,EAAY,KAChCwB,EAAOE,IAAI,CAAC,CAAC,EACd,EAAG,CAACF,EAAO,EAEL,CAAEG,OAAAA,CAAM,CAAEC,SAAAA,CAAQ,CAAEC,kBAAAA,CAAAA,CAAmB,CAAG1B,EAAQO,GAElDoB,EAAOjC,EAAU,4BAEjB,CAAEkC,SAAAA,CAAQ,CAAEC,KAAMC,CAAc,CAAEJ,kBAAmBK,CAAAA,CAAuB,CAAGZ,EAE/E,CAAEV,MAAAA,CAAK,CAAED,MAAAA,CAAAA,CAAO,CAAGgB,EAInBQ,EAAazC,EAAmB,UACrC,GAAI,CACH,MAAMoC,EAAKM,KAAAA,EAAS/C,EAAAA,EAAA,CAAA,EAChBsC,GAAM,CAAA,EAAA,CACTb,WAAYa,EAAOb,UAAU,CAAG,UAAY,QAAQ,EACjDmB,IAGJZ,EAAqB,CAAEgB,KAAM,UAAWC,QAASlB,EAAE,QAAS,GAC5DD,IACAK,EAAOE,IAAI,CAAC,CAAC,EACd,CAAE,MAAOa,EAAO,CACflB,EAAqB,CAAEgB,KAAM,QAASC,QAASC,CAAM,EACtD,CACD,GAEMC,EAAuB9C,EAAoB+C,IAChDlB,EAAmBlC,EAAAA,EAAA,CAAA,EAAMiC,GAAqBmB,GAC/C,GAEA,OACC1C,EAAA2C,aAAA,CAACxC,EAAI,KACJH,EAAA2C,aAAA,CAACxC,EAAKyC,MAAM,CAAA,CAACC,MAAOxB,EAAE,mBAAoB,EACzCrB,EAAA2C,aAAA,CAACjD,EAAW,KACXM,EAAA2C,aAAA,CAACnD,EAAM,CAACsD,KAAK,OAAOC,QAASrB,CAAa,EACxCL,EAAE,SAEJrB,EAAA2C,aAAA,CAACnD,EAAM,CAAC,aAAW,gCAAgCwD,QAAO,CAAA,EAACD,QAASX,EAAYa,SAAU,CA7B9E,CAAA,CAACjB,GAAYnB,GAASD,GAAUuB,CAAAA,GAAyBL,CAAAA,CAAiB,CA6Ba,EACjGT,EAAE,WAINrB,EAAA2C,aAAA,CAACxC,EAAK+C,2BAA2B,CAAA,KAChClD,EAAA2C,aAAA,CAACpD,EAAG,CAAC4D,SAAS,OAAOC,EAAE,OAAOC,UAAU,QAAQ,EAC/CrD,EAAA2C,aAAA,CAAClD,EAAU,KACVO,EAAA2C,aAAA,CAACrC,EAAmB,CAACsB,OAAQA,EAAQC,SAAUA,CAAS,GACxD7B,EAAA2C,aAAA,CAACtC,EAAmC,CAACiD,SAAUb,EAAsBc,MAAO3B,CAAO,MAMzF"}