)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/customFields/EditCustomFieldsPage.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Box, Button, ButtonGroup, FieldGroup } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useToastMessageDispatch, useRoute, useMethod, useTranslation } from '@rocket.chat/ui-contexts';\nimport React, { useCallback, useState } from 'react';\n\nimport Page from '../../../components/Page';\nimport { useForm } from '../../../hooks/useForm';\nimport { CustomFieldsAdditionalFormContainer } from '../additionalForms';\nimport NewCustomFieldsForm from './NewCustomFieldsForm';\n\nconst getInitialValues = (cf) => ({\n\tid: cf._id,\n\tfield: cf._id,\n\tlabel: cf.label,\n\tscope: cf.scope,\n\tvisibility: cf.visibility === 'visible',\n\tsearchable: !!cf.searchable,\n\tregexp: cf.regexp,\n});\n\nconst EditCustomFieldsPage = ({ customField, id, reload }) => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst [additionalValues, setAdditionalValues] = useState({});\n\n\tconst router = useRoute('omnichannel-customfields');\n\n\tconst handleReturn = useCallback(() => {\n\t\trouter.push({});\n\t}, [router]);\n\n\tconst { values, handlers, hasUnsavedChanges } = useForm(getInitialValues(customField));\n\n\tconst save = useMethod('livechat:saveCustomField');\n\n\tconst { hasError, data: additionalData, hasUnsavedChanges: additionalFormChanged } = additionalValues;\n\n\tconst { label, field } = values;\n\n\tconst canSave = !hasError && label && field && (additionalFormChanged || hasUnsavedChanges);\n\n\tconst handleSave = useMutableCallback(async () => {\n\t\ttry {\n\t\t\tawait save(id, {\n\t\t\t\t...additionalData,\n\t\t\t\t...values,\n\t\t\t\tvisibility: values.visibility ? 'visible' : 'hidden',\n\t\t\t});\n\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\treload();\n\t\t\trouter.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst handleAdditionalForm = useMutableCallback((val) => {\n\t\tsetAdditionalValues({ ...additionalValues, ...val });\n\t});\n\n\treturn (\n\t\t<Page>\n\t\t\t<Page.Header title={t('Edit_Custom_Field')}>\n\t\t\t\t<ButtonGroup align='end'>\n\t\t\t\t\t<Button icon='back' onClick={handleReturn}>\n\t\t\t\t\t\t{t('Back')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button data-qa-id='BtnSaveEditCustomFieldsPage' primary onClick={handleSave} disabled={!canSave}>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Header>\n\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t<Box maxWidth='x600' w='full' alignSelf='center'>\n\t\t\t\t\t<FieldGroup>\n\t\t\t\t\t\t<NewCustomFieldsForm values={values} handlers={handlers} />\n\t\t\t\t\t\t<CustomFieldsAdditionalFormContainer onChange={handleAdditionalForm} state={values} data={customField} />\n\t\t\t\t\t</FieldGroup>\n\t\t\t\t</Box>\n\t\t\t</Page.ScrollableContentWithShadow>\n\t\t</Page>\n\t);\n};\n\nexport default EditCustomFieldsPage;\n",null],"names":["_objectSpread","Box","Button","ButtonGroup","FieldGroup","useMutableCallback","useToastMessageDispatch","useRoute","useMethod","useTranslation","React","useCallback","useState","Page","useForm","CustomFieldsAdditionalFormContainer","NewCustomFieldsForm","module","link","default","v","getInitialValues","cf","id","_id","field","label","scope","visibility","searchable","regexp","exportDefault","_ref","customField","reload","t","dispatchToastMessage","additionalValues","setAdditionalValues","router","handleReturn","push","values","handlers","hasUnsavedChanges","save","hasError","data","additionalData","additionalFormChanged","handleSave","type","message","error","handleAdditionalForm","val","createElement","Header","title","align","icon","onClick","primary","disabled","ScrollableContentWithShadow","maxWidth","w","alignSelf","onChange","state"],"mappings":"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"}