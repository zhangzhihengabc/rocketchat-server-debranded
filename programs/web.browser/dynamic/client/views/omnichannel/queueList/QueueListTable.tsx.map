)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/queueList/QueueListTable.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { UserStatus } from '@rocket.chat/core-typings';\nimport { Box, Pagination } from '@rocket.chat/fuselage';\nimport { useMediaQuery } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation, useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useQuery } from '@tanstack/react-query';\nimport type { ReactElement } from 'react';\nimport React, { useMemo, useState } from 'react';\n\nimport GenericNoResults from '../../../components/GenericNoResults';\nimport {\n\tGenericTable,\n\tGenericTableHeader,\n\tGenericTableHeaderCell,\n\tGenericTableBody,\n\tGenericTableRow,\n\tGenericTableCell,\n\tGenericTableLoadingRow,\n} from '../../../components/GenericTable';\nimport { usePagination } from '../../../components/GenericTable/hooks/usePagination';\nimport { useSort } from '../../../components/GenericTable/hooks/useSort';\nimport UserAvatar from '../../../components/avatar/UserAvatar';\nimport { QueueListFilter } from './QueueListFilter';\n\nconst QueueListTable = (): ReactElement => {\n\tconst t = useTranslation();\n\tconst { current, itemsPerPage, setItemsPerPage: onSetItemsPerPage, setCurrent: onSetCurrent, ...paginationProps } = usePagination();\n\tconst { sortBy, sortDirection, setSort } = useSort<'servedBy' | 'department' | 'total' | 'status'>('servedBy');\n\n\tconst [filters, setFilters] = useState<{\n\t\tservedBy: string;\n\t\tstatus: string;\n\t\tdepartmentId: string;\n\t}>({\n\t\tservedBy: '',\n\t\tstatus: '',\n\t\tdepartmentId: '',\n\t});\n\n\tconst mediaQuery = useMediaQuery('(min-width: 1024px)');\n\n\tconst headers = (\n\t\t<>\n\t\t\t{mediaQuery && (\n\t\t\t\t<GenericTableHeaderCell key='servedBy' direction={sortDirection} active={sortBy === 'servedBy'} onClick={setSort} sort='servedBy'>\n\t\t\t\t\t{t('Served_By')}\n\t\t\t\t</GenericTableHeaderCell>\n\t\t\t)}\n\t\t\t<GenericTableHeaderCell\n\t\t\t\tkey='department'\n\t\t\t\tdirection={sortDirection}\n\t\t\t\tactive={sortBy === 'department'}\n\t\t\t\tonClick={setSort}\n\t\t\t\tsort='department'\n\t\t\t>\n\t\t\t\t{t('Department')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell key='total' direction={sortDirection} active={sortBy === 'total'} onClick={setSort} sort='total'>\n\t\t\t\t{t('Total')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell key='status' direction={sortDirection} active={sortBy === 'status'} onClick={setSort} sort='status'>\n\t\t\t\t{t('Status')}\n\t\t\t</GenericTableHeaderCell>\n\t\t</>\n\t);\n\n\tconst query = useMemo(() => {\n\t\tconst query: {\n\t\t\tagentId?: string;\n\t\t\tincludeOfflineAgents?: 'true' | 'false';\n\t\t\tdepartmentId?: string;\n\t\t\tsort: string;\n\t\t\tcount: number;\n\t\t} = {\n\t\t\tsort: `{ \"${sortBy}\": ${sortDirection === 'asc' ? 1 : -1} }`,\n\t\t\t...(itemsPerPage && { count: itemsPerPage }),\n\t\t\t...(current && { offset: current }),\n\t\t};\n\n\t\tif (filters.status !== 'online') {\n\t\t\tquery.includeOfflineAgents = 'true';\n\t\t}\n\t\tif (filters.servedBy) {\n\t\t\tquery.agentId = filters.servedBy;\n\t\t}\n\t\tif (filters.departmentId) {\n\t\t\tquery.departmentId = filters.departmentId;\n\t\t}\n\n\t\treturn query;\n\t}, [sortBy, sortDirection, itemsPerPage, current, filters.status, filters.departmentId, filters.servedBy]);\n\n\tconst getUserStatus = (status?: string) => {\n\t\tif (!status) {\n\t\t\treturn t('Offline');\n\t\t}\n\n\t\tswitch (status) {\n\t\t\tcase UserStatus.ONLINE:\n\t\t\t\treturn t('Online');\n\t\t\tcase UserStatus.AWAY:\n\t\t\t\treturn t('Away');\n\t\t\tcase UserStatus.BUSY:\n\t\t\t\treturn t('Busy');\n\t\t\tcase UserStatus.OFFLINE:\n\t\t\t\treturn t('Offline');\n\t\t\tdefault:\n\t\t\t\treturn status;\n\t\t}\n\t};\n\n\tconst getLivechatQueue = useEndpoint('GET', '/v1/livechat/queue');\n\tconst { data, isSuccess, isLoading } = useQuery(['livechat-queue', query], async () => getLivechatQueue(query));\n\n\treturn (\n\t\t<>\n\t\t\t<QueueListFilter setFilter={setFilters} />\n\t\t\t{isLoading && (\n\t\t\t\t<GenericTable>\n\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t<GenericTableLoadingRow cols={4} />\n\t\t\t\t\t</GenericTableBody>\n\t\t\t\t</GenericTable>\n\t\t\t)}\n\t\t\t{isSuccess && data?.queue.length === 0 && <GenericNoResults />}\n\t\t\t{isSuccess && data?.queue.length > 0 && (\n\t\t\t\t<>\n\t\t\t\t\t<GenericTable>\n\t\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t\t{data?.queue.map(({ user, department, chats }) => (\n\t\t\t\t\t\t\t\t<GenericTableRow key={user._id} tabIndex={0}>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>\n\t\t\t\t\t\t\t\t\t\t<Box display='flex' alignItems='center' mb='5px'>\n\t\t\t\t\t\t\t\t\t\t\t<UserAvatar size={mediaQuery ? 'x28' : 'x40'} username={user.username} />\n\t\t\t\t\t\t\t\t\t\t\t<Box display='flex' mi={8}>\n\t\t\t\t\t\t\t\t\t\t\t\t{user.username}\n\t\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t</GenericTableCell>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>{department ? department.name : ''}</GenericTableCell>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>{chats}</GenericTableCell>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>{getUserStatus(user?.status)}</GenericTableCell>\n\t\t\t\t\t\t\t\t</GenericTableRow>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</GenericTableBody>\n\t\t\t\t\t</GenericTable>\n\t\t\t\t\t<Pagination\n\t\t\t\t\t\tdivider\n\t\t\t\t\t\tcurrent={current}\n\t\t\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\t\t\tcount={data?.total || 0}\n\t\t\t\t\t\tonSetItemsPerPage={onSetItemsPerPage}\n\t\t\t\t\t\tonSetCurrent={onSetCurrent}\n\t\t\t\t\t\t{...paginationProps}\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default QueueListTable;\n",null],"names":["_extends","_objectSpread","_objectWithoutProperties","UserStatus","Box","Pagination","useMediaQuery","useTranslation","useEndpoint","useQuery","React","useMemo","useState","GenericNoResults","GenericTable","GenericTableHeader","GenericTableHeaderCell","GenericTableBody","GenericTableRow","GenericTableCell","GenericTableLoadingRow","usePagination","useSort","UserAvatar","QueueListFilter","module","link","default","exportDefault","t","_usePagination","current","itemsPerPage","setItemsPerPage","onSetItemsPerPage","setCurrent","onSetCurrent","paginationProps","_excluded","sortBy","sortDirection","setSort","filters","setFilters","servedBy","status","departmentId","mediaQuery","headers","createElement","Fragment","key","direction","active","onClick","sort","query","concat","count","offset","includeOfflineAgents","agentId","getUserStatus","ONLINE","AWAY","BUSY","OFFLINE","getLivechatQueue","data","isSuccess","isLoading","setFilter","cols","queue","length","map","_ref","user","department","chats","_id","tabIndex","withTruncatedText","display","alignItems","mb","size","username","mi","name","divider","total"],"mappings":"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"}