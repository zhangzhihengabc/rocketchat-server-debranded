)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/realTimeMonitoring/charts/ResponseTimesChart.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useTranslation } from '@rocket.chat/ui-contexts';\nimport React, { useRef, useEffect } from 'react';\n\nimport { drawLineChart } from '../../../../../app/livechat/client/lib/chartHandler';\nimport { secondsToHHMMSS } from '../../../../../lib/utils/secondsToHHMMSS';\nimport { AsyncStatePhase } from '../../../../hooks/useAsyncState';\nimport { useEndpointData } from '../../../../hooks/useEndpointData';\nimport Chart from './Chart';\nimport { getMomentChartLabelsAndData } from './getMomentChartLabelsAndData';\nimport { getMomentCurrentLabel } from './getMomentCurrentLabel';\nimport { useUpdateChartData } from './useUpdateChartData';\n\nconst [labels, initialData] = getMomentChartLabelsAndData();\nconst tooltipCallbacks = {\n\tcallbacks: {\n\t\ttitle([ctx]) {\n\t\t\tconst { dataset } = ctx;\n\t\t\treturn dataset.label;\n\t\t},\n\t\tlabel(ctx) {\n\t\t\tconst { dataset, dataIndex } = ctx;\n\t\t\treturn `${dataset.label}: ${secondsToHHMMSS(dataset.data[dataIndex])}`;\n\t\t},\n\t},\n};\nconst init = (canvas, context, t) =>\n\tdrawLineChart(\n\t\tcanvas,\n\t\tcontext,\n\t\t[t('Avg_reaction_time'), t('Longest_reaction_time'), t('Avg_response_time'), t('Longest_response_time')],\n\t\tlabels,\n\t\t[initialData, initialData.slice(), initialData.slice(), initialData.slice()],\n\t\t{ legends: true, anim: true, smallTicks: true, displayColors: false, tooltipCallbacks },\n\t);\n\nconst ResponseTimesChart = ({ params, reloadRef, ...props }) => {\n\tconst t = useTranslation();\n\n\tconst canvas = useRef();\n\tconst context = useRef();\n\n\tconst updateChartData = useUpdateChartData({\n\t\tcontext,\n\t\tcanvas,\n\t\tt,\n\t\tinit,\n\t});\n\n\tconst { value: data, phase: state, reload } = useEndpointData('/v1/livechat/analytics/dashboards/charts/timings', { params });\n\n\treloadRef.current.responseTimesChart = reload;\n\n\tconst {\n\t\treaction: { avg: reactionAvg, longest: reactionLongest },\n\t\tresponse: { avg: responseAvg, longest: responseLongest },\n\t} = data ?? {\n\t\treaction: {\n\t\t\tavg: 0,\n\t\t\tlongest: 0,\n\t\t},\n\t\tresponse: {\n\t\t\tavg: 0,\n\t\t\tlongest: 0,\n\t\t},\n\t};\n\n\tuseEffect(() => {\n\t\tconst initChart = async () => {\n\t\t\tcontext.current = await init(canvas.current, context.current, t);\n\t\t};\n\t\tinitChart();\n\t}, [t]);\n\n\tuseEffect(() => {\n\t\tif (state === AsyncStatePhase.RESOLVED) {\n\t\t\tconst label = getMomentCurrentLabel();\n\t\t\tupdateChartData(label, [reactionAvg, reactionLongest, responseAvg, responseLongest]);\n\t\t}\n\t}, [reactionAvg, reactionLongest, responseAvg, responseLongest, state, t, updateChartData]);\n\n\treturn <Chart ref={canvas} {...props} />;\n};\n\nexport default ResponseTimesChart;\n",null],"names":["_extends","_objectWithoutProperties","useTranslation","React","useRef","useEffect","drawLineChart","secondsToHHMMSS","AsyncStatePhase","useEndpointData","Chart","getMomentChartLabelsAndData","getMomentCurrentLabel","useUpdateChartData","module","link","default","v","labels","initialData","tooltipCallbacks","callbacks","title","_ref","ctx","dataset","label","dataIndex","concat","data","init","canvas","context","t","slice","legends","anim","smallTicks","displayColors","exportDefault","_ref2","params","reloadRef","props","_excluded","updateChartData","value","phase","state","reload","current","responseTimesChart","reaction","avg","reactionAvg","longest","reactionLongest","response","responseAvg","responseLongest","initChart","RESOLVED","createElement","ref"],"mappings":"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"}