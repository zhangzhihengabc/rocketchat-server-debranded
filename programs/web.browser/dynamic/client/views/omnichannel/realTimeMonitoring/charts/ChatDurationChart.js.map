)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/realTimeMonitoring/charts/ChatDurationChart.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useTranslation } from '@rocket.chat/ui-contexts';\nimport React, { useRef, useEffect } from 'react';\n\nimport { drawLineChart } from '../../../../../app/livechat/client/lib/chartHandler';\nimport { secondsToHHMMSS } from '../../../../../lib/utils/secondsToHHMMSS';\nimport { AsyncStatePhase } from '../../../../hooks/useAsyncState';\nimport { useEndpointData } from '../../../../hooks/useEndpointData';\nimport Chart from './Chart';\nimport { getMomentChartLabelsAndData } from './getMomentChartLabelsAndData';\nimport { getMomentCurrentLabel } from './getMomentCurrentLabel';\nimport { useUpdateChartData } from './useUpdateChartData';\n\nconst [labels, initialData] = getMomentChartLabelsAndData();\nconst tooltipCallbacks = {\n\tcallbacks: {\n\t\ttitle([ctx]) {\n\t\t\tconst { dataset } = ctx;\n\t\t\treturn dataset.label;\n\t\t},\n\t\tlabel(ctx) {\n\t\t\tconst { dataset, dataIndex } = ctx;\n\t\t\treturn `${dataset.label}: ${secondsToHHMMSS(dataset.data[dataIndex])}`;\n\t\t},\n\t},\n};\nconst init = (canvas, context, t) =>\n\tdrawLineChart(canvas, context, [t('Avg_chat_duration'), t('Longest_chat_duration')], labels, [initialData, initialData.slice()], {\n\t\tlegends: true,\n\t\tanim: true,\n\t\tsmallTicks: true,\n\t\tdisplayColors: false,\n\t\ttooltipCallbacks,\n\t});\n\nconst ChatDurationChart = ({ params, reloadRef, ...props }) => {\n\tconst t = useTranslation();\n\n\tconst canvas = useRef();\n\tconst context = useRef();\n\n\tconst updateChartData = useUpdateChartData({\n\t\tcontext,\n\t\tcanvas,\n\t\tt,\n\t\tinit,\n\t});\n\n\tconst { value: data, phase: state, reload } = useEndpointData('/v1/livechat/analytics/dashboards/charts/timings', { params });\n\n\treloadRef.current.chatDurationChart = reload;\n\n\tconst {\n\t\tchatDuration: { avg, longest },\n\t} = data ?? {\n\t\tchatDuration: {\n\t\t\tavg: 0,\n\t\t\tlongest: 0,\n\t\t},\n\t};\n\n\tuseEffect(() => {\n\t\tconst initChart = async () => {\n\t\t\tcontext.current = await init(canvas.current, context.current, t);\n\t\t};\n\t\tinitChart();\n\t}, [t]);\n\n\tuseEffect(() => {\n\t\tif (state === AsyncStatePhase.RESOLVED) {\n\t\t\tconst label = getMomentCurrentLabel();\n\t\t\tupdateChartData(label, [avg, longest]);\n\t\t}\n\t}, [avg, longest, state, t, updateChartData]);\n\n\treturn <Chart ref={canvas} {...props} />;\n};\n\nexport default ChatDurationChart;\n",null],"names":["_extends","_objectWithoutProperties","useTranslation","React","useRef","useEffect","drawLineChart","secondsToHHMMSS","AsyncStatePhase","useEndpointData","Chart","getMomentChartLabelsAndData","getMomentCurrentLabel","useUpdateChartData","module","link","default","v","labels","initialData","tooltipCallbacks","callbacks","title","_ref","ctx","dataset","label","dataIndex","concat","data","init","canvas","context","t","slice","legends","anim","smallTicks","displayColors","exportDefault","_ref2","params","reloadRef","props","_excluded","updateChartData","value","phase","state","reload","current","chatDurationChart","chatDuration","avg","longest","initChart","RESOLVED","createElement","ref"],"mappings":"2BAAIA,EAAsFC,EAAtFC,EAAmGC,EAAMC,EAAOC,EAAyGC,EAA2HC,EAAsHC,EAA6GC,EAA+GC,EAAyDC,EAA+IC,EAAuHC,+BAA59BC,EAAOC,IAAI,CAAC,iCAAiC,CAACC,QAAQC,CAAC,EAAEjB,EAASiB,CAAC,CAAC,EAAE,GAAgCH,EAAOC,IAAI,CAAC,iDAAiD,CAACC,QAAQC,CAAC,EAAEhB,EAAyBgB,CAAC,CAAC,EAAE,GAAtMH,EAAOC,IAAI,CAAC,2BAA2B,CAACb,eAAee,CAAC,EAAEf,EAAee,CAAC,CAAC,EAAE,GAA8BH,EAAOC,IAAI,CAAC,QAAQ,CAACC,QAAQC,CAAC,EAAEd,EAAMc,CAAC,EAAEb,OAAOa,CAAC,EAAEb,EAAOa,CAAC,EAAEZ,UAAUY,CAAC,EAAEZ,EAAUY,CAAC,CAAC,EAAE,GAAqBH,EAAOC,IAAI,CAAC,sDAAsD,CAACT,cAAcW,CAAC,EAAEX,EAAcW,CAAC,CAAC,EAAE,GAAuBH,EAAOC,IAAI,CAAC,2CAA2C,CAACR,gBAAgBU,CAAC,EAAEV,EAAgBU,CAAC,CAAC,EAAE,GAAuBH,EAAOC,IAAI,CAAC,kCAAkC,CAACP,gBAAgBS,CAAC,EAAET,EAAgBS,CAAC,CAAC,EAAE,GAAuBH,EAAOC,IAAI,CAAC,oCAAoC,CAACN,gBAAgBQ,CAAC,EAAER,EAAgBQ,CAAC,CAAC,EAAE,GAAaH,EAAOC,IAAI,CAAC,UAAU,CAACC,QAAQC,CAAC,EAAEP,EAAMO,CAAC,CAAC,EAAE,GAAmCH,EAAOC,IAAI,CAAC,gCAAgC,CAACJ,4BAA4BM,CAAC,EAAEN,EAA4BM,CAAC,CAAC,EAAE,GAA6BH,EAAOC,IAAI,CAAC,0BAA0B,CAACH,sBAAsBK,CAAC,EAAEL,EAAsBK,CAAC,CAAC,EAAE,GAA0BH,EAAOC,IAAI,CAAC,uBAAuB,CAACF,mBAAmBI,CAAC,EAAEJ,EAAmBI,CAAC,CAAC,EAAE,GAY7kC,GAAM,CAACC,EAAQC,EAAY,CAAGR,IACxBS,EAAmB,CACxBC,UAAW,CACVC,MAAKC,CAAA,EAAQ,GAAP,CAACC,EAAI,CAAAD,EACJ,CAAEE,QAAAA,CAAAA,CAAS,CAAGD,EACpB,OAAOC,EAAQC,KAAK,AACrB,EACAA,MAAMF,CAAG,EACR,GAAM,CAAEC,QAAAA,CAAO,CAAEE,UAAAA,CAAAA,CAAW,CAAGH,EAC/B,MAAA,GAAAI,MAAA,CAAUH,EAAQC,KAAK,CAAA,MAAAE,MAAA,CAAKrB,EAAgBkB,EAAQI,IAAI,CAACF,EAAU,EACpE,CACD,CACD,EACMG,EAAO,CAACC,EAAQC,EAASC,IAC9B3B,EAAcyB,EAAQC,EAAS,CAACC,EAAE,qBAAsBA,EAAE,yBAAyB,CAAEf,EAAQ,CAACC,EAAaA,EAAYe,KAAK,GAAG,CAAE,CAChIC,QAAS,CAAA,EACTC,KAAM,CAAA,EACNC,WAAY,CAAA,EACZC,cAAe,CAAA,EACflB,iBAAAA,CACD,GAhCDN,EAAOyB,aAAa,CAkCMC,IAAqC,GAApC,CAAEC,OAAAA,CAAM,CAAEC,UAAAA,CAAAA,CAAqB,CAAAF,EAAPG,EAAK1C,EAAAuC,EAAAI,GACjDX,EAAI/B,IAEJ6B,EAAS3B,IACT4B,EAAU5B,IAEVyC,EAAkBhC,EAAmB,CAC1CmB,QAAAA,EACAD,OAAAA,EACAE,EAAAA,EACAH,KAAAA,CACD,GAEM,CAAEgB,MAAOjB,CAAI,CAAEkB,MAAOC,CAAK,CAAEC,OAAAA,CAAAA,CAAQ,CAAGxC,EAAgB,mDAAoD,CAAEgC,OAAAA,CAAO,EAE3HC,CAAAA,EAAUQ,OAAO,CAACC,iBAAiB,CAAGF,EAEtC,GAAM,CACLG,aAAc,CAAEC,IAAAA,CAAG,CAAEC,QAAAA,CAAAA,CAAQ,CAC7B,CAAGzB,MAAAA,EAAAA,EAAQ,CACXuB,aAAc,CACbC,IAAK,EACLC,QAAS,CACV,CACD,EAgBA,OAdAjD,EAAU,KACT,IAAMkD,EAAY,UACjBvB,EAAQkB,OAAO,CAAG,MAAMpB,EAAKC,EAAOmB,OAAO,CAAElB,EAAQkB,OAAO,CAAEjB,EAC/D,EACAsB,GACD,EAAG,CAACtB,EAAE,EAEN5B,EAAU,KACT,GAAI2C,IAAUxC,EAAgBgD,QAAQ,CAAE,CACvC,IAAM9B,EAAQd,IACdiC,EAAgBnB,EAAO,CAAC2B,EAAKC,EAAQ,CACtC,CACD,EAAG,CAACD,EAAKC,EAASN,EAAOf,EAAGY,EAAgB,EAErC1C,EAAAsD,aAAA,CAAC/C,EAAKV,EAAA,CAAC0D,IAAK3B,CAAO,EAAKY,GAChC"}