)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/realTimeMonitoring/charts/AgentStatusChart.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useTranslation } from '@rocket.chat/ui-contexts';\nimport React, { useRef, useEffect } from 'react';\n\nimport { drawDoughnutChart } from '../../../../../app/livechat/client/lib/chartHandler';\nimport { AsyncStatePhase } from '../../../../hooks/useAsyncState';\nimport { useEndpointData } from '../../../../hooks/useEndpointData';\nimport Chart from './Chart';\nimport { useUpdateChartData } from './useUpdateChartData';\n\nconst labels = ['Available', 'Away', 'Busy', 'Offline'];\n\nconst initialData = {\n\tavailable: 0,\n\taway: 0,\n\tbusy: 0,\n\toffline: 0,\n};\n\nconst init = (canvas, context, t) =>\n\tdrawDoughnutChart(\n\t\tcanvas,\n\t\tt('Agents'),\n\t\tcontext,\n\t\tlabels.map((l) => t(l)),\n\t\tObject.values(initialData),\n\t);\n\nconst AgentStatusChart = ({ params, reloadRef, ...props }) => {\n\tconst t = useTranslation();\n\n\tconst canvas = useRef();\n\tconst context = useRef();\n\n\tconst updateChartData = useUpdateChartData({\n\t\tcontext,\n\t\tcanvas,\n\t\tt,\n\t\tinit,\n\t});\n\n\tconst { value: data, phase: state, reload } = useEndpointData('/v1/livechat/analytics/dashboards/charts/agents-status', { params });\n\n\treloadRef.current.agentStatusChart = reload;\n\n\tconst { offline = 0, available = 0, away = 0, busy = 0 } = data ?? initialData;\n\n\tuseEffect(() => {\n\t\tconst initChart = async () => {\n\t\t\tcontext.current = await init(canvas.current, context.current, t);\n\t\t};\n\t\tinitChart();\n\t}, [t]);\n\n\tuseEffect(() => {\n\t\tif (state === AsyncStatePhase.RESOLVED && context.current) {\n\t\t\tupdateChartData(t('Offline'), [offline]);\n\t\t\tupdateChartData(t('Available'), [available]);\n\t\t\tupdateChartData(t('Away'), [away]);\n\t\t\tupdateChartData(t('Busy'), [busy]);\n\t\t}\n\t}, [available, away, busy, offline, state, t, updateChartData]);\n\n\treturn <Chart ref={canvas} {...props} />;\n};\n\nexport default AgentStatusChart;\n",null],"names":["_extends","_objectWithoutProperties","useTranslation","React","useRef","useEffect","drawDoughnutChart","AsyncStatePhase","useEndpointData","Chart","useUpdateChartData","module","link","default","v","labels","initialData","available","away","busy","offline","init","canvas","context","t","map","l","Object","values","exportDefault","_ref","params","reloadRef","props","_excluded","updateChartData","value","data","phase","state","reload","current","agentStatusChart","initChart","RESOLVED","createElement","ref"],"mappings":"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"}