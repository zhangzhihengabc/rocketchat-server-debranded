)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/realTimeMonitoring/charts/ChatsChart.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useTranslation } from '@rocket.chat/ui-contexts';\nimport React, { useRef, useEffect } from 'react';\n\nimport { drawDoughnutChart } from '../../../../../app/livechat/client/lib/chartHandler';\nimport { AsyncStatePhase } from '../../../../hooks/useAsyncState';\nimport { useEndpointData } from '../../../../hooks/useEndpointData';\nimport Chart from './Chart';\nimport { useUpdateChartData } from './useUpdateChartData';\n\nconst labels = ['Open', 'Queued', 'On_Hold_Chats', 'Closed'];\n\nconst initialData = {\n\topen: 0,\n\tqueued: 0,\n\tonhold: 0,\n\tclosed: 0,\n};\n\nconst init = (canvas, context, t) =>\n\tdrawDoughnutChart(\n\t\tcanvas,\n\t\tt('Chats'),\n\t\tcontext,\n\t\tlabels.map((l) => t(l)),\n\t\tObject.values(initialData),\n\t);\n\nconst ChatsChart = ({ params, reloadRef, ...props }) => {\n\tconst t = useTranslation();\n\n\tconst canvas = useRef();\n\tconst context = useRef();\n\n\tconst updateChartData = useUpdateChartData({\n\t\tcontext,\n\t\tcanvas,\n\t\tt,\n\t\tinit,\n\t});\n\n\tconst { value: data, phase: state, reload } = useEndpointData('/v1/livechat/analytics/dashboards/charts/chats', { params });\n\n\treloadRef.current.chatsChart = reload;\n\n\tconst { open, queued, closed, onhold } = data ?? initialData;\n\n\tuseEffect(() => {\n\t\tconst initChart = async () => {\n\t\t\tcontext.current = await init(canvas.current, context.current, t);\n\t\t};\n\t\tinitChart();\n\t}, [t]);\n\n\tuseEffect(() => {\n\t\tif (state === AsyncStatePhase.RESOLVED) {\n\t\t\tupdateChartData(t('Open'), [open]);\n\t\t\tupdateChartData(t('Closed'), [closed]);\n\t\t\tupdateChartData(t('On_Hold_Chats'), [onhold]);\n\t\t\tupdateChartData(t('Queued'), [queued]);\n\t\t}\n\t}, [closed, open, queued, onhold, state, t, updateChartData]);\n\n\treturn <Chart ref={canvas} {...props} />;\n};\n\nexport default ChatsChart;\n",null],"names":["_extends","_objectWithoutProperties","useTranslation","React","useRef","useEffect","drawDoughnutChart","AsyncStatePhase","useEndpointData","Chart","useUpdateChartData","module","link","default","v","labels","initialData","open","queued","onhold","closed","init","canvas","context","t","map","l","Object","values","exportDefault","_ref","params","reloadRef","props","_excluded","updateChartData","value","data","phase","state","reload","current","chatsChart","initChart","RESOLVED","createElement","ref"],"mappings":"2BAAIA,EAAsFC,EAAtFC,EAAmGC,EAAMC,EAAOC,EAAyGC,EAAuIC,EAA6GC,EAA+GC,EAAyDC,+BAA5mBC,EAAOC,IAAI,CAAC,iCAAiC,CAACC,QAAQC,CAAC,EAAEd,EAASc,CAAC,CAAC,EAAE,GAAgCH,EAAOC,IAAI,CAAC,iDAAiD,CAACC,QAAQC,CAAC,EAAEb,EAAyBa,CAAC,CAAC,EAAE,GAAtMH,EAAOC,IAAI,CAAC,2BAA2B,CAACV,eAAeY,CAAC,EAAEZ,EAAeY,CAAC,CAAC,EAAE,GAA8BH,EAAOC,IAAI,CAAC,QAAQ,CAACC,QAAQC,CAAC,EAAEX,EAAMW,CAAC,EAAEV,OAAOU,CAAC,EAAEV,EAAOU,CAAC,EAAET,UAAUS,CAAC,EAAET,EAAUS,CAAC,CAAC,EAAE,GAAyBH,EAAOC,IAAI,CAAC,sDAAsD,CAACN,kBAAkBQ,CAAC,EAAER,EAAkBQ,CAAC,CAAC,EAAE,GAAuBH,EAAOC,IAAI,CAAC,kCAAkC,CAACL,gBAAgBO,CAAC,EAAEP,EAAgBO,CAAC,CAAC,EAAE,GAAuBH,EAAOC,IAAI,CAAC,oCAAoC,CAACJ,gBAAgBM,CAAC,EAAEN,EAAgBM,CAAC,CAAC,EAAE,GAAaH,EAAOC,IAAI,CAAC,UAAU,CAACC,QAAQC,CAAC,EAAEL,EAAMK,CAAC,CAAC,EAAE,GAA0BH,EAAOC,IAAI,CAAC,uBAAuB,CAACF,mBAAmBI,CAAC,EAAEJ,EAAmBI,CAAC,CAAC,EAAE,GAS7tB,IAAMC,EAAS,CAAC,OAAQ,SAAU,gBAAiB,SAAS,CAEtDC,EAAc,CACnBC,KAAM,EACNC,OAAQ,EACRC,OAAQ,EACRC,OAAQ,CACT,EAEMC,EAAO,CAACC,EAAQC,EAASC,IAC9BlB,EACCgB,EACAE,EAAE,SACFD,EACAR,EAAOU,GAAG,CAAEC,GAAMF,EAAEE,IACpBC,OAAOC,MAAM,CAACZ,IAxBhBL,EAAOkB,aAAa,CA2BDC,IAAqC,GAApC,CAAEC,OAAAA,CAAM,CAAEC,UAAAA,CAAAA,CAAqB,CAAAF,EAAPG,EAAKhC,EAAA6B,EAAAI,GAC1CV,EAAItB,IAEJoB,EAASlB,IACTmB,EAAUnB,IAEV+B,EAAkBzB,EAAmB,CAC1Ca,QAAAA,EACAD,OAAAA,EACAE,EAAAA,EACAH,KAAAA,CACD,GAEM,CAAEe,MAAOC,CAAI,CAAEC,MAAOC,CAAK,CAAEC,OAAAA,CAAAA,CAAQ,CAAGhC,EAAgB,iDAAkD,CAAEuB,OAAAA,CAAO,EAEzHC,CAAAA,EAAUS,OAAO,CAACC,UAAU,CAAGF,EAE/B,GAAM,CAAEvB,KAAAA,CAAI,CAAEC,OAAAA,CAAM,CAAEE,OAAAA,CAAM,CAAED,OAAAA,CAAAA,CAAQ,CAAGkB,MAAAA,EAAAA,EAAQrB,EAkBjD,OAhBAX,EAAU,KACT,IAAMsC,EAAY,UACjBpB,EAAQkB,OAAO,CAAG,MAAMpB,EAAKC,EAAOmB,OAAO,CAAElB,EAAQkB,OAAO,CAAEjB,EAC/D,EACAmB,GACD,EAAG,CAACnB,EAAE,EAENnB,EAAU,KACLkC,IAAUhC,EAAgBqC,QAAQ,GACrCT,EAAgBX,EAAE,QAAS,CAACP,EAAK,EACjCkB,EAAgBX,EAAE,UAAW,CAACJ,EAAO,EACrCe,EAAgBX,EAAE,iBAAkB,CAACL,EAAO,EAC5CgB,EAAgBX,EAAE,UAAW,CAACN,EAAO,EAEvC,EAAG,CAACE,EAAQH,EAAMC,EAAQC,EAAQoB,EAAOf,EAAGW,EAAgB,EAErDhC,EAAA0C,aAAA,CAACpC,EAAKT,EAAA,CAAC8C,IAAKxB,CAAO,EAAKW,GAChC"}