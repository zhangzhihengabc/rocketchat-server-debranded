)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/directory/calls/CallTable.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Pagination } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useRoute, useTranslation, useEndpoint, useUserId } from '@rocket.chat/ui-contexts';\nimport { useQuery, hashQueryKey } from '@tanstack/react-query';\nimport React, { useState, useMemo } from 'react';\n\nimport FilterByText from '../../../../components/FilterByText';\nimport GenericNoResults from '../../../../components/GenericNoResults/GenericNoResults';\nimport {\n\tGenericTable,\n\tGenericTableBody,\n\tGenericTableHeader,\n\tGenericTableHeaderCell,\n\tGenericTableLoadingRow,\n} from '../../../../components/GenericTable';\nimport { usePagination } from '../../../../components/GenericTable/hooks/usePagination';\nimport { useSort } from '../../../../components/GenericTable/hooks/useSort';\nimport { CallTableRow } from './CallTableRow';\n\nconst CallTable = () => {\n\tconst t = useTranslation();\n\tconst userIdLoggedIn = useUserId();\n\n\tconst [text, setText] = useState('');\n\tconst directoryRoute = useRoute('omnichannel-directory');\n\tconst { current, itemsPerPage, setItemsPerPage: onSetItemsPerPage, setCurrent: onSetCurrent, ...paginationProps } = usePagination();\n\tconst { sortBy, sortDirection, setSort } = useSort<'fname' | 'phone' | 'queue' | 'ts' | 'callDuration' | 'direction'>('fname');\n\n\tconst query = useMemo(\n\t\t() => ({\n\t\t\tsort: `{ \"${sortBy}\": ${sortDirection === 'asc' ? 1 : -1} }`,\n\t\t\topen: 'false' as const,\n\t\t\troomName: text || '',\n\t\t\tagents: userIdLoggedIn ? [userIdLoggedIn] : [],\n\t\t\t...(itemsPerPage && { count: itemsPerPage }),\n\t\t\t...(current && { offset: current }),\n\t\t}),\n\t\t[sortBy, current, sortDirection, itemsPerPage, userIdLoggedIn, text],\n\t);\n\n\tconst onRowClick = useMutableCallback((id, token) => {\n\t\tdirectoryRoute.push(\n\t\t\t{\n\t\t\t\tpage: 'calls',\n\t\t\t\tbar: 'info',\n\t\t\t\tid,\n\t\t\t},\n\t\t\t{ token },\n\t\t);\n\t});\n\n\tconst getVoipRooms = useEndpoint('GET', '/v1/voip/rooms');\n\tconst { data, isSuccess, isLoading } = useQuery(['voip-rooms', query], async () => getVoipRooms(query));\n\n\tconst [defaultQuery] = useState(hashQueryKey([query]));\n\tconst queryHasChanged = defaultQuery !== hashQueryKey([query]);\n\n\tconst headers = (\n\t\t<>\n\t\t\t<GenericTableHeaderCell key='fname' direction={sortDirection} active={sortBy === 'fname'} onClick={setSort} sort='fname' w='x400'>\n\t\t\t\t{t('Contact_Name')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell key='phone' direction={sortDirection} active={sortBy === 'phone'} onClick={setSort} sort='phone' w='x200'>\n\t\t\t\t{t('Phone')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell key='queue' direction={sortDirection} active={sortBy === 'queue'} onClick={setSort} sort='ts' w='x100'>\n\t\t\t\t{t('Queue')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell key='ts' direction={sortDirection} active={sortBy === 'ts'} onClick={setSort} sort='ts' w='x200'>\n\t\t\t\t{t('Started_At')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell\n\t\t\t\tkey='callDuration'\n\t\t\t\tdirection={sortDirection}\n\t\t\t\tactive={sortBy === 'callDuration'}\n\t\t\t\tonClick={setSort}\n\t\t\t\tsort='callDuration'\n\t\t\t\tw='x120'\n\t\t\t>\n\t\t\t\t{t('Talk_Time')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell\n\t\t\t\tkey='direction'\n\t\t\t\tdirection={sortDirection}\n\t\t\t\tactive={sortBy === 'direction'}\n\t\t\t\tonClick={setSort}\n\t\t\t\tsort='direction'\n\t\t\t\tw='x200'\n\t\t\t>\n\t\t\t\t{t('Direction')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell key='call' width={44} />\n\t\t</>\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t{((isSuccess && data?.rooms.length > 0) || queryHasChanged) && <FilterByText onChange={({ text }) => setText(text)} />}\n\t\t\t{isLoading && (\n\t\t\t\t<GenericTable>\n\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t<GenericTableLoadingRow cols={7} />\n\t\t\t\t\t</GenericTableBody>\n\t\t\t\t</GenericTable>\n\t\t\t)}\n\t\t\t{isSuccess && data?.rooms.length === 0 && queryHasChanged && <GenericNoResults />}\n\t\t\t{isSuccess && data?.rooms.length === 0 && !queryHasChanged && (\n\t\t\t\t<GenericNoResults\n\t\t\t\t\ticon='phone'\n\t\t\t\t\ttitle={t('No_calls_yet')}\n\t\t\t\t\tdescription={t('No_calls_yet_description')}\n\t\t\t\t\tlinkHref='https://go.rocket.chat/omnichannel-docs'\n\t\t\t\t\tlinkText={t('Learn_more_about_voice_channel')}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t{isSuccess && data?.rooms.length > 0 && (\n\t\t\t\t<>\n\t\t\t\t\t<GenericTable>\n\t\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t\t{data?.rooms.map((room) => (\n\t\t\t\t\t\t\t\t<CallTableRow key={room._id} room={room} onRowClick={onRowClick} />\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</GenericTableBody>\n\t\t\t\t\t</GenericTable>\n\t\t\t\t\t<Pagination\n\t\t\t\t\t\tdivider\n\t\t\t\t\t\tcurrent={current}\n\t\t\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\t\t\tcount={data?.total || 0}\n\t\t\t\t\t\tonSetItemsPerPage={onSetItemsPerPage}\n\t\t\t\t\t\tonSetCurrent={onSetCurrent}\n\t\t\t\t\t\t{...paginationProps}\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default CallTable;\n",null],"names":["_extends","_objectSpread","_objectWithoutProperties","Pagination","useMutableCallback","useRoute","useTranslation","useEndpoint","useUserId","useQuery","hashQueryKey","React","useState","useMemo","FilterByText","GenericNoResults","GenericTable","GenericTableBody","GenericTableHeader","GenericTableHeaderCell","GenericTableLoadingRow","usePagination","useSort","CallTableRow","module","link","default","exportDefault","t","userIdLoggedIn","text","setText","directoryRoute","_usePagination","current","itemsPerPage","setItemsPerPage","onSetItemsPerPage","setCurrent","onSetCurrent","paginationProps","_excluded","sortBy","sortDirection","setSort","query","sort","concat","open","roomName","agents","count","offset","onRowClick","id","token","push","page","bar","getVoipRooms","data","isSuccess","isLoading","defaultQuery","queryHasChanged","headers","createElement","Fragment","key","direction","active","onClick","w","width","rooms","length","onChange","_ref","cols","icon","title","description","linkHref","linkText","map","room","_id","divider","total"],"mappings":"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"}