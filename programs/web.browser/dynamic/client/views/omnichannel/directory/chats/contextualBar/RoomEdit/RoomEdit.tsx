function module(e,t,l){let a,n,i,o,r,s,c,u,m,d,h,k,p,f,g,C,v,E,b,S,F,y,x,I,P,_,w;l.link("@babel/runtime/helpers/extends",{default(e){a=e}},0),l.link("@babel/runtime/helpers/objectSpread2",{default(e){n=e}},1),l.link("@rocket.chat/fuselage",{Field(e){i=e},FieldLabel(e){o=e},FieldRow(e){r=e},TextInput(e){s=e},ButtonGroup(e){c=e},Button(e){u=e}},0),l.link("@rocket.chat/ui-client",{CustomFieldsForm(e){m=e}},1),l.link("@rocket.chat/ui-contexts",{useToastMessageDispatch(e){d=e},useTranslation(e){h=e},useEndpoint(e){k=e}},2),l.link("@tanstack/react-query",{useQueryClient(e){p=e}},3),l.link("react",{default(e){f=e},useCallback(e){g=e}},4),l.link("react-hook-form",{useController(e){C=e},useForm(e){v=e}},5),l.link("../../../../../../../app/authorization/client",{hasAtLeastOnePermission(e){E=e}},6),l.link("../../../../../../../ee/client/omnichannel/hooks/useOmnichannelPriorities",{useOmnichannelPriorities(e){b=e}},7),l.link("../../../../../../components/Contextualbar",{ContextualbarFooter(e){S=e},ContextualbarScrollableContent(e){F=e}},8),l.link("../../../../../../components/Omnichannel/Tags",{default(e){y=e}},9),l.link("../../../../additionalForms",{SlaPoliciesSelect(e){x=e},PrioritiesSelect(e){I=e}},10),l.link("../../../components/FormSkeleton",{FormSkeleton(e){P=e}},11),l.link("../../../hooks/useCustomFieldsMetadata",{useCustomFieldsMetadata(e){_=e}},12),l.link("../../../hooks/useSlaPolicies",{useSlaPolicies(e){w=e}},13);let D={topic:"",tags:[],livechatData:{},slaId:""},L=e=>{let{topic:t,tags:l,livechatData:a,slaId:n,priorityId:i}=null!=e?e:D;return{topic:null!=t?t:"",tags:null!=l?l:[],livechatData:null!=a?a:{},slaId:null!=n?n:"",priorityId:null!=i?i:""}};l.exportDefault(function(e){let{room:t,visitor:l,reload:D,reloadInfo:T,onClose:O}=e,G=h(),M=d(),A=p(),B=E(["view-livechat-room-customfields","edit-livechat-room-customfields"]),Q=k("POST","/v1/livechat/room.saveInfo"),{data:V,isInitialLoading:j}=w(),{data:q,isInitialLoading:z}=_({scope:"room",enabled:B}),{data:N,isLoading:R}=b(),{register:H,control:J,formState:{isDirty:K,isValid:U,isSubmitting:W},handleSubmit:X}=v({mode:"onChange",defaultValues:L(t)}),{field:Y}=C({control:J,name:"tags"}),{field:Z}=C({control:J,name:"slaId"}),{field:$}=C({control:J,name:"priorityId"}),ee=g(async e=>{if(!U)return;let{topic:a,tags:i,livechatData:o,slaId:r,priorityId:s}=e,c={_id:l._id},u=n({_id:t._id,topic:a,tags:i.sort(),livechatData:o,priorityId:s},r&&{slaId:r});try{await Q({guestData:c,roomData:u}),await A.invalidateQueries(["/v1/rooms.info",t._id]),M({type:"success",message:G("Saved")}),null==D||D(),null==T||T(),O()}catch(e){M({type:"error",message:e})}},[M,U,O,A,D,T,t._id,Q,G,l._id]);return z||j||R?f.createElement(F,null,f.createElement(P,null)):f.createElement(f.Fragment,null,f.createElement(F,{is:"form",onSubmit:X(ee)},B&&q&&f.createElement(m,{formName:"livechatData",formControl:J,metadata:q}),f.createElement(i,null,f.createElement(o,null,G("Topic")),f.createElement(r,null,f.createElement(s,a({},H("topic"),{flexGrow:1})))),f.createElement(i,null,f.createElement(y,{tags:Y.value,handler:Y.onChange,department:t.departmentId})),x&&!!(null!=V&&V.length)&&f.createElement(x,{label:G("SLA_Policy"),value:Z.value,options:V,onChange:Z.onChange}),I&&!!(null!=N&&N.length)&&f.createElement(I,{label:G("Priority"),value:$.value,options:N,onChange:$.onChange})),f.createElement(S,null,f.createElement(c,{stretch:!0},f.createElement(u,{flexGrow:1,onClick:O},G("Cancel")),f.createElement(u,{mie:"none",flexGrow:1,onClick:X(ee),loading:W,disabled:!U||!K,primary:!0},G("Save")))))})}
//# sourceMappingURL=/dynamic/client/views/omnichannel/directory/chats/contextualBar/RoomEdit/1d27f01b6c80b4df54325ba2d5e5682f85cb63ee.map
