)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/currentChats/CurrentChatsPage.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Callout, Pagination } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { GETLivechatRoomsParams } from '@rocket.chat/rest-typings';\nimport { usePermission, useTranslation } from '@rocket.chat/ui-contexts';\nimport { hashQueryKey } from '@tanstack/react-query';\nimport moment from 'moment';\nimport type { ComponentProps, ReactElement } from 'react';\nimport React, { memo, useCallback, useMemo, useState } from 'react';\n\nimport { RoomActivityIcon } from '../../../../ee/client/omnichannel/components/RoomActivityIcon';\nimport { useOmnichannelPriorities } from '../../../../ee/client/omnichannel/hooks/useOmnichannelPriorities';\nimport { PriorityIcon } from '../../../../ee/client/omnichannel/priorities/PriorityIcon';\nimport GenericNoResults from '../../../components/GenericNoResults';\nimport {\n\tGenericTable,\n\tGenericTableBody,\n\tGenericTableCell,\n\tGenericTableHeader,\n\tGenericTableHeaderCell,\n\tGenericTableLoadingTable,\n\tGenericTableRow,\n} from '../../../components/GenericTable';\nimport { usePagination } from '../../../components/GenericTable/hooks/usePagination';\nimport { useSort } from '../../../components/GenericTable/hooks/useSort';\nimport Page from '../../../components/Page';\nimport { useIsOverMacLimit } from '../../../hooks/omnichannel/useIsOverMacLimit';\nimport CustomFieldsList from './CustomFieldsList';\nimport FilterByText from './FilterByText';\nimport RemoveChatButton from './RemoveChatButton';\nimport { useAllCustomFields } from './hooks/useAllCustomFields';\nimport { useCurrentChats } from './hooks/useCurrentChats';\n\ntype DebouncedParams = {\n\tfname: string;\n\tguest: string;\n\tservedBy: string;\n\tdepartment: string;\n\tstatus: string;\n\tfrom: string;\n\tto: string;\n\ttags: any[];\n};\n\ntype CurrentChatQuery = {\n\tagents?: string[];\n\toffset?: number;\n\troomName?: string;\n\tdepartmentId?: string;\n\topen?: boolean;\n\tcreatedAt?: string;\n\tclosedAt?: string;\n\ttags?: string[];\n\tonhold?: boolean;\n\tcustomFields?: string;\n\tsort: string;\n\tcount?: number;\n};\n\ntype useQueryType = (\n\tdebouncedParams: DebouncedParams,\n\tcustomFields: { [key: string]: string } | undefined,\n\t[column, direction]: [string, 'asc' | 'desc'],\n\tcurrent: number,\n\titemsPerPage: 25 | 50 | 100,\n) => GETLivechatRoomsParams;\n\nconst sortDir = (sortDir: 'asc' | 'desc'): 1 | -1 => (sortDir === 'asc' ? 1 : -1);\n\nconst currentChatQuery: useQueryType = (\n\t{ guest, servedBy, department, status, from, to, tags },\n\tcustomFields,\n\t[column, direction],\n\tcurrent,\n\titemsPerPage,\n) => {\n\tconst query: CurrentChatQuery = {\n\t\t...(guest && { roomName: guest }),\n\t\tsort: JSON.stringify({\n\t\t\t[column]: sortDir(direction),\n\t\t\tts: column === 'ts' ? sortDir(direction) : undefined,\n\t\t}),\n\t\t...(itemsPerPage && { count: itemsPerPage }),\n\t\t...(current && { offset: current }),\n\t};\n\n\tif (from || to) {\n\t\tquery.createdAt = JSON.stringify({\n\t\t\t...(from && {\n\t\t\t\tstart: moment(new Date(from)).set({ hour: 0, minutes: 0, seconds: 0 }).toISOString(),\n\t\t\t}),\n\t\t\t...(to && {\n\t\t\t\tend: moment(new Date(to)).set({ hour: 23, minutes: 59, seconds: 59 }).toISOString(),\n\t\t\t}),\n\t\t});\n\t}\n\n\tif (status !== 'all') {\n\t\tquery.open = status === 'opened' || status === 'onhold';\n\t\tquery.onhold = status === 'onhold';\n\t}\n\tif (servedBy && servedBy !== 'all') {\n\t\tquery.agents = [servedBy];\n\t}\n\tif (department && department !== 'all') {\n\t\tquery.departmentId = department;\n\t}\n\n\tif (tags && tags.length > 0) {\n\t\tquery.tags = tags;\n\t}\n\n\tif (customFields && Object.keys(customFields).length > 0) {\n\t\tconst customFieldsQuery = Object.fromEntries(Object.entries(customFields).filter((item) => item[1] !== undefined && item[1] !== ''));\n\t\tif (Object.keys(customFieldsQuery).length > 0) {\n\t\t\tquery.customFields = JSON.stringify(customFieldsQuery);\n\t\t}\n\t}\n\n\treturn query;\n};\n\nconst CurrentChatsPage = ({ id, onRowClick }: { id?: string; onRowClick: (_id: string) => void }): ReactElement => {\n\tconst isWorkspaceOverMacLimit = useIsOverMacLimit();\n\tconst { sortBy, sortDirection, setSort } = useSort<'fname' | 'departmentId' | 'servedBy' | 'priorityWeight' | 'ts' | 'lm' | 'open'>(\n\t\t'ts',\n\t\t'desc',\n\t);\n\tconst [customFields, setCustomFields] = useState<{ [key: string]: string }>();\n\n\tconst t = useTranslation();\n\n\tconst canRemoveClosedChats = usePermission('remove-closed-livechat-room');\n\tconst { enabled: isPriorityEnabled } = useOmnichannelPriorities();\n\n\tconst { data: allCustomFields } = useAllCustomFields();\n\n\tconst { current, itemsPerPage, setItemsPerPage, setCurrent, ...paginationProps } = usePagination();\n\n\tconst [params, setParams] = useState({\n\t\tguest: '',\n\t\tfname: '',\n\t\tservedBy: '',\n\t\tstatus: 'all',\n\t\tdepartment: '',\n\t\tfrom: '',\n\t\tto: '',\n\t\ttags: [] as string[],\n\t});\n\n\tconst hasCustomFields = useMemo(\n\t\t() => !!allCustomFields?.customFields?.find((customField) => customField.scope === 'room'),\n\t\t[allCustomFields],\n\t);\n\n\tconst query = useMemo(\n\t\t() => currentChatQuery(params, customFields, [sortBy, sortDirection], current, itemsPerPage),\n\t\t[customFields, itemsPerPage, params, sortBy, sortDirection, current],\n\t);\n\n\tconst { data, isLoading, isSuccess } = useCurrentChats(query);\n\n\tconst [defaultQuery] = useState(hashQueryKey([query]));\n\tconst queryHasChanged = defaultQuery !== hashQueryKey([query]);\n\n\tconst onFilter = useMutableCallback((params: DebouncedParams): void => {\n\t\tsetParams(params);\n\t\tsetCurrent(0);\n\t});\n\n\tconst renderRow = useCallback(\n\t\t(room) => {\n\t\t\tconst { _id, fname, servedBy, ts, lm, department, open, onHold, priorityWeight } = room;\n\t\t\tconst getStatusText = (open: boolean, onHold: boolean): string => {\n\t\t\t\tif (!open) return t('Closed');\n\t\t\t\treturn onHold ? t('On_Hold_Chats') : t('Open');\n\t\t\t};\n\n\t\t\treturn (\n\t\t\t\t<GenericTableRow key={_id} onClick={(): void => onRowClick(_id)} action>\n\t\t\t\t\t{isPriorityEnabled && (\n\t\t\t\t\t\t<GenericTableCell withTruncatedText data-qa='current-chats-cell-priority'>\n\t\t\t\t\t\t\t<PriorityIcon level={priorityWeight} />\n\t\t\t\t\t\t</GenericTableCell>\n\t\t\t\t\t)}\n\t\t\t\t\t<GenericTableCell withTruncatedText data-qa='current-chats-cell-name'>\n\t\t\t\t\t\t{fname}\n\t\t\t\t\t</GenericTableCell>\n\t\t\t\t\t<GenericTableCell withTruncatedText data-qa='current-chats-cell-department'>\n\t\t\t\t\t\t{department ? department.name : ''}\n\t\t\t\t\t</GenericTableCell>\n\t\t\t\t\t<GenericTableCell withTruncatedText data-qa='current-chats-cell-servedBy'>\n\t\t\t\t\t\t{servedBy?.username}\n\t\t\t\t\t</GenericTableCell>\n\t\t\t\t\t<GenericTableCell withTruncatedText data-qa='current-chats-cell-startedAt'>\n\t\t\t\t\t\t{moment(ts).format('L LTS')}\n\t\t\t\t\t</GenericTableCell>\n\t\t\t\t\t<GenericTableCell withTruncatedText data-qa='current-chats-cell-lastMessage'>\n\t\t\t\t\t\t{moment(lm).format('L LTS')}\n\t\t\t\t\t</GenericTableCell>\n\t\t\t\t\t<GenericTableCell withTruncatedText data-qa='current-chats-cell-status'>\n\t\t\t\t\t\t<RoomActivityIcon room={room} /> {getStatusText(open, onHold)}\n\t\t\t\t\t</GenericTableCell>\n\t\t\t\t\t{canRemoveClosedChats && !open && <RemoveChatButton _id={_id} />}\n\t\t\t\t</GenericTableRow>\n\t\t\t);\n\t\t},\n\t\t[canRemoveClosedChats, onRowClick, isPriorityEnabled, t],\n\t);\n\n\tconst headers = (\n\t\t<>\n\t\t\t{isPriorityEnabled && (\n\t\t\t\t<GenericTableHeaderCell\n\t\t\t\t\tkey='priorityWeight'\n\t\t\t\t\tdirection={sortDirection}\n\t\t\t\t\tactive={sortBy === 'priorityWeight'}\n\t\t\t\t\tonClick={setSort}\n\t\t\t\t\tsort='priorityWeight'\n\t\t\t\t\tw='x100'\n\t\t\t\t\talignItems='center'\n\t\t\t\t>\n\t\t\t\t\t{t('Priority')}\n\t\t\t\t</GenericTableHeaderCell>\n\t\t\t)}\n\t\t\t<GenericTableHeaderCell\n\t\t\t\tkey='fname'\n\t\t\t\tdirection={sortDirection}\n\t\t\t\tactive={sortBy === 'fname'}\n\t\t\t\tonClick={setSort}\n\t\t\t\tsort='fname'\n\t\t\t\tdata-qa='current-chats-header-name'\n\t\t\t>\n\t\t\t\t{t('Name')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell\n\t\t\t\tkey='departmentId'\n\t\t\t\tdirection={sortDirection}\n\t\t\t\tactive={sortBy === 'departmentId'}\n\t\t\t\tonClick={setSort}\n\t\t\t\tsort='departmentId'\n\t\t\t\tdata-qa='current-chats-header-department'\n\t\t\t>\n\t\t\t\t{t('Department')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell\n\t\t\t\tkey='servedBy'\n\t\t\t\tdirection={sortDirection}\n\t\t\t\tactive={sortBy === 'servedBy'}\n\t\t\t\tonClick={setSort}\n\t\t\t\tsort='servedBy'\n\t\t\t\tdata-qa='current-chats-header-servedBy'\n\t\t\t>\n\t\t\t\t{t('Served_By')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell\n\t\t\t\tkey='ts'\n\t\t\t\tdirection={sortDirection}\n\t\t\t\tactive={sortBy === 'ts'}\n\t\t\t\tonClick={setSort}\n\t\t\t\tsort='ts'\n\t\t\t\tdata-qa='current-chats-header-startedAt'\n\t\t\t>\n\t\t\t\t{t('Started_At')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell\n\t\t\t\tkey='lm'\n\t\t\t\tdirection={sortDirection}\n\t\t\t\tactive={sortBy === 'lm'}\n\t\t\t\tonClick={setSort}\n\t\t\t\tsort='lm'\n\t\t\t\tdata-qa='current-chats-header-lastMessage'\n\t\t\t>\n\t\t\t\t{t('Last_Message')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell\n\t\t\t\tkey='open'\n\t\t\t\tdirection={sortDirection}\n\t\t\t\tactive={sortBy === 'open'}\n\t\t\t\tonClick={setSort}\n\t\t\t\tsort='open'\n\t\t\t\tw='x100'\n\t\t\t\tdata-qa='current-chats-header-status'\n\t\t\t>\n\t\t\t\t{t('Status')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t{canRemoveClosedChats && (\n\t\t\t\t<GenericTableHeaderCell key='remove' w='x60' data-qa='current-chats-header-remove'>\n\t\t\t\t\t{t('Remove')}\n\t\t\t\t</GenericTableHeaderCell>\n\t\t\t)}\n\t\t</>\n\t);\n\n\t// TODO: Missing error state\n\treturn (\n\t\t<Page flexDirection='row'>\n\t\t\t<Page>\n\t\t\t\t<Page.Header title={t('Current_Chats')} />\n\t\t\t\t<Page.Content>\n\t\t\t\t\t{((isSuccess && data?.rooms.length > 0) || queryHasChanged) && (\n\t\t\t\t\t\t<FilterByText\n\t\t\t\t\t\t\tsetFilter={onFilter as ComponentProps<typeof FilterByText>['setFilter']}\n\t\t\t\t\t\t\tsetCustomFields={setCustomFields}\n\t\t\t\t\t\t\tcustomFields={customFields}\n\t\t\t\t\t\t\thasCustomFields={hasCustomFields}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t{isWorkspaceOverMacLimit && (\n\t\t\t\t\t\t<Callout\n\t\t\t\t\t\t\ttype='danger'\n\t\t\t\t\t\t\ticon='warning'\n\t\t\t\t\t\t\ttitle={t('The_workspace_has_exceeded_the_monthly_limit_of_active_contacts')}\n\t\t\t\t\t\t\tstyle={{ marginBlock: '2rem' }}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{t('Talk_to_your_workspace_admin_to_address_this_issue')}\n\t\t\t\t\t\t</Callout>\n\t\t\t\t\t)}\n\t\t\t\t\t{isSuccess && data?.rooms.length === 0 && queryHasChanged && <GenericNoResults />}\n\t\t\t\t\t{isSuccess && data?.rooms.length === 0 && !queryHasChanged && (\n\t\t\t\t\t\t<GenericNoResults\n\t\t\t\t\t\t\ticon='discussion'\n\t\t\t\t\t\t\ttitle={t('No_chats_yet')}\n\t\t\t\t\t\t\tdescription={t('No_chats_yet_description')}\n\t\t\t\t\t\t\tlinkHref='https://go.rocket.chat/omnichannel-docs'\n\t\t\t\t\t\t\tlinkText={t('Learn_more_about_current_chats')}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t{isLoading && (\n\t\t\t\t\t\t<GenericTable>\n\t\t\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t\t\t<GenericTableLoadingTable headerCells={6} />\n\t\t\t\t\t\t\t</GenericTableBody>\n\t\t\t\t\t\t</GenericTable>\n\t\t\t\t\t)}\n\t\t\t\t\t{isSuccess && data?.rooms.length > 0 && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<GenericTable>\n\t\t\t\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t\t\t\t<GenericTableBody data-qa='GenericTableCurrentChatsBody'>\n\t\t\t\t\t\t\t\t\t{data.rooms.map((room) => renderRow({ ...room }))}\n\t\t\t\t\t\t\t\t</GenericTableBody>\n\t\t\t\t\t\t\t</GenericTable>\n\t\t\t\t\t\t\t<Pagination\n\t\t\t\t\t\t\t\tdivider\n\t\t\t\t\t\t\t\tcurrent={current}\n\t\t\t\t\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\t\t\t\t\tcount={data.total}\n\t\t\t\t\t\t\t\tonSetItemsPerPage={setItemsPerPage}\n\t\t\t\t\t\t\t\tonSetCurrent={setCurrent}\n\t\t\t\t\t\t\t\t{...paginationProps}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t</Page.Content>\n\t\t\t</Page>\n\t\t\t{id === 'custom-fields' && hasCustomFields && (\n\t\t\t\t<CustomFieldsList setCustomFields={setCustomFields} allCustomFields={allCustomFields?.customFields || []} />\n\t\t\t)}\n\t\t</Page>\n\t);\n};\n\nexport default memo(CurrentChatsPage);\n",null],"names":["_extends","_objectWithoutProperties","_objectSpread","Callout","Pagination","useMutableCallback","usePermission","useTranslation","hashQueryKey","moment","React","memo","useCallback","useMemo","useState","RoomActivityIcon","useOmnichannelPriorities","PriorityIcon","GenericNoResults","GenericTable","GenericTableBody","GenericTableCell","GenericTableHeader","GenericTableHeaderCell","GenericTableLoadingTable","GenericTableRow","usePagination","useSort","Page","useIsOverMacLimit","CustomFieldsList","FilterByText","RemoveChatButton","useAllCustomFields","useCurrentChats","module","link","default","v","sortDir","currentChatQuery","_ref","customFields","_ref2","current","itemsPerPage","guest","servedBy","department","status","from","to","tags","column","direction","query","roomName","sort","JSON","stringify","ts","undefined","count","offset","createdAt","start","Date","set","hour","minutes","seconds","toISOString","end","open","onhold","agents","departmentId","length","Object","keys","customFieldsQuery","fromEntries","entries","filter","item","exportDefault","_ref3","id","onRowClick","isWorkspaceOverMacLimit","sortBy","sortDirection","setSort","setCustomFields","t","canRemoveClosedChats","enabled","isPriorityEnabled","data","allCustomFields","_usePagination","setItemsPerPage","setCurrent","paginationProps","_excluded","params","setParams","fname","hasCustomFields","_allCustomFields$cust","find","customField","scope","isLoading","isSuccess","defaultQuery","queryHasChanged","onFilter","renderRow","room","_id","lm","onHold","priorityWeight","createElement","key","onClick","action","withTruncatedText","level","name","username","format","headers","Fragment","active","w","alignItems","flexDirection","Header","title","Content","rooms","setFilter","type","icon","style","marginBlock","description","linkHref","linkText","headerCells","map","divider","total","onSetItemsPerPage","onSetCurrent"],"mappings":"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"}