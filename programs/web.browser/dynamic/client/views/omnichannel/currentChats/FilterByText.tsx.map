)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/currentChats/FilterByText.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { TextInput, Box, Select, InputBox } from '@rocket.chat/fuselage';\nimport { useMutableCallback, useLocalStorage } from '@rocket.chat/fuselage-hooks';\nimport { useSetModal, useToastMessageDispatch, useMethod, useTranslation } from '@rocket.chat/ui-contexts';\nimport moment from 'moment';\nimport type { Dispatch, FC, SetStateAction } from 'react';\nimport React, { useEffect } from 'react';\n\nimport AutoCompleteAgent from '../../../components/AutoCompleteAgent';\nimport AutoCompleteDepartment from '../../../components/AutoCompleteDepartment';\nimport GenericModal from '../../../components/GenericModal';\nimport { CurrentChatTags } from '../additionalForms';\nimport Label from './Label';\nimport RemoveAllClosed from './RemoveAllClosed';\n\ntype FilterByTextType = FC<{\n\tsetFilter: Dispatch<SetStateAction<Record<string, any>>>;\n\tsetCustomFields: Dispatch<SetStateAction<{ [key: string]: string } | undefined>>;\n\tcustomFields: { [key: string]: string } | undefined;\n\thasCustomFields: boolean;\n\treload?: () => void;\n}>;\n\nconst FilterByText: FilterByTextType = ({ setFilter, reload, customFields, setCustomFields, hasCustomFields, ...props }) => {\n\tconst setModal = useSetModal();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst t = useTranslation();\n\n\tconst statusOptions: [string, string][] = [\n\t\t['all', t('All')],\n\t\t['closed', t('Closed')],\n\t\t['opened', t('Open')],\n\t\t['onhold', t('On_Hold_Chats')],\n\t];\n\n\tconst [guest, setGuest] = useLocalStorage('guest', '');\n\tconst [servedBy, setServedBy] = useLocalStorage('servedBy', 'all');\n\tconst [status, setStatus] = useLocalStorage('status', 'all');\n\tconst [department, setDepartment] = useLocalStorage<string>('department', 'all');\n\tconst [from, setFrom] = useLocalStorage('from', '');\n\tconst [to, setTo] = useLocalStorage('to', '');\n\tconst [tags, setTags] = useLocalStorage<never | { label: string; value: string }[]>('tags', []);\n\n\tconst handleGuest = useMutableCallback((e) => setGuest(e.target.value));\n\tconst handleServedBy = useMutableCallback((e) => setServedBy(e));\n\tconst handleStatus = useMutableCallback((e) => setStatus(e));\n\tconst handleDepartment = useMutableCallback((e) => setDepartment(e));\n\tconst handleFrom = useMutableCallback((e) => setFrom(e.target.value));\n\tconst handleTo = useMutableCallback((e) => setTo(e.target.value));\n\tconst handleTags = useMutableCallback((e) => setTags(e));\n\n\tconst reset = useMutableCallback(() => {\n\t\tsetGuest('');\n\t\tsetServedBy('all');\n\t\tsetStatus('all');\n\t\tsetDepartment('all');\n\t\tsetFrom('');\n\t\tsetTo('');\n\t\tsetTags([]);\n\t\tsetCustomFields(undefined);\n\t});\n\n\tconst onSubmit = useMutableCallback((e) => e.preventDefault());\n\n\tuseEffect(() => {\n\t\tsetFilter((data) => ({\n\t\t\t...data,\n\t\t\tguest,\n\t\t\tservedBy,\n\t\t\tstatus,\n\t\t\tdepartment: department && department !== 'all' ? department : '',\n\t\t\tfrom: from && moment(new Date(from)).utc().format('YYYY-MM-DDTHH:mm:ss'),\n\t\t\tto: to && moment(new Date(to)).utc().format('YYYY-MM-DDTHH:mm:ss'),\n\t\t\ttags: tags.map((tag) => tag.label),\n\t\t\tcustomFields,\n\t\t}));\n\t}, [setFilter, guest, servedBy, status, department, from, to, tags, customFields]);\n\n\tconst handleClearFilters = useMutableCallback(() => {\n\t\treset();\n\t});\n\n\tconst removeClosedChats = useMethod('livechat:removeAllClosedRooms');\n\n\tconst handleRemoveClosed = useMutableCallback(async () => {\n\t\tconst onDeleteAll = async (): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tawait removeClosedChats();\n\t\t\t\treload?.();\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Chat_removed') });\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t\tsetModal(null);\n\t\t};\n\n\t\tconst handleClose = (): void => {\n\t\t\tsetModal(null);\n\t\t};\n\n\t\tsetModal(\n\t\t\t<GenericModal variant='danger' onConfirm={onDeleteAll} onClose={handleClose} onCancel={handleClose} confirmText={t('Delete')} />,\n\t\t);\n\t});\n\n\treturn (\n\t\t<Box mb={16} is='form' onSubmit={onSubmit} display='flex' flexDirection='column' {...props}>\n\t\t\t<Box display='flex' flexDirection='row' flexWrap='wrap' {...props}>\n\t\t\t\t<Box display='flex' mie={8} flexGrow={1} flexDirection='column'>\n\t\t\t\t\t<Label mb={4}>{t('Guest')}</Label>\n\t\t\t\t\t<TextInput placeholder={t('Guest')} onChange={handleGuest} value={guest} data-qa='current-chats-guest' />\n\t\t\t\t</Box>\n\t\t\t\t<Box display='flex' mie={8} flexGrow={1} flexDirection='column' data-qa='current-chats-servedBy'>\n\t\t\t\t\t<Label mb={4}>{t('Served_By')}</Label>\n\t\t\t\t\t<AutoCompleteAgent haveAll value={servedBy} onChange={handleServedBy} />\n\t\t\t\t</Box>\n\t\t\t\t<Box display='flex' mie={8} flexGrow={1} flexDirection='column'>\n\t\t\t\t\t<Label mb={4}>{t('Status')}</Label>\n\t\t\t\t\t<Select options={statusOptions} value={status} onChange={handleStatus} placeholder={t('Status')} data-qa='current-chats-status' />\n\t\t\t\t</Box>\n\t\t\t\t<Box display='flex' mie={8} flexGrow={0} flexDirection='column'>\n\t\t\t\t\t<Label mb={4}>{t('From')}</Label>\n\t\t\t\t\t<InputBox type='date' placeholder={t('From')} onChange={handleFrom} value={from} data-qa='current-chats-from' color='default' />\n\t\t\t\t</Box>\n\t\t\t\t<Box display='flex' mie={8} flexGrow={0} flexDirection='column'>\n\t\t\t\t\t<Label mb={4}>{t('To')}</Label>\n\t\t\t\t\t<InputBox type='date' placeholder={t('To')} onChange={handleTo} value={to} data-qa='current-chats-to' color='default' />\n\t\t\t\t</Box>\n\n\t\t\t\t<RemoveAllClosed\n\t\t\t\t\thandleClearFilters={handleClearFilters}\n\t\t\t\t\thandleRemoveClosed={handleRemoveClosed}\n\t\t\t\t\thasCustomFields={hasCustomFields}\n\t\t\t\t/>\n\t\t\t</Box>\n\t\t\t<Box display='flex' marginBlockStart={8} flexGrow={1} flexDirection='column'>\n\t\t\t\t<Box display='flex' mie={8} flexGrow={1} flexDirection='column'>\n\t\t\t\t\t<Label mb={4}>{t('Department')}</Label>\n\t\t\t\t\t<AutoCompleteDepartment haveAll showArchived value={department} onChange={handleDepartment} onlyMyDepartments />\n\t\t\t\t</Box>\n\t\t\t</Box>\n\t\t\t{CurrentChatTags && (\n\t\t\t\t<Box display='flex' flexDirection='row' marginBlockStart={8} {...props}>\n\t\t\t\t\t<Box display='flex' mie={8} flexGrow={1} flexDirection='column'>\n\t\t\t\t\t\t<Label mb={4}>{t('Tags')}</Label>\n\t\t\t\t\t\t<CurrentChatTags value={tags} handler={handleTags} viewAll />\n\t\t\t\t\t</Box>\n\t\t\t\t</Box>\n\t\t\t)}\n\t\t</Box>\n\t);\n};\n\nexport default FilterByText;\n",null],"names":["_extends","_objectSpread","_objectWithoutProperties","TextInput","Box","Select","InputBox","useMutableCallback","useLocalStorage","useSetModal","useToastMessageDispatch","useMethod","useTranslation","moment","React","useEffect","AutoCompleteAgent","AutoCompleteDepartment","GenericModal","CurrentChatTags","Label","RemoveAllClosed","module","link","default","v","exportDefault","_ref","setFilter","reload","customFields","setCustomFields","hasCustomFields","props","_excluded","setModal","dispatchToastMessage","t","statusOptions","guest","setGuest","servedBy","setServedBy","status","setStatus","department","setDepartment","from","setFrom","to","setTo","tags","setTags","handleGuest","e","target","value","handleServedBy","handleStatus","handleDepartment","handleFrom","handleTo","handleTags","reset","undefined","onSubmit","preventDefault","data","Date","utc","format","map","tag","label","handleClearFilters","removeClosedChats","handleRemoveClosed","onDeleteAll","type","message","error","handleClose","createElement","variant","onConfirm","onClose","onCancel","confirmText","mb","is","display","flexDirection","flexWrap","mie","flexGrow","placeholder","onChange","haveAll","options","color","marginBlockStart","showArchived","onlyMyDepartments","handler","viewAll"],"mappings":"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"}