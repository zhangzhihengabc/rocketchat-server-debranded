function module(e,t,n){let a,r,l,i,o,s,c,m,d,u,h,k,y,g,p,E,v,C,f,T,_,b,P,S,w,x,q,F,I,O,B,G,L,A,N;let M=["current","itemsPerPage","setItemsPerPage","setCurrent"];n.link("@babel/runtime/helpers/extends",{default(e){a=e}},0),n.link("@babel/runtime/helpers/objectWithoutProperties",{default(e){r=e}},1),n.link("@babel/runtime/helpers/objectSpread2",{default(e){l=e}},2),n.link("@rocket.chat/fuselage",{Callout(e){i=e},Pagination(e){o=e}},0),n.link("@rocket.chat/fuselage-hooks",{useMutableCallback(e){s=e}},1),n.link("@rocket.chat/ui-contexts",{usePermission(e){c=e},useTranslation(e){m=e}},2),n.link("@tanstack/react-query",{hashQueryKey(e){d=e}},3),n.link("moment",{default(e){u=e}},4),n.link("react",{default(e){h=e},memo(e){k=e},useCallback(e){y=e},useMemo(e){g=e},useState(e){p=e}},5),n.link("../../../../ee/client/omnichannel/components/RoomActivityIcon",{RoomActivityIcon(e){E=e}},6),n.link("../../../../ee/client/omnichannel/hooks/useOmnichannelPriorities",{useOmnichannelPriorities(e){v=e}},7),n.link("../../../../ee/client/omnichannel/priorities/PriorityIcon",{PriorityIcon(e){C=e}},8),n.link("../../../components/GenericNoResults",{default(e){f=e}},9),n.link("../../../components/GenericTable",{GenericTable(e){T=e},GenericTableBody(e){_=e},GenericTableCell(e){b=e},GenericTableHeader(e){P=e},GenericTableHeaderCell(e){S=e},GenericTableLoadingTable(e){w=e},GenericTableRow(e){x=e}},10),n.link("../../../components/GenericTable/hooks/usePagination",{usePagination(e){q=e}},11),n.link("../../../components/GenericTable/hooks/useSort",{useSort(e){F=e}},12),n.link("../../../components/Page",{default(e){I=e}},13),n.link("../../../hooks/omnichannel/useIsOverMacLimit",{useIsOverMacLimit(e){O=e}},14),n.link("./CustomFieldsList",{default(e){B=e}},15),n.link("./FilterByText",{default(e){G=e}},16),n.link("./RemoveChatButton",{default(e){L=e}},17),n.link("./hooks/useAllCustomFields",{useAllCustomFields(e){A=e}},18),n.link("./hooks/useCurrentChats",{useCurrentChats(e){N=e}},19);let j=e=>"asc"===e?1:-1,R=(e,t,n,a,r)=>{let{guest:i,servedBy:o,department:s,status:c,from:m,to:d,tags:h}=e,[k,y]=n,g=l(l(l({},i&&{roomName:i}),{},{sort:JSON.stringify({[k]:j(y),ts:"ts"===k?j(y):void 0})},r&&{count:r}),a&&{offset:a});if((m||d)&&(g.createdAt=JSON.stringify(l(l({},m&&{start:u(new Date(m)).set({hour:0,minutes:0,seconds:0}).toISOString()}),d&&{end:u(new Date(d)).set({hour:23,minutes:59,seconds:59}).toISOString()}))),"all"!==c&&(g.open="opened"===c||"onhold"===c,g.onhold="onhold"===c),o&&"all"!==o&&(g.agents=[o]),s&&"all"!==s&&(g.departmentId=s),h&&h.length>0&&(g.tags=h),t&&Object.keys(t).length>0){let e=Object.fromEntries(Object.entries(t).filter(e=>void 0!==e[1]&&""!==e[1]));Object.keys(e).length>0&&(g.customFields=JSON.stringify(e))}return g};n.exportDefault(k(e=>{let{id:t,onRowClick:n}=e,k=O(),{sortBy:j,sortDirection:D,setSort:H}=F("ts","desc"),[W,J]=p(),K=m(),Q=c("remove-closed-livechat-room"),{enabled:z}=v(),{data:U}=A(),V=q(),{current:X,itemsPerPage:Y,setItemsPerPage:Z,setCurrent:$}=V,ee=r(V,M),[et,en]=p({guest:"",fname:"",servedBy:"",status:"all",department:"",from:"",to:"",tags:[]}),ea=g(()=>{var e;return!!(null!=U&&null!==(e=U.customFields)&&void 0!==e&&e.find(e=>"room"===e.scope))},[U]),er=g(()=>R(et,W,[j,D],X,Y),[W,Y,et,j,D,X]),{data:el,isLoading:ei,isSuccess:eo}=N(er),[es]=p(d([er])),ec=es!==d([er]),em=s(e=>{en(e),$(0)}),ed=y(e=>{let{_id:t,fname:a,servedBy:r,ts:l,lm:i,department:o,open:s,onHold:c,priorityWeight:m}=e;return h.createElement(x,{key:t,onClick:()=>n(t),action:!0},z&&h.createElement(b,{withTruncatedText:!0,"data-qa":"current-chats-cell-priority"},h.createElement(C,{level:m})),h.createElement(b,{withTruncatedText:!0,"data-qa":"current-chats-cell-name"},a),h.createElement(b,{withTruncatedText:!0,"data-qa":"current-chats-cell-department"},o?o.name:""),h.createElement(b,{withTruncatedText:!0,"data-qa":"current-chats-cell-servedBy"},null==r?void 0:r.username),h.createElement(b,{withTruncatedText:!0,"data-qa":"current-chats-cell-startedAt"},u(l).format("L LTS")),h.createElement(b,{withTruncatedText:!0,"data-qa":"current-chats-cell-lastMessage"},u(i).format("L LTS")),h.createElement(b,{withTruncatedText:!0,"data-qa":"current-chats-cell-status"},h.createElement(E,{room:e})," ",s?c?K("On_Hold_Chats"):K("Open"):K("Closed")),Q&&!s&&h.createElement(L,{_id:t}))},[Q,n,z,K]),eu=h.createElement(h.Fragment,null,z&&h.createElement(S,{key:"priorityWeight",direction:D,active:"priorityWeight"===j,onClick:H,sort:"priorityWeight",w:"x100",alignItems:"center"},K("Priority")),h.createElement(S,{key:"fname",direction:D,active:"fname"===j,onClick:H,sort:"fname","data-qa":"current-chats-header-name"},K("Name")),h.createElement(S,{key:"departmentId",direction:D,active:"departmentId"===j,onClick:H,sort:"departmentId","data-qa":"current-chats-header-department"},K("Department")),h.createElement(S,{key:"servedBy",direction:D,active:"servedBy"===j,onClick:H,sort:"servedBy","data-qa":"current-chats-header-servedBy"},K("Served_By")),h.createElement(S,{key:"ts",direction:D,active:"ts"===j,onClick:H,sort:"ts","data-qa":"current-chats-header-startedAt"},K("Started_At")),h.createElement(S,{key:"lm",direction:D,active:"lm"===j,onClick:H,sort:"lm","data-qa":"current-chats-header-lastMessage"},K("Last_Message")),h.createElement(S,{key:"open",direction:D,active:"open"===j,onClick:H,sort:"open",w:"x100","data-qa":"current-chats-header-status"},K("Status")),Q&&h.createElement(S,{key:"remove",w:"x60","data-qa":"current-chats-header-remove"},K("Remove")));return h.createElement(I,{flexDirection:"row"},h.createElement(I,null,h.createElement(I.Header,{title:K("Current_Chats")}),h.createElement(I.Content,null,(eo&&(null==el?void 0:el.rooms.length)>0||ec)&&h.createElement(G,{setFilter:em,setCustomFields:J,customFields:W,hasCustomFields:ea}),k&&h.createElement(i,{type:"danger",icon:"warning",title:K("The_workspace_has_exceeded_the_monthly_limit_of_active_contacts"),style:{marginBlock:"2rem"}},K("Talk_to_your_workspace_admin_to_address_this_issue")),eo&&(null==el?void 0:el.rooms.length)===0&&ec&&h.createElement(f,null),eo&&(null==el?void 0:el.rooms.length)===0&&!ec&&h.createElement(f,{icon:"discussion",title:K("No_chats_yet"),description:K("No_chats_yet_description"),linkHref:"https://go.rocket.chat/omnichannel-docs",linkText:K("Learn_more_about_current_chats")}),ei&&h.createElement(T,null,h.createElement(P,null,eu),h.createElement(_,null,h.createElement(w,{headerCells:6}))),eo&&(null==el?void 0:el.rooms.length)>0&&h.createElement(h.Fragment,null,h.createElement(T,null,h.createElement(P,null,eu),h.createElement(_,{"data-qa":"GenericTableCurrentChatsBody"},el.rooms.map(e=>ed(l({},e))))),h.createElement(o,a({divider:!0,current:X,itemsPerPage:Y,count:el.total,onSetItemsPerPage:Z,onSetCurrent:$},ee))))),"custom-fields"===t&&ea&&h.createElement(B,{setCustomFields:J,allCustomFields:(null==U?void 0:U.customFields)||[]}))}))}
//# sourceMappingURL=/dynamic/client/views/omnichannel/currentChats/056c5966153b819462130cbe679dfed09caaea18.map
