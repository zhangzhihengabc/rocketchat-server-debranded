)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/contactHistory/MessageList/ContactHistoryMessagesList.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Box, Icon, Margins, States, StatesIcon, StatesSubtitle, StatesTitle, TextInput, Throbber } from '@rocket.chat/fuselage';\nimport { useSetting, useTranslation, useUserPreference } from '@rocket.chat/ui-contexts';\nimport type { ChangeEvent, Dispatch, ReactElement, SetStateAction } from 'react';\nimport React, { useMemo, useState } from 'react';\nimport { Virtuoso } from 'react-virtuoso';\n\nimport {\n\tContextualbarHeader,\n\tContextualbarAction,\n\tContextualbarIcon,\n\tContextualbarTitle,\n\tContextualbarClose,\n\tContextualbarContent,\n\tContextualbarEmptyContent,\n} from '../../../../components/Contextualbar';\nimport ScrollableContentWrapper from '../../../../components/ScrollableContentWrapper';\nimport { useRecordList } from '../../../../hooks/lists/useRecordList';\nimport { AsyncStatePhase } from '../../../../lib/asyncState';\nimport { isMessageNewDay } from '../../../room/MessageList/lib/isMessageNewDay';\nimport { isMessageSequential } from '../../../room/MessageList/lib/isMessageSequential';\nimport ContactHistoryMessage from './ContactHistoryMessage';\nimport { useHistoryMessageList } from './useHistoryMessageList';\n\nconst ContactHistoryMessagesList = ({\n\tchatId,\n\tsetChatId,\n\tclose,\n}: {\n\tchatId: string;\n\tsetChatId: Dispatch<SetStateAction<string>>;\n\tclose: () => void;\n}): ReactElement => {\n\tconst [text, setText] = useState('');\n\tconst t = useTranslation();\n\tconst showUserAvatar = !!useUserPreference<boolean>('displayAvatars');\n\tconst { itemsList: messageList, loadMoreItems } = useHistoryMessageList(\n\t\tuseMemo(() => ({ roomId: chatId, filter: text }), [chatId, text]),\n\t);\n\n\tconst handleSearchChange = (event: ChangeEvent<HTMLInputElement>): void => {\n\t\tsetText(event.currentTarget.value);\n\t};\n\n\tconst { phase, error, items: messages, itemCount: totalItemCount } = useRecordList(messageList);\n\tconst messageGroupingPeriod = Number(useSetting('Message_GroupingPeriod'));\n\n\treturn (\n\t\t<>\n\t\t\t<ContextualbarHeader>\n\t\t\t\t<ContextualbarAction onClick={(): void => setChatId('')} title={t('Back')} name='arrow-back' />\n\t\t\t\t<ContextualbarIcon name='history' />\n\t\t\t\t<ContextualbarTitle>{t('Chat_History')}</ContextualbarTitle>\n\t\t\t\t<ContextualbarClose onClick={close} />\n\t\t\t</ContextualbarHeader>\n\n\t\t\t<ContextualbarContent paddingInline={0}>\n\t\t\t\t<Box\n\t\t\t\t\tdisplay='flex'\n\t\t\t\t\tflexDirection='row'\n\t\t\t\t\tp={24}\n\t\t\t\t\tborderBlockEndWidth='default'\n\t\t\t\t\tborderBlockEndStyle='solid'\n\t\t\t\t\tborderBlockEndColor='extra-light'\n\t\t\t\t\tflexShrink={0}\n\t\t\t\t>\n\t\t\t\t\t<Box display='flex' flexDirection='row' flexGrow={1} mi='neg-x4'>\n\t\t\t\t\t\t<Margins inline={4}>\n\t\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\t\tplaceholder={t('Search')}\n\t\t\t\t\t\t\t\tvalue={text}\n\t\t\t\t\t\t\t\tonChange={handleSearchChange}\n\t\t\t\t\t\t\t\taddon={<Icon name='magnifier' size='x20' />}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Margins>\n\t\t\t\t\t</Box>\n\t\t\t\t</Box>\n\t\t\t\t{phase === AsyncStatePhase.LOADING && (\n\t\t\t\t\t<Box pi={24} pb={12}>\n\t\t\t\t\t\t<Throbber size='x12' />\n\t\t\t\t\t</Box>\n\t\t\t\t)}\n\t\t\t\t{error && (\n\t\t\t\t\t<States>\n\t\t\t\t\t\t<StatesIcon name='warning' variation='danger' />\n\t\t\t\t\t\t<StatesTitle>{t('Something_went_wrong')}</StatesTitle>\n\t\t\t\t\t\t<StatesSubtitle>{error.toString()}</StatesSubtitle>\n\t\t\t\t\t</States>\n\t\t\t\t)}\n\t\t\t\t{phase !== AsyncStatePhase.LOADING && totalItemCount === 0 && <ContextualbarEmptyContent title={t('No_results_found')} />}\n\t\t\t\t<Box flexGrow={1} flexShrink={1} overflow='hidden' display='flex'>\n\t\t\t\t\t{!error && totalItemCount > 0 && history.length > 0 && (\n\t\t\t\t\t\t<Virtuoso\n\t\t\t\t\t\t\ttotalCount={totalItemCount}\n\t\t\t\t\t\t\tendReached={\n\t\t\t\t\t\t\t\tphase === AsyncStatePhase.LOADING\n\t\t\t\t\t\t\t\t\t? (): void => undefined\n\t\t\t\t\t\t\t\t\t: (start): unknown => loadMoreItems(start, Math.min(50, totalItemCount - start))\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\toverscan={25}\n\t\t\t\t\t\t\tdata={messages}\n\t\t\t\t\t\t\tcomponents={{ Scroller: ScrollableContentWrapper as any }}\n\t\t\t\t\t\t\titemContent={(index, data): ReactElement => {\n\t\t\t\t\t\t\t\tconst lastMessage = messages[index - 1];\n\t\t\t\t\t\t\t\tconst isSequential = isMessageSequential(data, lastMessage, messageGroupingPeriod);\n\t\t\t\t\t\t\t\tconst isNewDay = isMessageNewDay(data, lastMessage);\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<ContactHistoryMessage message={data} sequential={isSequential} isNewDay={isNewDay} showUserAvatar={showUserAvatar} />\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t</Box>\n\t\t\t</ContextualbarContent>\n\t\t</>\n\t);\n};\n\nexport default ContactHistoryMessagesList;\n",null],"names":["Box","Icon","Margins","States","StatesIcon","StatesSubtitle","StatesTitle","TextInput","Throbber","useSetting","useTranslation","useUserPreference","React","useMemo","useState","Virtuoso","ContextualbarHeader","ContextualbarAction","ContextualbarIcon","ContextualbarTitle","ContextualbarClose","ContextualbarContent","ContextualbarEmptyContent","ScrollableContentWrapper","useRecordList","AsyncStatePhase","isMessageNewDay","isMessageSequential","ContactHistoryMessage","useHistoryMessageList","module","link","default","exportDefault","_ref","chatId","setChatId","close","text","setText","t","showUserAvatar","itemsList","messageList","loadMoreItems","roomId","filter","phase","error","items","messages","itemCount","totalItemCount","messageGroupingPeriod","Number","createElement","Fragment","onClick","title","name","paddingInline","display","flexDirection","p","borderBlockEndWidth","borderBlockEndStyle","borderBlockEndColor","flexShrink","flexGrow","mi","inline","placeholder","value","onChange","event","currentTarget","addon","size","LOADING","pi","pb","variation","toString","overflow","history","length","totalCount","endReached","undefined","start","Math","min","overscan","data","components","Scroller","itemContent","index","lastMessage","isSequential","isNewDay","message","sequential"],"mappings":"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"}