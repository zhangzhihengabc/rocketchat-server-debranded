)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/contactHistory/MessageList/useHistoryMessageList.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useCallback, useState } from 'react';\n\nimport { useScrollableMessageList } from '../../../../hooks/lists/useScrollableMessageList';\nimport { useComponentDidUpdate } from '../../../../hooks/useComponentDidUpdate';\nimport { MessageList } from '../../../../lib/lists/MessageList';\n\ntype HistoryMessageListOptions = {\n\tfilter: string;\n\troomId: string;\n};\n\nexport const useHistoryMessageList = (\n\toptions: HistoryMessageListOptions,\n): {\n\titemsList: MessageList;\n\tinitialItemCount: number;\n\tloadMoreItems: (start: number, end: number) => void;\n} => {\n\tconst [itemsList, setItemsList] = useState(() => new MessageList());\n\tconst reload = useCallback(() => setItemsList(new MessageList()), []);\n\n\tconst getMessages = useEndpoint('GET', '/v1/livechat/:rid/messages', { rid: options.roomId });\n\n\tuseComponentDidUpdate(() => {\n\t\toptions && reload();\n\t}, [options, reload]);\n\n\tconst fetchMessages = useCallback(\n\t\tasync (start, end) => {\n\t\t\tconst { messages, total } = await getMessages({\n\t\t\t\t...(options.filter && { searchTerm: options.filter }),\n\t\t\t\toffset: start,\n\t\t\t\tcount: end,\n\t\t\t\tsort: `{ \"ts\": 1 }`,\n\t\t\t});\n\t\t\treturn {\n\t\t\t\titems: messages,\n\t\t\t\titemCount: total,\n\t\t\t};\n\t\t},\n\t\t[getMessages, options.filter],\n\t);\n\n\tconst { loadMoreItems, initialItemCount } = useScrollableMessageList(itemsList, fetchMessages, 25);\n\n\treturn {\n\t\titemsList,\n\t\tloadMoreItems,\n\t\tinitialItemCount,\n\t};\n};\n",null],"names":["_objectSpread","useEndpoint","useCallback","useState","useScrollableMessageList","useComponentDidUpdate","MessageList","module","link","default","export","useHistoryMessageList","options","itemsList","setItemsList","reload","getMessages","rid","roomId","fetchMessages","start","end","messages","total","filter","searchTerm","offset","count","sort","items","itemCount","loadMoreItems","initialItemCount"],"mappings":"2BAAAA,EAAuDC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA9CC,EAAaC,IAAM,CAAA,uCAA2B,CAAAC,QAAAA,CAAAA,EAAAT,EAAAA,CAAA,CAAA,EAAA,GAAvDO,EAAOG,MAAE,CAAA,CAAAC,sBAAmB,IAAAA,CAA2B,GAAAJ,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAN,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,QAAAA,CAAAL,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,mDAAAA,CAAAH,yBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,0CAAAA,CAAAF,sBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,oCAAAA,CAAAD,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAYhD,IAAMK,EACZC,IAMA,GAAM,CAACC,EAAWC,EAAa,CAAGX,EAAS,IAAM,IAAIG,GAC/CS,EAASb,EAAY,IAAMY,EAAa,IAAIR,GAAgB,EAAE,EAE9DU,EAAcf,EAAY,MAAO,6BAA8B,CAAEgB,IAAKL,EAAQM,MAAAA,AAAM,GAE1Fb,EAAsB,KACrBO,GAAWG,GACZ,EAAG,CAACH,EAASG,EAAO,EAEpB,IAAMI,EAAgBjB,EACrB,MAAOkB,EAAOC,KACb,GAAM,CAAEC,SAAAA,CAAQ,CAAEC,MAAAA,CAAAA,CAAO,CAAG,MAAMP,EAAWhB,EAAAA,EAAA,CAAA,EACxCY,EAAQY,MAAM,EAAI,CAAEC,WAAYb,EAAQY,MAAAA,AAAM,GAAE,CAAA,EAAA,CACpDE,OAAQN,EACRO,MAAON,EACPO,KAAI,aAAe,IAEpB,MAAO,CACNC,MAAOP,EACPQ,UAAWP,EAEb,EACA,CAACP,EAAaJ,EAAQY,MAAM,CAAC,EAGxB,CAAEO,cAAAA,CAAa,CAAEC,iBAAAA,CAAAA,CAAkB,CAAG5B,EAAyBS,EAAWM,EAAe,IAE/F,MAAO,CACNN,UAAAA,EACAkB,cAAAA,EACAC,iBAAAA,EAEF"}