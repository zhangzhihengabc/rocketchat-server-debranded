)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/businessHours/EditBusinessHoursPage.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Button, ButtonGroup, Callout } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useToastMessageDispatch, useRoute, useMethod, useTranslation } from '@rocket.chat/ui-contexts';\nimport React, { useRef, useMemo, useState } from 'react';\n\nimport Page from '../../../components/Page';\nimport PageSkeleton from '../../../components/PageSkeleton';\nimport { AsyncStatePhase } from '../../../hooks/useAsyncState';\nimport { useEndpointData } from '../../../hooks/useEndpointData';\nimport BusinessHoursFormContainer from './BusinessHoursFormContainer';\nimport { useIsSingleBusinessHours } from './BusinessHoursRouter';\nimport { mapBusinessHoursForm } from './mapBusinessHoursForm';\n\nconst EditBusinessHoursPage = ({ id, type }) => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst isSingleBH = useIsSingleBusinessHours();\n\n\tconst { value: data, phase: state } = useEndpointData('/v1/livechat/business-hour', {\n\t\tparams: useMemo(() => ({ _id: id, type }), [id, type]),\n\t});\n\n\tconst saveData = useRef({ form: {} });\n\n\tconst [hasChanges, setHasChanges] = useState(false);\n\n\tconst save = useMethod('livechat:saveBusinessHour');\n\tconst deleteBH = useMethod('livechat:removeBusinessHour');\n\n\tconst router = useRoute('omnichannel-businessHours');\n\n\tconst handleSave = useMutableCallback(async () => {\n\t\tif (state !== AsyncStatePhase.RESOLVED || !data.success) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst {\n\t\t\tcurrent: { form, multiple: { departments, ...multiple } = {}, timezone: { name: timezoneName } = {} },\n\t\t} = saveData;\n\n\t\tif (data.businessHour.type !== 'default' && multiple.name === '') {\n\t\t\treturn dispatchToastMessage({\n\t\t\t\ttype: 'error',\n\t\t\t\tmessage: t('error-the-field-is-required', { field: t('Name') }),\n\t\t\t});\n\t\t}\n\n\t\tconst mappedForm = mapBusinessHoursForm(form, data.businessHour);\n\n\t\tconst departmentsToApplyBusinessHour = departments?.map((dep) => dep.value).join(',') || '';\n\n\t\ttry {\n\t\t\tconst payload = {\n\t\t\t\t...data.businessHour,\n\t\t\t\t...multiple,\n\t\t\t\tdepartmentsToApplyBusinessHour: departmentsToApplyBusinessHour ?? '',\n\t\t\t\ttimezoneName: timezoneName || data.businessHour.timezone.name,\n\t\t\t\tworkHours: mappedForm,\n\t\t\t};\n\n\t\t\tawait save(payload);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Business_hours_updated') });\n\t\t\trouter.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst handleDelete = useMutableCallback(async () => {\n\t\tif (type !== 'custom') {\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tawait deleteBH(id, type);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Business_Hour_Removed') });\n\t\t\trouter.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst handleReturn = useMutableCallback(() => {\n\t\trouter.push({});\n\t});\n\n\tif (state === AsyncStatePhase.LOADING) {\n\t\treturn <PageSkeleton />;\n\t}\n\n\tif (state === AsyncStatePhase.REJECTED || (AsyncStatePhase.RESOLVED && !data.businessHour)) {\n\t\treturn (\n\t\t\t<Page>\n\t\t\t\t<Page.Header title={t('Business_Hours')}>\n\t\t\t\t\t<Button onClick={handleReturn}>{t('Back')}</Button>\n\t\t\t\t</Page.Header>\n\t\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t\t<Callout type='danger'>{t('Error')}</Callout>\n\t\t\t\t</Page.ScrollableContentWithShadow>\n\t\t\t</Page>\n\t\t);\n\t}\n\n\treturn (\n\t\t<Page>\n\t\t\t<Page.Header title={t('Business_Hours')}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t{!isSingleBH && <Button onClick={handleReturn}>{t('Back')}</Button>}\n\t\t\t\t\t{type === 'custom' && (\n\t\t\t\t\t\t<Button danger onClick={handleDelete}>\n\t\t\t\t\t\t\t{t('Delete')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t<Button primary onClick={handleSave} disabled={!hasChanges}>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Header>\n\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t<BusinessHoursFormContainer data={data.businessHour} saveRef={saveData} onChange={setHasChanges} />\n\t\t\t</Page.ScrollableContentWithShadow>\n\t\t</Page>\n\t);\n};\n\nexport default EditBusinessHoursPage;\n",null],"names":["_objectSpread","_objectWithoutProperties","Button","ButtonGroup","Callout","useMutableCallback","useToastMessageDispatch","useRoute","useMethod","useTranslation","React","useRef","useMemo","useState","Page","PageSkeleton","AsyncStatePhase","useEndpointData","BusinessHoursFormContainer","useIsSingleBusinessHours","mapBusinessHoursForm","module","link","default","v","exportDefault","_ref","id","type","t","dispatchToastMessage","isSingleBH","value","data","phase","state","params","_id","saveData","form","hasChanges","setHasChanges","save","deleteBH","router","handleSave","RESOLVED","success","current","multiple","departments","timezone","name","timezoneName","_excluded","businessHour","message","field","mappedForm","departmentsToApplyBusinessHour","map","dep","join","payload","workHours","push","error","handleDelete","handleReturn","LOADING","createElement","REJECTED","Header","title","onClick","ScrollableContentWithShadow","danger","primary","disabled","saveRef","onChange"],"mappings":"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"}