)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/omnichannel/businessHours/BusinessHoursFormContainer.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { FieldGroup, Box } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport React, { useEffect, useState } from 'react';\n\nimport { businessHourManager } from '../../../../app/livechat/client/views/app/business-hours/BusinessHours';\nimport { useForm } from '../../../hooks/useForm';\nimport { useReactiveValue } from '../../../hooks/useReactiveValue';\nimport { BusinessHoursMultipleContainer } from '../additionalForms';\nimport BusinessHourForm from './BusinessHoursForm';\nimport BusinessHoursTimeZone from './BusinessHoursTimeZone';\n\nconst useChangeHandler = (name, ref) =>\n\tuseMutableCallback((val) => {\n\t\tref.current[name] = { ...ref.current[name], ...val };\n\t});\n\nconst getInitalData = ({ workHours }) => ({\n\tdaysOpen: workHours.filter(({ open }) => !!open).map(({ day }) => day),\n\tdaysTime: workHours.reduce((acc, { day, start: { time: start }, finish: { time: finish } }) => {\n\t\tacc = { ...acc, [day]: { start, finish } };\n\t\treturn acc;\n\t}, {}),\n});\n\nconst BusinessHoursFormContainer = ({ data, saveRef, onChange = () => {} }) => {\n\tconst [hasChangesMultiple, setHasChangesMultiple] = useState(false);\n\tconst [hasChangesTimeZone, setHasChangesTimeZone] = useState(false);\n\n\tconst showMultipleBHForm = useReactiveValue(useMutableCallback(() => businessHourManager.showCustomTemplate(data)));\n\n\tconst onChangeTimezone = useChangeHandler('timezone', saveRef);\n\tconst onChangeMultipleBHForm = useChangeHandler('multiple', saveRef);\n\n\tconst { values, handlers, hasUnsavedChanges } = useForm(getInitalData(data));\n\n\tsaveRef.current.form = values;\n\n\tuseEffect(() => {\n\t\tonChange(hasUnsavedChanges || (showMultipleBHForm && hasChangesMultiple) || hasChangesTimeZone);\n\t});\n\n\treturn (\n\t\t<Box maxWidth='600px' w='full' alignSelf='center'>\n\t\t\t<FieldGroup>\n\t\t\t\t{showMultipleBHForm && (\n\t\t\t\t\t<BusinessHoursMultipleContainer onChange={onChangeMultipleBHForm} data={data} hasChangesAndIsValid={setHasChangesMultiple} />\n\t\t\t\t)}\n\t\t\t\t<BusinessHoursTimeZone\n\t\t\t\t\tonChange={onChangeTimezone}\n\t\t\t\t\tdata={data?.timezone?.name ?? data?.timezoneName}\n\t\t\t\t\thasChanges={setHasChangesTimeZone}\n\t\t\t\t/>\n\t\t\t\t<BusinessHourForm values={values} handlers={handlers} />\n\t\t\t</FieldGroup>\n\t\t</Box>\n\t);\n};\n\nexport default BusinessHoursFormContainer;\n",null],"names":["_objectSpread","FieldGroup","Box","useMutableCallback","React","useEffect","useState","businessHourManager","useForm","useReactiveValue","BusinessHoursMultipleContainer","BusinessHourForm","BusinessHoursTimeZone","module","link","default","v","useChangeHandler","name","ref","val","current","getInitalData","_ref","workHours","daysOpen","filter","_ref2","open","map","_ref3","day","daysTime","reduce","acc","_ref4","start","time","finish","exportDefault","_ref5","_data$timezone$name","_data$timezone","data","saveRef","onChange","hasChangesMultiple","setHasChangesMultiple","hasChangesTimeZone","setHasChangesTimeZone","showMultipleBHForm","showCustomTemplate","onChangeTimezone","onChangeMultipleBHForm","values","handlers","hasUnsavedChanges","form","createElement","maxWidth","w","alignSelf","hasChangesAndIsValid","timezone","timezoneName","hasChanges"],"mappings":"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"}