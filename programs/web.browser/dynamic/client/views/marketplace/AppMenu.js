function module(e,a,t){let n,l,i,s,r,o,c,p,d,u,m,b,h,k,E,v,f,g,y,A,_,x,M,w,I,P,T,S,U,D,O,z;let C=["app","isAppDetailsPage"];t.link("@babel/runtime/helpers/extends",{default(e){n=e}},0),t.link("@babel/runtime/helpers/objectSpread2",{default(e){l=e}},1),t.link("@babel/runtime/helpers/objectWithoutProperties",{default(e){i=e}},2),t.link("@rocket.chat/fuselage",{Box(e){s=e},Icon(e){r=e},Menu(e){o=e},Skeleton(e){c=e}},0),t.link("@rocket.chat/ui-contexts",{useSetModal(e){p=e},useEndpoint(e){d=e},useTranslation(e){u=e},useRouteParameter(e){m=e},useToastMessageDispatch(e){b=e},usePermission(e){h=e},useRouter(e){k=e}},1),t.link("react",{default(e){E=e},useMemo(e){v=e},useCallback(e){f=e},useState(e){g=e}},2),t.link("semver",{default(e){y=e}},3),t.link("../../components/WarningModal",{default(e){A=e}},4),t.link("../../hooks/useIsEnterprise",{useIsEnterprise(e){_=e}},5),t.link("./IframeModal",{default(e){x=e}},6),t.link("./components/UninstallGrandfatheredAppModal/UninstallGrandfatheredAppModal",{default(e){M=e}},7),t.link("./helpers",{appEnabledStatuses(e){w=e},appButtonProps(e){I=e}},8),t.link("./helpers/handleAPIError",{handleAPIError(e){P=e}},9),t.link("./helpers/marketplaceActions",{marketplaceActions(e){T=e}},10),t.link("./helpers/warnEnableDisableApp",{warnEnableDisableApp(e){S=e}},11),t.link("./hooks/useAppInstallationHandler",{useAppInstallationHandler(e){U=e}},12),t.link("./hooks/useAppsCountQuery",{useAppsCountQuery(e){D=e}},13),t.link("./hooks/useOpenAppPermissionsReviewModal",{useOpenAppPermissionsReviewModal(e){O=e}},14),t.link("./hooks/useOpenIncompatibleModal",{useOpenIncompatibleModal(e){z=e}},15),t.exportDefault(function(e){var a,t,F;let{app:R,isAppDetailsPage:q}=e,G=i(e,C),H=u(),L=b(),V=p(),j=k(),B=m("context"),Q=m("tab"),W=d("POST","/apps/".concat(R.id,"/status")),Y=d("GET","/apps"),N=d("POST","/apps/".concat(R.id,"/sync")),J=d("DELETE","/apps/".concat(R.id)),{data:K}=_(),X=!!(null!=K&&K.isEnterprise),[Z,$]=g(!1),[ee,ea]=g(R.requestedEndUser),et="subscription"===R.purchaseType,en=R.subscriptionInfo&&["active","trialing"].includes(R.subscriptionInfo.status),el=w.includes(R.status),[ei,es]=g(null==R?void 0:R.isPurchased),er=h("manage-apps"),eo=D(B),ec=z(),ep=I(l(l({},R),{},{isAdminUser:er})),ed=(null==ep?void 0:ep.action)||"",eu=f(()=>{V(null),$(!1)},[V,$]),em=f(async(e,a)=>{"purchase"===e&&es(!0),"request"===e?ea(!0):await T[e](l(l({},R),{},{permissionsGranted:a})),$(!1)},[R,$]),eb=O({app:R,onCancel:eu,onConfirm:e=>em(ed,e)}),eh=U({app:R,isAppPurchased:ei,action:ed,onDismiss:eu,onSuccess:em}),ek=f(()=>{$(!0),eh()},[eh,$]),eE=f(async()=>{let e;if(null!=R&&R.versionIncompatible&&!en){ec(R,"subscribe",eu);return}try{e=await Y({buildExternalUrl:"true",appId:R.id,purchaseType:R.purchaseType,details:!0})}catch(e){P(e);return}let a=async()=>{try{await N()}catch(e){P(e)}};V(E.createElement(x,{url:e.url,confirm:a,cancel:eu}))},[R,en,V,eu,ec,Y,N]),ev=f(()=>{j.navigate({name:"marketplace",params:{context:B,page:"info",id:R.id,version:R.version,tab:"logs"}})},[R.id,R.version,B,j]),ef=f(()=>{let e=async()=>{eu();try{let{status:e}=await W({status:"manually_disabled"});S(R.name,e,"disable")}catch(e){P(e)}};V(E.createElement(A,{close:eu,confirm:e,text:H("Apps_Marketplace_Deactivate_App_Prompt"),confirmText:H("Yes")}))},[R.name,eu,W,V,H]),eg=f(async()=>{try{let{status:e}=await W({status:"manually_enabled"});S(R.name,e,"enable")}catch(e){P(e)}},[R.name,W]),ey=f(()=>{let e=async()=>{eu();try{let{success:e}=await J();e&&(L({type:"success",message:"".concat(R.name," uninstalled")}),"details"===B&&"details"!==Q&&j.navigate({name:"marketplace",params:l(l({},j.getRouteParameters()),{},{tab:"details"})},{replace:!0}))}catch(e){P(e)}};if(en){let a=async()=>{await eE()};V(E.createElement(A,{close:eu,cancel:e,confirm:a,text:H("Apps_Marketplace_Uninstall_Subscribed_App_Prompt"),confirmText:H("Apps_Marketplace_Modify_App_Subscription"),cancelText:H("Apps_Marketplace_Uninstall_Subscribed_App_Anyway")}))}if(eo.data){if(R.migrated){V(E.createElement(M,{context:B,appName:R.name,limit:eo.data.limit,handleUninstall:e,handleClose:eu}));return}V(E.createElement(A,{close:eu,confirm:e,text:H("Apps_Marketplace_Uninstall_App_Prompt"),confirmText:H("Yes")}))}},[en,eo.data,R.migrated,R.name,V,eu,H,J,L,B,Q,j,eE]),eA=f((e,a)=>e.versionIncompatible?("subscribe"!==a||en)&&"install"!==a&&"update"!==a?"card":"warning":"update"===a?"refresh":"card",[en]),e_=f(async()=>{if($(!0),null!=R&&R.versionIncompatible){ec(R,"update",eu);return}eb()},[R,eb,ec,eu]),ex=R.installed&&R.version&&R.marketplaceVersion&&y.lt(R.version,R.marketplaceVersion),eM=v(()=>{var e,a,t;let n=l({},et&&en&&er&&{subscribe:{label:E.createElement(E.Fragment,null,E.createElement(r,{name:eA(R,"subscribe"),size:"x16",mie:4}),H("Subscription")),action:eE}}),i=l({},!R.installed&&ep&&{acquire:{label:E.createElement(E.Fragment,null,er&&E.createElement(r,{name:eA(R,"install"),size:"x16",mie:4}),H(ep.label.replace(" ","_"))),action:ek,disabled:ee}}),o=R.isEnterpriseOnly&&X||!R.isEnterpriseOnly,c=R.installed&&er&&!el&&o,p=!R.migrated&&!(null!=eo&&null!==(e=eo.data)&&void 0!==e&&e.hasUnlimitedApps)&&(null==eo?void 0:null===(a=eo.data)||void 0===a?void 0:a.enabled)>=(null==eo?void 0:null===(t=eo.data)||void 0===t?void 0:t.limit),d=l(l(l(l(l(l({},"details"!==B&&er&&R.installed&&{viewLogs:{label:E.createElement(E.Fragment,null,E.createElement(r,{name:"desktop-text",size:"x16",mie:4}),H("View_Logs")),action:ev}}),er&&ex&&!q&&{update:{label:E.createElement(E.Fragment,null,E.createElement(r,{name:eA(R,"update"),size:"x16",mie:4}),H("Update")),action:e_}}),R.installed&&er&&el&&{disable:{label:E.createElement(s,{color:"status-font-on-warning"},E.createElement(r,{name:"ban",size:"x16",mie:4}),H("Disable")),action:ef}}),c&&{enable:{label:E.createElement(E.Fragment,null,E.createElement(r,{name:"check",size:"x16",marginInlineEnd:"x4"}),H("Enable")),disabled:p,action:eg}}),R.installed&&er&&{divider:{type:"divider"}}),R.installed&&er&&{uninstall:{label:E.createElement(s,{color:"status-font-on-danger"},E.createElement(r,{name:"trash",size:"x16",mie:4}),H("Uninstall")),action:ey}});return l(l(l({},n),i),d)},[et,en,er,eA,R,H,eE,ep,ek,ee,X,el,null==eo?void 0:null===(a=eo.data)||void 0===a?void 0:a.hasUnlimitedApps,null==eo?void 0:null===(t=eo.data)||void 0===t?void 0:t.enabled,null==eo?void 0:null===(F=eo.data)||void 0===F?void 0:F.limit,B,ev,ex,q,e_,ef,eg,ey]);return Z?E.createElement(c,{variant:"rect",height:"x28",width:"x28"}):!er&&null!=R&&R.installed?null:E.createElement(o,n({title:H("More_options"),options:eM,placement:"bottom-start",maxHeight:"initial"},G))})}
//# sourceMappingURL=/dynamic/client/views/marketplace/562328672c4ccb98bc9e1af28c8ad2805e10a3ec.map
