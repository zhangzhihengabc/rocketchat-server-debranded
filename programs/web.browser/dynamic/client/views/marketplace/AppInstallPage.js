function module(e,l,t){let a,n,r,i,o,p,s,c,u,m,d,k,h,f,E,A,y,x,F,g,w,C,I,b,_,v,U,P,M,S,R,O,z,D,B;t.link("@babel/runtime/helpers/extends",{default(e){a=e}},0),t.link("@rocket.chat/fuselage",{Button(e){n=e},ButtonGroup(e){r=e},Icon(e){i=e},Field(e){o=e},FieldGroup(e){p=e},FieldLabel(e){s=e},FieldRow(e){c=e},TextInput(e){u=e}},0),t.link("@rocket.chat/fuselage-hooks",{useUniqueId(e){m=e}},1),t.link("@rocket.chat/ui-contexts",{useSetModal(e){d=e},useEndpoint(e){k=e},useUpload(e){h=e},useTranslation(e){f=e},useRouteParameter(e){E=e},useRouter(e){A=e},useSearchParameter(e){y=e}},2),t.link("react",{default(e){x=e},useCallback(e){F=e},useState(e){g=e}},3),t.link("react-hook-form",{useForm(e){w=e},Controller(e){C=e}},4),t.link("../../../ee/client/apps/orchestrator",{AppClientOrchestratorInstance(e){I=e}},5),t.link("../../components/Page",{default(e){b=e}},6),t.link("../../contexts/hooks/useAppsReload",{useAppsReload(e){_=e}},7),t.link("../../hooks/useExternalLink",{useExternalLink(e){v=e}},8),t.link("../../hooks/useFileInput",{useFileInput(e){U=e}},9),t.link("../admin/subscription/hooks/useCheckoutUrl",{useCheckoutUrl(e){P=e}},10),t.link("./AppPermissionsReviewModal",{default(e){M=e}},11),t.link("./AppUpdateModal",{default(e){S=e}},12),t.link("./components/AppInstallModal/AppInstallModal",{default(e){R=e}},13),t.link("./helpers/handleAPIError",{handleAPIError(e){O=e}},14),t.link("./helpers/handleInstallError",{handleInstallError(e){z=e}},15),t.link("./hooks/useAppsCountQuery",{useAppsCountQuery(e){D=e}},16),t.link("./lib/getManifestFromZippedApp",{getManifestFromZippedApp(e){B=e}},17),t.exportDefault(function(){let e=f(),l=_(),t=A(),L=E("context"),T=d(),G=y("id"),N=y("url"),[Q,Z]=g(!1),q=G?"/apps/".concat(G):"/apps",H=k("POST",q),J=h(q),V=h("".concat(q,"/update")),W=D("private"),j=v(),K=P()({target:"marketplace-app-install",action:"Enable_unlimited_apps"}),{control:X,setValue:Y,watch:$}=w({defaultValues:{url:N||""}}),{file:ee,url:el}=$(),et=!!el||!!(null!=ee&&ee.name),[ea]=U(e=>Y("file",e),"app"),en=async(e,a,n)=>{let r;let i=new FormData;i.append("app",a,a.name),i.append("permissions",JSON.stringify(e));try{n?await V(i):r=await J(i),t.navigate({name:"marketplace",params:{context:"private",page:"info",id:n||r.app.id}}),l()}catch(e){O(e)}finally{Z(!1),T(null)}},er=F(()=>{Z(!1),T(null)},[Z,T]),ei=async e=>{try{let l=await I.getApp(e);return!!l}catch(e){return!1}},eo=async(e,l,t)=>{T(x.createElement(M,{appPermissions:e,onCancel:er,onConfirm:e=>en(e,l,t)}))},ep=async(e,l)=>{let{id:t,permissions:a}=l,n=await ei(t);if(n)return T(x.createElement(S,{cancel:er,confirm:()=>eo(a,e,t)}));await eo(a,e)},es=async()=>{try{let e,l;if(el){let{buff:t}=await H({url:el,downloadOnly:!0}),a=Uint8Array.from(t.data);e=await B(a),l=new File([a],"app.zip",{type:"application/zip"})}else l=ee,e=await B(l);return{appFile:l,manifest:e}}catch(e){return z(e),{appFile:null,manifest:null}}},ec=async()=>{if(Z(!0),!W.data)return er();let{appFile:e,manifest:l}=await es();return e&&l?W.data.hasUnlimitedApps?ep(e,l):void T(x.createElement(R,{context:L,enabled:W.data.enabled,limit:W.data.limit,appName:l.name,handleClose:er,handleConfirm:()=>ep(e,l),handleEnableUnlimitedApps:()=>{j(K),T(null)}})):er()},eu=m(),em=m();return x.createElement(b,{flexDirection:"column"},x.createElement(b.Header,{title:e("App_Installation")}),x.createElement(b.ScrollableContent,null,x.createElement(p,{display:"flex",flexDirection:"column",alignSelf:"center",maxWidth:"x600",w:"full"},x.createElement(o,null,x.createElement(s,{htmlFor:eu},e("App_Url_to_Install_From")),x.createElement(c,null,x.createElement(C,{name:"url",control:X,render:e=>{let{field:l}=e;return x.createElement(u,a({id:eu,placeholder:"https://rocket.chat/apps/package.zip",addon:x.createElement(i,{name:"permalink",size:"x20"})},l))}}))),x.createElement(o,null,x.createElement(s,{htmlFor:em},e("App_Url_to_Install_From_File")),x.createElement(c,null,x.createElement(C,{name:"file",control:X,render:l=>{var t;let{field:r}=l;return x.createElement(u,a({id:em,readOnly:!0},r,{value:(null===(t=r.value)||void 0===t?void 0:t.name)||"",addon:x.createElement(n,{icon:"upload",small:!0,primary:!0,onClick:ea,mb:"neg-x4",mie:"neg-x8"},e("Browse_Files"))}))}}))),x.createElement(o,null,x.createElement(r,null,x.createElement(n,{disabled:!et,loading:Q,onClick:ec},e("Install")),x.createElement(n,{onClick:()=>{t.navigate({name:"marketplace",params:{context:L,page:"list"}})}},e("Cancel")))))))})}
//# sourceMappingURL=/dynamic/client/views/marketplace/8d7caa9eedf598e7e1221b887a4131beb8f039b0.map
