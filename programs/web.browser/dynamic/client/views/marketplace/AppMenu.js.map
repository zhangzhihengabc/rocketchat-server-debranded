)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/marketplace/AppMenu.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Box, Icon, Menu, Skeleton } from '@rocket.chat/fuselage';\nimport {\n\tuseSetModal,\n\tuseEndpoint,\n\tuseTranslation,\n\tuseRouteParameter,\n\tuseToastMessageDispatch,\n\tusePermission,\n\tuseRouter,\n} from '@rocket.chat/ui-contexts';\nimport React, { useMemo, useCallback, useState } from 'react';\nimport semver from 'semver';\n\nimport WarningModal from '../../components/WarningModal';\nimport { useIsEnterprise } from '../../hooks/useIsEnterprise';\nimport IframeModal from './IframeModal';\nimport UninstallGrandfatheredAppModal from './components/UninstallGrandfatheredAppModal/UninstallGrandfatheredAppModal';\nimport { appEnabledStatuses, appButtonProps } from './helpers';\nimport { handleAPIError } from './helpers/handleAPIError';\nimport { marketplaceActions } from './helpers/marketplaceActions';\nimport { warnEnableDisableApp } from './helpers/warnEnableDisableApp';\nimport { useAppInstallationHandler } from './hooks/useAppInstallationHandler';\nimport { useAppsCountQuery } from './hooks/useAppsCountQuery';\nimport { useOpenAppPermissionsReviewModal } from './hooks/useOpenAppPermissionsReviewModal';\nimport { useOpenIncompatibleModal } from './hooks/useOpenIncompatibleModal';\n\nfunction AppMenu({ app, isAppDetailsPage, ...props }) {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst setModal = useSetModal();\n\tconst router = useRouter();\n\n\tconst context = useRouteParameter('context');\n\tconst currentTab = useRouteParameter('tab');\n\n\tconst setAppStatus = useEndpoint('POST', `/apps/${app.id}/status`);\n\tconst buildExternalUrl = useEndpoint('GET', '/apps');\n\tconst syncApp = useEndpoint('POST', `/apps/${app.id}/sync`);\n\tconst uninstallApp = useEndpoint('DELETE', `/apps/${app.id}`);\n\tconst { data } = useIsEnterprise();\n\n\tconst isEnterpriseLicense = !!data?.isEnterprise;\n\n\tconst [loading, setLoading] = useState(false);\n\tconst [requestedEndUser, setRequestedEndUser] = useState(app.requestedEndUser);\n\n\tconst canAppBeSubscribed = app.purchaseType === 'subscription';\n\tconst isSubscribed = app.subscriptionInfo && ['active', 'trialing'].includes(app.subscriptionInfo.status);\n\tconst isAppEnabled = appEnabledStatuses.includes(app.status);\n\tconst [isAppPurchased, setPurchased] = useState(app?.isPurchased);\n\n\tconst isAdminUser = usePermission('manage-apps');\n\tconst appCountQuery = useAppsCountQuery(context);\n\tconst openIncompatibleModal = useOpenIncompatibleModal();\n\n\tconst button = appButtonProps({ ...app, isAdminUser });\n\tconst action = button?.action || '';\n\n\tconst closeModal = useCallback(() => {\n\t\tsetModal(null);\n\t\tsetLoading(false);\n\t}, [setModal, setLoading]);\n\n\tconst installationSuccess = useCallback(\n\t\tasync (action, permissionsGranted) => {\n\t\t\tif (action === 'purchase') {\n\t\t\t\tsetPurchased(true);\n\t\t\t}\n\n\t\t\tif (action === 'request') {\n\t\t\t\tsetRequestedEndUser(true);\n\t\t\t} else {\n\t\t\t\tawait marketplaceActions[action]({ ...app, permissionsGranted });\n\t\t\t}\n\n\t\t\tsetLoading(false);\n\t\t},\n\t\t[app, setLoading],\n\t);\n\n\tconst openPermissionModal = useOpenAppPermissionsReviewModal({\n\t\tapp,\n\t\tonCancel: closeModal,\n\t\tonConfirm: (permissionsGranted) => installationSuccess(action, permissionsGranted),\n\t});\n\n\tconst appInstallationHandler = useAppInstallationHandler({\n\t\tapp,\n\t\tisAppPurchased,\n\t\taction,\n\t\tonDismiss: closeModal,\n\t\tonSuccess: installationSuccess,\n\t});\n\n\tconst handleAcquireApp = useCallback(() => {\n\t\tsetLoading(true);\n\t\tappInstallationHandler();\n\t}, [appInstallationHandler, setLoading]);\n\n\tconst handleSubscription = useCallback(async () => {\n\t\tif (app?.versionIncompatible && !isSubscribed) {\n\t\t\topenIncompatibleModal(app, 'subscribe', closeModal);\n\t\t\treturn;\n\t\t}\n\n\t\tlet data;\n\t\ttry {\n\t\t\tdata = await buildExternalUrl({\n\t\t\t\tbuildExternalUrl: 'true',\n\t\t\t\tappId: app.id,\n\t\t\t\tpurchaseType: app.purchaseType,\n\t\t\t\tdetails: true,\n\t\t\t});\n\t\t} catch (error) {\n\t\t\thandleAPIError(error);\n\t\t\treturn;\n\t\t}\n\n\t\tconst confirm = async () => {\n\t\t\ttry {\n\t\t\t\tawait syncApp();\n\t\t\t} catch (error) {\n\t\t\t\thandleAPIError(error);\n\t\t\t}\n\t\t};\n\n\t\tsetModal(<IframeModal url={data.url} confirm={confirm} cancel={closeModal} />);\n\t}, [app, isSubscribed, setModal, closeModal, openIncompatibleModal, buildExternalUrl, syncApp]);\n\n\tconst handleViewLogs = useCallback(() => {\n\t\trouter.navigate({\n\t\t\tname: 'marketplace',\n\t\t\tparams: {\n\t\t\t\tcontext,\n\t\t\t\tpage: 'info',\n\t\t\t\tid: app.id,\n\t\t\t\tversion: app.version,\n\t\t\t\ttab: 'logs',\n\t\t\t},\n\t\t});\n\t}, [app.id, app.version, context, router]);\n\n\tconst handleDisable = useCallback(() => {\n\t\tconst confirm = async () => {\n\t\t\tcloseModal();\n\t\t\ttry {\n\t\t\t\tconst { status } = await setAppStatus({ status: 'manually_disabled' });\n\t\t\t\twarnEnableDisableApp(app.name, status, 'disable');\n\t\t\t} catch (error) {\n\t\t\t\thandleAPIError(error);\n\t\t\t}\n\t\t};\n\t\tsetModal(\n\t\t\t<WarningModal close={closeModal} confirm={confirm} text={t('Apps_Marketplace_Deactivate_App_Prompt')} confirmText={t('Yes')} />,\n\t\t);\n\t}, [app.name, closeModal, setAppStatus, setModal, t]);\n\n\tconst handleEnable = useCallback(async () => {\n\t\ttry {\n\t\t\tconst { status } = await setAppStatus({ status: 'manually_enabled' });\n\t\t\twarnEnableDisableApp(app.name, status, 'enable');\n\t\t} catch (error) {\n\t\t\thandleAPIError(error);\n\t\t}\n\t}, [app.name, setAppStatus]);\n\n\tconst handleUninstall = useCallback(() => {\n\t\tconst uninstall = async () => {\n\t\t\tcloseModal();\n\t\t\ttry {\n\t\t\t\tconst { success } = await uninstallApp();\n\t\t\t\tif (success) {\n\t\t\t\t\tdispatchToastMessage({ type: 'success', message: `${app.name} uninstalled` });\n\t\t\t\t\tif (context === 'details' && currentTab !== 'details') {\n\t\t\t\t\t\trouter.navigate(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: 'marketplace',\n\t\t\t\t\t\t\t\tparams: { ...router.getRouteParameters(), tab: 'details' },\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ replace: true },\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\thandleAPIError(error);\n\t\t\t}\n\t\t};\n\n\t\tif (isSubscribed) {\n\t\t\tconst confirm = async () => {\n\t\t\t\tawait handleSubscription();\n\t\t\t};\n\n\t\t\tsetModal(\n\t\t\t\t<WarningModal\n\t\t\t\t\tclose={closeModal}\n\t\t\t\t\tcancel={uninstall}\n\t\t\t\t\tconfirm={confirm}\n\t\t\t\t\ttext={t('Apps_Marketplace_Uninstall_Subscribed_App_Prompt')}\n\t\t\t\t\tconfirmText={t('Apps_Marketplace_Modify_App_Subscription')}\n\t\t\t\t\tcancelText={t('Apps_Marketplace_Uninstall_Subscribed_App_Anyway')}\n\t\t\t\t/>,\n\t\t\t);\n\t\t}\n\n\t\tif (!appCountQuery.data) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (app.migrated) {\n\t\t\tsetModal(\n\t\t\t\t<UninstallGrandfatheredAppModal\n\t\t\t\t\tcontext={context}\n\t\t\t\t\tappName={app.name}\n\t\t\t\t\tlimit={appCountQuery.data.limit}\n\t\t\t\t\thandleUninstall={uninstall}\n\t\t\t\t\thandleClose={closeModal}\n\t\t\t\t/>,\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tsetModal(\n\t\t\t<WarningModal close={closeModal} confirm={uninstall} text={t('Apps_Marketplace_Uninstall_App_Prompt')} confirmText={t('Yes')} />,\n\t\t);\n\t}, [\n\t\tisSubscribed,\n\t\tappCountQuery.data,\n\t\tapp.migrated,\n\t\tapp.name,\n\t\tsetModal,\n\t\tcloseModal,\n\t\tt,\n\t\tuninstallApp,\n\t\tdispatchToastMessage,\n\t\tcontext,\n\t\tcurrentTab,\n\t\trouter,\n\t\thandleSubscription,\n\t]);\n\n\tconst incompatibleIconName = useCallback(\n\t\t(app, action) => {\n\t\t\tif (!app.versionIncompatible) {\n\t\t\t\tif (action === 'update') {\n\t\t\t\t\treturn 'refresh';\n\t\t\t\t}\n\n\t\t\t\treturn 'card';\n\t\t\t}\n\n\t\t\t// Now we are handling an incompatible app\n\t\t\tif (action === 'subscribe' && !isSubscribed) {\n\t\t\t\treturn 'warning';\n\t\t\t}\n\n\t\t\tif (action === 'install' || action === 'update') {\n\t\t\t\treturn 'warning';\n\t\t\t}\n\n\t\t\treturn 'card';\n\t\t},\n\t\t[isSubscribed],\n\t);\n\n\tconst handleUpdate = useCallback(async () => {\n\t\tsetLoading(true);\n\n\t\tif (app?.versionIncompatible) {\n\t\t\topenIncompatibleModal(app, 'update', closeModal);\n\t\t\treturn;\n\t\t}\n\n\t\topenPermissionModal();\n\t}, [app, openPermissionModal, openIncompatibleModal, closeModal]);\n\n\tconst canUpdate = app.installed && app.version && app.marketplaceVersion && semver.lt(app.version, app.marketplaceVersion);\n\n\tconst menuOptions = useMemo(() => {\n\t\tconst bothAppStatusOptions = {\n\t\t\t...(canAppBeSubscribed &&\n\t\t\t\tisSubscribed &&\n\t\t\t\tisAdminUser && {\n\t\t\t\t\tsubscribe: {\n\t\t\t\t\t\tlabel: (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<Icon name={incompatibleIconName(app, 'subscribe')} size='x16' mie={4} />\n\t\t\t\t\t\t\t\t{t('Subscription')}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t),\n\t\t\t\t\t\taction: handleSubscription,\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t};\n\n\t\tconst nonInstalledAppOptions = {\n\t\t\t...(!app.installed &&\n\t\t\t\tbutton && {\n\t\t\t\t\tacquire: {\n\t\t\t\t\t\tlabel: (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t{isAdminUser && <Icon name={incompatibleIconName(app, 'install')} size='x16' mie={4} />}\n\t\t\t\t\t\t\t\t{t(button.label.replace(' ', '_'))}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t),\n\t\t\t\t\t\taction: handleAcquireApp,\n\t\t\t\t\t\tdisabled: requestedEndUser,\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t};\n\n\t\tconst isEnterpriseOrNot = (app.isEnterpriseOnly && isEnterpriseLicense) || !app.isEnterpriseOnly;\n\t\tconst isPossibleToEnableApp = app.installed && isAdminUser && !isAppEnabled && isEnterpriseOrNot;\n\t\tconst doesItReachedTheLimit =\n\t\t\t!app.migrated && !appCountQuery?.data?.hasUnlimitedApps && appCountQuery?.data?.enabled >= appCountQuery?.data?.limit;\n\n\t\tconst installedAppOptions = {\n\t\t\t...(context !== 'details' &&\n\t\t\t\tisAdminUser &&\n\t\t\t\tapp.installed && {\n\t\t\t\t\tviewLogs: {\n\t\t\t\t\t\tlabel: (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<Icon name='desktop-text' size='x16' mie={4} />\n\t\t\t\t\t\t\t\t{t('View_Logs')}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t),\n\t\t\t\t\t\taction: handleViewLogs,\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t...(isAdminUser &&\n\t\t\t\tcanUpdate &&\n\t\t\t\t!isAppDetailsPage && {\n\t\t\t\t\tupdate: {\n\t\t\t\t\t\tlabel: (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<Icon name={incompatibleIconName(app, 'update')} size='x16' mie={4} />\n\t\t\t\t\t\t\t\t{t('Update')}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t),\n\t\t\t\t\t\taction: handleUpdate,\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t...(app.installed &&\n\t\t\t\tisAdminUser &&\n\t\t\t\tisAppEnabled && {\n\t\t\t\t\tdisable: {\n\t\t\t\t\t\tlabel: (\n\t\t\t\t\t\t\t<Box color='status-font-on-warning'>\n\t\t\t\t\t\t\t\t<Icon name='ban' size='x16' mie={4} />\n\t\t\t\t\t\t\t\t{t('Disable')}\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t),\n\t\t\t\t\t\taction: handleDisable,\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t...(isPossibleToEnableApp && {\n\t\t\t\tenable: {\n\t\t\t\t\tlabel: (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<Icon name='check' size='x16' marginInlineEnd='x4' />\n\t\t\t\t\t\t\t{t('Enable')}\n\t\t\t\t\t\t</>\n\t\t\t\t\t),\n\t\t\t\t\tdisabled: doesItReachedTheLimit,\n\t\t\t\t\taction: handleEnable,\n\t\t\t\t},\n\t\t\t}),\n\t\t\t...(app.installed &&\n\t\t\t\tisAdminUser && {\n\t\t\t\t\tdivider: {\n\t\t\t\t\t\ttype: 'divider',\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t...(app.installed &&\n\t\t\t\tisAdminUser && {\n\t\t\t\t\tuninstall: {\n\t\t\t\t\t\tlabel: (\n\t\t\t\t\t\t\t<Box color='status-font-on-danger'>\n\t\t\t\t\t\t\t\t<Icon name='trash' size='x16' mie={4} />\n\t\t\t\t\t\t\t\t{t('Uninstall')}\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t),\n\t\t\t\t\t\taction: handleUninstall,\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t};\n\n\t\treturn {\n\t\t\t...bothAppStatusOptions,\n\t\t\t...nonInstalledAppOptions,\n\t\t\t...installedAppOptions,\n\t\t};\n\t}, [\n\t\tcanAppBeSubscribed,\n\t\tisSubscribed,\n\t\tisAdminUser,\n\t\tincompatibleIconName,\n\t\tapp,\n\t\tt,\n\t\thandleSubscription,\n\t\tbutton,\n\t\thandleAcquireApp,\n\t\trequestedEndUser,\n\t\tisEnterpriseLicense,\n\t\tisAppEnabled,\n\t\tappCountQuery?.data?.hasUnlimitedApps,\n\t\tappCountQuery?.data?.enabled,\n\t\tappCountQuery?.data?.limit,\n\t\tcontext,\n\t\thandleViewLogs,\n\t\tcanUpdate,\n\t\tisAppDetailsPage,\n\t\thandleUpdate,\n\t\thandleDisable,\n\t\thandleEnable,\n\t\thandleUninstall,\n\t]);\n\n\tif (loading) {\n\t\treturn <Skeleton variant='rect' height='x28' width='x28' />;\n\t}\n\n\tif (!isAdminUser && app?.installed) {\n\t\treturn null;\n\t}\n\n\treturn <Menu title={t('More_options')} options={menuOptions} placement='bottom-start' maxHeight='initial' {...props} />;\n}\n\nexport default AppMenu;\n",null],"names":["_extends","_objectSpread","_objectWithoutProperties","Box","Icon","Menu","Skeleton","useSetModal","useEndpoint","useTranslation","useRouteParameter","useToastMessageDispatch","usePermission","useRouter","React","useMemo","useCallback","useState","semver","WarningModal","useIsEnterprise","IframeModal","UninstallGrandfatheredAppModal","appEnabledStatuses","appButtonProps","handleAPIError","marketplaceActions","warnEnableDisableApp","useAppInstallationHandler","useAppsCountQuery","useOpenAppPermissionsReviewModal","useOpenIncompatibleModal","module","link","default","v","exportDefault","_ref","_appCountQuery$data4","_appCountQuery$data5","_appCountQuery$data6","app","isAppDetailsPage","props","_excluded","t","dispatchToastMessage","setModal","router","context","currentTab","setAppStatus","concat","id","buildExternalUrl","syncApp","uninstallApp","data","isEnterpriseLicense","isEnterprise","loading","setLoading","requestedEndUser","setRequestedEndUser","canAppBeSubscribed","purchaseType","isSubscribed","subscriptionInfo","includes","status","isAppEnabled","isAppPurchased","setPurchased","isPurchased","isAdminUser","appCountQuery","openIncompatibleModal","button","action","closeModal","installationSuccess","permissionsGranted","openPermissionModal","onCancel","onConfirm","appInstallationHandler","onDismiss","onSuccess","handleAcquireApp","handleSubscription","versionIncompatible","appId","details","error","confirm","createElement","url","cancel","handleViewLogs","navigate","name","params","page","version","tab","handleDisable","close","text","confirmText","handleEnable","handleUninstall","uninstall","success","type","message","getRouteParameters","replace","cancelText","migrated","appName","limit","handleClose","incompatibleIconName","handleUpdate","canUpdate","installed","marketplaceVersion","lt","menuOptions","_appCountQuery$data","_appCountQuery$data2","_appCountQuery$data3","bothAppStatusOptions","subscribe","label","Fragment","size","mie","nonInstalledAppOptions","acquire","disabled","isEnterpriseOrNot","isEnterpriseOnly","isPossibleToEnableApp","doesItReachedTheLimit","hasUnlimitedApps","enabled","installedAppOptions","viewLogs","update","disable","color","enable","marginInlineEnd","divider","variant","height","width","title","options","placement","maxHeight"],"mappings":"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"}