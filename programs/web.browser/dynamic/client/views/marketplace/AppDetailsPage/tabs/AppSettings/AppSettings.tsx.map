)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/marketplace/AppDetailsPage/tabs/AppSettings/AppSettings.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { ISetting } from '@rocket.chat/apps-engine/definition/settings';\nimport type { SettingValue } from '@rocket.chat/core-typings';\nimport { Box } from '@rocket.chat/fuselage';\nimport { useTranslation } from '@rocket.chat/ui-contexts';\nimport type { FC, MutableRefObject } from 'react';\nimport React, { useMemo, useEffect } from 'react';\n\nimport type { ISettings } from '../../../../../../ee/client/apps/@types/IOrchestrator';\nimport { useForm } from '../../../../../hooks/useForm';\nimport AppSettingsAssembler from './AppSettingsAssembler';\n\ntype AppSettingsProps = {\n\tsettings: ISettings;\n\tsetHasUnsavedChanges: (hasUnsavedChanges: boolean) => void;\n\tsettingsRef: MutableRefObject<Record<string, ISetting['value']>>;\n};\n\nconst AppSettings: FC<AppSettingsProps> = ({ settings, setHasUnsavedChanges, settingsRef }) => {\n\tconst t = useTranslation();\n\n\tconst stringifiedSettings = JSON.stringify(settings);\n\n\tconst reducedSettings = useMemo(() => {\n\t\tconst settings: AppSettingsProps['settings'] = JSON.parse(stringifiedSettings);\n\t\treturn Object.values(settings).reduce((ret, { id, value, packageValue }) => ({ ...ret, [id]: value ?? packageValue }), {});\n\t}, [stringifiedSettings]);\n\n\tconst { values, handlers, hasUnsavedChanges } = useForm(reducedSettings) as {\n\t\tvalues: Record<string, SettingValue>;\n\t\thandlers: Record<string, (eventOrValue: SettingValue) => void>;\n\t\thasUnsavedChanges: boolean;\n\t};\n\tconst stringifiedValues = JSON.stringify(values);\n\n\tuseEffect(() => {\n\t\tconst values = JSON.parse(stringifiedValues);\n\t\tsetHasUnsavedChanges(hasUnsavedChanges);\n\t\tsettingsRef.current = values;\n\t}, [hasUnsavedChanges, stringifiedValues, setHasUnsavedChanges, settingsRef]);\n\n\treturn (\n\t\t<>\n\t\t\t<Box display='flex' flexDirection='column' maxWidth='x640' w='full' marginInline='auto'>\n\t\t\t\t<Box fontScale='h4' mb={12}>\n\t\t\t\t\t{t('Settings')}\n\t\t\t\t</Box>\n\t\t\t\t<AppSettingsAssembler settings={settings} values={values} handlers={handlers} />\n\t\t\t</Box>\n\t\t</>\n\t);\n};\n\nexport default AppSettings;\n",null],"names":["_objectSpread","Box","useTranslation","React","useMemo","useEffect","useForm","AppSettingsAssembler","module","link","default","exportDefault","_ref","settings","setHasUnsavedChanges","settingsRef","t","stringifiedSettings","JSON","stringify","reducedSettings","parse","Object","values","reduce","ret","_ref2","id","value","packageValue","handlers","hasUnsavedChanges","stringifiedValues","current","createElement","Fragment","display","flexDirection","maxWidth","w","marginInline","fontScale","mb"],"mappings":"2BAEAA,EAAAC,EAA4CC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA9BC,EAAMC,IAAA,CAAA,uCAAwB,CAAAC,QAAAA,CAAAA,EAAAV,EAAAA,CAAA,CAAA,EAAA,GAArCQ,EAAOC,IAAA,CAAM,wBAAwB,CAAAR,IAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAO,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAN,eAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,QAAAA,CAAAE,QAAAA,CAAAA,EAAAP,EAAAA,CAAA,EAAAC,QAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,UAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,+BAAAA,CAAAF,QAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,yBAAAA,CAAAE,QAAAA,CAAAA,EAAAH,EAAAA,CAAA,CAAA,EAAA,GAA5CC,EAAOG,aAAa,CAesBC,IAAoD,GAAnD,CAAEC,SAAAA,CAAQ,CAAEC,qBAAAA,CAAoB,CAAEC,YAAAA,CAAAA,CAAa,CAAAH,EACnFI,EAAId,IAEJe,EAAsBC,KAAKC,SAAS,CAACN,GAErCO,EAAkBhB,EAAQ,KAC/B,IAAMS,EAAyCK,KAAKG,KAAK,CAACJ,GAC1D,OAAOK,OAAOC,MAAM,CAACV,GAAUW,MAAM,CAAC,CAACC,EAAGC,KAAA,GAAE,CAAEC,GAAAA,CAAE,CAAEC,MAAAA,CAAK,CAAEC,aAAAA,CAAAA,CAAc,CAAAH,EAAA,OAAA1B,EAAAA,EAAA,CAAA,EAAWyB,GAAG,CAAA,EAAA,CAAE,CAACE,EAAE,CAAGC,MAAAA,EAAAA,EAASC,CAAY,EAAA,EAAK,CAAA,EACxH,EAAG,CAACZ,EAAoB,EAElB,CAAEM,OAAAA,CAAM,CAAEO,SAAAA,CAAQ,CAAEC,kBAAAA,CAAAA,CAAmB,CAAGzB,EAAQc,GAKlDY,EAAoBd,KAAKC,SAAS,CAACI,GAQzC,OANAlB,EAAU,KACT,IAAMkB,EAASL,KAAKG,KAAK,CAACW,GAC1BlB,EAAqBiB,GACrBhB,EAAYkB,OAAO,CAAGV,CACvB,EAAG,CAACQ,EAAmBC,EAAmBlB,EAAsBC,EAAY,EAG3EZ,EAAA+B,aAAA,CAAA/B,EAAAgC,QAAA,CAAA,KACChC,EAAA+B,aAAA,CAACjC,EAAG,CAACmC,QAAQ,OAAOC,cAAc,SAASC,SAAS,OAAOC,EAAE,OAAOC,aAAa,MAAM,EACtFrC,EAAA+B,aAAA,CAACjC,EAAG,CAACwC,UAAU,KAAKC,GAAI,EAAG,EACzB1B,EAAE,aAEJb,EAAA+B,aAAA,CAAC3B,EAAoB,CAACM,SAAUA,EAAUU,OAAQA,EAAQO,SAAUA,CAAS,IAIjF"}