)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/invite/hooks/useValidateInviteQuery.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useEndpoint, useSessionDispatch, useSetting, useToastMessageDispatch, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useQuery } from '@tanstack/react-query';\n\nimport { useInviteTokenMutation } from './useInviteTokenMutation';\n\nexport const useValidateInviteQuery = (userId: string | null, token: string | undefined) => {\n\tconst t = useTranslation();\n\n\tconst registrationForm = useSetting('Accounts_RegistrationForm');\n\n\tconst setLoginDefaultState = useSessionDispatch('loginDefaultState');\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst getInviteRoomMutation = useInviteTokenMutation();\n\n\tconst handleValidateInviteToken = useEndpoint('POST', '/v1/validateInviteToken');\n\n\treturn useQuery(\n\t\t['invite', token],\n\t\tasync () => {\n\t\t\tif (!token) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tconst { valid } = await handleValidateInviteToken({ token });\n\n\t\t\t\treturn valid;\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: t('Failed_to_validate_invite_token') });\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tonSuccess: async (valid) => {\n\t\t\t\tif (!token) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (registrationForm !== 'Disabled') {\n\t\t\t\t\tsetLoginDefaultState('register');\n\t\t\t\t} else {\n\t\t\t\t\tsetLoginDefaultState('login');\n\t\t\t\t}\n\n\t\t\t\tif (!valid || !userId) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\treturn getInviteRoomMutation(token);\n\t\t\t},\n\t\t},\n\t);\n};\n",null],"names":["useEndpoint","useSessionDispatch","useSetting","useToastMessageDispatch","useTranslation","useQuery","useInviteTokenMutation","module","export","useValidateInviteQuery","userId","token","t","registrationForm","setLoginDefaultState","dispatchToastMessage","getInviteRoomMutation","handleValidateInviteToken","valid","error","type","message","onSuccess"],"mappings":"2BAAsDA,EAAyBC,EAAsBC,EAAAC,EAA2BC,EAAAC,EAAAC,EAAhIC,EAAOC,MAAE,CAAA,CAAAC,uBAAa,IAAoBA,CAAY,GAA0EF,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAP,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,mBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,WAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,wBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAF,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAD,uBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAKzH,IAAMG,EAAyB,CAACC,EAAuBC,KAC7D,IAAMC,EAAIR,IAEJS,EAAmBX,EAAW,6BAE9BY,EAAuBb,EAAmB,qBAC1Cc,EAAuBZ,IACvBa,EAAwBV,IAExBW,EAA4BjB,EAAY,OAAQ,2BAEtD,OAAOK,EACN,CAAC,SAAUM,EAAM,CACjB,UACC,GAAI,CAACA,EACJ,MAAO,CAAA,EAGR,GAAI,CACH,GAAM,CAAEO,MAAAA,CAAAA,CAAO,CAAG,MAAMD,EAA0B,CAAEN,MAAAA,CAAK,GAEzD,OAAOO,EACN,MAAOC,EAAO,CAEf,OADAJ,EAAqB,CAAEK,KAAM,QAASC,QAAST,EAAE,kCAAkC,GAC5E,CAAA,EAET,EACA,CACCU,UAAW,MAAOJ,IACjB,GAAKP,IAIDE,AAAqB,aAArBA,EACHC,EAAqB,YAErBA,EAAqB,SAGlB,AAACI,GAAUR,GAIf,OAAOM,EAAsBL,EAC9B,GAGH"}