)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/hooks/roomActions/useDeleteRoom.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IRoom, RoomAdminFieldsType } from '@rocket.chat/core-typings';\nimport { isRoomFederated } from '@rocket.chat/core-typings';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useSetModal, useToastMessageDispatch, useRouter, usePermission, useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useMutation } from '@tanstack/react-query';\nimport React from 'react';\n\nimport GenericModal from '../../../components/GenericModal';\nimport DeleteTeamModal from '../../teams/contextualBar/info/DeleteTeam';\n\nexport const useDeleteRoom = (room: IRoom | Pick<IRoom, RoomAdminFieldsType>, { reload }: { reload?: () => void } = {}) => {\n\tconst t = useTranslation();\n\tconst router = useRouter();\n\tconst setModal = useSetModal();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst hasPermissionToDelete = usePermission(`delete-${room.t}`, room._id);\n\tconst canDeleteRoom = isRoomFederated(room) ? false : hasPermissionToDelete;\n\n\tconst isAdminRoute = router.getRouteName() === 'admin-rooms';\n\n\tconst deleteRoomEndpoint = useEndpoint('POST', '/v1/rooms.delete');\n\tconst deleteTeamEndpoint = useEndpoint('POST', '/v1/teams.delete');\n\n\tconst deleteRoomMutation = useMutation({\n\t\tmutationFn: deleteRoomEndpoint,\n\t\tonSuccess: () => {\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Room_has_been_deleted') });\n\t\t\tif (isAdminRoute) {\n\t\t\t\treturn router.navigate('/admin/rooms');\n\t\t\t}\n\n\t\t\treturn router.navigate('/home');\n\t\t},\n\t\tonError: (error) => {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t},\n\t\tonSettled: () => {\n\t\t\tsetModal(null);\n\t\t\treload?.();\n\t\t},\n\t});\n\n\tconst deleteTeamMutation = useMutation({\n\t\tmutationFn: deleteTeamEndpoint,\n\t\tonSuccess: () => {\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Team_has_been_deleted') });\n\t\t\tif (isAdminRoute) {\n\t\t\t\treturn router.navigate('/admin/rooms');\n\t\t\t}\n\n\t\t\treturn router.navigate('/home');\n\t\t},\n\t\tonError: (error) => {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t},\n\t\tonSettled: () => {\n\t\t\tsetModal(null);\n\t\t\treload?.();\n\t\t},\n\t});\n\n\tconst isDeleting = deleteTeamMutation.isLoading || deleteRoomMutation.isLoading;\n\n\tconst handleDelete = useMutableCallback(() => {\n\t\tconst handleDeleteTeam = async (roomsToRemove: IRoom['_id'][]) => {\n\t\t\tif (!room.teamId) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdeleteTeamMutation.mutateAsync({ teamId: room.teamId, ...(roomsToRemove.length && { roomsToRemove }) });\n\t\t};\n\n\t\tif (room.teamMain && room.teamId) {\n\t\t\treturn setModal(<DeleteTeamModal onConfirm={handleDeleteTeam} onCancel={(): void => setModal(null)} teamId={room.teamId} />);\n\t\t}\n\n\t\tconst handleDeleteRoom = async () => {\n\t\t\tdeleteRoomMutation.mutateAsync({ roomId: room._id });\n\t\t};\n\n\t\tsetModal(\n\t\t\t<GenericModal variant='danger' onConfirm={handleDeleteRoom} onCancel={(): void => setModal(null)} confirmText={t('Yes_delete_it')}>\n\t\t\t\t{t('Delete_Room_Warning')}\n\t\t\t</GenericModal>,\n\t\t);\n\t});\n\n\treturn { handleDelete, canDeleteRoom, isDeleting };\n};\n",null],"names":["_objectSpread","isRoomFederated","useMutableCallback","useSetModal","useToastMessageDispatch","useRouter","usePermission","useEndpoint","useTranslation","useMutation","React","GenericModal","DeleteTeamModal","module","link","default","export","useDeleteRoom","room","reload","arguments","length","undefined","t","router","setModal","dispatchToastMessage","hasPermissionToDelete","concat","_id","canDeleteRoom","isAdminRoute","getRouteName","deleteRoomEndpoint","deleteTeamEndpoint","deleteRoomMutation","mutationFn","onSuccess","type","message","navigate","onError","error","onSettled","deleteTeamMutation","isDeleting","isLoading","handleDelete","handleDeleteTeam","roomsToRemove","teamId","mutateAsync","teamMain","createElement","onConfirm","onCancel","handleDeleteRoom","roomId","variant","confirmText"],"mappings":"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"}