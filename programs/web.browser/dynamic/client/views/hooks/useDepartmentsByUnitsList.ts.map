)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/hooks/useDepartmentsByUnitsList.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { ILivechatDepartment, IOmnichannelBusinessUnit } from '@rocket.chat/core-typings';\nimport { useTranslation, useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useCallback, useState } from 'react';\n\nimport { useScrollableRecordList } from '../../hooks/lists/useScrollableRecordList';\nimport { useComponentDidUpdate } from '../../hooks/useComponentDidUpdate';\nimport { RecordList } from '../../lib/lists/RecordList';\n\ntype DepartmentsListOptions = {\n\tunitId?: IOmnichannelBusinessUnit['_id'];\n\tfilter: string;\n};\n\nexport const useDepartmentsByUnitsList = (\n\toptions: DepartmentsListOptions,\n): {\n\titemsList: RecordList<ILivechatDepartment>;\n\tinitialItemCount: number;\n\treload: () => void;\n\tloadMoreItems: (start: number, end: number) => void;\n} => {\n\tconst t = useTranslation();\n\tconst [itemsList, setItemsList] = useState(() => new RecordList<ILivechatDepartment>());\n\tconst reload = useCallback(() => setItemsList(new RecordList<ILivechatDepartment>()), []);\n\n\tconst getDepartments = useEndpoint('GET', '/v1/livechat/units/:unitId/departments/available', { unitId: options.unitId || 'none' });\n\n\tuseComponentDidUpdate(() => {\n\t\toptions && reload();\n\t}, [options, reload]);\n\n\tconst fetchData = useCallback(\n\t\tasync (start, end) => {\n\t\t\tconst { departments, total } = await getDepartments({\n\t\t\t\ttext: options.filter,\n\t\t\t\toffset: start,\n\t\t\t\tcount: end + start,\n\t\t\t});\n\n\t\t\treturn {\n\t\t\t\titems: departments.map(({ _id, name, _updatedAt, ...department }) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...department,\n\t\t\t\t\t\t_id,\n\t\t\t\t\t\tname: department.archived ? `${name} [${t('Archived')}]` : name,\n\t\t\t\t\t\tlabel: name,\n\t\t\t\t\t\tvalue: _id,\n\t\t\t\t\t};\n\t\t\t\t}),\n\t\t\t\titemCount: total,\n\t\t\t};\n\t\t},\n\t\t[getDepartments, options.filter, t],\n\t);\n\n\tconst { loadMoreItems, initialItemCount } = useScrollableRecordList(itemsList, fetchData, 25);\n\n\treturn {\n\t\treload,\n\t\titemsList,\n\t\tloadMoreItems,\n\t\tinitialItemCount,\n\t};\n};\n",null],"names":["_objectSpread","_objectWithoutProperties","useTranslation","useEndpoint","useCallback","useState","useScrollableRecordList","useComponentDidUpdate","RecordList","module","link","default","v","export","useDepartmentsByUnitsList","options","t","itemsList","setItemsList","reload","getDepartments","unitId","fetchData","start","end","departments","total","text","filter","offset","count","items","map","_ref","_id","name","_updatedAt","department","_excluded","archived","concat","label","value","itemCount","loadMoreItems","initialItemCount"],"mappings":"2BACAA,EAAuEC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,oCAA9DC,EAAgBC,IAAAA,CAAAA,uCAAmB,CAA0BC,QAACC,CAAA,EAAAZ,EAAAA,CAAA,CAAA,EAAA,GAAAS,EAAAA,IAAAA,CAAAA,iDAAAA,CAAAE,QAAAA,CAAAA,EAAAV,EAAAA,CAAA,CAAA,EAAA,GAAvEQ,EAAOI,MAAE,CAAA,CAAAC,0BAA6B,IAAMA,CAA0B,GAACL,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAP,eAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,QAAAA,CAAAL,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,4CAAAA,CAAAH,wBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,oCAAAA,CAAAF,sBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,6BAAAA,CAAAD,WAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAYhE,IAAMM,EACZC,IAOA,IAAMC,EAAId,IACJ,CAACe,EAAWC,EAAa,CAAGb,EAAS,IAAM,IAAIG,GAC/CW,EAASf,EAAY,IAAMc,EAAa,IAAIV,GAAoC,EAAE,EAElFY,EAAiBjB,EAAY,MAAO,mDAAoD,CAAEkB,OAAQN,EAAQM,MAAM,EAAI,MAAM,GAEhId,EAAsB,KACrBQ,GAAWI,GACZ,EAAG,CAACJ,EAASI,EAAO,EAEpB,IAAMG,EAAYlB,EACjB,MAAOmB,EAAOC,KACb,GAAM,CAAEC,YAAAA,CAAW,CAAEC,MAAAA,CAAAA,CAAO,CAAG,MAAMN,EAAe,CACnDO,KAAMZ,EAAQa,MAAM,CACpBC,OAAQN,EACRO,MAAON,EAAMD,IAGd,MAAO,CACNQ,MAAON,EAAYO,GAAG,CAACC,IAA6C,GAA5C,CAAEC,IAAAA,CAAG,CAAEC,KAAAA,CAAI,CAAEC,WAAAA,CAAAA,CAA2B,CAAAH,EAAZI,EAAUpC,EAAAgC,EAAAK,GAC7D,OAAAtC,EAAAA,EAAA,CAAA,EACIqC,GAAU,CAAA,EAAA,CACbH,IAAAA,EACAC,KAAME,EAAWE,QAAQ,CAAA,GAAAC,MAAA,CAAML,EAAI,MAAAK,MAAA,CAAKxB,EAAE,YAAW,KAAMmB,EAC3DM,MAAON,EACPO,MAAOR,CAAG,EAEZ,GACAS,UAAWjB,EAEb,EACA,CAACN,EAAgBL,EAAQa,MAAM,CAAEZ,EAAE,EAG9B,CAAE4B,cAAAA,CAAa,CAAEC,iBAAAA,CAAAA,CAAkB,CAAGvC,EAAwBW,EAAWK,EAAW,IAE1F,MAAO,CACNH,OAAAA,EACAF,UAAAA,EACA2B,cAAAA,EACAC,iBAAAA,EAEF"}