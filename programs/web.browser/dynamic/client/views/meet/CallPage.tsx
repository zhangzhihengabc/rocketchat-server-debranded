function module(e,t,n){let a,i,l,o,r,s,c,m,d,u,f,g,p,y,h,E;n.link("@babel/runtime/helpers/objectSpread2",{default(e){a=e}},0),n.link("@rocket.chat/fuselage",{Box(e){i=e},Flex(e){l=e},ButtonGroup(e){o=e},Button(e){r=e},Icon(e){s=e}},0),n.link("@rocket.chat/ui-contexts",{useTranslation(e){c=e}},1),n.link("moment",{default(e){m=e}},2),n.link("react",{default(e){d=e},useEffect(e){u=e},useState(e){f=e}},3),n.link("../../../app/notifications/client",{Notifications(e){g=e}},4),n.link("../../../app/webrtc/client",{WebRTC(e){p=e}},5),n.link("../../../app/webrtc/lib/constants",{WEB_RTC_EVENTS(e){y=e}},6),n.link("../../components/avatar/UserAvatar",{default(e){h=e}},7),n.link("./OngoingCallDuration",{default(e){E=e}},8),n.link("./styles.css"),n.exportDefault(e=>{let{roomId:t,visitorToken:n,visitorId:b,status:w,setStatus:k,isLayoutEmbedded:v,visitorName:x,agentName:C,callStartTime:I}=e,[z,S]=f(!1),[_,R]=f(!1),[T,N]=f(!1),[D,B]=f(!1),[O,j]=f(!1),[V,P]=f(!1),[H,q]=f(!1),M="x21",W="x40";v&&(M="x19",W="x35");let A=c();u(()=>{if(n){let e=p.getInstanceByRoomId(t,b),n=()=>(v&&j(!0),window.innerWidth<=450&&window.innerHeight>=629&&window.innerHeight<=900&&(q(!0),e.media={audio:!0,video:{width:{ideal:440},height:{ideal:580}}},!0));g.onVisitor(y.WEB_RTC,b,(t,n)=>{null!=n.room&&e.onUserStream(t,n)}),g.onRoom(t,"webrtc",(a,i)=>{"callStatus"===a&&"ended"===i.callStatus?(e.stop(),k(i.callStatus)):"getDeviceType"===a?g.notifyRoom(t,"webrtc","deviceType",{isMobileDevice:n()}):"cameraStatus"===a&&P(i.isCameraOn)}),g.notifyRoom(t,"webrtc","deviceType",{isMobileDevice:n()}),g.notifyRoom(t,"webrtc","callStatus",{callStatus:"inProgress"})}else if(!z){let e=p.getInstanceByRoomId(t);"inProgress"===w&&(g.notifyRoom(t,"webrtc","getDeviceType"),e.startCall({audio:!0,video:{width:{ideal:1920},height:{ideal:1080}}})),g.onRoom(t,"webrtc",(t,n)=>{if("callStatus"===t){switch(n.callStatus){case"ended":e.stop();break;case"inProgress":e.startCall({audio:!0,video:{width:{ideal:1920},height:{ideal:1080}}})}k(n.callStatus)}else"deviceType"===t&&n.isMobileDevice?B(!0):"cameraStatus"===t&&P(n.isCameraOn)}),S(!0)}},[z,w,k,b,t,n,v]);let U=e=>{if("mic"===e)return p.getInstanceByRoomId(t,n).toggleAudio(),R(!_);p.getInstanceByRoomId(t,n).toggleVideo(),N(!T),g.notifyRoom(t,"webrtc","cameraStatus",{isCameraOn:!T})},F=()=>{if(v){var e;return null===(e=parent)||void 0===e?void 0:e.handleIframeClose()}return window.close()},X=e=>m.duration(m(new Date).diff(m(e))).asSeconds(),G=(e,t)=>d.createElement(l.Container,{direction:"column",justifyContent:"center"},d.createElement(i,{width:"full",minHeight:"sh",alignItems:"center",backgroundColor:"dark",overflow:"hidden",position:"relative"},d.createElement(i,{position:"absolute",zIndex:1,style:{top:"5%",right:"2%"},className:"Self_Video",alignItems:"center",backgroundColor:"dark"},d.createElement("video",{id:"localVideo",autoPlay:!0,playsInline:!0,muted:!0,style:{width:"100%",transform:"scaleX(-1)",display:T?"block":"none"}}),d.createElement(h,{style:{display:T?"none":"block",margin:"auto"},username:e,className:"rcx-message__avatar",size:H||O?"x32":"x48"})),d.createElement(o,{position:"absolute",zIndex:1,style:{bottom:"5%"}},d.createElement(r,{id:"mic",square:!0,title:_?A("Mute_microphone"):A("Unmute_microphone"),onClick:()=>U("mic"),className:_?"On":"Off",size:Number(W)},_?d.createElement(s,{name:"mic",size:M}):d.createElement(s,{name:"mic-off",size:M})),d.createElement(r,{id:"camera",square:!0,title:T?A("Turn_off_video"):A("Turn_on_video"),onClick:()=>U("camera"),className:T?"On":"Off",size:parseInt(W)},T?d.createElement(s,{name:"video",size:M}):d.createElement(s,{name:"video-off",size:M})),v&&d.createElement(r,{square:!0,backgroundColor:"dark",borderColor:"stroke-extra-dark","data-title":A("Expand_view"),onClick:()=>{var e;return null===(e=parent)||void 0===e?void 0:e.expandCall()},size:parseInt(W)},d.createElement(s,{name:"arrow-expand",size:M,color:"white"})),d.createElement(r,{square:!0,danger:!0,title:A("End_call"),onClick:F,size:parseInt(W)},d.createElement(s,{name:"phone-off",size:M,color:"white"}))),d.createElement("video",{id:"remoteVideo",autoPlay:!0,playsInline:!0,style:{width:D?"45%":"100%",transform:"scaleX(-1)",display:V?"block":"none"}}),d.createElement(i,{position:"absolute",zIndex:1,display:V?"none":"flex",justifyContent:"center",flexDirection:"column",alignItems:"center",style:{top:D||H?"10%":"30%"}},d.createElement(h,{style:{display:"block",margin:"auto"},username:t,className:"rcx-message__avatar",size:O?"x48":"x124"}),d.createElement(i,{color:"white",fontSize:O?12:18,textAlign:"center",margin:3},d.createElement(E,{counter:X(I)})),d.createElement(i,{style:a({color:"white",fontSize:O?12:22,margin:O?5:9},O&&{marginTop:0})},t))));return d.createElement(d.Fragment,null,"ringing"===w&&d.createElement(l.Container,{direction:"column",justifyContent:"center"},d.createElement(i,{width:"full",minHeight:"sh",alignItems:"center",backgroundColor:"dark",overflow:"hidden",position:"relative"},d.createElement(i,{position:"absolute",zIndex:1,style:{top:"5%",right:"2%"},className:"Self_Video",backgroundColor:"dark",alignItems:"center"},d.createElement(h,{style:{display:"block",margin:"auto"},username:C,className:"rcx-message__avatar",size:H?"x32":"x48"})),d.createElement(i,{position:"absolute",zIndex:1,style:{top:"20%",display:"flex",justifyContent:"center",flexDirection:"column"},alignItems:"center"},d.createElement(h,{style:{display:"block",margin:"auto"},username:x,className:"rcx-message__avatar",size:"x124"}),d.createElement(i,{color:"white",fontSize:16,margin:15},"Calling..."),d.createElement(i,{style:{color:"white",fontSize:H?15:22}},x)))),"declined"===w&&d.createElement(i,{minHeight:"90%",display:"flex",justifyContent:"center",alignItems:"center",color:"white",fontSize:"s1"},A("Call_declined")),"inProgress"===w&&d.createElement(l.Container,{direction:"column",justifyContent:"center"},n?G(x,C):G(C,x)))})}
//# sourceMappingURL=/dynamic/client/views/meet/e3295e8331ef181efab32a4c71b288d4d37f9e58.map
