)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/oauth/components/AuthorizationFormPage.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IOAuthApps, IUser } from '@rocket.chat/core-typings';\nimport { Box, Button, ButtonGroup } from '@rocket.chat/fuselage';\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport { Form } from '@rocket.chat/layout';\nimport { useLogout, useRoute } from '@rocket.chat/ui-contexts';\nimport { Accounts } from 'meteor/accounts-base';\nimport { Meteor } from 'meteor/meteor';\nimport React, { useEffect, useMemo, useRef } from 'react';\nimport { Trans, useTranslation } from 'react-i18next';\n\nimport { queueMicrotask } from '../../../lib/utils/queueMicrotask';\nimport CurrentUserDisplay from './CurrentUserDisplay';\nimport Layout from './Layout';\n\ntype AuthorizationFormPageProps = {\n\toauthApp: IOAuthApps;\n\tredirectUri: string;\n\tuser: IUser;\n};\n\nconst AuthorizationFormPage = ({ oauthApp, redirectUri, user }: AuthorizationFormPageProps) => {\n\tconst token = useMemo(() => Meteor._localStorage.getItem(Accounts.LOGIN_TOKEN_KEY) ?? undefined, []);\n\n\tconst formLabelId = useUniqueId();\n\n\tconst { t } = useTranslation();\n\n\tconst homeRoute = useRoute('home');\n\n\tconst handleCancelButtonClick = () => {\n\t\tqueueMicrotask(() => {\n\t\t\thomeRoute.push();\n\t\t});\n\t\twindow.close();\n\t};\n\n\tconst logout = useLogout();\n\n\tconst handleLogoutButtonClick = () => {\n\t\tlogout();\n\t};\n\n\tconst submitRef = useRef<HTMLButtonElement>(null);\n\n\tconst hasAuthorized = user.oauth?.authorizedClients?.includes(oauthApp.clientId);\n\n\tuseEffect(() => {\n\t\tif (hasAuthorized) {\n\t\t\tsubmitRef.current?.click();\n\t\t}\n\t}, [oauthApp.clientId, hasAuthorized]);\n\n\treturn (\n\t\t<Layout>\n\t\t\t<Form method='post' action='' aria-labelledby={formLabelId}>\n\t\t\t\t<Form.Header>\n\t\t\t\t\t<Form.Title id={formLabelId}>{t('core.Authorize_access_to_your_account')}</Form.Title>\n\t\t\t\t</Form.Header>\n\t\t\t\t<Form.Container>\n\t\t\t\t\t<Box withRichContent>\n\t\t\t\t\t\t<CurrentUserDisplay user={user} />\n\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t<Trans i18nKey='core.The_application_will_be_able_to' t={t}>\n\t\t\t\t\t\t\t\tThe application <strong>{{ appName: oauthApp.name }}</strong> will be able to:\n\t\t\t\t\t\t\t</Trans>\n\t\t\t\t\t\t</p>\n\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t<li>{t('core.access_your_basic_information')}</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</Box>\n\t\t\t\t\t<input type='hidden' name='access_token' value={token} />\n\t\t\t\t\t<input type='hidden' name='client_id' value={oauthApp.clientId} />\n\t\t\t\t\t<input type='hidden' name='redirect_uri' value={redirectUri} />\n\t\t\t\t\t<input type='hidden' name='response_type' value='code' />\n\t\t\t\t</Form.Container>\n\t\t\t\t<Form.Footer>\n\t\t\t\t\t<ButtonGroup stretch flexGrow={1}>\n\t\t\t\t\t\t<Button ref={submitRef} type='submit' primary name='allow' value='yes'>\n\t\t\t\t\t\t\t{t('core.Authorize')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button onClick={handleCancelButtonClick}>{t('core.Cancel')}</Button>\n\t\t\t\t\t\t<Button danger onClick={handleLogoutButtonClick}>\n\t\t\t\t\t\t\t{t('core.Logout')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</ButtonGroup>\n\t\t\t\t</Form.Footer>\n\t\t\t</Form>\n\t\t</Layout>\n\t);\n};\n\nexport default AuthorizationFormPage;\n",null],"names":["Box","Button","ButtonGroup","useUniqueId","Form","useLogout","useRoute","Accounts","Meteor","React","useEffect","useMemo","useRef","Trans","useTranslation","queueMicrotask","CurrentUserDisplay","Layout","module","link","v","default","exportDefault","_ref","_user$oauth","_user$oauth$authorize","oauthApp","redirectUri","user","token","_Meteor$_localStorage","_localStorage","getItem","LOGIN_TOKEN_KEY","undefined","formLabelId","t","homeRoute","logout","submitRef","hasAuthorized","oauth","authorizedClients","includes","clientId","_submitRef$current","current","click","createElement","method","action","Header","Title","id","Container","withRichContent","i18nKey","appName","name","type","value","Footer","stretch","flexGrow","ref","primary","onClick","push","window","close","danger"],"mappings":"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"}