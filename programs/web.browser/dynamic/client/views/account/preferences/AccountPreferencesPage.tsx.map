)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/account/preferences/AccountPreferencesPage.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { ButtonGroup, Button, Box, Accordion } from '@rocket.chat/fuselage';\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport { useToastMessageDispatch, useSetting, useTranslation, useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useMutation } from '@tanstack/react-query';\nimport type { ReactElement } from 'react';\nimport React from 'react';\nimport { FormProvider, useForm } from 'react-hook-form';\n\nimport Page from '../../../components/Page';\nimport { getDirtyFields } from '../../../lib/getDirtyFields';\nimport PreferencesGlobalSection from './PreferencesGlobalSection';\nimport PreferencesHighlightsSection from './PreferencesHighlightsSection';\nimport PreferencesLocalizationSection from './PreferencesLocalizationSection';\nimport PreferencesMessagesSection from './PreferencesMessagesSection';\nimport PreferencesMyDataSection from './PreferencesMyDataSection';\nimport PreferencesNotificationsSection from './PreferencesNotificationsSection';\nimport PreferencesSoundSection from './PreferencesSoundSection';\nimport PreferencesUserPresenceSection from './PreferencesUserPresenceSection';\nimport type { AccountPreferencesData } from './useAccountPreferencesValues';\nimport { useAccountPreferencesValues } from './useAccountPreferencesValues';\n\nconst AccountPreferencesPage = (): ReactElement => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst dataDownloadEnabled = useSetting('UserData_EnableDownload');\n\tconst preferencesValues = useAccountPreferencesValues();\n\n\tconst methods = useForm({ defaultValues: preferencesValues });\n\tconst {\n\t\thandleSubmit,\n\t\treset,\n\t\twatch,\n\t\tformState: { isDirty, dirtyFields },\n\t} = methods;\n\n\tconst currentData = watch();\n\n\tconst setPreferencesEndpoint = useEndpoint('POST', '/v1/users.setPreferences');\n\tconst setPreferencesAction = useMutation({\n\t\tmutationFn: setPreferencesEndpoint,\n\t\tonSuccess: () => {\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Preferences_saved') });\n\t\t},\n\t\tonError: (error) => {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t},\n\t\tonSettled: () => reset(currentData),\n\t});\n\n\tconst handleSaveData = async (formData: AccountPreferencesData) => {\n\t\tconst { highlights, dontAskAgainList, ...data } = getDirtyFields(formData, dirtyFields);\n\t\tif (highlights || highlights === '') {\n\t\t\tObject.assign(data, {\n\t\t\t\thighlights:\n\t\t\t\t\ttypeof highlights === 'string' &&\n\t\t\t\t\thighlights\n\t\t\t\t\t\t.split(/,|\\n/)\n\t\t\t\t\t\t.map((val) => val.trim())\n\t\t\t\t\t\t.filter(Boolean),\n\t\t\t});\n\t\t}\n\n\t\tif (dontAskAgainList) {\n\t\t\tconst list =\n\t\t\t\tArray.isArray(dontAskAgainList) && dontAskAgainList.length > 0\n\t\t\t\t\t? dontAskAgainList.map(([action, label]) => ({ action, label }))\n\t\t\t\t\t: [];\n\t\t\tObject.assign(data, { dontAskAgainList: list });\n\t\t}\n\n\t\tsetPreferencesAction.mutateAsync({ data });\n\t};\n\n\tconst preferencesFormId = useUniqueId();\n\n\treturn (\n\t\t<Page>\n\t\t\t<Page.Header title={t('Preferences')} />\n\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t<FormProvider {...methods}>\n\t\t\t\t\t<Box id={preferencesFormId} is='form' maxWidth='x600' w='full' alignSelf='center' onSubmit={handleSubmit(handleSaveData)}>\n\t\t\t\t\t\t<Accordion>\n\t\t\t\t\t\t\t<PreferencesLocalizationSection />\n\t\t\t\t\t\t\t<PreferencesGlobalSection />\n\t\t\t\t\t\t\t<PreferencesUserPresenceSection />\n\t\t\t\t\t\t\t<PreferencesNotificationsSection />\n\t\t\t\t\t\t\t<PreferencesMessagesSection />\n\t\t\t\t\t\t\t<PreferencesHighlightsSection />\n\t\t\t\t\t\t\t<PreferencesSoundSection />\n\t\t\t\t\t\t\t{dataDownloadEnabled && <PreferencesMyDataSection />}\n\t\t\t\t\t\t</Accordion>\n\t\t\t\t\t</Box>\n\t\t\t\t</FormProvider>\n\t\t\t</Page.ScrollableContentWithShadow>\n\t\t\t<Page.Footer isDirty={isDirty}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t<Button onClick={() => reset(preferencesValues)}>{t('Cancel')}</Button>\n\t\t\t\t\t<Button form={preferencesFormId} primary type='submit'>\n\t\t\t\t\t\t{t('Save_changes')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Footer>\n\t\t</Page>\n\t);\n};\n\nexport default AccountPreferencesPage;\n",null],"names":["_objectWithoutProperties","ButtonGroup","Button","Box","Accordion","useUniqueId","useToastMessageDispatch","useSetting","useTranslation","useEndpoint","useMutation","React","FormProvider","useForm","Page","getDirtyFields","PreferencesGlobalSection","PreferencesHighlightsSection","PreferencesLocalizationSection","PreferencesMessagesSection","PreferencesMyDataSection","PreferencesNotificationsSection","PreferencesSoundSection","PreferencesUserPresenceSection","useAccountPreferencesValues","module","link","default","v","exportDefault","t","dispatchToastMessage","dataDownloadEnabled","preferencesValues","methods","defaultValues","handleSubmit","reset","watch","formState","isDirty","dirtyFields","currentData","setPreferencesEndpoint","setPreferencesAction","mutationFn","onSuccess","type","message","onError","error","onSettled","handleSaveData","formData","_getDirtyFields","highlights","dontAskAgainList","data","_excluded","Object","assign","split","map","val","trim","filter","Boolean","list","Array","isArray","length","_ref","action","label","mutateAsync","preferencesFormId","createElement","Header","title","ScrollableContentWithShadow","id","is","maxWidth","w","alignSelf","onSubmit","Footer","onClick","form","primary"],"mappings":"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"}