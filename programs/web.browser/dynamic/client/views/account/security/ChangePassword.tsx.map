)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/account/security/ChangePassword.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Box, Field, FieldError, FieldGroup, FieldHint, FieldLabel, FieldRow, Icon, PasswordInput } from '@rocket.chat/fuselage';\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport { PasswordVerifier, useValidatePassword } from '@rocket.chat/ui-client';\nimport { useMethod, useToastMessageDispatch, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { AllHTMLAttributes } from 'react';\nimport React from 'react';\nimport { Controller, useFormContext } from 'react-hook-form';\n\nimport { useAllowPasswordChange } from './useAllowPasswordChange';\n\ntype PasswordFieldValues = { password: string; confirmationPassword: string };\n\nconst ChangePassword = (props: AllHTMLAttributes<HTMLFormElement>) => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst passwordId = useUniqueId();\n\tconst confirmPasswordId = useUniqueId();\n\tconst passwordVerifierId = useUniqueId();\n\n\tconst {\n\t\twatch,\n\t\tformState: { errors },\n\t\thandleSubmit,\n\t\treset,\n\t\tcontrol,\n\t} = useFormContext<PasswordFieldValues>();\n\n\tconst password = watch('password');\n\tconst passwordIsValid = useValidatePassword(password);\n\tconst { allowPasswordChange } = useAllowPasswordChange();\n\n\t// FIXME: replace to endpoint\n\tconst updatePassword = useMethod('saveUserProfile');\n\n\tconst handleSave = async ({ password }: { password?: string }) => {\n\t\ttry {\n\t\t\tawait updatePassword({ newPassword: password }, {});\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Password_changed_successfully') });\n\t\t\treset();\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t};\n\n\treturn (\n\t\t<Box {...props} is='form' autoComplete='off' onSubmit={handleSubmit(handleSave)}>\n\t\t\t<FieldGroup>\n\t\t\t\t<Field>\n\t\t\t\t\t<FieldLabel htmlFor={passwordId}>{t('New_password')}</FieldLabel>\n\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t<Controller\n\t\t\t\t\t\t\tcontrol={control}\n\t\t\t\t\t\t\tname='password'\n\t\t\t\t\t\t\trules={{\n\t\t\t\t\t\t\t\tvalidate: () => (password?.length && !passwordIsValid ? t('Password_must_meet_the_complexity_requirements') : true),\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\trender={({ field: { onChange, value } }) => (\n\t\t\t\t\t\t\t\t<PasswordInput\n\t\t\t\t\t\t\t\t\tid={passwordId}\n\t\t\t\t\t\t\t\t\tonChange={onChange}\n\t\t\t\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\t\t\t\terror={errors.password?.message}\n\t\t\t\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t\t\t\taddon={<Icon name='key' size='x20' />}\n\t\t\t\t\t\t\t\t\tdisabled={!allowPasswordChange}\n\t\t\t\t\t\t\t\t\taria-describedby={`${passwordVerifierId} ${passwordId}-hint ${passwordId}-error`}\n\t\t\t\t\t\t\t\t\taria-invalid={errors.password ? 'true' : 'false'}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</FieldRow>\n\t\t\t\t\t{!allowPasswordChange && <FieldHint id={`${passwordId}-hint`}>{t('Password_Change_Disabled')}</FieldHint>}\n\t\t\t\t\t{errors?.password && (\n\t\t\t\t\t\t<FieldError aria-live='assertive' id={`${passwordId}-error`}>\n\t\t\t\t\t\t\t{errors.password.message}\n\t\t\t\t\t\t</FieldError>\n\t\t\t\t\t)}\n\t\t\t\t\t{allowPasswordChange && <PasswordVerifier password={password} id={passwordVerifierId} />}\n\t\t\t\t</Field>\n\t\t\t\t<Field>\n\t\t\t\t\t<FieldLabel htmlFor={confirmPasswordId}>{t('Confirm_password')}</FieldLabel>\n\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t<Controller\n\t\t\t\t\t\t\tcontrol={control}\n\t\t\t\t\t\t\tname='confirmationPassword'\n\t\t\t\t\t\t\trules={{ validate: (confirmationPassword) => (password !== confirmationPassword ? t('Passwords_do_not_match') : true) }}\n\t\t\t\t\t\t\trender={({ field: { onChange, value } }) => (\n\t\t\t\t\t\t\t\t<PasswordInput\n\t\t\t\t\t\t\t\t\tid={confirmPasswordId}\n\t\t\t\t\t\t\t\t\tonChange={onChange}\n\t\t\t\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\t\t\t\terror={errors.confirmationPassword?.message}\n\t\t\t\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t\t\t\taddon={<Icon name='key' size='x20' />}\n\t\t\t\t\t\t\t\t\tdisabled={!allowPasswordChange || !passwordIsValid}\n\t\t\t\t\t\t\t\t\taria-required={password !== '' ? 'true' : 'false'}\n\t\t\t\t\t\t\t\t\taria-invalid={errors.confirmationPassword ? 'true' : 'false'}\n\t\t\t\t\t\t\t\t\taria-describedby={`${confirmPasswordId}-error`}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</FieldRow>\n\t\t\t\t\t{errors.confirmationPassword && (\n\t\t\t\t\t\t<FieldError aria-live='assertive' id={`${confirmPasswordId}-error`}>\n\t\t\t\t\t\t\t{errors.confirmationPassword.message}\n\t\t\t\t\t\t</FieldError>\n\t\t\t\t\t)}\n\t\t\t\t</Field>\n\t\t\t</FieldGroup>\n\t\t</Box>\n\t);\n};\n\nexport default ChangePassword;\n",null],"names":["_extends","Box","Field","FieldError","FieldGroup","FieldHint","FieldLabel","FieldRow","Icon","PasswordInput","useUniqueId","PasswordVerifier","useValidatePassword","useMethod","useToastMessageDispatch","useTranslation","React","Controller","useFormContext","useAllowPasswordChange","module","link","default","v","exportDefault","props","t","dispatchToastMessage","passwordId","confirmPasswordId","passwordVerifierId","watch","formState","errors","handleSubmit","reset","control","password","passwordIsValid","allowPasswordChange","updatePassword","handleSave","_ref","newPassword","type","message","error","createElement","is","autoComplete","onSubmit","htmlFor","name","rules","validate","length","render","_ref2","_errors$password","field","onChange","value","id","flexGrow","addon","size","disabled","concat","confirmationPassword","_ref3","_errors$confirmationP"],"mappings":"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"}