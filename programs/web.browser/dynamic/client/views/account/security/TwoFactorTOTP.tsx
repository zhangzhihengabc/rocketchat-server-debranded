function module(e,t,a){let l,n,r,o,c,s,i,u,d,m,f,_,y,E,p,h,k,g,w,C;a.link("@babel/runtime/helpers/extends",{default(e){l=e}},0),a.link("@rocket.chat/fuselage",{Box(e){n=e},Button(e){r=e},TextInput(e){o=e},Margins(e){c=e}},0),a.link("@rocket.chat/fuselage-hooks",{useSafely(e){s=e}},1),a.link("@rocket.chat/ui-contexts",{useSetModal(e){i=e},useToastMessageDispatch(e){u=e},useUser(e){d=e},useMethod(e){m=e},useTranslation(e){f=e}},2),a.link("react",{default(e){_=e},useState(e){y=e},useCallback(e){E=e},useEffect(e){p=e}},3),a.link("react-hook-form",{useForm(e){h=e}},4),a.link("yaqrcode",{default(e){k=e}},5),a.link("../../../components/TextCopy",{default(e){g=e}},6),a.link("../../../components/TwoFactorModal/TwoFactorTotpModal",{default(e){w=e}},7),a.link("./BackupCodesModal",{default(e){C=e}},8),a.exportDefault(e=>{var t,a;let b=f(),v=u(),x=d(),T=i(),M=m("2fa:enable"),S=m("2fa:disable"),F=m("2fa:validateTempToken"),D=m("2fa:checkCodesRemaining"),I=m("2fa:regenerateCodes"),[B,R]=s(y(!1)),[z,Q]=s(y()),[V,q]=s(y()),[U,Y]=s(y(0)),{register:j,handleSubmit:A}=h({defaultValues:{authCode:""}}),G=null==x?void 0:null===(t=x.services)||void 0===t?void 0:null===(a=t.totp)||void 0===a?void 0:a.enabled,H=E(()=>T(null),[T]);p(()=>{let e=async()=>{if(!G)return!1;let e=await D();Y(e.remaining)};e()},[D,Y,G]);let J=E(async()=>{try{let e=await M();q(e.secret),Q(k(e.url,{size:200})),R(!0)}catch(e){v({type:"error",message:e})}},[v,M,Q,R,q]),K=E(async()=>{let e=async e=>{try{let t=await S(e);if(!t)return v({type:"error",message:b("Invalid_two_factor_code")});v({type:"success",message:b("Two-factor_authentication_disabled")})}catch(e){v({type:"error",message:e})}H()};T(_.createElement(w,{onConfirm:e,onClose:H}))},[H,S,v,T,b]),L=E(async e=>{let{authCode:t}=e;try{let e=await F(t);if(!e)return v({type:"error",message:b("Invalid_two_factor_code")});T(_.createElement(C,{codes:e.codes,onClose:H}))}catch(e){v({type:"error",message:e})}},[H,v,T,b,F]),N=E(()=>{let e=async e=>{try{let t=await I(e);if(!t)return v({type:"error",message:b("Invalid_two_factor_code")});T(_.createElement(C,{codes:t.codes,onClose:H}))}catch(e){v({type:"error",message:e})}};T(_.createElement(w,{onConfirm:e,onClose:H}))},[H,v,I,T,b]);return _.createElement(n,l({display:"flex",flexDirection:"column",alignItems:"flex-start"},e),_.createElement(c,{blockEnd:8},_.createElement(n,{fontScale:"h4"},b("Two-factor_authentication")),!G&&!B&&_.createElement(_.Fragment,null,_.createElement(n,null,b("Two-factor_authentication_is_currently_disabled")),_.createElement(r,{primary:!0,onClick:J},b("Enable_two-factor_authentication"))),!G&&B&&_.createElement(_.Fragment,null,_.createElement(n,null,b("Scan_QR_code")),_.createElement(n,null,b("Scan_QR_code_alternative_s")),_.createElement(g,{text:V||""}),_.createElement(n,{is:"img",size:"x200",src:z,"aria-hidden":"true"}),_.createElement(n,{display:"flex",flexDirection:"row",w:"full"},_.createElement(o,l({placeholder:b("Enter_authentication_code")},j("authCode"))),_.createElement(r,{primary:!0,onClick:A(L)},b("Verify")))),G&&_.createElement(_.Fragment,null,_.createElement(r,{danger:!0,onClick:K},b("Disable_two-factor_authentication")),_.createElement(n,{fontScale:"p2m",mbs:8},b("Backup_codes")),_.createElement(n,null,b("You_have_n_codes_remaining",{number:U})),_.createElement(r,{onClick:N},b("Regenerate_codes")))))})}
//# sourceMappingURL=/dynamic/client/views/account/security/98289f4f5c8f42a9b13ac744acc0f0d5c2e85b9f.map
