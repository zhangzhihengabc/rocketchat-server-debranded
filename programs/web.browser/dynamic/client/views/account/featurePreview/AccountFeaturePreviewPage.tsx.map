)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/account/featurePreview/AccountFeaturePreviewPage.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { css } from '@rocket.chat/css-in-js';\nimport {\n\tButtonGroup,\n\tButton,\n\tBox,\n\tToggleSwitch,\n\tStates,\n\tStatesIcon,\n\tStatesTitle,\n\tAccordion,\n\tField,\n\tFieldGroup,\n\tFieldLabel,\n\tFieldRow,\n\tFieldHint,\n} from '@rocket.chat/fuselage';\nimport type { FeaturePreviewProps } from '@rocket.chat/ui-client';\nimport { useFeaturePreviewList } from '@rocket.chat/ui-client';\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\nimport { useToastMessageDispatch, useTranslation, useEndpoint } from '@rocket.chat/ui-contexts';\nimport type { ChangeEvent } from 'react';\nimport React, { useEffect, Fragment } from 'react';\nimport { useForm } from 'react-hook-form';\n\nimport Page from '../../../components/Page';\n\nconst AccountFeaturePreviewPage = () => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst { features, unseenFeatures } = useFeaturePreviewList();\n\n\tconst setUserPreferences = useEndpoint('POST', '/v1/users.setPreferences');\n\n\tuseEffect(() => {\n\t\tif (unseenFeatures) {\n\t\t\tconst featuresPreview = features.map((feature) => ({\n\t\t\t\tname: feature.name,\n\t\t\t\tvalue: feature.value,\n\t\t\t}));\n\n\t\t\tvoid setUserPreferences({ data: { featuresPreview } });\n\t\t}\n\t}, [setUserPreferences, features, unseenFeatures]);\n\n\tconst {\n\t\twatch,\n\t\tformState: { isDirty },\n\t\tsetValue,\n\t\thandleSubmit,\n\t\treset,\n\t} = useForm({\n\t\tdefaultValues: { featuresPreview: features },\n\t});\n\n\tconst { featuresPreview } = watch();\n\n\tconst handleSave = async () => {\n\t\ttry {\n\t\t\tawait setUserPreferences({ data: { featuresPreview } });\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Preferences_saved') });\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t} finally {\n\t\t\treset({ featuresPreview });\n\t\t}\n\t};\n\n\tconst handleFeatures = (e: ChangeEvent<HTMLInputElement>) => {\n\t\tconst updated = featuresPreview.map((item) => (item.name === e.target.name ? { ...item, value: e.target.checked } : item));\n\t\tsetValue('featuresPreview', updated, { shouldDirty: true });\n\t};\n\n\tconst grouppedFeaturesPreview = Object.entries(\n\t\tfeaturesPreview.reduce((result, currentValue) => {\n\t\t\t(result[currentValue.group] = result[currentValue.group] || []).push(currentValue);\n\t\t\treturn result;\n\t\t}, {} as Record<FeaturePreviewProps['group'], FeaturePreviewProps[]>),\n\t);\n\n\treturn (\n\t\t<Page>\n\t\t\t<Page.Header title={t('Feature_preview')} />\n\t\t\t<Page.ScrollableContentWithShadow>\n\t\t\t\t<Box maxWidth='x600' w='full' alignSelf='center'>\n\t\t\t\t\t{featuresPreview.length === 0 && (\n\t\t\t\t\t\t<States>\n\t\t\t\t\t\t\t<StatesIcon name='magnifier' />\n\t\t\t\t\t\t\t<StatesTitle>{t('No_feature_to_preview')}</StatesTitle>\n\t\t\t\t\t\t</States>\n\t\t\t\t\t)}\n\t\t\t\t\t{featuresPreview.length > 0 && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<Box\n\t\t\t\t\t\t\t\tclassName={css`\n\t\t\t\t\t\t\t\t\twhite-space: break-spaces;\n\t\t\t\t\t\t\t\t`}\n\t\t\t\t\t\t\t\tpbe={24}\n\t\t\t\t\t\t\t\tfontScale='p1'\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{t('Feature_preview_page_description')}\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t<Accordion>\n\t\t\t\t\t\t\t\t{grouppedFeaturesPreview?.map(([group, features], index) => (\n\t\t\t\t\t\t\t\t\t<Accordion.Item defaultExpanded={index === 0} key={group} title={t(group as TranslationKey)}>\n\t\t\t\t\t\t\t\t\t\t<FieldGroup>\n\t\t\t\t\t\t\t\t\t\t\t{features.map((feature) => (\n\t\t\t\t\t\t\t\t\t\t\t\t<Fragment key={feature.name}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Box display='flex' flexDirection='row' justifyContent='spaceBetween' flexGrow={1}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FieldLabel htmlFor={feature.name}>{t(feature.i18n)}</FieldLabel>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ToggleSwitch id={feature.name} checked={feature.value} name={feature.name} onChange={handleFeatures} />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{feature.description && <FieldHint mbs={12}>{t(feature.description)}</FieldHint>}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{feature.imageUrl && <Box is='img' width='100%' height='auto' mbs={16} src={feature.imageUrl} alt='' />}\n\t\t\t\t\t\t\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t</FieldGroup>\n\t\t\t\t\t\t\t\t\t</Accordion.Item>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</Accordion>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t</Box>\n\t\t\t</Page.ScrollableContentWithShadow>\n\t\t\t<Page.Footer isDirty={isDirty}>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t<Button onClick={() => reset({ featuresPreview: features })}>{t('Cancel')}</Button>\n\t\t\t\t\t<Button primary disabled={!isDirty} onClick={handleSubmit(handleSave)}>\n\t\t\t\t\t\t{t('Save_changes')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Page.Footer>\n\t\t</Page>\n\t);\n};\n\nexport default AccountFeaturePreviewPage;\n",null],"names":["_taggedTemplateLiteral","_objectSpread","css","ButtonGroup","Button","Box","ToggleSwitch","States","StatesIcon","StatesTitle","Accordion","Field","FieldGroup","FieldLabel","FieldRow","FieldHint","useFeaturePreviewList","useToastMessageDispatch","useTranslation","useEndpoint","React","useEffect","Fragment","useForm","Page","module","default","link","exportDefault","t","dispatchToastMessage","features","unseenFeatures","setUserPreferences","featuresPreview","map","feature","name","value","data","watch","formState","isDirty","setValue","handleSubmit","reset","defaultValues","handleSave","type","message","error","handleFeatures","e","updated","item","target","checked","shouldDirty","grouppedFeaturesPreview","Object","entries","reduce","result","currentValue","group","push","createElement","Header","title","ScrollableContentWithShadow","maxWidth","w","alignSelf","length","className","_templateObject","pbe","fontScale","_ref","index","Item","defaultExpanded","key","display","flexDirection","justifyContent","flexGrow","htmlFor","i18n","id","onChange","description","mbs","imageUrl","is","width","height","src","alt","Footer","onClick","primary","disabled"],"mappings":"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"}