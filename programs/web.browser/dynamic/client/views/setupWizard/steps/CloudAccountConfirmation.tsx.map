)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/setupWizard/steps/CloudAccountConfirmation.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { AwaitingConfirmationPage } from '@rocket.chat/onboarding-ui';\nimport { useToastMessageDispatch, useSettingSetValue, useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useEffect, useCallback } from 'react';\n\nimport { useSetupWizardContext } from '../contexts/SetupWizardContext';\n\nconst setIntervalTime = (interval?: number): number => (interval ? interval * 1000 : 0);\n\nconst CloudAccountConfirmation = (): ReactElement => {\n\tconst {\n\t\tregisterServer,\n\t\tcurrentStep,\n\t\tmaxSteps,\n\t\tgoToStep,\n\t\tsetupWizardData: { registrationData },\n\t\tsaveWorkspaceData,\n\t} = useSetupWizardContext();\n\tconst setShowSetupWizard = useSettingSetValue('Show_Setup_Wizard');\n\tconst cloudConfirmationPoll = useEndpoint('GET', '/v1/cloud.confirmationPoll');\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst t = useTranslation();\n\n\tconst getConfirmation = useCallback(async () => {\n\t\ttry {\n\t\t\tif (registrationData.device_code) {\n\t\t\t\tconst { pollData } = await cloudConfirmationPoll({\n\t\t\t\t\tdeviceCode: registrationData.device_code,\n\t\t\t\t});\n\n\t\t\t\tif ('successful' in pollData && pollData.successful) {\n\t\t\t\t\tawait saveWorkspaceData();\n\t\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Your_workspace_is_ready') });\n\t\t\t\t\treturn setShowSetupWizard('completed');\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (error: unknown) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t}, [cloudConfirmationPoll, registrationData.device_code, setShowSetupWizard, saveWorkspaceData, dispatchToastMessage, t]);\n\n\tuseEffect(() => {\n\t\tconst pollInterval = setInterval(() => getConfirmation(), setIntervalTime(registrationData.interval));\n\n\t\treturn (): void => clearInterval(pollInterval);\n\t}, [getConfirmation, registrationData.interval]);\n\n\treturn (\n\t\t<AwaitingConfirmationPage\n\t\t\tcurrentStep={currentStep}\n\t\t\tstepCount={maxSteps}\n\t\t\temailAddress={registrationData.cloudEmail}\n\t\t\tsecurityCode={registrationData.user_code}\n\t\t\tonResendEmailRequest={(): Promise<void> => registerServer({ email: registrationData.cloudEmail, resend: true })}\n\t\t\tonChangeEmailRequest={(): void => goToStep(3)}\n\t\t/>\n\t);\n};\n\nexport default CloudAccountConfirmation;\n",null],"names":["AwaitingConfirmationPage","useToastMessageDispatch","useSettingSetValue","useEndpoint","useTranslation","React","useEffect","useCallback","useSetupWizardContext","module","link","default","setIntervalTime","interval","exportDefault","registerServer","currentStep","maxSteps","goToStep","setupWizardData","registrationData","saveWorkspaceData","setShowSetupWizard","cloudConfirmationPoll","dispatchToastMessage","t","getConfirmation","device_code","pollData","deviceCode","successful","type","message","error","pollInterval","setInterval","clearInterval","createElement","stepCount","emailAddress","cloudEmail","securityCode","user_code","onResendEmailRequest","email","resend","onChangeEmailRequest"],"mappings":"2BAAAA,EAAsEC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA7DC,EAA0BC,IAAA,CAAM,6BAA6B,CAAAV,yBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAS,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAR,wBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,mBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAK,EAAAA,IAAAA,CAAAA,QAAAA,CAAAE,QAAAA,CAAAA,EAAAN,EAAAA,CAAA,EAAAC,UAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,iCAAAA,CAAAD,sBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAOtE,IAAMI,EAAmBC,GAA+BA,EAAWA,AAAW,IAAXA,EAAkB,EAPrFJ,EAAOK,aAAE,CASwB,KAChC,GAAM,CACLC,eAAAA,CAAc,CACdC,YAAAA,CAAW,CACXC,SAAAA,CAAQ,CACRC,SAAAA,CAAQ,CACRC,gBAAiB,CAAEC,iBAAAA,CAAAA,CAAkB,CACrCC,kBAAAA,CAAAA,CACA,CAAGb,IACEc,EAAqBpB,EAAmB,qBACxCqB,EAAwBpB,EAAY,MAAO,8BAC3CqB,EAAuBvB,IACvBwB,EAAIrB,IAEJsB,EAAkBnB,EAAY,UACnC,GAAI,CACH,GAAIa,EAAiBO,WAAW,CAAE,CACjC,GAAM,CAAEC,SAAAA,CAAAA,CAAU,CAAG,MAAML,EAAsB,CAChDM,WAAYT,EAAiBO,WAAAA,GAG9B,GAAI,eAAgBC,GAAYA,EAASE,UAAU,CAGlD,OAFA,MAAMT,IACNG,EAAqB,CAAEO,KAAM,UAAWC,QAASP,EAAE,0BAA0B,GACtEH,EAAmB,cAG3B,MAAOW,EAAgB,CACxBT,EAAqB,CAAEO,KAAM,QAASC,QAASC,CAAK,GAEtD,EAAG,CAACV,EAAuBH,EAAiBO,WAAW,CAAEL,EAAoBD,EAAmBG,EAAsBC,EAAE,EAQxH,OANAnB,EAAU,KACT,IAAM4B,EAAeC,YAAY,IAAMT,IAAmBd,EAAgBQ,EAAiBP,QAAQ,GAEnG,MAAO,IAAYuB,cAAcF,EAClC,EAAG,CAACR,EAAiBN,EAAiBP,QAAQ,CAAC,EAG9CR,EAAAgC,aAAA,CAACrC,EAAwB,CACxBgB,YAAaA,EACbsB,UAAWrB,EACXsB,aAAcnB,EAAiBoB,UAAW,CAC1CC,aAAcrB,EAAiBsB,SAAU,CACzCC,qBAAsB,IAAqB5B,EAAe,CAAE6B,MAAOxB,EAAiBoB,UAAU,CAAEK,OAAQ,CAAA,CAAI,GAC5GC,qBAAsB,IAAY5B,EAAS,EAAG,EAGjD"}