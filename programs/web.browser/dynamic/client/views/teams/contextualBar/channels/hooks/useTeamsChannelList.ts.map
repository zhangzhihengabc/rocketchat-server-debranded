)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/teams/contextualBar/channels/hooks/useTeamsChannelList.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IRoom } from '@rocket.chat/core-typings';\nimport { useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useCallback, useMemo, useState } from 'react';\n\nimport { useScrollableRecordList } from '../../../../../hooks/lists/useScrollableRecordList';\nimport { useComponentDidUpdate } from '../../../../../hooks/useComponentDidUpdate';\nimport { RecordList } from '../../../../../lib/lists/RecordList';\nimport { getConfig } from '../../../../../lib/utils/getConfig';\nimport { mapMessageFromApi } from '../../../../../lib/utils/mapMessageFromApi';\n\ntype TeamsChannelListOptions = {\n\tteamId: string;\n\ttype: 'all' | 'autoJoin';\n\ttext: string;\n};\n\nexport const useTeamsChannelList = (\n\toptions: TeamsChannelListOptions,\n): {\n\tteamsChannelList: RecordList<IRoom>;\n\tinitialItemCount: number;\n\treload: () => void;\n\tloadMoreItems: (start: number, end: number) => void;\n} => {\n\tconst apiEndPoint = useEndpoint('GET', '/v1/teams.listRooms');\n\tconst [teamsChannelList, setTeamsChannelList] = useState(() => new RecordList<IRoom>());\n\tconst reload = useCallback(() => setTeamsChannelList(new RecordList<IRoom>()), []);\n\n\tuseComponentDidUpdate(() => {\n\t\toptions && reload();\n\t}, [options, reload]);\n\n\tconst fetchData = useCallback(\n\t\tasync (start, end) => {\n\t\t\tconst { rooms, total } = await apiEndPoint({\n\t\t\t\tteamId: options.teamId,\n\t\t\t\toffset: start,\n\t\t\t\tcount: end,\n\t\t\t\tfilter: options.text,\n\t\t\t\ttype: options.type,\n\t\t\t});\n\n\t\t\treturn {\n\t\t\t\titems: rooms.map(({ _updatedAt, lastMessage, lm, ts, webRtcCallStartTime, ...room }) => ({\n\t\t\t\t\t...(lm && { lm: new Date(lm) }),\n\t\t\t\t\t...(ts && { ts: new Date(ts) }),\n\t\t\t\t\t_updatedAt: new Date(_updatedAt),\n\t\t\t\t\t...(lastMessage && { lastMessage: mapMessageFromApi(lastMessage) }),\n\t\t\t\t\t...(webRtcCallStartTime && { webRtcCallStartTime: new Date(webRtcCallStartTime) }),\n\t\t\t\t\t...room,\n\t\t\t\t})),\n\t\t\t\titemCount: total,\n\t\t\t};\n\t\t},\n\t\t[apiEndPoint, options],\n\t);\n\n\tconst { loadMoreItems, initialItemCount } = useScrollableRecordList(\n\t\tteamsChannelList,\n\t\tfetchData,\n\t\tuseMemo(() => parseInt(`${getConfig('teamsChannelListSize', 10)}`), []),\n\t);\n\n\treturn {\n\t\treload,\n\t\tteamsChannelList,\n\t\tloadMoreItems,\n\t\tinitialItemCount,\n\t};\n};\n",null],"names":["_objectSpread","_objectWithoutProperties","useEndpoint","useCallback","useMemo","useState","useScrollableRecordList","useComponentDidUpdate","RecordList","getConfig","mapMessageFromApi","module","link","default","export","useTeamsChannelList","options","apiEndPoint","teamsChannelList","setTeamsChannelList","reload","fetchData","start","end","rooms","total","teamId","offset","count","filter","text","type","items","map","_ref","_updatedAt","lastMessage","lm","ts","webRtcCallStartTime","room","_excluded","Date","itemCount","loadMoreItems","initialItemCount","parseInt","concat"],"mappings":"2BACAA,EAAuDC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,qEAA9CC,EAAaC,IAAM,CAAA,uCAA2B,CAAAC,QAAAA,CAAAA,EAAAb,EAAAA,CAAA,CAAA,EAAA,GAAAW,EAAAA,IAAAA,CAAAA,iDAAAA,CAAAE,QAAAA,CAAAA,EAAAZ,EAAAA,CAAA,CAAA,EAAA,GAAvDU,EAAOG,MAAE,CAAA,CAAAC,oBAAmB,IAAAA,CAA2B,GAAAJ,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAT,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAS,EAAAA,IAAAA,CAAAA,QAAAA,CAAAR,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,QAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,qDAAAA,CAAAL,wBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAK,EAAAA,IAAAA,CAAAA,6CAAAA,CAAAJ,sBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,sCAAAA,CAAAH,WAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,qCAAAA,CAAAF,UAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,6CAAAA,CAAAD,kBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAehD,IAAMK,EACZC,IAOA,IAAMC,EAAcf,EAAY,MAAO,uBACjC,CAACgB,EAAkBC,EAAoB,CAAGd,EAAS,IAAM,IAAIG,GAC7DY,EAASjB,EAAY,IAAMgB,EAAoB,IAAIX,GAAsB,EAAE,EAEjFD,EAAsB,KACrBS,GAAWI,GACZ,EAAG,CAACJ,EAASI,EAAO,EAEpB,IAAMC,EAAYlB,EACjB,MAAOmB,EAAOC,KACb,GAAM,CAAEC,MAAAA,CAAK,CAAEC,MAAAA,CAAAA,CAAO,CAAG,MAAMR,EAAY,CAC1CS,OAAQV,EAAQU,MAAM,CACtBC,OAAQL,EACRM,MAAOL,EACPM,OAAQb,EAAQc,IAAI,CACpBC,KAAMf,EAAQe,IAAAA,GAGf,MAAO,CACNC,MAAOR,EAAMS,GAAG,CAACC,IAAA,GAAC,CAAEC,WAAAA,CAAU,CAAEC,YAAAA,CAAW,CAAEC,GAAAA,CAAE,CAAEC,GAAAA,CAAE,CAAEC,oBAAAA,CAAAA,CAA8B,CAAAL,EAANM,EAAIvC,EAAAiC,EAAAO,GAAA,OAAAzC,EAAAA,EAAAA,EAAAA,EAAAA,EAAA,CAAA,EAC5EqC,GAAM,CAAEA,GAAI,IAAIK,KAAKL,EAAG,GACxBC,GAAM,CAAEA,GAAI,IAAII,KAAKJ,EAAG,GAAE,CAAA,EAAA,CAC9BH,WAAY,IAAIO,KAAKP,EAAW,EAC5BC,GAAe,CAAEA,YAAa1B,EAAkB0B,EAAY,GAC5DG,GAAuB,CAAEA,oBAAqB,IAAIG,KAAKH,EAAoB,GAC5EC,EAAI,GAERG,UAAWlB,EAEb,EACA,CAACR,EAAaD,EAAQ,EAGjB,CAAE4B,cAAAA,CAAa,CAAEC,iBAAAA,CAAAA,CAAkB,CAAGvC,EAC3CY,EACAG,EACAjB,EAAQ,IAAM0C,SAAQ,GAAAC,MAAA,CAAItC,EAAU,uBAAwB,MAAQ,EAAE,GAGvE,MAAO,CACNW,OAAAA,EACAF,iBAAAA,EACA0B,cAAAA,EACAC,iBAAAA,EAEF"}