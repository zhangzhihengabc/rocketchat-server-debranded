)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/teams/contextualBar/channels/RoomActions.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Box, CheckBox, Menu, Option } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useSetModal, useToastMessageDispatch, usePermission, useTranslation } from '@rocket.chat/ui-contexts';\nimport React, { useMemo } from 'react';\n\nimport { useEndpointAction } from '../../../../hooks/useEndpointAction';\nimport { roomCoordinator } from '../../../../lib/rooms/roomCoordinator';\nimport ConfirmationModal from './ConfirmationModal';\n\nconst useReactModal = (Component, props) => {\n\tconst setModal = useSetModal();\n\n\treturn useMutableCallback(() => {\n\t\tconst handleClose = () => {\n\t\t\tsetModal(null);\n\t\t};\n\n\t\tsetModal(() => <Component onClose={handleClose} {...props} />);\n\t});\n};\n\nconst RoomActions = ({ room, reload }) => {\n\tconst t = useTranslation();\n\tconst rid = room._id;\n\tconst type = room.t;\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst canDeleteTeamChannel = usePermission(type === 'c' ? 'delete-c' : 'delete-p', rid);\n\tconst canEditTeamChannel = usePermission('edit-team-channel', rid);\n\tconst canRemoveTeamChannel = usePermission('remove-team-channel', rid);\n\n\tconst updateRoomEndpoint = useEndpointAction('POST', '/v1/teams.updateRoom');\n\tconst removeRoomEndpoint = useEndpointAction('POST', '/v1/teams.removeRoom', { successMessage: t('Room_has_been_removed') });\n\tconst deleteRoomEndpoint = useEndpointAction('POST', room.t === 'c' ? '/v1/channels.delete' : '/v1/groups.delete', {\n\t\tsuccessMessage: t('Room_has_been_deleted'),\n\t});\n\n\tconst RemoveFromTeamAction = useReactModal(ConfirmationModal, {\n\t\tonConfirmAction: async () => {\n\t\t\ttry {\n\t\t\t\tawait removeRoomEndpoint({ teamId: room.teamId, roomId: room._id });\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t\treload();\n\t\t},\n\t\tlabelButton: t('Remove'),\n\t\tcontent: (\n\t\t\t<Box is='span' size='14px'>\n\t\t\t\t{t('Team_Remove_from_team_modal_content', {\n\t\t\t\t\tteamName: roomCoordinator.getRoomName(room.t, room),\n\t\t\t\t})}\n\t\t\t</Box>\n\t\t),\n\t});\n\n\tconst DeleteChannelAction = useReactModal(ConfirmationModal, {\n\t\tonConfirmAction: async () => {\n\t\t\ttry {\n\t\t\t\tawait deleteRoomEndpoint({ roomId: room._id });\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t\treload();\n\t\t},\n\t\tlabelButton: t('Delete'),\n\t\tcontent: (\n\t\t\t<>\n\t\t\t\t<Box is='span' size='14px' color='status-font-on-danger' fontWeight='600'>\n\t\t\t\t\t{t('Team_Delete_Channel_modal_content_danger')}\n\t\t\t\t</Box>\n\t\t\t\t<Box is='span' size='14px'>\n\t\t\t\t\t{' '}\n\t\t\t\t\t{t('Team_Delete_Channel_modal_content')}\n\t\t\t\t</Box>\n\t\t\t</>\n\t\t),\n\t});\n\n\tconst menuOptions = useMemo(() => {\n\t\tconst AutoJoinAction = async () => {\n\t\t\ttry {\n\t\t\t\tawait updateRoomEndpoint({\n\t\t\t\t\troomId: rid,\n\t\t\t\t\tisDefault: !room.teamDefault,\n\t\t\t\t});\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\n\t\t\treload();\n\t\t};\n\n\t\treturn [\n\t\t\tcanEditTeamChannel && {\n\t\t\t\tlabel: {\n\t\t\t\t\tlabel: t('Team_Auto-join'),\n\t\t\t\t\ticon: type === 'c' ? 'hash' : 'hashtag-lock',\n\t\t\t\t},\n\t\t\t\taction: AutoJoinAction,\n\t\t\t},\n\t\t\tcanRemoveTeamChannel && {\n\t\t\t\tlabel: {\n\t\t\t\t\tlabel: t('Team_Remove_from_team'),\n\t\t\t\t\ticon: 'cross',\n\t\t\t\t},\n\t\t\t\taction: RemoveFromTeamAction,\n\t\t\t},\n\t\t\tcanDeleteTeamChannel && {\n\t\t\t\tlabel: {\n\t\t\t\t\tlabel: t('Delete'),\n\t\t\t\t\ticon: 'trash',\n\t\t\t\t},\n\t\t\t\taction: DeleteChannelAction,\n\t\t\t},\n\t\t].filter(Boolean);\n\t}, [\n\t\tDeleteChannelAction,\n\t\tRemoveFromTeamAction,\n\t\trid,\n\t\ttype,\n\t\troom.teamDefault,\n\t\tt,\n\t\tupdateRoomEndpoint,\n\t\treload,\n\t\tdispatchToastMessage,\n\t\tcanDeleteTeamChannel,\n\t\tcanRemoveTeamChannel,\n\t\tcanEditTeamChannel,\n\t]);\n\n\treturn (\n\t\t<Menu\n\t\t\tflexShrink={0}\n\t\t\tkey='menu'\n\t\t\ttiny\n\t\t\trenderItem={({ label: { label, icon }, ...props }) =>\n\t\t\t\ticon.match(/hash/) ? (\n\t\t\t\t\t<Option {...props} label={label} icon={icon}>\n\t\t\t\t\t\t<CheckBox checked={room.teamDefault} />\n\t\t\t\t\t</Option>\n\t\t\t\t) : (\n\t\t\t\t\t<Box color='status-font-on-danger'>\n\t\t\t\t\t\t<Option {...props} label={label} icon={icon} />\n\t\t\t\t\t</Box>\n\t\t\t\t)\n\t\t\t}\n\t\t\toptions={(canEditTeamChannel || canRemoveTeamChannel || canDeleteTeamChannel) && menuOptions}\n\t\t/>\n\t);\n};\n\nexport default RoomActions;\n",null],"names":["_objectWithoutProperties","_extends","Box","CheckBox","Menu","Option","useMutableCallback","useSetModal","useToastMessageDispatch","usePermission","useTranslation","React","useMemo","useEndpointAction","roomCoordinator","ConfirmationModal","module","link","default","v","useReactModal","Component","props","setModal","handleClose","createElement","onClose","exportDefault","_ref","room","reload","t","rid","_id","type","dispatchToastMessage","canDeleteTeamChannel","canEditTeamChannel","canRemoveTeamChannel","updateRoomEndpoint","removeRoomEndpoint","successMessage","deleteRoomEndpoint","RemoveFromTeamAction","onConfirmAction","teamId","roomId","error","message","labelButton","content","is","size","teamName","getRoomName","DeleteChannelAction","Fragment","color","fontWeight","menuOptions","AutoJoinAction","isDefault","teamDefault","label","icon","action","filter","Boolean","flexShrink","key","tiny","renderItem","_ref2","_excluded","match","checked","options"],"mappings":"2BAAIA,EAAsIC,EAAtIC,EAAIC,EAASC,EAAKC,EAA8HC,EAAkHC,EAAYC,EAAwBC,EAAcC,EAAyNC,EAAMC,EAA+EC,EAAuHC,EAAmHC,kBAAnzBC,EAAOC,IAAI,CAAC,iDAAiD,CAACC,QAAQC,CAAC,EAAEnB,EAAyBmB,CAAC,CAAC,EAAE,GAAgBH,EAAOC,IAAI,CAAC,iCAAiC,CAACC,QAAQC,CAAC,EAAElB,EAASkB,CAAC,CAAC,EAAE,GAA5LH,EAAOC,IAAI,CAAC,wBAAwB,CAACf,IAAIiB,CAAC,EAAEjB,EAAIiB,CAAC,EAAEhB,SAASgB,CAAC,EAAEhB,EAASgB,CAAC,EAAEf,KAAKe,CAAC,EAAEf,EAAKe,CAAC,EAAEd,OAAOc,CAAC,EAAEd,EAAOc,CAAC,CAAC,EAAE,GAA0BH,EAAOC,IAAI,CAAC,8BAA8B,CAACX,mBAAmBa,CAAC,EAAEb,EAAmBa,CAAC,CAAC,EAAE,GAAwEH,EAAOC,IAAI,CAAC,2BAA2B,CAACV,YAAYY,CAAC,EAAEZ,EAAYY,CAAC,EAAEX,wBAAwBW,CAAC,EAAEX,EAAwBW,CAAC,EAAEV,cAAcU,CAAC,EAAEV,EAAcU,CAAC,EAAET,eAAeS,CAAC,EAAET,EAAeS,CAAC,CAAC,EAAE,GAAqBH,EAAOC,IAAI,CAAC,QAAQ,CAACC,QAAQC,CAAC,EAAER,EAAMQ,CAAC,EAAEP,QAAQO,CAAC,EAAEP,EAAQO,CAAC,CAAC,EAAE,GAAyBH,EAAOC,IAAI,CAAC,sCAAsC,CAACJ,kBAAkBM,CAAC,EAAEN,EAAkBM,CAAC,CAAC,EAAE,GAAuBH,EAAOC,IAAI,CAAC,wCAAwC,CAACH,gBAAgBK,CAAC,EAAEL,EAAgBK,CAAC,CAAC,EAAE,GAAyBH,EAAOC,IAAI,CAAC,sBAAsB,CAACC,QAAQC,CAAC,EAAEJ,EAAkBI,CAAC,CAAC,EAAE,GASt6B,IAAMC,EAAgB,CAACC,EAAWC,KACjC,IAAMC,EAAWhB,IAEjB,OAAOD,EAAmB,KACzB,IAAMkB,EAAc,KACnBD,EAAS,KACV,EAEAA,EAAS,IAAMZ,EAAAc,aAAA,CAACJ,EAASpB,EAAA,CAACyB,QAASF,CAAY,EAAKF,IACrD,EACD,EAnBAN,EAAOW,aAAa,CAqBAC,IAAsB,GAArB,CAAEC,KAAAA,CAAI,CAAEC,OAAAA,CAAAA,CAAQ,CAAAF,EAC9BG,EAAIrB,IACJsB,EAAMH,EAAKI,GAAG,CACdC,EAAOL,EAAKE,CAAC,CAEbI,EAAuB3B,IAEvB4B,EAAuB3B,EAAcyB,AAAS,MAATA,EAAe,WAAa,WAAYF,GAC7EK,EAAqB5B,EAAc,oBAAqBuB,GACxDM,EAAuB7B,EAAc,sBAAuBuB,GAE5DO,EAAqB1B,EAAkB,OAAQ,wBAC/C2B,EAAqB3B,EAAkB,OAAQ,uBAAwB,CAAE4B,eAAgBV,EAAE,wBAAyB,GACpHW,EAAqB7B,EAAkB,OAAQgB,AAAW,MAAXA,EAAKE,CAAC,CAAW,sBAAwB,oBAAqB,CAClHU,eAAgBV,EAAE,wBACnB,GAEMY,EAAuBvB,EAAcL,EAAmB,CAC7D6B,gBAAiB,UAChB,GAAI,CACH,MAAMJ,EAAmB,CAAEK,OAAQhB,EAAKgB,MAAM,CAAEC,OAAQjB,EAAKI,GAAAA,AAAI,EAClE,CAAE,MAAOc,EAAO,CACfZ,EAAqB,CAAED,KAAM,QAASc,QAASD,CAAM,EACtD,CACAjB,GACD,EACAmB,YAAalB,EAAE,UACfmB,QACCvC,EAAAc,aAAA,CAACvB,EAAG,CAACiD,GAAG,OAAOC,KAAK,MAAM,EACxBrB,EAAE,sCAAuC,CACzCsB,SAAUvC,EAAgBwC,WAAW,CAACzB,EAAKE,CAAC,CAAEF,EAC/C,GAGH,GAEM0B,EAAsBnC,EAAcL,EAAmB,CAC5D6B,gBAAiB,UAChB,GAAI,CACH,MAAMF,EAAmB,CAAEI,OAAQjB,EAAKI,GAAAA,AAAI,EAC7C,CAAE,MAAOc,EAAO,CACfZ,EAAqB,CAAED,KAAM,QAASc,QAASD,CAAM,EACtD,CACAjB,GACD,EACAmB,YAAalB,EAAE,UACfmB,QACCvC,EAAAc,aAAA,CAAAd,EAAA6C,QAAA,CAAA,KACC7C,EAAAc,aAAA,CAACvB,EAAG,CAACiD,GAAG,OAAOC,KAAK,OAAOK,MAAM,wBAAwBC,WAAW,KAAK,EACvE3B,EAAE,6CAEJpB,EAAAc,aAAA,CAACvB,EAAG,CAACiD,GAAG,OAAOC,KAAK,MAAM,EACxB,IACArB,EAAE,sCAIP,GAEM4B,EAAc/C,EAAQ,KAC3B,IAAMgD,EAAiB,UACtB,GAAI,CACH,MAAMrB,EAAmB,CACxBO,OAAQd,EACR6B,UAAW,CAAChC,EAAKiC,WAAAA,AAClB,EACD,CAAE,MAAOf,EAAO,CACfZ,EAAqB,CAAED,KAAM,QAASc,QAASD,CAAM,EACtD,CAEAjB,GACD,EAEA,MAAO,CACNO,GAAsB,CACrB0B,MAAO,CACNA,MAAOhC,EAAE,kBACTiC,KAAM9B,AAAS,MAATA,EAAe,OAAS,cAC/B,EACA+B,OAAQL,CACT,EACAtB,GAAwB,CACvByB,MAAO,CACNA,MAAOhC,EAAE,yBACTiC,KAAM,OACP,EACAC,OAAQtB,CACT,EACAP,GAAwB,CACvB2B,MAAO,CACNA,MAAOhC,EAAE,UACTiC,KAAM,OACP,EACAC,OAAQV,CACT,EACA,CAACW,MAAM,CAACC,QACV,EAAG,CACFZ,EACAZ,EACAX,EACAE,EACAL,EAAKiC,WAAW,CAChB/B,EACAQ,EACAT,EACAK,EACAC,EACAE,EACAD,EACA,EAED,OACC1B,EAAAc,aAAA,CAACrB,EAAI,CACJgE,WAAY,EACZC,IAAI,OACJC,KAAI,CAAA,EACJC,WAAYC,IAAA,GAAC,CAAET,MAAO,CAAEA,MAAAA,CAAK,CAAEC,KAAAA,CAAAA,CAAK,CAAa,CAAAQ,EAAPlD,EAAKtB,EAAAwE,EAAAC,GAAA,OAC9CT,EAAKU,KAAK,CAAC,QACV/D,EAAAc,aAAA,CAACpB,EAAMJ,EAAA,CAAA,EAAKqB,EAAK,CAAEyC,MAAOA,EAAOC,KAAMA,CAAK,GAC3CrD,EAAAc,aAAA,CAACtB,EAAQ,CAACwE,QAAS9C,EAAKiC,WAAAA,AAAY,IAGrCnD,EAAAc,aAAA,CAACvB,EAAG,CAACuD,MAAM,uBAAuB,EACjC9C,EAAAc,aAAA,CAACpB,EAAMJ,EAAA,CAAA,EAAKqB,EAAK,CAAEyC,MAAOA,EAAOC,KAAMA,CAAK,IAE7C,EAEFY,QAAS,AAACvC,CAAAA,GAAsBC,GAAwBF,CAAAA,GAAyBuB,CAAY,EAGhG"}