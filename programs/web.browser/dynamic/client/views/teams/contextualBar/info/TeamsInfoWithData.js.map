)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/views/teams/contextualBar/info/TeamsInfoWithData.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport {\n\tuseSetModal,\n\tuseToastMessageDispatch,\n\tuseUserId,\n\tuseSetting,\n\tusePermission,\n\tuseMethod,\n\tuseTranslation,\n\tuseRouter,\n} from '@rocket.chat/ui-contexts';\nimport React, { useCallback } from 'react';\n\nimport { UiTextContext } from '../../../../../definition/IRoomTypeConfig';\nimport { GenericModalDoNotAskAgain } from '../../../../components/GenericModal';\nimport { useDontAskAgain } from '../../../../hooks/useDontAskAgain';\nimport { useEndpointAction } from '../../../../hooks/useEndpointAction';\nimport { roomCoordinator } from '../../../../lib/rooms/roomCoordinator';\nimport { useDeleteRoom } from '../../../hooks/roomActions/useDeleteRoom';\nimport { useRoom } from '../../../room/contexts/RoomContext';\nimport { useRoomToolbox } from '../../../room/contexts/RoomToolboxContext';\nimport ConvertToChannelModal from '../../ConvertToChannelModal';\nimport LeaveTeam from './LeaveTeam';\nimport TeamsInfo from './TeamsInfo';\n\nconst retentionPolicyMaxAge = {\n\tc: 'RetentionPolicy_MaxAge_Channels',\n\tp: 'RetentionPolicy_MaxAge_Groups',\n\td: 'RetentionPolicy_MaxAge_DMs',\n};\n\nconst retentionPolicyAppliesTo = {\n\tc: 'RetentionPolicy_AppliesToChannels',\n\tp: 'RetentionPolicy_AppliesToGroups',\n\td: 'RetentionPolicy_AppliesToDMs',\n};\n\nconst TeamsInfoWithLogic = ({ openEditing }) => {\n\tconst room = useRoom();\n\tconst { openTab, closeTab } = useRoomToolbox();\n\tconst t = useTranslation();\n\tconst userId = useUserId();\n\n\tconst retentionPolicyEnabled = useSetting('RetentionPolicy_Enabled');\n\tconst retentionPolicy = {\n\t\tretentionPolicyEnabled,\n\t\tmaxAgeDefault: useSetting(retentionPolicyMaxAge[room.t]) || 30,\n\t\tretentionEnabledDefault: useSetting(retentionPolicyAppliesTo[room.t]),\n\t\texcludePinnedDefault: useSetting('RetentionPolicy_DoNotPrunePinned'),\n\t\tfilesOnlyDefault: useSetting('RetentionPolicy_FilesOnly'),\n\t};\n\n\tconst dontAskHideRoom = useDontAskAgain('hideRoom');\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst setModal = useSetModal();\n\tconst closeModal = useMutableCallback(() => setModal());\n\n\tconst leaveTeam = useEndpointAction('POST', '/v1/teams.leave');\n\tconst convertTeamToChannel = useEndpointAction('POST', '/v1/teams.convertToChannel');\n\n\tconst hideTeam = useMethod('hideRoom');\n\n\tconst router = useRouter();\n\n\tconst canEdit = usePermission('edit-team-channel', room._id);\n\n\t// const canLeave = usePermission('leave-team'); /* && room.cl !== false && joined */\n\n\tconst { handleDelete, canDeleteRoom } = useDeleteRoom(room);\n\n\tconst onClickLeave = useMutableCallback(() => {\n\t\tconst onConfirm = async (roomsLeft) => {\n\t\t\troomsLeft = Object.keys(roomsLeft);\n\t\t\tconst roomsToLeave = Array.isArray(roomsLeft) && roomsLeft.length > 0 ? roomsLeft : [];\n\n\t\t\ttry {\n\t\t\t\tawait leaveTeam({\n\t\t\t\t\tteamId: room.teamId,\n\t\t\t\t\t...(roomsToLeave.length && { rooms: roomsToLeave }),\n\t\t\t\t});\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Teams_left_team_successfully') });\n\t\t\t\trouter.navigate('/home');\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t} finally {\n\t\t\t\tcloseModal();\n\t\t\t}\n\t\t};\n\n\t\tsetModal(<LeaveTeam onConfirm={onConfirm} onCancel={closeModal} teamId={room.teamId} />);\n\t});\n\n\tconst handleHide = useMutableCallback(async () => {\n\t\tconst hide = async () => {\n\t\t\ttry {\n\t\t\t\tawait hideTeam(room._id);\n\t\t\t\trouter.navigate('/home');\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t} finally {\n\t\t\t\tcloseModal();\n\t\t\t}\n\t\t};\n\n\t\tconst warnText = roomCoordinator.getRoomDirectives(room.t).getUiText(UiTextContext.HIDE_WARNING);\n\n\t\tif (dontAskHideRoom) {\n\t\t\treturn hide();\n\t\t}\n\n\t\tsetModal(\n\t\t\t<GenericModalDoNotAskAgain\n\t\t\t\tvariant='danger'\n\t\t\t\tconfirmText={t('Yes_hide_it')}\n\t\t\t\tcancelText={t('Cancel')}\n\t\t\t\tonClose={closeModal}\n\t\t\t\tonCancel={closeModal}\n\t\t\t\tonConfirm={hide}\n\t\t\t\tdontAskAgain={{\n\t\t\t\t\taction: 'hideRoom',\n\t\t\t\t\tlabel: t('Hide_room'),\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{t(warnText, room.fname)}\n\t\t\t</GenericModalDoNotAskAgain>,\n\t\t);\n\t});\n\n\tconst onClickViewChannels = useCallback(() => openTab('team-channels'), [openTab]);\n\n\tconst onClickConvertToChannel = useMutableCallback(() => {\n\t\tconst onConfirm = async (roomsToRemove) => {\n\t\t\ttry {\n\t\t\t\tawait convertTeamToChannel({\n\t\t\t\t\tteamId: room.teamId,\n\t\t\t\t\troomsToRemove: Object.keys(roomsToRemove),\n\t\t\t\t});\n\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Success') });\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t} finally {\n\t\t\t\tcloseModal();\n\t\t\t}\n\t\t};\n\n\t\tsetModal(\n\t\t\t<ConvertToChannelModal onClose={closeModal} onCancel={closeModal} onConfirm={onConfirm} teamId={room.teamId} userId={userId} />,\n\t\t);\n\t});\n\n\treturn (\n\t\t<TeamsInfo\n\t\t\troom={room}\n\t\t\tretentionPolicy={retentionPolicyEnabled && retentionPolicy}\n\t\t\tonClickEdit={canEdit && openEditing}\n\t\t\tonClickClose={closeTab}\n\t\t\tonClickDelete={canDeleteRoom && handleDelete}\n\t\t\tonClickLeave={/* canLeave && */ onClickLeave}\n\t\t\tonClickHide={/* joined && */ handleHide}\n\t\t\tonClickViewChannels={onClickViewChannels}\n\t\t\tonClickConvertToChannel={canEdit && onClickConvertToChannel}\n\t\t/>\n\t);\n};\n\nexport default TeamsInfoWithLogic;\n",null],"names":["_objectSpread","useMutableCallback","useSetModal","useToastMessageDispatch","useUserId","useSetting","usePermission","useMethod","useTranslation","useRouter","React","useCallback","UiTextContext","GenericModalDoNotAskAgain","useDontAskAgain","useEndpointAction","roomCoordinator","useDeleteRoom","useRoom","useRoomToolbox","ConvertToChannelModal","LeaveTeam","TeamsInfo","module","link","default","v","retentionPolicyMaxAge","c","p","d","retentionPolicyAppliesTo","exportDefault","_ref","openEditing","room","openTab","closeTab","t","userId","retentionPolicyEnabled","retentionPolicy","maxAgeDefault","retentionEnabledDefault","excludePinnedDefault","filesOnlyDefault","dontAskHideRoom","dispatchToastMessage","setModal","closeModal","leaveTeam","convertTeamToChannel","hideTeam","router","canEdit","_id","handleDelete","canDeleteRoom","onClickLeave","onConfirm","roomsLeft","Object","keys","roomsToLeave","Array","isArray","length","teamId","rooms","type","message","navigate","error","createElement","onCancel","handleHide","hide","warnText","getRoomDirectives","getUiText","HIDE_WARNING","variant","confirmText","cancelText","onClose","dontAskAgain","action","label","fname","onClickViewChannels","onClickConvertToChannel","roomsToRemove","onClickEdit","onClickClose","onClickDelete","onClickHide"],"mappings":"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"}