function module(e,t,n){let l,r,a,c,o,i,m,s,u,_,d,E,f,p,g,h,v,k,C,b,T,F,S,q,y,x,B;n.link("@babel/runtime/helpers/extends",{default(e){l=e}},0),n.link("@rocket.chat/fuselage",{Field(e){r=e},FieldGroup(e){a=e},Button(e){c=e},TextInput(e){o=e},Modal(e){i=e},Box(e){m=e},CheckBox(e){s=e},Divider(e){u=e},EmailInput(e){_=e},FieldLabel(e){d=e},FieldRow(e){E=e},FieldError(e){f=e}},0),n.link("@rocket.chat/ui-contexts",{usePermission(e){p=e},useSetting(e){g=e},useTranslation(e){h=e},useUserPreference(e){v=e}},1),n.link("react",{default(e){k=e},useCallback(e){C=e},useState(e){b=e},useEffect(e){T=e},useMemo(e){F=e}},2),n.link("react-hook-form",{useForm(e){S=e}},3),n.link("../../../../ee/client/hooks/useHasLicenseModule",{useHasLicenseModule(e){q=e}},4),n.link("../../../lib/toast",{dispatchToastMessage(e){y=e}},5),n.link("../../GenericModal",{default(e){x=e}},6),n.link("../Tags",{default(e){B=e}},7),n.exportDefault(e=>{var t,n,j,w,M;let{department:P,visitorEmail:D,onCancel:G,onConfirm:L}=e,O=h(),{formState:{errors:A},handleSubmit:H,register:I,setError:R,setFocus:N,setValue:U,watch:W}=S(),z=g("Livechat_request_comment_when_closing_conversation"),[J,K]=b(!1),Q=W("tags"),V=W("comment"),X=W("transcriptEmail"),Y=W("subject"),Z=null!==(t=v("omnichannelTranscriptEmail"))&&void 0!==t&&t,$=null!==(n=v("omnichannelTranscriptPDF"))&&void 0!==n&&n,ee=q("livechat-enterprise"),et=p("request-pdf-transcript"),en=p("send-omnichannel-chat-transcript"),el=en&&D,er=et&&ee,ea=el||er,ec=C(e=>{let{comment:t,tags:n,transcriptPDF:l,transcriptEmail:r,subject:a}=e,c=r&&D?{email:D,subject:a}:void 0;!(null!=t&&t.trim())&&z&&R("comment",{type:"custom",message:O("The_field_is_required",O("Comment"))}),r&&!a&&R("subject",{type:"custom",message:O("The_field_is_required",O("Subject"))}),!(null!=n&&n.length)&&J&&R("tags",{type:"custom",message:O("error-tags-must-be-assigned-before-closing-chat")}),(!A.comment||A.tags)&&L(t,n,{omnichannelTranscriptPDF:!!l,omnichannelTranscriptEmail:!!r},c)},[z,J,D,A,R,O,L]),eo=F(()=>{let e=J&&!(null!=Q&&Q.length)||A.tags,t=z&&!(null!=V&&V.trim())||A.comment,n=X&&(!D||!Y);return!!(e||t||n)},[V,z,A,J,Q,X,D,Y]);return T(()=>{null!=P&&P.requestTagBeforeClosingChat&&K(!0)},[P]),T(()=>{z&&N("comment")},[z,N]),T(()=>{J&&I("tags")},[I,J]),T(()=>{if(X){if(!D){y({type:"error",message:O("Customer_without_registered_email")});return}U("subject",Y||O("Transcript_of_your_livechat_conversation"))}},[X,U,D,Y,O]),z||J||ea?k.createElement(i,{wrapperFunction:e=>k.createElement(m,l({is:"form",onSubmit:H(ec)},e))},k.createElement(i.Header,null,k.createElement(i.Icon,{name:"baloon-close-top-right"}),k.createElement(i.Title,null,O("Wrap_up_conversation")),k.createElement(i.Close,{onClick:G})),k.createElement(i.Content,{fontScale:"p2"},k.createElement(m,{color:"annotation"},O("Close_room_description")),k.createElement(a,null,k.createElement(r,null,k.createElement(d,{required:z},O("Comment")),k.createElement(E,null,k.createElement(o,l({},I("comment"),{error:A.comment&&O("error-the-field-is-required",{field:O("Comment")}),flexGrow:1,placeholder:O("Please_add_a_comment")}))),k.createElement(f,null,null===(j=A.comment)||void 0===j?void 0:j.message)),k.createElement(r,null,k.createElement(B,l({tagRequired:J,tags:Q,handler:e=>{U("tags",e)}},P&&{department:P._id})),k.createElement(f,null,null===(w=A.tags)||void 0===w?void 0:w.message)),ea&&k.createElement(k.Fragment,null,k.createElement(r,null,k.createElement(u,null),k.createElement(d,{marginBlockStart:8},O("Chat_transcript"))),er&&k.createElement(r,{marginBlockStart:10},k.createElement(E,null,k.createElement(s,l({id:"transcript-pdf"},I("transcriptPDF",{value:$}))),k.createElement(d,{htmlFor:"transcript-pdf",color:"default",fontScale:"c1"},O("Omnichannel_transcript_pdf")))),el&&k.createElement(k.Fragment,null,k.createElement(r,{marginBlockStart:10},k.createElement(E,null,k.createElement(s,l({id:"transcript-email"},I("transcriptEmail",{value:Z}))),k.createElement(d,{htmlFor:"transcript-email",color:"default",fontScale:"c1"},O("Omnichannel_transcript_email")))),X&&k.createElement(k.Fragment,null,k.createElement(r,{marginBlockStart:14},k.createElement(d,{required:!0},O("Contact_email")),k.createElement(E,null,k.createElement(_,{value:D,required:!0,disabled:!0,flexGrow:1}))),k.createElement(r,{marginBlockStart:12},k.createElement(d,{required:!0},O("Subject")),k.createElement(E,null,k.createElement(o,l({},I("subject",{required:!0}),{className:"active",error:A.subject&&O("error-the-field-is-required",{field:O("Subject")}),flexGrow:1}))),k.createElement(f,null,null===(M=A.subject)||void 0===M?void 0:M.message)))),k.createElement(r,{marginBlockStart:16},k.createElement(d,{color:"annotation",fontScale:"c1"},er&&el?O("These_options_affect_this_conversation_only_To_set_default_selections_go_to_My_Account_Omnichannel"):O("This_option_affect_this_conversation_only_To_set_default_selection_go_to_My_Account_Omnichannel")))))),k.createElement(i.Footer,null,k.createElement(i.FooterControllers,null,k.createElement(c,{onClick:G},O("Cancel")),k.createElement(c,{type:"submit",disabled:eo,primary:!0},O("Confirm"))))):k.createElement(x,{variant:"warning",title:O("Are_you_sure_you_want_to_close_this_chat"),onConfirm:()=>L(),onCancel:G,onClose:G,confirmText:O("Confirm")})})}
//# sourceMappingURL=/dynamic/client/components/Omnichannel/modals/bab4c61f7d30531cf84ab2a559df6335cd9f398d.map
