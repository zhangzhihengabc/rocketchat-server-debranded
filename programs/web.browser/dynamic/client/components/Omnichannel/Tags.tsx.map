)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/components/Omnichannel/Tags.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { TextInput, Chip, Button, FieldLabel, FieldRow } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useToastMessageDispatch, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ChangeEvent, ReactElement } from 'react';\nimport React, { useMemo, useState } from 'react';\n\nimport { CurrentChatTags } from '../../views/omnichannel/additionalForms';\nimport { FormSkeleton } from './Skeleton';\nimport { useLivechatTags } from './hooks/useLivechatTags';\n\ntype TagsProps = {\n\ttags?: string[];\n\thandler: (value: string[]) => void;\n\terror?: string;\n\ttagRequired?: boolean;\n\tdepartment?: string;\n};\n\nconst Tags = ({ tags = [], handler, error, tagRequired, department }: TagsProps): ReactElement => {\n\tconst t = useTranslation();\n\n\tconst { data: tagsResult, isInitialLoading } = useLivechatTags({\n\t\tdepartment,\n\t\tviewAll: !department,\n\t});\n\n\tconst customTags = useMemo(() => {\n\t\treturn tags.filter((tag) => !tagsResult?.tags.find((rtag) => rtag.name === tag));\n\t}, [tags, tagsResult?.tags]);\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst [tagValue, handleTagValue] = useState('');\n\n\tconst paginatedTagValue = useMemo(() => tags.map((tag) => ({ label: tag, value: tag })), [tags]);\n\n\tconst removeTag = (tagToRemove: string): void => {\n\t\tif (!tags) return;\n\n\t\thandler(tags.filter((tag) => tag !== tagToRemove));\n\t};\n\n\tconst handleTagTextSubmit = useMutableCallback(() => {\n\t\tif (!tags) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!tagValue || tagValue.trim() === '') {\n\t\t\tdispatchToastMessage({ type: 'error', message: t('Enter_a_tag') });\n\t\t\thandleTagValue('');\n\t\t\treturn;\n\t\t}\n\n\t\tif (tags.includes(tagValue)) {\n\t\t\tdispatchToastMessage({ type: 'error', message: t('Tag_already_exists') });\n\t\t\treturn;\n\t\t}\n\t\thandler([...tags, tagValue]);\n\t\thandleTagValue('');\n\t});\n\n\tif (isInitialLoading) {\n\t\treturn <FormSkeleton />;\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<FieldLabel required={tagRequired} mb={4}>\n\t\t\t\t{t('Tags')}\n\t\t\t</FieldLabel>\n\n\t\t\t{tagsResult?.tags && tagsResult?.tags.length ? (\n\t\t\t\t<FieldRow>\n\t\t\t\t\t<CurrentChatTags\n\t\t\t\t\t\tvalue={paginatedTagValue}\n\t\t\t\t\t\thandler={(tags: { label: string; value: string }[]): void => {\n\t\t\t\t\t\t\thandler(tags.map((tag) => tag.label));\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tdepartment={department}\n\t\t\t\t\t\tviewAll={!department}\n\t\t\t\t\t/>\n\t\t\t\t</FieldRow>\n\t\t\t) : (\n\t\t\t\t<>\n\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t<TextInput\n\t\t\t\t\t\t\terror={error}\n\t\t\t\t\t\t\tvalue={tagValue}\n\t\t\t\t\t\t\tonChange={({ currentTarget }: ChangeEvent<HTMLInputElement>): void => handleTagValue(currentTarget.value)}\n\t\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t\tplaceholder={t('Enter_a_tag')}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Button disabled={!tagValue} mis={8} title={t('Add')} onClick={handleTagTextSubmit}>\n\t\t\t\t\t\t\t{t('Add')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</FieldRow>\n\t\t\t\t</>\n\t\t\t)}\n\n\t\t\t{customTags.length > 0 && (\n\t\t\t\t<FieldRow justifyContent='flex-start'>\n\t\t\t\t\t{customTags?.map((tag, i) => (\n\t\t\t\t\t\t<Chip key={i} onClick={(): void => removeTag(tag)} mie={8}>\n\t\t\t\t\t\t\t{tag}\n\t\t\t\t\t\t</Chip>\n\t\t\t\t\t))}\n\t\t\t\t</FieldRow>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default Tags;\n",null],"names":["TextInput","Chip","Button","FieldLabel","FieldRow","useMutableCallback","useToastMessageDispatch","useTranslation","React","useMemo","useState","CurrentChatTags","FormSkeleton","useLivechatTags","module","v","default","exportDefault","_ref","tags","handler","error","tagRequired","department","t","data","tagsResult","isInitialLoading","viewAll","customTags","filter","tag","find","rtag","name","dispatchToastMessage","tagValue","handleTagValue","paginatedTagValue","map","label","value","removeTag","tagToRemove","handleTagTextSubmit","trim","type","message","includes","createElement","Fragment","required","mb","length","onChange","_ref2","currentTarget","flexGrow","placeholder","disabled","mis","title","onClick","justifyContent","i","key","mie"],"mappings":"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"}