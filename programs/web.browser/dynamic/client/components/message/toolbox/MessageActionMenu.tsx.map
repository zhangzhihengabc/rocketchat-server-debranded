)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/components/message/toolbox/MessageActionMenu.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { MessageToolboxItem, Option, OptionDivider, OptionTitle } from '@rocket.chat/fuselage';\nimport { useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ComponentProps, MouseEvent, MouseEventHandler, ReactElement } from 'react';\nimport React, { Fragment, useCallback, useRef, useState } from 'react';\n\nimport type { MessageActionConfig } from '../../../../app/ui-utils/client/lib/MessageAction';\nimport { useEmbeddedLayout } from '../../../hooks/useEmbeddedLayout';\nimport ToolboxDropdown from './ToolboxDropdown';\n\ntype MessageActionConfigOption = Omit<MessageActionConfig, 'condition' | 'context' | 'order' | 'action'> & {\n\taction: ((event: MouseEvent<HTMLElement, MouseEvent>) => void) & MouseEventHandler<HTMLElement>;\n};\n\ntype MessageActionMenuProps = {\n\tonChangeMenuVisibility: (visible: boolean) => void;\n\toptions: MessageActionConfigOption[];\n};\n\nconst getSectionOrder = (section: string): number => {\n\tswitch (section) {\n\t\tcase 'communication':\n\t\t\treturn 0;\n\t\tcase 'interaction':\n\t\t\treturn 1;\n\t\tcase 'duplication':\n\t\t\treturn 2;\n\t\tcase 'apps':\n\t\t\treturn 3;\n\t\tcase 'management':\n\t\t\treturn 4;\n\t\tdefault:\n\t\t\treturn 5;\n\t}\n};\n\nconst MessageActionMenu = ({ options, onChangeMenuVisibility, ...props }: MessageActionMenuProps): ReactElement => {\n\tconst buttonRef = useRef<HTMLButtonElement | null>(null);\n\tconst t = useTranslation();\n\tconst [visible, setVisible] = useState(false);\n\tconst isLayoutEmbedded = useEmbeddedLayout();\n\n\tconst handleChangeMenuVisibility = useCallback(\n\t\t(visible: boolean): void => {\n\t\t\tsetVisible(visible);\n\t\t\tonChangeMenuVisibility(visible);\n\t\t},\n\t\t[onChangeMenuVisibility],\n\t);\n\n\tconst groupOptions = options.reduce((acc, option) => {\n\t\tconst { type = '' } = option;\n\n\t\tif (option.color === 'alert') {\n\t\t\toption.variant = 'danger' as const;\n\t\t}\n\n\t\tconst order = getSectionOrder(type);\n\n\t\tconst [sectionType, options] = acc[getSectionOrder(type)] ?? [type, []];\n\n\t\tif (!(isLayoutEmbedded && option.id === 'reply-directly')) {\n\t\t\toptions.push(option);\n\t\t}\n\n\t\tif (options.length === 0) {\n\t\t\treturn acc;\n\t\t}\n\n\t\tacc[order] = [sectionType, options];\n\n\t\treturn acc;\n\t}, [] as unknown as [section: string, options: Array<MessageActionConfigOption>][]);\n\n\tconst handleClose = useCallback(() => {\n\t\thandleChangeMenuVisibility(false);\n\t}, [handleChangeMenuVisibility]);\n\treturn (\n\t\t<>\n\t\t\t<MessageToolboxItem\n\t\t\t\tref={buttonRef}\n\t\t\t\ticon='kebab'\n\t\t\t\tonClick={(): void => handleChangeMenuVisibility(!visible)}\n\t\t\t\tdata-qa-id='menu'\n\t\t\t\tdata-qa-type='message-action-menu'\n\t\t\t\ttitle={t('More')}\n\t\t\t/>\n\t\t\t{visible && (\n\t\t\t\t<>\n\t\t\t\t\t<ToolboxDropdown handleClose={handleClose} reference={buttonRef} {...props}>\n\t\t\t\t\t\t{groupOptions.map(([section, options], index, arr) => (\n\t\t\t\t\t\t\t<Fragment key={index}>\n\t\t\t\t\t\t\t\t{section === 'apps' && <OptionTitle>Apps</OptionTitle>}\n\t\t\t\t\t\t\t\t{options.map((option) => (\n\t\t\t\t\t\t\t\t\t<Option\n\t\t\t\t\t\t\t\t\t\tvariant={option.variant}\n\t\t\t\t\t\t\t\t\t\tkey={option.id}\n\t\t\t\t\t\t\t\t\t\tid={option.id}\n\t\t\t\t\t\t\t\t\t\ticon={option.icon as ComponentProps<typeof Option>['icon']}\n\t\t\t\t\t\t\t\t\t\tlabel={t(option.label)}\n\t\t\t\t\t\t\t\t\t\tonClick={(e) => {\n\t\t\t\t\t\t\t\t\t\t\thandleClose();\n\t\t\t\t\t\t\t\t\t\t\toption.action(e);\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tdata-qa-type='message-action'\n\t\t\t\t\t\t\t\t\t\tdata-qa-id={option.id}\n\t\t\t\t\t\t\t\t\t\trole={option.role ? option.role : 'button'}\n\t\t\t\t\t\t\t\t\t\tgap={!option.icon && option.type === 'apps'}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t{index !== arr.length - 1 && <OptionDivider />}\n\t\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</ToolboxDropdown>\n\t\t\t\t</>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default MessageActionMenu;\n",null],"names":["_extends","_objectWithoutProperties","MessageToolboxItem","Option","OptionDivider","OptionTitle","useTranslation","React","Fragment","useCallback","useRef","useState","useEmbeddedLayout","ToolboxDropdown","module","default","v","link","getSectionOrder","section","exportDefault","_ref","options","onChangeMenuVisibility","props","_excluded","buttonRef","t","visible","setVisible","isLayoutEmbedded","handleChangeMenuVisibility","groupOptions","reduce","acc","option","_acc$getSectionOrder","type","color","variant","order","sectionType","id","push","length","handleClose","createElement","ref","icon","onClick","title","reference","map","_ref2","index","arr","key","label","e","action","role","gap"],"mappings":"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"}