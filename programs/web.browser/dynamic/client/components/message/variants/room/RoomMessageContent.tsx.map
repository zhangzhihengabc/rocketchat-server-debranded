)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/components/message/variants/room/RoomMessageContent.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IMessage } from '@rocket.chat/core-typings';\nimport { isDiscussionMessage, isThreadMainMessage, isE2EEMessage } from '@rocket.chat/core-typings';\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\nimport { useSetting, useTranslation, useUserId } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { memo } from 'react';\n\nimport { useUserData } from '../../../../hooks/useUserData';\nimport type { UserPresence } from '../../../../lib/presence';\nimport { useChat } from '../../../../views/room/contexts/ChatContext';\nimport MessageContentBody from '../../MessageContentBody';\nimport ReadReceiptIndicator from '../../ReadReceiptIndicator';\nimport Attachments from '../../content/Attachments';\nimport BroadcastMetrics from '../../content/BroadcastMetrics';\nimport DiscussionMetrics from '../../content/DiscussionMetrics';\nimport Location from '../../content/Location';\nimport MessageActions from '../../content/MessageActions';\nimport Reactions from '../../content/Reactions';\nimport ThreadMetrics from '../../content/ThreadMetrics';\nimport UrlPreviews from '../../content/UrlPreviews';\nimport { useNormalizedMessage } from '../../hooks/useNormalizedMessage';\nimport { useOembedLayout } from '../../hooks/useOembedLayout';\nimport { useSubscriptionFromMessageQuery } from '../../hooks/useSubscriptionFromMessageQuery';\nimport UiKitMessageBlock from '../../uikit/UiKitMessageBlock';\n\ntype RoomMessageContentProps = {\n\tmessage: IMessage;\n\tunread: boolean;\n\tmention: boolean;\n\tall: boolean;\n\tsearchText?: string;\n};\n\nconst RoomMessageContent = ({ message, unread, all, mention, searchText }: RoomMessageContentProps): ReactElement => {\n\tconst encrypted = isE2EEMessage(message);\n\tconst { enabled: oembedEnabled } = useOembedLayout();\n\tconst subscription = useSubscriptionFromMessageQuery(message).data ?? undefined;\n\tconst broadcast = subscription?.broadcast ?? false;\n\tconst uid = useUserId();\n\tconst messageUser: UserPresence = { ...message.u, roles: [], ...useUserData(message.u._id) };\n\tconst readReceiptEnabled = useSetting('Message_Read_Receipt_Enabled', false);\n\tconst chat = useChat();\n\tconst t = useTranslation();\n\n\tconst normalizedMessage = useNormalizedMessage(message);\n\n\treturn (\n\t\t<>\n\t\t\t{!normalizedMessage.blocks?.length && !!normalizedMessage.md?.length && (\n\t\t\t\t<>\n\t\t\t\t\t{(!encrypted || normalizedMessage.e2e === 'done') && (\n\t\t\t\t\t\t<MessageContentBody\n\t\t\t\t\t\t\tmd={normalizedMessage.md}\n\t\t\t\t\t\t\tmentions={normalizedMessage.mentions}\n\t\t\t\t\t\t\tchannels={normalizedMessage.channels}\n\t\t\t\t\t\t\tsearchText={searchText}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t{encrypted && normalizedMessage.e2e === 'pending' && t('E2E_message_encrypted_placeholder')}\n\t\t\t\t</>\n\t\t\t)}\n\n\t\t\t{normalizedMessage.blocks && (\n\t\t\t\t<UiKitMessageBlock rid={normalizedMessage.rid} mid={normalizedMessage._id} blocks={normalizedMessage.blocks} />\n\t\t\t)}\n\n\t\t\t{!!normalizedMessage?.attachments?.length && <Attachments attachments={normalizedMessage.attachments} />}\n\n\t\t\t{oembedEnabled && !!normalizedMessage.urls?.length && <UrlPreviews urls={normalizedMessage.urls} />}\n\n\t\t\t{normalizedMessage.actionLinks?.length && (\n\t\t\t\t<MessageActions\n\t\t\t\t\tmessage={normalizedMessage}\n\t\t\t\t\tactions={normalizedMessage.actionLinks.map(({ method_id: methodId, i18nLabel, ...action }) => ({\n\t\t\t\t\t\tmethodId,\n\t\t\t\t\t\ti18nLabel: i18nLabel as TranslationKey,\n\t\t\t\t\t\t...action,\n\t\t\t\t\t}))}\n\t\t\t\t/>\n\t\t\t)}\n\n\t\t\t{normalizedMessage.reactions && Object.keys(normalizedMessage.reactions).length && <Reactions message={normalizedMessage} />}\n\n\t\t\t{chat && isThreadMainMessage(normalizedMessage) && (\n\t\t\t\t<ThreadMetrics\n\t\t\t\t\tcounter={normalizedMessage.tcount}\n\t\t\t\t\tfollowing={Boolean(uid && normalizedMessage?.replies?.indexOf(uid) > -1)}\n\t\t\t\t\tmid={normalizedMessage._id}\n\t\t\t\t\trid={normalizedMessage.rid}\n\t\t\t\t\tlm={normalizedMessage.tlm}\n\t\t\t\t\tunread={unread}\n\t\t\t\t\tmention={mention}\n\t\t\t\t\tall={all}\n\t\t\t\t\tparticipants={normalizedMessage?.replies?.length}\n\t\t\t\t/>\n\t\t\t)}\n\n\t\t\t{isDiscussionMessage(normalizedMessage) && (\n\t\t\t\t<DiscussionMetrics\n\t\t\t\t\tcount={normalizedMessage.dcount}\n\t\t\t\t\tdrid={normalizedMessage.drid}\n\t\t\t\t\tlm={normalizedMessage.dlm}\n\t\t\t\t\trid={normalizedMessage.rid}\n\t\t\t\t/>\n\t\t\t)}\n\n\t\t\t{normalizedMessage.location && <Location location={normalizedMessage.location} />}\n\n\t\t\t{broadcast && !!messageUser.username && normalizedMessage.u._id !== uid && (\n\t\t\t\t<BroadcastMetrics username={messageUser.username} message={normalizedMessage} />\n\t\t\t)}\n\n\t\t\t{readReceiptEnabled && <ReadReceiptIndicator unread={normalizedMessage.unread} />}\n\t\t</>\n\t);\n};\n\nexport default memo(RoomMessageContent);\n",null],"names":["_objectWithoutProperties","_objectSpread","isDiscussionMessage","isThreadMainMessage","isE2EEMessage","useSetting","useTranslation","useUserId","React","memo","useUserData","useChat","MessageContentBody","ReadReceiptIndicator","Attachments","BroadcastMetrics","DiscussionMetrics","Location","MessageActions","Reactions","ThreadMetrics","UrlPreviews","useNormalizedMessage","useOembedLayout","useSubscriptionFromMessageQuery","UiKitMessageBlock","module","link","default","v","exportDefault","_ref","_useSubscriptionFromM","_subscription$broadca","_normalizedMessage$bl","_normalizedMessage$md","_normalizedMessage$at","_normalizedMessage$ur","_normalizedMessage$ac","_normalizedMessage$re","_normalizedMessage$re2","message","unread","all","mention","searchText","encrypted","enabled","oembedEnabled","subscription","data","undefined","broadcast","uid","messageUser","u","roles","_id","readReceiptEnabled","chat","t","normalizedMessage","createElement","Fragment","blocks","length","md","e2e","mentions","channels","rid","mid","attachments","urls","actionLinks","actions","map","_ref2","method_id","methodId","i18nLabel","_excluded","reactions","Object","keys","counter","tcount","following","Boolean","replies","indexOf","lm","tlm","participants","count","dcount","drid","dlm","location","username"],"mappings":"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"}