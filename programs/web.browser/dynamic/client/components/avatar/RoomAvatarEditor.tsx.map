)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/components/avatar/RoomAvatarEditor.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { isRoomFederated } from '@rocket.chat/core-typings';\nimport type { IRoom, RoomAdminFieldsType } from '@rocket.chat/core-typings';\nimport { css } from '@rocket.chat/css-in-js';\nimport { Box, Button, ButtonGroup } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useToastMessageDispatch, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useEffect } from 'react';\n\nimport { getAvatarURL } from '../../../app/utils/client/getAvatarURL';\nimport { useFileInput } from '../../hooks/useFileInput';\nimport { isValidImageFormat } from '../../lib/utils/isValidImageFormat';\nimport RoomAvatar from './RoomAvatar';\n\ntype RoomAvatarEditorProps = {\n\troom: Pick<IRoom, RoomAdminFieldsType>;\n\tdisabled?: boolean;\n\troomAvatar?: string;\n\tonChangeAvatar: (url: string | null) => void;\n};\n\nconst RoomAvatarEditor = ({ disabled = false, room, roomAvatar, onChangeAvatar }: RoomAvatarEditorProps): ReactElement => {\n\tconst t = useTranslation();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst handleChangeAvatar = useMutableCallback(async (file) => {\n\t\tconst reader = new FileReader();\n\t\treader.readAsDataURL(file);\n\t\treader.onloadend = async (): Promise<void> => {\n\t\t\tconst { result } = reader;\n\t\t\tif (typeof result === 'string' && (await isValidImageFormat(result))) {\n\t\t\t\tonChangeAvatar(result);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdispatchToastMessage({ type: 'error', message: t('Avatar_format_invalid') });\n\t\t};\n\t});\n\n\tconst [clickUpload, reset] = useFileInput(handleChangeAvatar);\n\tconst clickReset = useMutableCallback(() => {\n\t\treset();\n\t\tonChangeAvatar(null);\n\t});\n\n\tuseEffect(() => {\n\t\t!roomAvatar && reset();\n\t}, [roomAvatar, reset]);\n\n\tconst defaultUrl = room.prid ? getAvatarURL({ roomId: room.prid }) : getAvatarURL({ username: `@${room.name}` }); // Discussions inherit avatars from the parent room\n\n\treturn (\n\t\t<Box borderRadius='x2' maxWidth='x332' w='full' position='relative'>\n\t\t\t<RoomAvatar {...(roomAvatar !== undefined && { url: roomAvatar === null ? defaultUrl : roomAvatar })} room={room} size='x332' />\n\t\t\t<Box\n\t\t\t\tclassName={[\n\t\t\t\t\tcss`\n\t\t\t\t\t\tbottom: 0;\n\t\t\t\t\t\tright: 0;\n\t\t\t\t\t`,\n\t\t\t\t]}\n\t\t\t\tposition='absolute'\n\t\t\t\tm={12}\n\t\t\t>\n\t\t\t\t<ButtonGroup>\n\t\t\t\t\t<Button icon='upload' disabled={isRoomFederated(room) || disabled} small title={t('Upload_user_avatar')} onClick={clickUpload}>\n\t\t\t\t\t\t{t('Upload')}\n\t\t\t\t\t</Button>\n\n\t\t\t\t\t<Button\n\t\t\t\t\t\tsmall\n\t\t\t\t\t\tdanger\n\t\t\t\t\t\ticon='trash'\n\t\t\t\t\t\ttitle={t('Accounts_SetDefaultAvatar')}\n\t\t\t\t\t\tdisabled={!roomAvatar || isRoomFederated(room) || disabled}\n\t\t\t\t\t\tonClick={clickReset}\n\t\t\t\t\t/>\n\t\t\t\t</ButtonGroup>\n\t\t\t</Box>\n\t\t</Box>\n\t);\n};\n\nexport default RoomAvatarEditor;\n",null],"names":["_taggedTemplateLiteral","_extends","isRoomFederated","css","Box","Button","ButtonGroup","useMutableCallback","useToastMessageDispatch","useTranslation","React","useEffect","getAvatarURL","useFileInput","isValidImageFormat","RoomAvatar","module","link","default","exportDefault","_ref","disabled","room","roomAvatar","onChangeAvatar","t","dispatchToastMessage","handleChangeAvatar","file","reader","FileReader","readAsDataURL","onloadend","result","type","message","clickUpload","reset","clickReset","defaultUrl","prid","roomId","username","concat","name","createElement","borderRadius","maxWidth","w","position","undefined","url","size","className","_templateObject","m","icon","small","title","onClick","danger"],"mappings":"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"}