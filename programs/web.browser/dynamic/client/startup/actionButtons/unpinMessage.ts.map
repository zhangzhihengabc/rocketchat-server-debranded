)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/startup/actionButtons/unpinMessage.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Meteor } from 'meteor/meteor';\n\nimport { hasAtLeastOnePermission } from '../../../app/authorization/client';\nimport { settings } from '../../../app/settings/client';\nimport { MessageAction } from '../../../app/ui-utils/client';\nimport { sdk } from '../../../app/utils/client/lib/SDKClient';\nimport { queryClient } from '../../lib/queryClient';\nimport { dispatchToastMessage } from '../../lib/toast';\nimport { messageArgs } from '../../lib/utils/messageArgs';\n\nMeteor.startup(() => {\n\tMessageAction.addButton({\n\t\tid: 'unpin-message',\n\t\ticon: 'pin',\n\t\tlabel: 'Unpin',\n\t\ttype: 'interaction',\n\t\tcontext: ['pinned', 'message', 'message-mobile', 'threads', 'direct', 'videoconf', 'videoconf-threads'],\n\t\tasync action(_, props) {\n\t\t\tconst { message = messageArgs(this).msg } = props;\n\t\t\tmessage.pinned = false;\n\t\t\ttry {\n\t\t\t\tawait sdk.call('unpinMessage', message);\n\t\t\t\tqueryClient.invalidateQueries(['rooms', message.rid, 'pinned-messages']);\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t}\n\t\t},\n\t\tcondition({ message, subscription }) {\n\t\t\tif (!subscription || !settings.get('Message_AllowPinning') || !message.pinned) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn hasAtLeastOnePermission('pin-message', message.rid);\n\t\t},\n\t\torder: 2,\n\t\tgroup: 'menu',\n\t});\n});\n",null],"names":["Meteor","hasAtLeastOnePermission","settings","MessageAction","sdk","queryClient","dispatchToastMessage","messageArgs","module","link","startup","addButton","id","icon","label","type","context","action","_","props","message","msg","pinned","call","invalidateQueries","rid","error","condition","_ref","subscription","get","order","group"],"mappings":"2BAAAA,EAAuCC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA9BC,EAAQC,IAAA,CAAM,gBAAgB,CAAAT,OAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAQ,EAAAA,IAAAA,CAAAA,oCAAAA,CAAAP,wBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAO,EAAAA,IAAAA,CAAAA,+BAAAA,CAAAN,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,+BAAAA,CAAAL,cAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAK,EAAAA,IAAAA,CAAAA,0CAAAA,CAAAJ,IAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAH,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,kBAAAA,CAAAF,qBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,8BAAAA,CAAAD,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAUvCP,EAAOU,OAAO,CAAC,KACdP,EAAcQ,SAAS,CAAC,CACvBC,GAAI,gBACJC,KAAM,MACNC,MAAO,QACPC,KAAM,cACNC,QAAS,CAAC,SAAU,UAAW,iBAAkB,UAAW,SAAU,YAAa,oBAAoB,CACvG,MAAMC,OAAOC,CAAC,CAAEC,CAAK,EACpB,GAAM,CAAEC,QAAAA,EAAUb,EAAY,IAAI,EAAEc,GAAAA,CAAK,CAAGF,CAC5CC,CAAAA,EAAQE,MAAM,CAAG,CAAA,EACjB,GAAI,CACH,MAAMlB,EAAImB,IAAI,CAAC,eAAgBH,GAC/Bf,EAAYmB,iBAAiB,CAAC,CAAC,QAASJ,EAAQK,GAAG,CAAE,kBAAkB,EACtE,MAAOC,EAAO,CACfpB,EAAqB,CAAES,KAAM,QAASK,QAASM,CAAK,GAEtD,EACAC,UAASC,CAAA,EAA0B,GAAzB,CAAER,QAAAA,CAAO,CAAES,aAAAA,CAAAA,CAAc,CAAAD,QAClC,EAAI,CAAA,AAACC,GAAiB3B,EAAS4B,GAAG,CAAC,uBAAsB,KAAMV,EAAQE,MAAM,EAItErB,EAAwB,cAAemB,EAAQK,GAAG,CAC1D,EACAM,MAAO,EACPC,MAAO,QAET"}