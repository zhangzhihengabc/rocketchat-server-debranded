)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/startup/actionButtons/starMessage.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Meteor } from 'meteor/meteor';\n\nimport { settings } from '../../../app/settings/client';\nimport { MessageAction } from '../../../app/ui-utils/client';\nimport { sdk } from '../../../app/utils/client/lib/SDKClient';\nimport { queryClient } from '../../lib/queryClient';\nimport { roomCoordinator } from '../../lib/rooms/roomCoordinator';\nimport { dispatchToastMessage } from '../../lib/toast';\nimport { messageArgs } from '../../lib/utils/messageArgs';\n\nMeteor.startup(() => {\n\tMessageAction.addButton({\n\t\tid: 'star-message',\n\t\ticon: 'star',\n\t\tlabel: 'Star',\n\t\ttype: 'interaction',\n\t\tcontext: ['starred', 'message', 'message-mobile', 'threads', 'federated', 'videoconf', 'videoconf-threads'],\n\t\tasync action(_, props) {\n\t\t\tconst { message = messageArgs(this).msg } = props;\n\n\t\t\ttry {\n\t\t\t\tawait sdk.call('starMessage', { ...message, starred: true });\n\t\t\t\tqueryClient.invalidateQueries(['rooms', message.rid, 'starred-messages']);\n\t\t\t} catch (error) {\n\t\t\t\tif (error) {\n\t\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tcondition({ message, subscription, user, room }) {\n\t\t\tif (subscription == null && settings.get('Message_AllowStarring')) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst isLivechatRoom = roomCoordinator.isLivechatRoom(room.t);\n\t\t\tif (isLivechatRoom) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn !Array.isArray(message.starred) || !message.starred.find((star: any) => star._id === user?._id);\n\t\t},\n\t\torder: 3,\n\t\tgroup: 'menu',\n\t});\n});\n",null],"names":["_objectSpread","Meteor","settings","MessageAction","sdk","queryClient","roomCoordinator","dispatchToastMessage","messageArgs","module","link","default","startup","addButton","id","icon","label","type","context","action","_","props","message","msg","call","starred","invalidateQueries","rid","error","condition","_ref","subscription","user","room","get","isLivechatRoom","t","Array","isArray","find","star","_id","order","group"],"mappings":"2BAAAA,EAAAC,EAAuCC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAtBC,EAAMC,IAAA,CAAA,uCAAgB,CAAAC,QAAAA,CAAAA,EAAAX,EAAAA,CAAA,CAAA,EAAA,GAA9BS,EAAQC,IAAA,CAAM,gBAAgB,CAAAT,OAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAQ,EAAAA,IAAAA,CAAAA,+BAAAA,CAAAP,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAO,EAAAA,IAAAA,CAAAA,+BAAAA,CAAAN,cAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,0CAAAA,CAAAL,IAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAK,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAJ,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,kCAAAA,CAAAH,gBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,kBAAAA,CAAAF,qBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,8BAAAA,CAAAD,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAUvCP,EAAOW,OAAO,CAAC,KACdT,EAAcU,SAAS,CAAC,CACvBC,GAAI,eACJC,KAAM,OACNC,MAAO,OACPC,KAAM,cACNC,QAAS,CAAC,UAAW,UAAW,iBAAkB,UAAW,YAAa,YAAa,oBAAoB,CAC3G,MAAMC,OAAOC,CAAC,CAAEC,CAAK,EACpB,GAAM,CAAEC,QAAAA,EAAUd,EAAY,IAAI,EAAEe,GAAAA,CAAK,CAAGF,EAE5C,GAAI,CACH,MAAMjB,EAAIoB,IAAI,CAAC,cAAaxB,EAAAA,EAAA,CAAA,EAAOsB,GAAO,CAAA,EAAA,CAAEG,QAAS,CAAA,CAAI,IACzDpB,EAAYqB,iBAAiB,CAAC,CAAC,QAASJ,EAAQK,GAAG,CAAE,mBAAmB,EACvE,MAAOC,EAAO,CACXA,GACHrB,EAAqB,CAAEU,KAAM,QAASK,QAASM,CAAK,GAGvD,EACAC,UAASC,CAAA,EAAsC,GAArC,CAAER,QAAAA,CAAO,CAAES,aAAAA,CAAY,CAAEC,KAAAA,CAAI,CAAEC,KAAAA,CAAAA,CAAM,CAAAH,EAC9C,GAAIC,AAAgB,MAAhBA,GAAwB7B,EAASgC,GAAG,CAAC,yBACxC,MAAO,CAAA,EAER,IAAMC,EAAiB7B,EAAgB6B,cAAc,CAACF,EAAKG,CAAC,QAC5D,CAAID,GAIG,CAAA,CAACE,MAAMC,OAAO,CAAChB,EAAQG,OAAO,GAAK,CAACH,EAAQG,OAAO,CAACc,IAAI,CAAEC,GAAcA,EAAKC,GAAG,GAAKT,CAAAA,MAAAA,EAAI,KAAA,EAAJA,EAAMS,GAAG,AAAHA,EAAG,CACtG,EACAC,MAAO,EACPC,MAAO,QAET"}