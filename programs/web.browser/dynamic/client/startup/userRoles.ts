function module(e,t,i){let r,d,l,s,u,o,a;i.link("meteor/meteor",{Meteor(e){r=e}},0),i.link("meteor/tracker",{Tracker(e){d=e}},1),i.link("../../app/models/client",{UserRoles(e){l=e},ChatMessage(e){s=e}},2),i.link("../../app/notifications/client",{Notifications(e){u=e}},3),i.link("../../app/utils/client/lib/SDKClient",{sdk(e){o=e}},4),i.link("../lib/toast",{dispatchToastMessage(e){a=e}},5),r.startup(()=>{d.autorun(()=>{r.userId()&&(o.call("getUserRoles").then(e=>{for(let t of e)l.upsert({_id:t._id},t)}).catch(e=>{a({type:"error",message:e})}),u.onLogged("roles-change",e=>{if("added"===e.type){if(!e.scope){if(!e.u)return;l.upsert({_id:e.u._id},{$addToSet:{roles:e._id},$set:{username:e.u.username}}),s.update({"u._id":e.u._id},{$addToSet:{roles:e._id}},{multi:!0})}return}if("removed"===e.type){if(!e.scope){if(!e.u)return;l.update({_id:e.u._id},{$pull:{roles:e._id}}),s.update({"u._id":e.u._id},{$pull:{roles:e._id}},{multi:!0})}return}"changed"===e.type&&s.update({roles:e._id},{$inc:{rerender:1}},{multi:!0})}))})})}
//# sourceMappingURL=/dynamic/client/startup/fedd99ad2daf7a9091ae5e7c6935aa3611e92486.map
