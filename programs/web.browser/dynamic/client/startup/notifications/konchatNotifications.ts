function module(e,o,t){let n,i,a,l,r,s,c,d,u,p,m,k,f;t.link("meteor/meteor",{Meteor(e){n=e}},0),t.link("meteor/tracker",{Tracker(e){i=e}},1),t.link("react",{lazy(e){a=e}},2),t.link("../../../app/models/client",{CachedChatSubscription(e){l=e}},3),t.link("../../../app/notifications/client",{Notifications(e){r=e}},4),t.link("../../../app/settings/client",{settings(e){s=e}},5),t.link("../../../app/ui/client/lib/KonchatNotification",{KonchatNotification(e){c=e}},6),t.link("../../../app/utils/client",{getUserPreference(e){d=e}},7),t.link("../../lib/RoomManager",{RoomManager(e){u=e}},8),t.link("../../lib/imperativeModal",{imperativeModal(e){p=e}},9),t.link("../../lib/utils/fireGlobalEvent",{fireGlobalEvent(e){m=e}},10),t.link("../../lib/utils/isLayoutEmbedded",{isLayoutEmbedded(e){k=e}},11),t.link("../../providers/RouterProvider",{router(e){f=e}},12);let b=a(()=>t.dynamicImport("../../views/outlookCalendar/OutlookCalendarEventModal")),g=async e=>{let o=n.user();o&&"busy"!==o.status&&(f.getRouteParameters().name&&f.getRouteParameters().name===e.name||e.ls||!0!==e.alert||c.newRoom(e.rid))};n.startup(()=>{let e=async function(e){let o=n.user();if(!o||"busy"===o.status)return;let t=d(n.userId(),"desktopNotificationRequireInteraction"),i=new Notification(e.title,{body:e.text,tag:e.payload._id,silent:!0,requireInteraction:t});i.onclick=function(){this.close(),window.focus(),p.open({component:b,props:{id:e.payload._id,onClose:p.close,onCancel:p.close}})}};i.autorun(()=>{if(!n.userId()||!s.get("Outlook_Calendar_Enabled"))return r.unUser("calendar");r.onUser("calendar",e)}),i.autorun(()=>{n.userId()&&(r.onUser("notification",e=>{let o=["channel","group","direct"].includes(f.getRouteName())?u.opened:void 0,t=document.hasFocus(),i=o===e.payload.rid;m("notification",{notification:e,fromOpenedRoom:i,hasFocus:t}),k()?!t&&i&&c.showDesktop(e):t&&i||c.showDesktop(e),function(e){let o=document.hasFocus(),t=u.opened===e,i=d(n.userId(),"muteFocusedConversations");k()?!o&&t&&c.newMessage(e):o&&t&&i||c.newMessage(e)}(e.payload.rid)}),l.on("changed",e=>{g(e)}),r.onUser("subscriptions-changed",(e,o)=>{"removed"!==e&&g(o)}))})})}
//# sourceMappingURL=/dynamic/client/startup/notifications/1e9a8acce3dd7740b5b51d7901845ddc63dabf9b.map
