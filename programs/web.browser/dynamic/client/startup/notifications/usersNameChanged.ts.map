)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/startup/notifications/usersNameChanged.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IUser } from '@rocket.chat/core-typings';\nimport { Meteor } from 'meteor/meteor';\n\nimport { Messages, Subscriptions } from '../../../app/models/client';\nimport { Notifications } from '../../../app/notifications/client';\n\ntype UsersNameChangedEvent = Partial<IUser>;\n\nMeteor.startup(() => {\n\tNotifications.onLogged('Users:NameChanged', ({ _id, name, username }: UsersNameChangedEvent) => {\n\t\tMessages.update(\n\t\t\t{\n\t\t\t\t'u._id': _id,\n\t\t\t},\n\t\t\t{\n\t\t\t\t$set: {\n\t\t\t\t\t'u.username': username,\n\t\t\t\t\t'u.name': name,\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tmulti: true,\n\t\t\t},\n\t\t);\n\n\t\tMessages.update(\n\t\t\t{\n\t\t\t\tmentions: {\n\t\t\t\t\t$elemMatch: { _id },\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\t$set: {\n\t\t\t\t\t'mentions.$.username': username,\n\t\t\t\t\t'mentions.$.name': name,\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tmulti: true,\n\t\t\t},\n\t\t);\n\n\t\tSubscriptions.update(\n\t\t\t{\n\t\t\t\tname: username,\n\t\t\t\tt: 'd',\n\t\t\t},\n\t\t\t{\n\t\t\t\t$set: {\n\t\t\t\t\tfname: name,\n\t\t\t\t},\n\t\t\t},\n\t\t);\n\t});\n});\n",null],"names":["Meteor","Messages","Subscriptions","Notifications","module","link","startup","onLogged","_ref","_id","name","username","update","$set","multi","mentions","$elemMatch","t","fname"],"mappings":"2BACAA,EAAuCC,EAAAC,EAAAC,EAA9BC,EAAQC,IAAA,CAAM,gBAAgB,CAAAL,OAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,6BAAAA,CAAAH,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,cAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,oCAAAA,CAAAD,cAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAOvCH,EAAOM,OAAO,CAAC,KACdH,EAAcI,QAAQ,CAAC,oBAAqBC,IAAmD,GAAlD,CAAEC,IAAAA,CAAG,CAAEC,KAAAA,CAAI,CAAEC,SAAAA,CAAAA,CAAiC,CAAAH,EAC1FP,EAASW,MAAM,CACd,CACC,QAASH,GAEV,CACCI,KAAM,CACL,aAAcF,EACd,SAAUD,IAGZ,CACCI,MAAO,CAAA,IAITb,EAASW,MAAM,CACd,CACCG,SAAU,CACTC,WAAY,CAAEP,IAAAA,CAAG,IAGnB,CACCI,KAAM,CACL,sBAAuBF,EACvB,kBAAmBD,IAGrB,CACCI,MAAO,CAAA,IAITZ,EAAcU,MAAM,CACnB,CACCF,KAAMC,EACNM,EAAG,KAEJ,CACCJ,KAAM,CACLK,MAAOR,IAIX,EACD"}