)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/startup/startup.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { UserStatus } from '@rocket.chat/core-typings';\nimport { Meteor } from 'meteor/meteor';\nimport { UserPresence } from 'meteor/rocketchat:user-presence';\nimport { Session } from 'meteor/session';\nimport { Tracker } from 'meteor/tracker';\nimport moment from 'moment';\n\nimport { register } from '../../app/markdown/lib/hljs';\nimport { settings } from '../../app/settings/client';\nimport { getUserPreference } from '../../app/utils/client';\nimport 'hljs9/styles/github.css';\nimport { sdk } from '../../app/utils/client/lib/SDKClient';\nimport { synchronizeUserData, removeLocalUserData } from '../lib/userData';\nimport { fireGlobalEvent } from '../lib/utils/fireGlobalEvent';\n\nMeteor.startup(() => {\n\tfireGlobalEvent('startup', true);\n\n\tSession.setDefault('AvatarRandom', 0);\n\n\twindow.lastMessageWindow = {};\n\twindow.lastMessageWindowHistory = {};\n\n\tlet status: UserStatus | undefined = undefined;\n\tTracker.autorun(async () => {\n\t\tconst uid = Meteor.userId();\n\t\tif (!uid) {\n\t\t\tremoveLocalUserData();\n\t\t\treturn;\n\t\t}\n\t\tif (!Meteor.status().connected) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst user = await synchronizeUserData(uid);\n\t\tif (!user) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst utcOffset = moment().utcOffset() / 60;\n\t\tif (user.utcOffset !== utcOffset) {\n\t\t\tsdk.call('userSetUtcOffset', utcOffset);\n\t\t}\n\n\t\tif (getUserPreference(user, 'enableAutoAway')) {\n\t\t\tconst idleTimeLimit = (getUserPreference(user, 'idleTimeLimit') as number | null | undefined) || 300;\n\t\t\tUserPresence.awayTime = idleTimeLimit * 1000;\n\t\t} else {\n\t\t\tdelete UserPresence.awayTime;\n\t\t\tUserPresence.stopTimer();\n\t\t}\n\n\t\tUserPresence.start();\n\n\t\tif (user.status !== status) {\n\t\t\tstatus = user.status;\n\t\t\tfireGlobalEvent('status-changed', status);\n\t\t}\n\t});\n});\nMeteor.startup(() => {\n\tTracker.autorun(() => {\n\t\tconst code = settings.get('Message_Code_highlight') as string | undefined;\n\t\tcode?.split(',').forEach((language: string) => {\n\t\t\tlanguage.trim() && register(language.trim());\n\t\t});\n\t});\n});\n",null],"names":["Meteor","UserPresence","Session","Tracker","moment","register","settings","getUserPreference","sdk","synchronizeUserData","removeLocalUserData","fireGlobalEvent","module","link","default","startup","status","setDefault","window","lastMessageWindow","lastMessageWindowHistory","autorun","uid","userId","connected","user","utcOffset","call","idleTimeLimit","awayTime","stopTimer","start","code","get","split","forEach","language","trim"],"mappings":"2BACAA,EAAuCC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA9BC,EAAQC,IAAA,CAAM,gBAAgB,CAAAb,OAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAY,EAAAA,IAAAA,CAAAA,kCAAAA,CAAAX,aAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAW,EAAAA,IAAAA,CAAAA,iBAAAA,CAAAV,QAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAU,EAAAA,IAAAA,CAAAA,iBAAAA,CAAAT,QAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAS,EAAAA,IAAAA,CAAAA,SAAAA,CAAAE,QAAAA,CAAAA,EAAAV,EAAAA,CAAA,CAAA,EAAA,GAAAQ,EAAAA,IAAAA,CAAAA,8BAAAA,CAAAP,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAO,EAAAA,IAAAA,CAAAA,4BAAAA,CAAAN,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,yBAAAA,CAAAL,kBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAK,EAAAA,IAAAA,CAAAA,2BAAAA,EAAAA,IAAAA,CAAAA,uCAAAA,CAAAJ,IAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,kBAAAA,CAAAH,oBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,oBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,+BAAAA,CAAAD,gBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,IAcvCX,EAAOe,OAAO,CAAC,SAQVC,EAPJL,EAAgB,UAAW,CAAA,GAE3BT,EAAQe,UAAU,CAAC,eAAgB,GAEnCC,OAAOC,iBAAiB,CAAG,CAAA,EAC3BD,OAAOE,wBAAwB,CAAG,CAAA,EAGlCjB,EAAQkB,OAAO,CAAC,UACf,IAAMC,EAAMtB,EAAOuB,MAAM,GACzB,GAAI,CAACD,EAAK,CACTZ,IACA,OAED,GAAI,CAACV,EAAOgB,MAAM,GAAGQ,SAAS,CAC7B,OAGD,IAAMC,EAAO,MAAMhB,EAAoBa,GACvC,GAAI,CAACG,EACJ,OAGD,IAAMC,EAAYtB,IAASsB,SAAS,GAAK,GAKzC,GAJID,EAAKC,SAAS,GAAKA,GACtBlB,EAAImB,IAAI,CAAC,mBAAoBD,GAG1BnB,EAAkBkB,EAAM,kBAAmB,CAC9C,IAAMG,EAAiBrB,EAAkBkB,EAAM,kBAAkD,GACjGxB,CAAAA,EAAa4B,QAAQ,CAAGD,AAAgB,IAAhBA,OAExB,OAAO3B,EAAa4B,QAAQ,CAC5B5B,EAAa6B,SAAS,GAGvB7B,EAAa8B,KAAK,GAEdN,EAAKT,MAAM,GAAKA,GAEnBL,EAAgB,iBADhBK,EAASS,EAAKT,MAAM,CAGtB,EACD,GACAhB,EAAOe,OAAO,CAAC,KACdZ,EAAQkB,OAAO,CAAC,KACf,IAAMW,EAAO1B,EAAS2B,GAAG,CAAC,yBAC1BD,OAAAA,GAAAA,EAAME,KAAK,CAAC,KAAKC,OAAO,CAAEC,IACzBA,EAASC,IAAI,IAAMhC,EAAS+B,EAASC,IAAI,GAC1C,EACD,EACD"}