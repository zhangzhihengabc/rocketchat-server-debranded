)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/lib/portals/portalsSubscription.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Emitter } from '@rocket.chat/emitter';\nimport { Random } from '@rocket.chat/random';\nimport type { ReactElement } from 'react';\n\ntype SubscribedPortal = {\n\tportal: ReactElement;\n\tkey: string;\n};\n\ntype PortalsSubscription = {\n\tsubscribe: (callback: () => void) => () => void;\n\tgetSnapshot: () => SubscribedPortal[];\n\thas: (key: unknown) => boolean;\n\tset: (key: unknown, portal: ReactElement) => void;\n\tdelete: (key: unknown) => void;\n};\n\nconst createPortalsSubscription = (): PortalsSubscription => {\n\tconst portalsMap = new Map<unknown, SubscribedPortal>();\n\tlet portals = Array.from(portalsMap.values());\n\tconst emitter = new Emitter<{ update: void }>();\n\n\treturn {\n\t\tgetSnapshot: (): SubscribedPortal[] => portals,\n\t\tsubscribe: (callback): (() => void) => emitter.on('update', callback),\n\t\tdelete: (key): void => {\n\t\t\tportalsMap.delete(key);\n\t\t\tportals = Array.from(portalsMap.values());\n\t\t\temitter.emit('update');\n\t\t},\n\t\tset: (key, portal): void => {\n\t\t\tportalsMap.set(key, { portal, key: Random.id() });\n\t\t\tportals = Array.from(portalsMap.values());\n\t\t\temitter.emit('update');\n\t\t},\n\t\thas: (key): boolean => portalsMap.has(key),\n\t};\n};\n\nexport const portalsSubscription = createPortalsSubscription();\n\nexport const unregisterPortal = (key: unknown): void => {\n\tportalsSubscription.delete(key);\n};\n\nexport const registerPortal = (key: unknown, portal: ReactElement): (() => void) => {\n\tportalsSubscription.set(key, portal);\n\treturn (): void => {\n\t\tunregisterPortal(key);\n\t};\n};\n",null],"names":["Emitter","Random","module","export","portalsSubscription","unregisterPortal","registerPortal","createPortalsSubscription","portalsMap","Map","portals","Array","from","values","emitter","getSnapshot","subscribe","callback","on","delete","key","emit","set","portal","id","has"],"mappings":"2BAA+CA,EAAAC,EAA/CC,EAAOC,MAAE,CAAA,CAAAC,oBAAe,IAAAA,EAAuBC,iBAAAA,IAAAA,EAAAC,eAAAA,IAAAA,CAAA,GAAAJ,EAAAA,IAAAA,CAAAA,uBAAAA,CAAAF,QAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,sBAAAA,CAAAD,OAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAuCxC,IAAMG,EAAsBG,AAtBD,CAAA,KACjC,IAAMC,EAAa,IAAIC,IACnBC,EAAUC,MAAMC,IAAI,CAACJ,EAAWK,MAAM,IACpCC,EAAU,IAAId,EAEpB,MAAO,CACNe,YAAa,IAA0BL,EACvCM,UAAYC,GAA2BH,EAAQI,EAAE,CAAC,SAAUD,GAC5DE,OAASC,IACRZ,EAAWW,MAAM,CAACC,GAClBV,EAAUC,MAAMC,IAAI,CAACJ,EAAWK,MAAM,IACtCC,EAAQO,IAAI,CAAC,SACd,EACAC,IAAK,CAACF,EAAKG,KACVf,EAAWc,GAAG,CAACF,EAAK,CAAEG,OAAAA,EAAQH,IAAKnB,EAAOuB,EAAE,EAAE,GAC9Cd,EAAUC,MAAMC,IAAI,CAACJ,EAAWK,MAAM,IACtCC,EAAQO,IAAI,CAAC,SACd,EACAI,IAAML,GAAiBZ,EAAWiB,GAAG,CAACL,GAExC,CAAA,IAIaf,EAAoBe,IAChChB,EAAoBe,MAAM,CAACC,EAC5B,EAEad,EAAiB,CAACc,EAAcG,KAC5CnB,EAAoBkB,GAAG,CAACF,EAAKG,GACtB,KACNlB,EAAiBe,EAClB"}