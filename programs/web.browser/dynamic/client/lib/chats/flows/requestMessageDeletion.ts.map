)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/lib/chats/flows/requestMessageDeletion.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IMessage } from '@rocket.chat/core-typings';\n\nimport { t } from '../../../../app/utils/lib/i18n';\nimport GenericModal from '../../../components/GenericModal';\nimport { imperativeModal } from '../../imperativeModal';\nimport { dispatchToastMessage } from '../../toast';\nimport type { ChatAPI } from '../ChatAPI';\n\nexport const requestMessageDeletion = async (chat: ChatAPI, message: IMessage): Promise<void> => {\n\tif (!(await chat.data.canDeleteMessage(message))) {\n\t\tdispatchToastMessage({ type: 'error', message: t('Message_deleting_blocked') });\n\t\treturn;\n\t}\n\n\tconst room = message.drid ? await chat.data.getDiscussionByID(message.drid) : undefined;\n\n\tawait new Promise<void>((resolve, reject) => {\n\t\tconst onConfirm = async (): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tif (!(await chat.data.canDeleteMessage(message))) {\n\t\t\t\t\tdispatchToastMessage({ type: 'error', message: t('Message_deleting_blocked') });\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tawait chat.data.deleteMessage(message._id);\n\n\t\t\t\timperativeModal.close();\n\n\t\t\t\tif (chat.currentEditing?.mid === message._id) {\n\t\t\t\t\tchat.currentEditing.stop();\n\t\t\t\t}\n\t\t\t\tchat.composer?.focus();\n\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Your_entry_has_been_deleted') });\n\t\t\t\tresolve();\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t\treject(error);\n\t\t\t}\n\t\t};\n\n\t\tconst onCloseModal = async (): Promise<void> => {\n\t\t\timperativeModal.close();\n\n\t\t\tif (chat.currentEditing?.mid === message._id) {\n\t\t\t\tchat.currentEditing.stop();\n\t\t\t}\n\t\t\tchat.composer?.focus();\n\n\t\t\tresolve();\n\t\t};\n\n\t\timperativeModal.open({\n\t\t\tcomponent: GenericModal,\n\t\t\tprops: {\n\t\t\t\ttitle: t('Are_you_sure'),\n\t\t\t\tchildren: room ? t('The_message_is_a_discussion_you_will_not_be_able_to_recover') : t('You_will_not_be_able_to_recover'),\n\t\t\t\tvariant: 'danger',\n\t\t\t\tconfirmText: t('Yes_delete_it'),\n\t\t\t\tonConfirm,\n\t\t\t\tonClose: onCloseModal,\n\t\t\t\tonCancel: onCloseModal,\n\t\t\t},\n\t\t});\n\t});\n};\n",null],"names":["t","GenericModal","imperativeModal","dispatchToastMessage","module","export","requestMessageDeletion","default","chat","message","data","canDeleteMessage","type","room","drid","getDiscussionByID","undefined","Promise","resolve","reject","onConfirm","_chat$currentEditing","_chat$composer","deleteMessage","_id","close","currentEditing","mid","stop","composer","focus","error","onCloseModal","_chat$currentEditing2","_chat$composer2","open","component","props","title","children","variant","confirmText","onClose","onCancel"],"mappings":"2BAEmDA,EAAAC,EAAAC,EAAAC,EAAnDC,EAAOC,MAAK,CAAA,CAAAC,uBAAM,IAAAA,CAAiC,GAAAF,EAAAA,IAAAA,CAAAA,iCAAAA,CAAAJ,EAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,mCAAAA,CAAAG,QAAAA,CAAAA,EAAAN,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAF,gBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,cAAAA,CAAAD,qBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAM5C,IAAMG,EAAyB,MAAOE,EAAeC,KAC3D,GAAI,CAAE,MAAMD,EAAKE,IAAI,CAACC,gBAAgB,CAACF,GAAW,CACjDN,EAAqB,CAAES,KAAM,QAASH,QAAST,EAAE,2BAA2B,GAC5E,OAGD,IAAMa,EAAOJ,EAAQK,IAAI,CAAG,MAAMN,EAAKE,IAAI,CAACK,iBAAiB,CAACN,EAAQK,IAAI,EAAIE,KAAAA,CAE9E,OAAM,IAAIC,QAAc,CAACC,EAASC,KACjC,IAAMC,EAAY,UACjB,GAAI,CAAA,IAAAC,EAAAC,EACH,GAAI,CAAE,MAAMd,EAAKE,IAAI,CAACC,gBAAgB,CAACF,GAAW,CACjDN,EAAqB,CAAES,KAAM,QAASH,QAAST,EAAE,2BAA2B,GAC5E,OAED,MAAMQ,EAAKE,IAAI,CAACa,aAAa,CAACd,EAAQe,GAAG,EAEzCtB,EAAgBuB,KAAK,GAEjB,CAAA,AAAmB,OAAnBJ,CAAAA,EAAAb,EAAKkB,cAAc,AAAdA,GAAcL,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAnBA,EAAqBM,GAAG,AAAHA,IAAQlB,EAAQe,GAAG,EAC3ChB,EAAKkB,cAAc,CAACE,IAAI,GAEzB,AAAa,OAAbN,CAAAA,EAAAd,EAAKqB,QAAQ,AAARA,GAAQP,AAAA,KAAA,IAAAA,GAAbA,EAAeQ,KAAK,GAEpB3B,EAAqB,CAAES,KAAM,UAAWH,QAAST,EAAE,8BAA8B,GACjFkB,IACC,MAAOa,EAAO,CACf5B,EAAqB,CAAES,KAAM,QAASH,QAASsB,CAAK,GACpDZ,EAAOY,GAET,EAEMC,EAAe,UAA0B,IAAAC,EAAAC,EAC9ChC,EAAgBuB,KAAK,GAEjB,CAAA,AAAmB,OAAnBQ,CAAAA,EAAAzB,EAAKkB,cAAc,AAAdA,GAAcO,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAnBA,EAAqBN,GAAG,AAAHA,IAAQlB,EAAQe,GAAG,EAC3ChB,EAAKkB,cAAc,CAACE,IAAI,GAEzB,AAAa,OAAbM,CAAAA,EAAA1B,EAAKqB,QAAQ,AAARA,GAAQK,AAAA,KAAA,IAAAA,GAAbA,EAAeJ,KAAK,GAEpBZ,GACD,EAEAhB,EAAgBiC,IAAI,CAAC,CACpBC,UAAWnC,EACXoC,MAAO,CACNC,MAAOtC,EAAE,gBACTuC,SAAU1B,EAAOb,EAAE,+DAAiEA,EAAE,mCACtFwC,QAAS,SACTC,YAAazC,EAAE,iBACfoB,UAAAA,EACAsB,QAASV,EACTW,SAAUX,IAGb,EACD"}