function module(e,t,n){let o,a,l,s,i;n.export({processTooLongMessage:()=>r}),n.link("../../../../app/settings/client",{settings(e){o=e}},0),n.link("../../../../app/utils/lib/i18n",{t(e){a=e}},1),n.link("../../../components/GenericModal",{default(e){l=e}},2),n.link("../../imperativeModal",{imperativeModal(e){s=e}},3),n.link("../../toast",{dispatchToastMessage(e){i=e}},4);let r=async(e,t)=>{let{msg:n}=t,r=o.get("Message_MaxAllowedSize");if(n.length<=r)return!1;let c=o.get("FileUpload_Enabled"),p=o.get("Message_AllowConvertLongMessagesToAttachment");if(e.currentEditing||!c||!p){var d;return i({type:"error",message:Error(a("Message_too_long"))}),null===(d=e.composer)||void 0===d||d.setText(n),!0}return await new Promise(t=>{let o=async()=>{var o,a;let l="text/plain",i=new Blob([n],{type:l}),r="".concat(null!==(o=null===(a=Meteor.user())||void 0===a?void 0:a.username)&&void 0!==o?o:"anonymous"," - ").concat(new Date,".txt"),c=new File([i],r,{type:l,lastModified:Date.now()});s.close(),await e.flows.uploadFiles([c]),t()},i=()=>{var o;null===(o=e.composer)||void 0===o||o.setText(n),s.close(),t()};s.open({component:l,props:{title:a("Message_too_long"),children:a("Send_it_as_attachment_instead_question"),onConfirm:o,onClose:i,onCancel:i,variant:"warning"}})}),!0}}
//# sourceMappingURL=/dynamic/client/lib/chats/flows/52b35ea0d5ef9919285721203efb182a8798c2a1.map
