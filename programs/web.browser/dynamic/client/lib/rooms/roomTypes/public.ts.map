)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/lib/rooms/roomTypes/public.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { AtLeast, IRoom } from '@rocket.chat/core-typings';\nimport { isRoomFederated } from '@rocket.chat/core-typings';\nimport { Meteor } from 'meteor/meteor';\nimport type { Mongo } from 'meteor/mongo';\n\nimport { hasAtLeastOnePermission } from '../../../../app/authorization/client';\nimport { ChatRoom } from '../../../../app/models/client';\nimport { settings } from '../../../../app/settings/client';\nimport { getUserPreference } from '../../../../app/utils/client';\nimport { getRoomAvatarURL } from '../../../../app/utils/client/getRoomAvatarURL';\nimport type { IRoomTypeClientDirectives } from '../../../../definition/IRoomTypeConfig';\nimport { RoomSettingsEnum, RoomMemberActions, UiTextContext } from '../../../../definition/IRoomTypeConfig';\nimport { getPublicRoomType } from '../../../../lib/rooms/roomTypes/public';\nimport * as Federation from '../../federation/Federation';\nimport { roomCoordinator } from '../roomCoordinator';\n\nexport const PublicRoomType = getPublicRoomType(roomCoordinator);\n\nroomCoordinator.add(\n\t{\n\t\t...PublicRoomType,\n\t\tlabel: 'Channels',\n\t},\n\t{\n\t\tallowRoomSettingChange(room, setting) {\n\t\t\tif (isRoomFederated(room as IRoom)) {\n\t\t\t\treturn Federation.isRoomSettingAllowed(room, setting);\n\t\t\t}\n\t\t\tswitch (setting) {\n\t\t\t\tcase RoomSettingsEnum.BROADCAST:\n\t\t\t\t\treturn Boolean(room.broadcast);\n\t\t\t\tcase RoomSettingsEnum.READ_ONLY:\n\t\t\t\t\treturn Boolean(!room.broadcast);\n\t\t\t\tcase RoomSettingsEnum.REACT_WHEN_READ_ONLY:\n\t\t\t\t\treturn Boolean(!room.broadcast && room.ro);\n\t\t\t\tcase RoomSettingsEnum.E2E:\n\t\t\t\t\treturn false;\n\t\t\t\tcase RoomSettingsEnum.SYSTEM_MESSAGES:\n\t\t\t\tdefault:\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t},\n\n\t\tallowMemberAction(_room, action, showingUserId, userSubscription) {\n\t\t\tif (isRoomFederated(_room as IRoom)) {\n\t\t\t\treturn Federation.actionAllowed(_room, action, showingUserId, userSubscription);\n\t\t\t}\n\t\t\tswitch (action) {\n\t\t\t\tcase RoomMemberActions.BLOCK:\n\t\t\t\t\treturn false;\n\t\t\t\tdefault:\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t},\n\n\t\troomName(roomData) {\n\t\t\tif (roomData.prid || isRoomFederated(roomData)) {\n\t\t\t\treturn roomData.fname;\n\t\t\t}\n\t\t\tif (settings.get('UI_Allow_room_names_with_special_chars')) {\n\t\t\t\treturn roomData.fname || roomData.name;\n\t\t\t}\n\t\t\treturn roomData.name;\n\t\t},\n\n\t\tisGroupChat(_room) {\n\t\t\treturn true;\n\t\t},\n\n\t\tgetUiText(context) {\n\t\t\tswitch (context) {\n\t\t\t\tcase UiTextContext.HIDE_WARNING:\n\t\t\t\t\treturn 'Hide_Room_Warning';\n\t\t\t\tcase UiTextContext.LEAVE_WARNING:\n\t\t\t\t\treturn 'Leave_Room_Warning';\n\t\t\t\tdefault:\n\t\t\t\t\treturn '';\n\t\t\t}\n\t\t},\n\n\t\tcondition() {\n\t\t\tconst groupByType = getUserPreference(Meteor.userId(), 'sidebarGroupByType');\n\t\t\treturn (\n\t\t\t\tgroupByType &&\n\t\t\t\t(hasAtLeastOnePermission(['view-c-room', 'view-joined-room']) || settings.get('Accounts_AllowAnonymousRead') === true)\n\t\t\t);\n\t\t},\n\n\t\tgetAvatarPath(room) {\n\t\t\treturn getRoomAvatarURL({ roomId: room._id, cache: room.avatarETag });\n\t\t},\n\n\t\tgetIcon(room) {\n\t\t\tif (room.prid) {\n\t\t\t\treturn 'discussion';\n\t\t\t}\n\t\t\tif (room.teamMain) {\n\t\t\t\treturn 'team';\n\t\t\t}\n\t\t\tif (isRoomFederated(room)) {\n\t\t\t\treturn 'globe';\n\t\t\t}\n\n\t\t\treturn 'hashtag';\n\t\t},\n\n\t\textractOpenRoomParams({ name }) {\n\t\t\treturn { type: 'c', reference: name };\n\t\t},\n\n\t\tfindRoom(identifier) {\n\t\t\tconst query: Mongo.Selector<IRoom> = {\n\t\t\t\tt: 'c',\n\t\t\t\tname: identifier,\n\t\t\t};\n\n\t\t\treturn ChatRoom.findOne(query);\n\t\t},\n\n\t\tshowJoinLink(roomId) {\n\t\t\treturn !!ChatRoom.findOne({ _id: roomId, t: 'c' });\n\t\t},\n\t} as AtLeast<IRoomTypeClientDirectives, 'isGroupChat' | 'roomName'>,\n);\n",null],"names":["_objectSpread","isRoomFederated","Meteor","hasAtLeastOnePermission","ChatRoom","settings","getUserPreference","getRoomAvatarURL","RoomSettingsEnum","RoomMemberActions","UiTextContext","getPublicRoomType","Federation","roomCoordinator","module","link","default","export","PublicRoomType","v","add","label","allowRoomSettingChange","room","setting","isRoomSettingAllowed","BROADCAST","Boolean","broadcast","READ_ONLY","REACT_WHEN_READ_ONLY","ro","E2E","SYSTEM_MESSAGES","allowMemberAction","_room","action","showingUserId","userSubscription","actionAllowed","BLOCK","roomName","roomData","prid","fname","get","name","isGroupChat","getUiText","context","HIDE_WARNING","LEAVE_WARNING","condition","groupByType","userId","getAvatarPath","roomId","_id","cache","avatarETag","getIcon","teamMain","extractOpenRoomParams","_ref","type","reference","findRoom","identifier","findOne","t","showJoinLink"],"mappings":"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"}