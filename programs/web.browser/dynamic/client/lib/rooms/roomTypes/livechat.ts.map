)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/lib/rooms/roomTypes/livechat.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { AtLeast, ValueOf } from '@rocket.chat/core-typings';\n\nimport { hasPermission } from '../../../../app/authorization/client';\nimport { ChatRoom, ChatSubscription } from '../../../../app/models/client';\nimport { settings } from '../../../../app/settings/client';\nimport { getAvatarURL } from '../../../../app/utils/client/getAvatarURL';\nimport type { IRoomTypeClientDirectives } from '../../../../definition/IRoomTypeConfig';\nimport { RoomSettingsEnum, RoomMemberActions, UiTextContext } from '../../../../definition/IRoomTypeConfig';\nimport { getLivechatRoomType } from '../../../../lib/rooms/roomTypes/livechat';\nimport { roomCoordinator } from '../roomCoordinator';\n\nexport const LivechatRoomType = getLivechatRoomType(roomCoordinator);\n\nroomCoordinator.add(\n\t{\n\t\t...LivechatRoomType,\n\t\tlabel: 'Omnichannel',\n\t},\n\t{\n\t\tallowRoomSettingChange(_room, setting) {\n\t\t\tswitch (setting) {\n\t\t\t\tcase RoomSettingsEnum.JOIN_CODE:\n\t\t\t\t\treturn false;\n\t\t\t\tdefault:\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t},\n\n\t\tallowMemberAction(_room, action) {\n\t\t\treturn ([RoomMemberActions.INVITE, RoomMemberActions.JOIN] as Array<ValueOf<typeof RoomMemberActions>>).includes(action);\n\t\t},\n\n\t\troomName(room) {\n\t\t\treturn room.name || room.fname || (room as any).label;\n\t\t},\n\n\t\tgetUiText(context) {\n\t\t\tswitch (context) {\n\t\t\t\tcase UiTextContext.HIDE_WARNING:\n\t\t\t\t\treturn 'Hide_Livechat_Warning';\n\t\t\t\tcase UiTextContext.LEAVE_WARNING:\n\t\t\t\t\treturn 'Hide_Livechat_Warning';\n\t\t\t\tdefault:\n\t\t\t\t\treturn '';\n\t\t\t}\n\t\t},\n\n\t\tcondition() {\n\t\t\treturn settings.get('Livechat_enabled') && hasPermission('view-l-room');\n\t\t},\n\n\t\tgetAvatarPath(room) {\n\t\t\treturn getAvatarURL({ username: `@${this.roomName(room)}` }) || '';\n\t\t},\n\n\t\tfindRoom(identifier) {\n\t\t\treturn ChatRoom.findOne({ _id: identifier });\n\t\t},\n\n\t\tisLivechatRoom() {\n\t\t\treturn true;\n\t\t},\n\n\t\tcanSendMessage(rid) {\n\t\t\tconst room = ChatRoom.findOne({ _id: rid }, { fields: { open: 1 } });\n\t\t\treturn Boolean(room?.open);\n\t\t},\n\n\t\treadOnly(rid, _user) {\n\t\t\tconst room = ChatRoom.findOne({ _id: rid }, { fields: { open: 1, servedBy: 1 } });\n\t\t\tif (!room?.open) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tconst subscription = ChatSubscription.findOne({ rid });\n\t\t\treturn !subscription;\n\t\t},\n\n\t\tgetIcon() {\n\t\t\treturn 'livechat';\n\t\t},\n\n\t\textractOpenRoomParams({ id }) {\n\t\t\treturn { type: 'l', reference: id };\n\t\t},\n\t} as AtLeast<IRoomTypeClientDirectives, 'roomName'>,\n);\n",null],"names":["_objectSpread","hasPermission","ChatRoom","ChatSubscription","settings","getAvatarURL","RoomSettingsEnum","RoomMemberActions","UiTextContext","getLivechatRoomType","roomCoordinator","module","link","default","export","LivechatRoomType","add","label","allowRoomSettingChange","_room","setting","JOIN_CODE","allowMemberAction","action","INVITE","JOIN","includes","roomName","room","name","fname","getUiText","context","HIDE_WARNING","LEAVE_WARNING","condition","get","getAvatarPath","username","concat","findRoom","identifier","findOne","_id","isLivechatRoom","canSendMessage","rid","fields","open","Boolean","readOnly","_user","servedBy","subscription","getIcon","extractOpenRoomParams","_ref","id","type","reference"],"mappings":"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"}