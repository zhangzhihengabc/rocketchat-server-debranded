)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/methods/starMessage.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { ServerMethods } from '@rocket.chat/ui-contexts';\nimport { Meteor } from 'meteor/meteor';\n\nimport { ChatMessage, ChatSubscription } from '../../app/models/client';\nimport { settings } from '../../app/settings/client';\nimport { t } from '../../app/utils/lib/i18n';\nimport { dispatchToastMessage } from '../lib/toast';\n\nMeteor.methods<ServerMethods>({\n\tstarMessage(message) {\n\t\tconst uid = Meteor.userId();\n\n\t\tif (!uid) {\n\t\t\tdispatchToastMessage({ type: 'error', message: t('error-starring-message') });\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!ChatSubscription.findOne({ rid: message.rid })) {\n\t\t\tdispatchToastMessage({ type: 'error', message: t('error-starring-message') });\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!ChatMessage.findOneByRoomIdAndMessageId(message.rid, message._id)) {\n\t\t\tdispatchToastMessage({ type: 'error', message: t('error-starring-message') });\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!settings.get('Message_AllowStarring')) {\n\t\t\tdispatchToastMessage({ type: 'error', message: t('error-starring-message') });\n\t\t\treturn false;\n\t\t}\n\n\t\tif (message.starred) {\n\t\t\tChatMessage.update(\n\t\t\t\t{ _id: message._id },\n\t\t\t\t{\n\t\t\t\t\t$addToSet: {\n\t\t\t\t\t\tstarred: { _id: uid },\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t);\n\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Message_has_been_starred') });\n\n\t\t\treturn true;\n\t\t}\n\n\t\tChatMessage.update(\n\t\t\t{ _id: message._id },\n\t\t\t{\n\t\t\t\t$pull: {\n\t\t\t\t\tstarred: { _id: uid },\n\t\t\t\t},\n\t\t\t},\n\t\t);\n\n\t\tdispatchToastMessage({ type: 'success', message: t('Message_has_been_unstarred') });\n\t\treturn true;\n\t},\n});\n",null],"names":["Meteor","ChatMessage","ChatSubscription","settings","t","dispatchToastMessage","module","link","methods","starMessage","message","uid","userId","findOne","rid","findOneByRoomIdAndMessageId","_id","get","starred","update","$addToSet","type","$pull"],"mappings":"2BACAA,EAAuCC,EAAAC,EAAAC,EAAAC,EAAAC,EAA9BC,EAAQC,IAAA,CAAM,gBAAgB,CAAAP,OAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,0BAAAA,CAAAL,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,iBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,4BAAAA,CAAAH,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAF,EAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,eAAAA,CAAAD,qBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAOvCL,EAAOQ,OAAO,CAAgB,CAC7BC,YAAYC,CAAO,EAClB,IAAMC,EAAMX,EAAOY,MAAM,UAEzB,AAAKD,GAKAT,EAAiBW,OAAO,CAAC,CAAEC,IAAKJ,EAAQI,GAAAA,AAAG,IAK3Cb,EAAYc,2BAA2B,CAACL,EAAQI,GAAG,CAAEJ,EAAQM,GAAG,GAKhEb,EAASc,GAAG,CAAC,0BAKdP,EAAQQ,OAAO,EAClBjB,EAAYkB,MAAM,CACjB,CAAEH,IAAKN,EAAQM,GAAAA,AAAG,EAClB,CACCI,UAAW,CACVF,QAAS,CAAEF,IAAKL,CAAG,KAKtBN,EAAqB,CAAEgB,KAAM,UAAWX,QAASN,EAAE,2BAA2B,KAK/EH,EAAYkB,MAAM,CACjB,CAAEH,IAAKN,EAAQM,GAAAA,AAAG,EAClB,CACCM,MAAO,CACNJ,QAAS,CAAEF,IAAKL,CAAG,KAKtBN,EAAqB,CAAEgB,KAAM,UAAWX,QAASN,EAAE,6BAA6B,IACzE,CAAA,IA5CNC,EAAqB,CAAEgB,KAAM,QAASX,QAASN,EAAE,yBAAyB,GACnE,CAAA,EA4CT"}