)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/methods/unpinMessage.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IMessage } from '@rocket.chat/core-typings';\nimport type { ServerMethods } from '@rocket.chat/ui-contexts';\nimport { Meteor } from 'meteor/meteor';\n\nimport { ChatMessage, ChatSubscription } from '../../app/models/client';\nimport { settings } from '../../app/settings/client';\nimport { t } from '../../app/utils/lib/i18n';\nimport { dispatchToastMessage } from '../lib/toast';\n\nMeteor.methods<ServerMethods>({\n\tunpinMessage(message: IMessage) {\n\t\tif (!Meteor.userId()) {\n\t\t\tdispatchToastMessage({ type: 'error', message: t('error-not-authorized') });\n\t\t\treturn false;\n\t\t}\n\t\tif (!settings.get('Message_AllowPinning')) {\n\t\t\tdispatchToastMessage({ type: 'error', message: t('unpinning-not-allowed') });\n\t\t\treturn false;\n\t\t}\n\t\tif (!ChatSubscription.findOne({ rid: message.rid })) {\n\t\t\tdispatchToastMessage({ type: 'error', message: t('error-unpinning-message') });\n\t\t\treturn false;\n\t\t}\n\t\tif (typeof message._id !== 'string') {\n\t\t\tdispatchToastMessage({ type: 'error', message: t('error-unpinning-message') });\n\t\t\treturn false;\n\t\t}\n\t\tdispatchToastMessage({ type: 'success', message: t('Message_has_been_unpinned') });\n\t\tChatMessage.update(\n\t\t\t{\n\t\t\t\t_id: message._id,\n\t\t\t\trid: message.rid,\n\t\t\t},\n\t\t\t{\n\t\t\t\t$set: {\n\t\t\t\t\tpinned: false,\n\t\t\t\t},\n\t\t\t},\n\t\t);\n\n\t\treturn true;\n\t},\n});\n",null],"names":["Meteor","ChatMessage","ChatSubscription","settings","t","dispatchToastMessage","module","link","methods","unpinMessage","message","userId","get","findOne","rid","_id","type","update","$set","pinned"],"mappings":"2BAEAA,EAAuCC,EAAAC,EAAAC,EAAAC,EAAAC,EAA9BC,EAAQC,IAAA,CAAM,gBAAgB,CAAAP,OAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAM,EAAAA,IAAAA,CAAAA,0BAAAA,CAAAL,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,iBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,4BAAAA,CAAAH,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAF,EAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,eAAAA,CAAAD,qBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAOvCL,EAAOQ,OAAO,CAAgB,CAC7BC,aAAAA,AAAaC,GACZ,AAAKV,EAAOW,MAAM,GAIbR,EAASS,GAAG,CAAC,wBAIbV,EAAiBW,OAAO,CAAC,CAAEC,IAAKJ,EAAQI,GAAAA,AAAG,IAI5C,AAAuB,UAAvB,OAAOJ,EAAQK,GAAG,EAItBV,EAAqB,CAAEW,KAAM,UAAWN,QAASN,EAAE,4BAA4B,GAC/EH,EAAYgB,MAAM,CACjB,CACCF,IAAKL,EAAQK,GAAG,CAChBD,IAAKJ,EAAQI,GAAAA,EAEd,CACCI,KAAM,CACLC,OAAQ,CAAA,KAKJ,CAAA,IApBNd,EAAqB,CAAEW,KAAM,QAASN,QAASN,EAAE,0BAA0B,GACpE,CAAA,IALPC,EAAqB,CAAEW,KAAM,QAASN,QAASN,EAAE,wBAAwB,GAClE,CAAA,IALPC,EAAqB,CAAEW,KAAM,QAASN,QAASN,EAAE,uBAAuB,GACjE,CAAA"}