function module(e,t,r){var a,i,l;let n,o,s,u,c,d,m,p,v,g,b,f,h,k,w,x,y,S,T,E,_,I,q,z,A,D,M,j,C,R,B,U,V,P,L,N;let F=["setValue"];r.link("@babel/runtime/helpers/extends",{default(e){n=e}},0),r.link("@babel/runtime/helpers/taggedTemplateLiteral",{default(e){o=e}},1),r.link("@babel/runtime/helpers/objectWithoutProperties",{default(e){s=e}},2),r.link("@babel/runtime/helpers/objectSpread2",{default(e){u=e}},3),r.link("@rocket.chat/css-in-js",{css(e){c=e}},0),r.link("@rocket.chat/fuselage",{Sidebar(e){d=e},TextInput(e){m=e},Box(e){p=e},Icon(e){v=e}},1),r.link("@rocket.chat/fuselage-hooks",{useMutableCallback(e){g=e},useDebouncedValue(e){b=e},useAutoFocus(e){f=e},useUniqueId(e){h=e},useMergedRefs(e){k=e}},2),r.link("@rocket.chat/string-helpers",{escapeRegExp(e){w=e}},3),r.link("@rocket.chat/ui-contexts",{useUserPreference(e){x=e},useUserSubscriptions(e){y=e},useSetting(e){S=e},useTranslation(e){T=e},useMethod(e){E=e}},4),r.link("@tanstack/react-query",{useQuery(e){_=e}},5),r.link("react",{default(e){I=e},forwardRef(e){q=e},useState(e){z=e},useMemo(e){A=e},useEffect(e){D=e},useRef(e){M=e}},6),r.link("react-virtuoso",{Virtuoso(e){j=e}},7),r.link("tinykeys",{default(e){C=e}},8),r.link("../../lib/utils/getConfig",{getConfig(e){R=e}},9),r.link("../hooks/useAvatarTemplate",{useAvatarTemplate(e){B=e}},10),r.link("../hooks/usePreventDefault",{usePreventDefault(e){U=e}},11),r.link("../hooks/useTemplateByViewMode",{useTemplateByViewMode(e){V=e}},12),r.link("./Row",{default(e){P=e}},13),r.link("./ScrollerWithCustomProps",{default(e){L=e}},14);let K=null!==(i=navigator.userAgentData)&&void 0!==i&&i.mobile||(N=!1,l=navigator.userAgent||navigator.vendor||window.opera||"",(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(l)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(l.substr(0,4)))&&(N=!0),N)?"":window.navigator.platform.toLowerCase().includes("mac")?"(⌘+K)":"(⌃+K)",W=parseInt(String(R("Sidebar_Search_Spotlight_LIMIT",20))),$={sort:{lm:-1,name:1},limit:W},O=e=>{let[,t,r]=A(()=>e.match(/(@|#)?(.*)/i)||[],[e]),a=A(()=>{let e=RegExp(w(r),"i");return u({$or:[{name:e},{fname:e}]},t&&{t:"@"===t?"d":{$ne:"d"}})},[r,t]),i=y(a,$),l=[...null==i?void 0:i.map(e=>{let{t,name:r}=e;return"d"===t?r:null})].filter(Boolean),n="#"===t,o="@"===t,s=A(()=>n?{users:!1,rooms:!0,includeFederatedRooms:!0}:o?{users:!0,rooms:!1}:{users:!0,rooms:!0,includeFederatedRooms:!0},[n,o]),c=E("spotlight");return _(["sidebar/search/spotlight",r,l,s,i.map(e=>{let{_id:t}=e;return t})],async()=>{if(i.length===W)return i;let e=await c(r,l,s),t=[];t.push(...e.users.filter((e,t,r)=>{let{_id:a}=e;return t===r.findIndex(e=>a===e._id)}).filter(e=>!i.find(t=>{var r;return"d"===t.t&&t.uids&&(null===(r=t.uids)||void 0===r?void 0:r.length)===2&&t.uids.includes(e._id)})).map(e=>({_id:e._id,t:"d",name:e.username,fname:e.name,avatarETag:e.avatarETag}))),t.push(...e.rooms.filter(e=>!i.find(t=>{var r;return"d"===e.t&&e.uids&&e.uids.length>1&&(null===(r=e.uids)||void 0===r?void 0:r.includes(t._id))||[t.rid,t._id].includes(e._id)})));let a=null==t?void 0:t.filter(e=>[e.name,e.fname].includes(r));return Array.from(new Set([...a,...i,...t]))},{staleTime:6e4,keepPreviousData:!0,placeholderData:i})},Q=e=>{let[t,r]=z(e),a=g(e=>{r(e.currentTarget.value)});return{value:t,onChange:a,setValue:r}},G=(e,t,r)=>{null==r||r.setAttribute("aria-activedescendant",e.id),e.setAttribute("aria-selected","true"),e.classList.add("rcx-sidebar-item--selected"),t&&(t.removeAttribute("aria-selected"),t.classList.remove("rcx-sidebar-item--selected"))},H=q(function e(e,t){let{onClose:r}=e,i=h(),l=T(),u=Q(""),{setValue:w}=u,y=s(u,F),E=M(null),_=k(f(),E),q=M(null),z=M(null),R=M(null),N=M(0),W=x("sidebarViewMode"),$=S("UI_Use_Real_Name"),H=V(),J=B(),X="extended"===W,Y=b(y.value,100),Z=[l("Search"),K].filter(Boolean).join(" "),{data:ee=[],isLoading:et}=O(Y),er=A(()=>({items:ee,t:l,SideBarItemTemplate:H,avatarTemplate:J,useRealName:$,extended:X,sidebarViewMode:W}),[J,X,ee,$,H,W,l]),ea=g(e=>{var t,r,a,i;let l=null;if("up"===e){let e=null===(t=R.current)||void 0===t?void 0:null===(r=t.parentElement)||void 0===r?void 0:r.previousSibling;e&&(l=e.querySelector("a"))}else{let e=null===(a=R.current)||void 0===a?void 0:null===(i=a.parentElement)||void 0===i?void 0:i.nextSibling;e&&(l=e.querySelector("a"))}return l?(G(l,R.current||void 0,(null==E?void 0:E.current)||void 0),l):R.current}),ei=g(()=>{var e,t;N.current=0,null===(e=q.current)||void 0===e||e.scrollToIndex({index:N.current}),R.current=null===(t=z.current)||void 0===t?void 0:t.querySelector("a.rcx-sidebar-item"),R.current&&G(R.current,void 0,(null==E?void 0:E.current)||void 0)});return U(z),D(()=>{ei()}),D(()=>{ei()},[Y,ei]),D(()=>{if(null!=E&&E.current)return C(null==E?void 0:E.current,{Escape:e=>{e.preventDefault(),w(e=>(e||r(),ei(),""))},Tab:r,ArrowUp:()=>{var e;let t=ea("up");N.current=Math.max(N.current-1,0),null===(e=q.current)||void 0===e||e.scrollToIndex({index:N.current}),R.current=t},ArrowDown:()=>{var e;let t=ea("down");N.current=Math.min(N.current+1,ee.length+1),null===(e=q.current)||void 0===e||e.scrollToIndex({index:N.current}),R.current=t},Enter:()=>{R.current&&R.current.click()}})},[E,ea,ee.length,r,ei,w]),I.createElement(p,{position:"absolute","rcx-sidebar":!0,h:"full",display:"flex",flexDirection:"column",zIndex:99,w:"full",className:c(a||(a=o(["\n				left: 0;\n				top: 0;\n			"]))),ref:t,role:"search"},I.createElement(d.TopBar.Section,{flexShrink:0,is:"form"},I.createElement(m,n({"aria-owns":i,"data-qa":"sidebar-search-input",ref:_},y,{placeholder:Z,role:"searchbox",addon:I.createElement(v,{name:"cross",size:"x20",onClick:r})}))),I.createElement(p,{ref:z,role:"listbox",id:i,tabIndex:-1,flexShrink:1,h:"full",w:"full","data-qa":"sidebar-search-result","aria-live":"polite","aria-atomic":"true","aria-busy":et,onClick:e=>{var t;if(!(e.target instanceof Element&&[e.target.tagName,null===(t=e.target.parentElement)||void 0===t?void 0:t.tagName].includes("BUTTON")))return r()}},I.createElement(j,{style:{height:"100%",width:"100%"},totalCount:ee.length,data:ee,components:{Scroller:L},computeItemKey:(e,t)=>t._id,itemContent:(e,t)=>I.createElement(P,{data:er,item:t}),ref:q})))});r.exportDefault(H)}
//# sourceMappingURL=/dynamic/client/sidebar/search/1b221f554ae899691f922650ae35ef3a998ad72c.map
