)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/sidebar/header/CreateDirectMessage.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IUser } from '@rocket.chat/core-typings';\nimport { Box, Modal, Button, FieldGroup, Field, FieldRow, FieldLabel, FieldError } from '@rocket.chat/fuselage';\nimport { useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation, useEndpoint, useToastMessageDispatch } from '@rocket.chat/ui-contexts';\nimport { useMutation } from '@tanstack/react-query';\nimport React, { memo } from 'react';\nimport { useForm, Controller } from 'react-hook-form';\n\nimport UserAutoCompleteMultipleFederated from '../../components/UserAutoCompleteMultiple/UserAutoCompleteMultipleFederated';\nimport { goToRoomById } from '../../lib/utils/goToRoomById';\n\nconst CreateDirectMessage = ({ onClose }: { onClose: () => void }) => {\n\tconst t = useTranslation();\n\tconst membersFieldId = useUniqueId();\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\n\tconst createDirectAction = useEndpoint('POST', '/v1/dm.create');\n\n\tconst {\n\t\tcontrol,\n\t\thandleSubmit,\n\t\tformState: { isDirty, isSubmitting, isValidating, errors },\n\t} = useForm({ mode: 'onBlur', defaultValues: { users: [] } });\n\n\tconst mutateDirectMessage = useMutation({\n\t\tmutationFn: createDirectAction,\n\t\tonSuccess: ({ room: { rid } }) => {\n\t\t\tgoToRoomById(rid);\n\t\t},\n\t\tonError: (error) => {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t},\n\t\tonSettled: () => {\n\t\t\tonClose();\n\t\t},\n\t});\n\n\tconst handleCreate = async ({ users }: { users: IUser['username'][] }) => {\n\t\treturn mutateDirectMessage.mutateAsync({ usernames: users.join(',') });\n\t};\n\n\treturn (\n\t\t<Modal data-qa='create-direct-modal' wrapperFunction={(props) => <Box is='form' onSubmit={handleSubmit(handleCreate)} {...props} />}>\n\t\t\t<Modal.Header>\n\t\t\t\t<Modal.Title>{t('Create_direct_message')}</Modal.Title>\n\t\t\t\t<Modal.Close tabIndex={-1} onClick={onClose} />\n\t\t\t</Modal.Header>\n\t\t\t<Modal.Content mbe={2}>\n\t\t\t\t<Box mbe={24}>{t('Direct_message_creation_description')}</Box>\n\t\t\t\t<FieldGroup>\n\t\t\t\t\t<Field>\n\t\t\t\t\t\t<FieldLabel htmlFor={membersFieldId} required>\n\t\t\t\t\t\t\t{t('Members')}\n\t\t\t\t\t\t</FieldLabel>\n\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t<Controller\n\t\t\t\t\t\t\t\tname='users'\n\t\t\t\t\t\t\t\trules={{ required: t('error-the-field-is-required', { field: t('Members') }) }}\n\t\t\t\t\t\t\t\tcontrol={control}\n\t\t\t\t\t\t\t\trender={({ field: { name, onChange, value, onBlur } }) => (\n\t\t\t\t\t\t\t\t\t<UserAutoCompleteMultipleFederated\n\t\t\t\t\t\t\t\t\t\tname={name}\n\t\t\t\t\t\t\t\t\t\tonChange={onChange}\n\t\t\t\t\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\t\t\t\t\tonBlur={onBlur}\n\t\t\t\t\t\t\t\t\t\tid={membersFieldId}\n\t\t\t\t\t\t\t\t\t\taria-describedby={`${membersFieldId}-error`}\n\t\t\t\t\t\t\t\t\t\taria-required='true'\n\t\t\t\t\t\t\t\t\t\taria-invalid={Boolean(errors.users)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t{errors.users && (\n\t\t\t\t\t\t\t<FieldError aria-live='assertive' id={`${membersFieldId}-error`}>\n\t\t\t\t\t\t\t\t{errors.users.message}\n\t\t\t\t\t\t\t</FieldError>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Field>\n\t\t\t\t</FieldGroup>\n\t\t\t</Modal.Content>\n\t\t\t<Modal.Footer>\n\t\t\t\t<Modal.FooterControllers>\n\t\t\t\t\t<Button onClick={onClose}>{t('Cancel')}</Button>\n\t\t\t\t\t<Button disabled={!isDirty} loading={isSubmitting || isValidating} type='submit' primary>\n\t\t\t\t\t\t{t('Create')}\n\t\t\t\t\t</Button>\n\t\t\t\t</Modal.FooterControllers>\n\t\t\t</Modal.Footer>\n\t\t</Modal>\n\t);\n};\n\nexport default memo(CreateDirectMessage);\n",null],"names":["_extends","Box","Modal","Button","FieldGroup","Field","FieldRow","FieldLabel","FieldError","useUniqueId","useTranslation","useEndpoint","useToastMessageDispatch","useMutation","React","memo","useForm","Controller","UserAutoCompleteMultipleFederated","goToRoomById","module","link","default","exportDefault","_ref","onClose","t","membersFieldId","dispatchToastMessage","createDirectAction","control","handleSubmit","formState","isDirty","isSubmitting","isValidating","errors","mode","defaultValues","users","mutateDirectMessage","mutationFn","onSuccess","_ref2","room","rid","onError","error","type","message","onSettled","handleCreate","_ref3","mutateAsync","usernames","join","createElement","wrapperFunction","props","is","onSubmit","Header","Title","Close","tabIndex","onClick","Content","mbe","htmlFor","required","name","rules","field","render","_ref4","onChange","value","onBlur","id","concat","Boolean","Footer","FooterControllers","disabled","loading","primary"],"mappings":"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"}