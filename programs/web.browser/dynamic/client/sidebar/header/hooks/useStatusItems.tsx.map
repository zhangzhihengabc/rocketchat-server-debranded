)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/sidebar/header/hooks/useStatusItems.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IUser, ValueOf } from '@rocket.chat/core-typings';\nimport { UserStatus as UserStatusEnum } from '@rocket.chat/core-typings';\nimport { Box } from '@rocket.chat/fuselage';\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\nimport { useEndpoint, useSetting, useTranslation } from '@rocket.chat/ui-contexts';\nimport React from 'react';\n\nimport { userStatus } from '../../../../app/user-status/client';\nimport { callbacks } from '../../../../lib/callbacks';\nimport type { GenericMenuItemProps } from '../../../components/GenericMenu/GenericMenuItem';\nimport MarkdownText from '../../../components/MarkdownText';\nimport { UserStatus } from '../../../components/UserStatus';\nimport { useStatusDisabledModal } from '../../../views/admin/customUserStatus/hooks/useStatusDisabledModal';\nimport { useCustomStatusModalHandler } from './useCustomStatusModalHandler';\n\nconst isDefaultStatus = (id: string): boolean => (Object.values(UserStatusEnum) as string[]).includes(id);\nconst isDefaultStatusName = (_name: string, id: string): _name is UserStatusEnum => isDefaultStatus(id);\nconst translateStatusName = (t: ReturnType<typeof useTranslation>, status: (typeof userStatus.list)['']): string => {\n\tif (isDefaultStatusName(status.name, status.id)) {\n\t\treturn t(status.name as TranslationKey);\n\t}\n\n\treturn status.name;\n};\n\nexport const useStatusItems = (user: IUser): GenericMenuItemProps[] => {\n\tconst t = useTranslation();\n\tconst presenceDisabled = useSetting<boolean>('Presence_broadcast_disabled');\n\tconst setStatus = useEndpoint('POST', '/v1/users.setStatus');\n\n\tconst setStatusAction = (status: (typeof userStatus.list)['']): void => {\n\t\tsetStatus({ status: status.statusType, message: !isDefaultStatus(status.id) ? status.name : '' });\n\t\tvoid callbacks.run('userStatusManuallySet', status);\n\t};\n\n\tconst filterInvisibleStatus = !useSetting('Accounts_AllowInvisibleStatusOption')\n\t\t? (status: ValueOf<(typeof userStatus)['list']>): boolean => status.name !== 'invisible'\n\t\t: (): boolean => true;\n\n\tconst handleCustomStatus = useCustomStatusModalHandler();\n\n\tconst handleStatusDisabledModal = useStatusDisabledModal();\n\n\tconst presenceDisabledItem = {\n\t\tid: 'presence-disabled',\n\t\tcontent: (\n\t\t\t<Box fontScale='p2'>\n\t\t\t\t<Box mbe={4} wordBreak='break-word' style={{ whiteSpace: 'normal' }}>\n\t\t\t\t\t{t('User_status_disabled')}\n\t\t\t\t</Box>\n\t\t\t\t<Box is='a' color='info' onClick={handleStatusDisabledModal}>\n\t\t\t\t\t{t('Learn_more')}\n\t\t\t\t</Box>\n\t\t\t</Box>\n\t\t),\n\t};\n\n\tconst statusItems = Object.values(userStatus.list)\n\t\t.filter(filterInvisibleStatus)\n\t\t.map((status) => {\n\t\t\tconst name = status.localizeName ? translateStatusName(t, status) : status.name;\n\t\t\tconst modifier = status.statusType || user?.status;\n\t\t\treturn {\n\t\t\t\tid: status.id,\n\t\t\t\tstatus: <UserStatus status={modifier} />,\n\t\t\t\tcontent: <MarkdownText content={name} parseEmoji={true} variant='inline' />,\n\t\t\t\tonClick: () => setStatusAction(status),\n\t\t\t\tdisabled: presenceDisabled,\n\t\t\t};\n\t\t});\n\n\treturn [\n\t\t...(presenceDisabled ? [presenceDisabledItem] : []),\n\t\t...statusItems,\n\t\t{ id: 'custom-status', icon: 'emoji', content: t('Custom_Status'), onClick: handleCustomStatus, disabled: presenceDisabled },\n\t];\n};\n",null],"names":["UserStatusEnum","Box","useEndpoint","useSetting","useTranslation","React","userStatus","callbacks","MarkdownText","UserStatus","useStatusDisabledModal","useCustomStatusModalHandler","module","export","useStatusItems","link","default","isDefaultStatus","id","Object","values","includes","isDefaultStatusName","_name","translateStatusName","t","status","name","user","presenceDisabled","setStatus","setStatusAction","statusType","message","run","filterInvisibleStatus","handleCustomStatus","handleStatusDisabledModal","presenceDisabledItem","content","createElement","fontScale","mbe","wordBreak","style","whiteSpace","is","color","onClick","statusItems","list","filter","map","localizeName","modifier","parseEmoji","variant","disabled","icon"],"mappings":"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"}