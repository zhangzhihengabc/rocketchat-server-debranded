)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/hooks/useFileInput.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useRef, useEffect } from 'react';\n\nexport const useFileInput = (\n\tonSetFile: (file: FileList[number], formData: FormData) => void,\n\tfileType = 'image/*',\n\tfileField = 'image',\n): [onClick: () => void, reset: () => void] => {\n\tconst ref = useRef<HTMLInputElement>();\n\n\tuseEffect(() => {\n\t\tconst fileInput = document.createElement('input');\n\t\tfileInput.setAttribute('type', 'file');\n\t\tfileInput.setAttribute('style', 'display: none');\n\t\tdocument.body.appendChild(fileInput);\n\t\tref.current = fileInput;\n\n\t\treturn (): void => {\n\t\t\tref.current = undefined;\n\t\t\tfileInput.remove();\n\t\t};\n\t}, []);\n\n\tuseEffect(() => {\n\t\tconst fileInput = ref.current;\n\t\tif (!fileInput) {\n\t\t\treturn;\n\t\t}\n\n\t\tfileInput.setAttribute('accept', fileType);\n\t}, [fileType]);\n\n\tuseEffect(() => {\n\t\tconst fileInput = ref.current;\n\t\tif (!fileInput) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst handleFiles = (): void => {\n\t\t\tif (!fileInput?.files?.length) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst formData = new FormData();\n\t\t\tformData.append(fileField, fileInput.files[0]);\n\t\t\tonSetFile(fileInput.files[0], formData);\n\t\t};\n\n\t\tfileInput.addEventListener('change', handleFiles, false);\n\n\t\treturn (): void => {\n\t\t\tfileInput.removeEventListener('change', handleFiles, false);\n\t\t};\n\t}, [fileField, fileType, onSetFile]);\n\n\tconst onClick = useMutableCallback(() => ref?.current?.click());\n\tconst reset = useMutableCallback(() => {\n\t\tif (ref.current) {\n\t\t\tref.current.value = '';\n\t\t}\n\t});\n\treturn [onClick, reset];\n};\n",null],"names":["useMutableCallback","useRef","useEffect","module","export","useFileInput","onSetFile","fileType","arguments","length","undefined","fileField","ref","fileInput","document","createElement","setAttribute","body","appendChild","current","remove","handleFiles","_fileInput$files","files","formData","FormData","append","addEventListener","removeEventListener","onClick","_ref$current","click","reset","value"],"mappings":"2BAAmCA,EAA8BC,EAAAC,EAAjEC,EAAOC,MAAE,CAAA,CAAAC,aAAkB,IAAEA,CAAM,GAA8BF,EAAAA,IAAAA,CAAAA,8BAAAA,CAAAH,mBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,QAAAA,CAAAF,OAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,UAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAG1D,IAAMG,EAAe,SAC3BC,CAA+D,EAGlB,IAF7CC,EAAQC,UAAAC,MAAA,CAAA,GAAAD,AAAAE,KAAAA,IAAAF,SAAA,CAAA,EAAA,CAAAA,SAAA,CAAA,EAAA,CAAG,UACXG,EAASH,UAAAC,MAAA,CAAA,GAAAD,AAAAE,KAAAA,IAAAF,SAAA,CAAA,EAAA,CAAAA,SAAA,CAAA,EAAA,CAAG,QAENI,EAAMX,IAEZC,EAAU,KACT,IAAMW,EAAYC,SAASC,aAAa,CAAC,SAMzC,OALAF,EAAUG,YAAY,CAAC,OAAQ,QAC/BH,EAAUG,YAAY,CAAC,QAAS,iBAChCF,SAASG,IAAI,CAACC,WAAW,CAACL,GAC1BD,EAAIO,OAAO,CAAGN,EAEP,KACND,EAAIO,OAAO,CAAGT,KAAAA,EACdG,EAAUO,MAAM,EACjB,CACD,EAAG,EAAE,EAELlB,EAAU,KACT,IAAMW,EAAYD,EAAIO,OAAO,CACxBN,GAILA,EAAUG,YAAY,CAAC,SAAUT,EAClC,EAAG,CAACA,EAAS,EAEbL,EAAU,KACT,IAAMW,EAAYD,EAAIO,OAAO,CAC7B,GAAI,CAACN,EACJ,OAGD,IAAMQ,EAAc,KAAW,IAAAC,EAC9B,GAAI,CAACT,CAAAA,MAAAA,GAAS,AAAO,OAAPS,CAAAA,EAATT,EAAWU,KAAK,AAALA,GAAKD,AAAA,KAAA,IAAAA,GAAhBA,EAAkBb,MAAM,AAANA,EACtB,OAED,IAAMe,EAAW,IAAIC,SACrBD,EAASE,MAAM,CAACf,EAAWE,EAAUU,KAAK,CAAC,EAAE,EAC7CjB,EAAUO,EAAUU,KAAK,CAAC,EAAE,CAAEC,EAC/B,EAIA,OAFAX,EAAUc,gBAAgB,CAAC,SAAUN,EAAa,CAAA,GAE3C,KACNR,EAAUe,mBAAmB,CAAC,SAAUP,EAAa,CAAA,EACtD,CACD,EAAG,CAACV,EAAWJ,EAAUD,EAAU,EAEnC,IAAMuB,EAAU7B,EAAmB,KAAA,IAAA8B,EAAA,OAAMlB,MAAAA,EAAG,KAAA,EAAA,AAAS,OAATkB,CAAAA,EAAHlB,EAAKO,OAAO,AAAPA,GAAOW,AAAA,KAAA,IAAAA,EAAA,KAAA,EAAZA,EAAcC,KAAK,EAAE,GACxDC,EAAQhC,EAAmB,KAC5BY,EAAIO,OAAO,EACdP,CAAAA,EAAIO,OAAO,CAACc,KAAK,CAAG,EAAA,CAEtB,GACA,MAAO,CAACJ,EAASG,EAAM,AACxB"}