)]}'
{"version":3,"sources":["meteor://ðŸ’»app/client/hooks/useAnalyticsEventTracking.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useRouter, useSetting, useUserId } from '@rocket.chat/ui-contexts';\nimport { useEffect } from 'react';\n\nimport { callbacks } from '../../lib/callbacks';\n\nfunction trackEvent(category: string, action: string, label?: unknown) {\n\tconst { _paq, ga } = window;\n\n\t_paq?.push(['trackEvent', category, action, label]);\n\tga?.('send', 'event', category, action, label);\n}\n\nexport const useAnalyticsEventTracking = () => {\n\tconst router = useRouter();\n\n\tuseEffect(\n\t\t() =>\n\t\t\trouter.subscribeToRouteChange(() => {\n\t\t\t\tconst { _paq, ga } = window;\n\n\t\t\t\tif (_paq) {\n\t\t\t\t\tconst http = location.protocol;\n\t\t\t\t\tconst slashes = http.concat('//');\n\t\t\t\t\tconst host = slashes.concat(location.hostname);\n\t\t\t\t\t_paq.push(['setCustomUrl', host + router.getLocationPathname()]);\n\t\t\t\t\t_paq.push(['trackPageView']);\n\t\t\t\t}\n\n\t\t\t\tga?.('send', 'pageview', router.getLocationPathname());\n\t\t\t}),\n\t\t[router],\n\t);\n\n\tuseEffect(() => {\n\t\tcallbacks.add(\n\t\t\t'loginPageStateChange',\n\t\t\t(state) => {\n\t\t\t\ttrackEvent('Navigation', 'Login Page State Change', state);\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'analytics-login-state-change',\n\t\t);\n\n\t\treturn () => {\n\t\t\tcallbacks.remove('loginPageStateChange', 'analytics-login-state-change');\n\t\t};\n\t}, []);\n\n\tconst featuresMessages = useSetting('Analytics_features_messages', true);\n\n\tuseEffect(() => {\n\t\tif (!featuresMessages) {\n\t\t\treturn;\n\t\t}\n\n\t\tcallbacks.add(\n\t\t\t'afterSaveMessage',\n\t\t\t(_message, room, _uid) => {\n\t\t\t\ttrackEvent('Message', 'Send', `${room.name} (${room._id})`);\n\t\t\t},\n\t\t\tcallbacks.priority.LOW,\n\t\t\t'trackEvents',\n\t\t);\n\n\t\treturn () => {\n\t\t\tcallbacks.remove('afterSaveMessage', 'trackEvents');\n\t\t};\n\t}, [featuresMessages]);\n\n\tconst featuresRooms = useSetting('Analytics_features_rooms', true);\n\n\tuseEffect(() => {\n\t\tif (!featuresRooms) {\n\t\t\treturn;\n\t\t}\n\n\t\tcallbacks.add(\n\t\t\t'afterCreateChannel',\n\t\t\t(_owner, room) => {\n\t\t\t\ttrackEvent('Room', 'Create', `${room.name} (${room._id})`);\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'analytics-after-create-channel',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'roomNameChanged',\n\t\t\t(room) => {\n\t\t\t\ttrackEvent('Room', 'Changed Name', `${room.name} (${room._id})`);\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'analytics-room-name-changed',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'roomTopicChanged',\n\t\t\t(room) => {\n\t\t\t\ttrackEvent('Room', 'Changed Topic', `${room.name} (${room._id})`);\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'analytics-room-topic-changed',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'roomAnnouncementChanged',\n\t\t\t(room) => {\n\t\t\t\ttrackEvent('Room', 'Changed Announcement', `${room.name} (${room._id})`);\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'analytics-room-announcement-changed',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'roomTypeChanged',\n\t\t\t(room) => {\n\t\t\t\ttrackEvent('Room', 'Changed Room Type', `${room.name} (${room._id})`);\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'analytics-room-type-changed',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'archiveRoom',\n\t\t\t(room) => {\n\t\t\t\ttrackEvent('Room', 'Archived', `${room.name} (${room._id})`);\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'analytics-archive-room',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'unarchiveRoom',\n\t\t\t(room) => {\n\t\t\t\ttrackEvent('Room', 'Unarchived', `${room.name} (${room._id})`);\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'analytics-unarchive-room',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'roomAvatarChanged',\n\t\t\t(room) => {\n\t\t\t\ttrackEvent('Room', 'Changed Avatar', `${room.name} (${room._id})`);\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'analytics-room-avatar-changed',\n\t\t);\n\n\t\treturn () => {\n\t\t\tcallbacks.remove('afterCreateChannel', 'analytics-after-create-channel');\n\t\t\tcallbacks.remove('roomNameChanged', 'analytics-room-name-changed');\n\t\t\tcallbacks.remove('roomTopicChanged', 'analytics-room-topic-changed');\n\t\t\tcallbacks.remove('roomAnnouncementChanged', 'analytics-room-announcement-changed');\n\t\t\tcallbacks.remove('roomTypeChanged', 'analytics-room-type-changed');\n\t\t\tcallbacks.remove('archiveRoom', 'analytics-archive-room');\n\t\t\tcallbacks.remove('unarchiveRoom', 'analytics-unarchive-room');\n\t\t\tcallbacks.remove('roomAvatarChanged', 'analytics-room-avatar-changed');\n\t\t};\n\t}, [featuresRooms]);\n\n\tconst featuresUsers = useSetting('Analytics_features_users', true);\n\n\tuseEffect(() => {\n\t\tif (!featuresUsers) {\n\t\t\treturn;\n\t\t}\n\n\t\tcallbacks.add(\n\t\t\t'userRegistered',\n\t\t\t() => {\n\t\t\t\ttrackEvent('User', 'Registered');\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'piwik-user-resitered',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'usernameSet',\n\t\t\t() => {\n\t\t\t\ttrackEvent('User', 'Username Set');\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'piweik-username-set',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'userPasswordReset',\n\t\t\t() => {\n\t\t\t\ttrackEvent('User', 'Reset Password');\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'piwik-user-password-reset',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'userConfirmationEmailRequested',\n\t\t\t() => {\n\t\t\t\ttrackEvent('User', 'Confirmation Email Requested');\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'piwik-user-confirmation-email-requested',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'userForgotPasswordEmailRequested',\n\t\t\t() => {\n\t\t\t\ttrackEvent('User', 'Forgot Password Email Requested');\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'piwik-user-forgot-password-email-requested',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'userStatusManuallySet',\n\t\t\t(status) => {\n\t\t\t\ttrackEvent('User', 'Status Manually Changed', status);\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'analytics-user-status-manually-set',\n\t\t);\n\n\t\tcallbacks.add(\n\t\t\t'userAvatarSet',\n\t\t\t(service) => {\n\t\t\t\ttrackEvent('User', 'Avatar Changed', service);\n\t\t\t},\n\t\t\tcallbacks.priority.MEDIUM,\n\t\t\t'analytics-user-avatar-set',\n\t\t);\n\n\t\treturn () => {\n\t\t\tcallbacks.remove('userRegistered', 'piwik-user-resitered');\n\t\t\tcallbacks.remove('usernameSet', 'piweik-username-set');\n\t\t\tcallbacks.remove('userPasswordReset', 'piwik-user-password-reset');\n\t\t\tcallbacks.remove('userConfirmationEmailRequested', 'piwik-user-confirmation-email-requested');\n\t\t\tcallbacks.remove('userForgotPasswordEmailRequested', 'piwik-user-forgot-password-email-requested');\n\t\t\tcallbacks.remove('userStatusManuallySet', 'analytics-user-status-manually-set');\n\t\t\tcallbacks.remove('userAvatarSet', 'analytics-user-avatar-set');\n\t\t};\n\t}, [featuresUsers]);\n\n\tconst uid = useUserId();\n\n\tuseEffect(() => {\n\t\tif (!featuresUsers) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { _paq } = window;\n\n\t\ttrackEvent('User', 'Login', uid);\n\t\t_paq?.push(['setUserId', uid]);\n\n\t\treturn () => {\n\t\t\ttrackEvent('User', 'Logout', uid);\n\t\t};\n\t}, [featuresUsers, uid]);\n};\n",null],"names":["useRouter","useEffect","callbacks","trackEvent","category","action","label","_paq","ga","window","push","module","export","useAnalyticsEventTracking","useSetting","useUserId","router","subscribeToRouteChange","http","location","protocol","slashes","concat","host","hostname","getLocationPathname","add","state","priority","MEDIUM","remove","featuresMessages","_message","room","_uid","name","_id","LOW","featuresRooms","_owner","featuresUsers","status","service","uid"],"mappings":"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"}