)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/views/admin/engagementDashboard/messages/MessagesSentSection.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { ResponsiveBar } from '@nivo/bar';\nimport { Box, Flex, Skeleton, Palette, Tooltip } from '@rocket.chat/fuselage';\nimport colors from '@rocket.chat/fuselage-tokens/colors.json';\nimport { useTranslation } from '@rocket.chat/ui-contexts';\nimport moment from 'moment';\nimport type { ReactElement } from 'react';\nimport React, { useMemo } from 'react';\n\nimport CounterSet from '../../../../../../client/components/dataView/CounterSet';\nimport DownloadDataButton from '../../../../components/dashboards/DownloadDataButton';\nimport PeriodSelector from '../../../../components/dashboards/PeriodSelector';\nimport { usePeriodLabel } from '../../../../components/dashboards/usePeriodLabel';\nimport { usePeriodSelectorState } from '../../../../components/dashboards/usePeriodSelectorState';\nimport EngagementDashboardCardFilter from '../EngagementDashboardCardFilter';\nimport { useMessagesSent } from './useMessagesSent';\n\nconst MessagesSentSection = (): ReactElement => {\n\tconst [period, periodSelectorProps] = usePeriodSelectorState('last 7 days', 'last 30 days', 'last 90 days');\n\tconst periodLabel = usePeriodLabel(period);\n\n\tconst t = useTranslation();\n\n\tconst { data } = useMessagesSent({ period });\n\n\tconst [countFromPeriod, variatonFromPeriod, countFromYesterday, variationFromYesterday, values] = useMemo(() => {\n\t\tif (!data) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst values = Array.from({ length: moment(data.end).diff(data.start, 'days') + 1 }, (_, i) => ({\n\t\t\tdate: moment(data.start).add(i, 'days').toISOString(),\n\t\t\tnewMessages: 0,\n\t\t}));\n\n\t\tfor (const { day, messages } of data.days ?? []) {\n\t\t\tconst i = moment(day).diff(data.start, 'days');\n\t\t\tif (i >= 0) {\n\t\t\t\tvalues[i].newMessages += messages;\n\t\t\t}\n\t\t}\n\n\t\treturn [data.period?.count, data.period?.variation, data.yesterday?.count, data.yesterday?.variation, values];\n\t}, [data]);\n\n\treturn (\n\t\t<>\n\t\t\t<EngagementDashboardCardFilter>\n\t\t\t\t<PeriodSelector {...periodSelectorProps} />\n\t\t\t\t<DownloadDataButton\n\t\t\t\t\tattachmentName={`MessagesSentSection_start_${data?.start}_end_${data?.end}`}\n\t\t\t\t\theaders={['Date', 'Messages']}\n\t\t\t\t\tdataAvailable={!!data}\n\t\t\t\t\tdataExtractor={(): unknown[][] | undefined => values?.map(({ date, newMessages }) => [date, newMessages])}\n\t\t\t\t/>\n\t\t\t</EngagementDashboardCardFilter>\n\n\t\t\t<CounterSet\n\t\t\t\tcounters={[\n\t\t\t\t\t{\n\t\t\t\t\t\tcount: countFromPeriod ?? <Skeleton variant='rect' width='3ex' height='1em' />,\n\t\t\t\t\t\tvariation: variatonFromPeriod ?? 0,\n\t\t\t\t\t\tdescription: periodLabel,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcount: countFromYesterday ?? <Skeleton variant='rect' width='3ex' height='1em' />,\n\t\t\t\t\t\tvariation: variationFromYesterday ?? 0,\n\t\t\t\t\t\tdescription: t('Yesterday'),\n\t\t\t\t\t},\n\t\t\t\t]}\n\t\t\t/>\n\t\t\t<Flex.Container>\n\t\t\t\t{values ? (\n\t\t\t\t\t<Box style={{ height: 240 }}>\n\t\t\t\t\t\t<Flex.Item align='stretch' grow={1} shrink={0}>\n\t\t\t\t\t\t\t<Box style={{ position: 'relative' }}>\n\t\t\t\t\t\t\t\t<Box\n\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\t\t\t\t\theight: '100%',\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<ResponsiveBar\n\t\t\t\t\t\t\t\t\t\tdata={values}\n\t\t\t\t\t\t\t\t\t\tindexBy='date'\n\t\t\t\t\t\t\t\t\t\tkeys={['newMessages']}\n\t\t\t\t\t\t\t\t\t\tgroupMode='grouped'\n\t\t\t\t\t\t\t\t\t\tpadding={0.25}\n\t\t\t\t\t\t\t\t\t\tmargin={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\tbottom: 20,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tcolors={[\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\tPalette.statusColor['status-font-on-info'].toString(),\n\t\t\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\t\t\tenableLabel={false}\n\t\t\t\t\t\t\t\t\t\tenableGridY={false}\n\t\t\t\t\t\t\t\t\t\taxisTop={null}\n\t\t\t\t\t\t\t\t\t\taxisRight={null}\n\t\t\t\t\t\t\t\t\t\taxisBottom={\n\t\t\t\t\t\t\t\t\t\t\t(values.length === 7 && {\n\t\t\t\t\t\t\t\t\t\t\t\ttickSize: 0,\n\t\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\t\ttickPadding: 4,\n\t\t\t\t\t\t\t\t\t\t\t\ttickRotation: 0,\n\t\t\t\t\t\t\t\t\t\t\t\tformat: (date): string => moment(date).format('dddd'),\n\t\t\t\t\t\t\t\t\t\t\t}) ||\n\t\t\t\t\t\t\t\t\t\t\tnull\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\taxisLeft={null}\n\t\t\t\t\t\t\t\t\t\tanimate={true}\n\t\t\t\t\t\t\t\t\t\tmotionConfig='stiff'\n\t\t\t\t\t\t\t\t\t\ttheme={{\n\t\t\t\t\t\t\t\t\t\t\t// TODO: Get it from theme\n\t\t\t\t\t\t\t\t\t\t\taxis: {\n\t\t\t\t\t\t\t\t\t\t\t\tticks: {\n\t\t\t\t\t\t\t\t\t\t\t\t\ttext: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill: colors.n600,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontFamily:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'Inter, -apple-system, system-ui, \"Segoe UI\", Roboto, Oxygen, Ubuntu, Cantarell, \"Helvetica Neue\", \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Meiryo UI\", Arial, sans-serif',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontSize: '10px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontStyle: 'normal',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontWeight: 600,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tletterSpacing: '0.2px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlineHeight: '12px',\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\ttooltip={({ value }) => <Tooltip>{t('Value_messages', { value })}</Tooltip>}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t\t</Box>\n\t\t\t\t\t\t</Flex.Item>\n\t\t\t\t\t</Box>\n\t\t\t\t) : (\n\t\t\t\t\t<Skeleton variant='rect' height={240} />\n\t\t\t\t)}\n\t\t\t</Flex.Container>\n\t\t</>\n\t);\n};\n\nexport default MessagesSentSection;\n",null],"names":["ResponsiveBar","Box","Flex","Skeleton","Palette","Tooltip","colors","useTranslation","moment","React","useMemo","CounterSet","DownloadDataButton","PeriodSelector","usePeriodLabel","usePeriodSelectorState","EngagementDashboardCardFilter","useMessagesSent","module","link","default","exportDefault","period","periodSelectorProps","periodLabel","t","data","countFromPeriod","variatonFromPeriod","countFromYesterday","variationFromYesterday","values","_data$period","_data$period2","_data$yesterday","_data$yesterday2","_data$days","Array","from","length","end","diff","start","_","i","date","add","toISOString","newMessages","day","messages","days","count","variation","yesterday","createElement","Fragment","attachmentName","concat","headers","dataAvailable","dataExtractor","map","_ref","counters","variant","width","height","description","Container","style","Item","align","grow","shrink","position","indexBy","keys","groupMode","padding","margin","bottom","statusColor","toString","enableLabel","enableGridY","axisTop","axisRight","axisBottom","tickSize","tickPadding","tickRotation","format","axisLeft","animate","motionConfig","theme","axis","ticks","text","fill","n600","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","tooltip","_ref2","value"],"mappings":"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"}