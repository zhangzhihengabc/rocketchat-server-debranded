)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/views/admin/deviceManagement/DeviceManagementAdminTable/DeviceManagementAdminTable.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { DeviceManagementPopulatedSession, DeviceManagementSession, Serialized } from '@rocket.chat/core-typings';\nimport { useDebouncedValue, useMediaQuery } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement, MutableRefObject } from 'react';\nimport React, { useState, useMemo, useEffect } from 'react';\n\nimport FilterByText from '../../../../../../client/components/FilterByText';\nimport { GenericTableHeaderCell } from '../../../../../../client/components/GenericTable';\nimport { usePagination } from '../../../../../../client/components/GenericTable/hooks/usePagination';\nimport { useSort } from '../../../../../../client/components/GenericTable/hooks/useSort';\nimport { useEndpointData } from '../../../../../../client/hooks/useEndpointData';\nimport DeviceManagementTable from '../../../../components/deviceManagement/DeviceManagementTable';\nimport DeviceManagementAdminRow from './DeviceManagementAdminRow';\n\nconst sortMapping = {\n\tclient: 'device.name',\n\tusername: '_user.username',\n\tos: 'device.os.name',\n\tloginAt: 'loginAt',\n};\n\nconst isSessionPopulatedSession = (\n\tsession: Serialized<DeviceManagementPopulatedSession | DeviceManagementSession>,\n): session is Serialized<DeviceManagementPopulatedSession> => '_user' in session;\n\nconst DeviceManagementAdminTable = ({ reloadRef }: { reloadRef: MutableRefObject<() => void> }): ReactElement => {\n\tconst t = useTranslation();\n\tconst [text, setText] = useState('');\n\tconst { current, itemsPerPage, setCurrent, setItemsPerPage, ...paginationProps } = usePagination();\n\tconst { sortBy, sortDirection, setSort } = useSort<'client' | 'os' | 'username' | 'loginAt'>('username');\n\n\tconst query = useDebouncedValue(\n\t\tuseMemo(\n\t\t\t() => ({\n\t\t\t\tfilter: text,\n\t\t\t\tsort: JSON.stringify({ [sortMapping[sortBy]]: sortDirection === 'asc' ? 1 : -1 }),\n\t\t\t\tcount: itemsPerPage,\n\t\t\t\toffset: text ? undefined : current,\n\t\t\t}),\n\t\t\t[text, itemsPerPage, current, sortBy, sortDirection],\n\t\t),\n\t\t500,\n\t);\n\n\tconst { value: data, phase, error, reload } = useEndpointData('/v1/sessions/list.all', { params: query });\n\n\tuseEffect(() => {\n\t\treloadRef.current = reload;\n\t}, [reloadRef, reload]);\n\n\tconst mediaQuery = useMediaQuery('(min-width: 1024px)');\n\n\tconst headers = useMemo(\n\t\t() => [\n\t\t\t<GenericTableHeaderCell key='client' direction={sortDirection} active={sortBy === 'client'} onClick={setSort} sort='client'>\n\t\t\t\t{t('Client')}\n\t\t\t</GenericTableHeaderCell>,\n\t\t\t<GenericTableHeaderCell key='rcVersion'>{t('Version')}</GenericTableHeaderCell>,\n\t\t\t<GenericTableHeaderCell key='os' direction={sortDirection} active={sortBy === 'os'} onClick={setSort} sort='os'>\n\t\t\t\t{t('OS')}\n\t\t\t</GenericTableHeaderCell>,\n\t\t\t<GenericTableHeaderCell key='username' direction={sortDirection} active={sortBy === 'username'} onClick={setSort} sort='username'>\n\t\t\t\t{t('User')}\n\t\t\t</GenericTableHeaderCell>,\n\t\t\tmediaQuery && (\n\t\t\t\t<GenericTableHeaderCell key='loginAt' direction={sortDirection} active={sortBy === 'loginAt'} onClick={setSort} sort='loginAt'>\n\t\t\t\t\t{t('Last_login')}\n\t\t\t\t</GenericTableHeaderCell>\n\t\t\t),\n\t\t\tmediaQuery && <GenericTableHeaderCell key='_id'>{t('Device_ID')}</GenericTableHeaderCell>,\n\t\t\tmediaQuery && <GenericTableHeaderCell key='ip'>{t('IP_Address')}</GenericTableHeaderCell>,\n\t\t\t<GenericTableHeaderCell width='5%' key='menu' />,\n\t\t],\n\t\t[t, mediaQuery, setSort, sortDirection, sortBy],\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t<FilterByText placeholder={t('Search_Devices_Users')} onChange={({ text }): void => setText(text)} />\n\t\t\t<DeviceManagementTable\n\t\t\t\tdata={data}\n\t\t\t\tphase={phase}\n\t\t\t\terror={error}\n\t\t\t\treload={reload}\n\t\t\t\theaders={headers}\n\t\t\t\trenderRow={(session): ReactElement => (\n\t\t\t\t\t<DeviceManagementAdminRow\n\t\t\t\t\t\tkey={session._id}\n\t\t\t\t\t\t_id={session._id}\n\t\t\t\t\t\tusername={isSessionPopulatedSession(session) ? session._user?.username : ''}\n\t\t\t\t\t\tip={session.ip}\n\t\t\t\t\t\tdeviceName={session?.device?.name}\n\t\t\t\t\t\tdeviceType={session?.device?.type}\n\t\t\t\t\t\tdeviceOSName={session?.device?.os?.name}\n\t\t\t\t\t\trcVersion={session?.device?.version}\n\t\t\t\t\t\tloginAt={session.loginAt}\n\t\t\t\t\t\tonReload={reload}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\tcurrent={current}\n\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\tsetCurrent={setCurrent}\n\t\t\t\tsetItemsPerPage={setItemsPerPage}\n\t\t\t\tpaginationProps={paginationProps}\n\t\t\t/>\n\t\t</>\n\t);\n};\n\nexport default DeviceManagementAdminTable;\n",null],"names":["_objectWithoutProperties","useDebouncedValue","useMediaQuery","useTranslation","React","useState","useMemo","useEffect","FilterByText","GenericTableHeaderCell","usePagination","useSort","useEndpointData","DeviceManagementTable","DeviceManagementAdminRow","module","default","link","sortMapping","client","username","os","loginAt","isSessionPopulatedSession","session","exportDefault","_ref","reloadRef","t","text","setText","_usePagination","current","itemsPerPage","setCurrent","setItemsPerPage","paginationProps","_excluded","sortBy","sortDirection","setSort","query","filter","sort","JSON","stringify","count","offset","undefined","value","data","phase","error","reload","params","mediaQuery","headers","createElement","key","direction","active","onClick","width","Fragment","placeholder","onChange","_ref2","renderRow","_session$_user","_session$device","_session$device2","_session$device3","_session$device3$os","_session$device4","_id","_user","ip","deviceName","device","name","deviceType","type","deviceOSName","rcVersion","version","onReload"],"mappings":"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"}