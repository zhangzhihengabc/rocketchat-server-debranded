)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/views/audit/components/forms/DateRangePicker.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Box, InputBox, Menu, Margins, Option } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation } from '@rocket.chat/ui-contexts';\nimport moment from 'moment';\nimport type { ReactElement, ComponentProps, SetStateAction } from 'react';\nimport React, { useMemo } from 'react';\n\nimport type { DateRange } from '../../utils/dateRange';\n\nconst formatToDateInput = (date: Date | undefined) => {\n\tif (!date) {\n\t\treturn '';\n\t}\n\n\tconst yearPart = date.getFullYear().toString().padStart(4, '0').slice(0, 4);\n\tconst monthPart = (date.getMonth() + 1).toString().padStart(2, '0').slice(0, 2);\n\tconst dayPart = date.getDate().toString().padStart(2, '0').slice(0, 2);\n\treturn `${yearPart}-${monthPart}-${dayPart}`;\n};\n\nconst parseFromStartDateInput = (date: string) => {\n\tif (!date) {\n\t\treturn undefined;\n\t}\n\n\treturn moment(date, 'YYYY-MM-DD').startOf('day').toDate();\n};\n\nconst parseFromEndDateInput = (date: string) => {\n\tif (!date) {\n\t\treturn undefined;\n\t}\n\n\treturn moment(date, 'YYYY-MM-DD').endOf('day').toDate();\n};\n\ntype DateRangeAction =\n\t| SetStateAction<DateRange>\n\t| 'today'\n\t| 'yesterday'\n\t| 'this-week'\n\t| 'last-week'\n\t| 'this-month'\n\t| 'last-month'\n\t| { newStart: string }\n\t| { newEnd: string };\n\nconst dateRangeReducer = (state: DateRange, action: DateRangeAction): DateRange => {\n\tswitch (action) {\n\t\tcase 'today': {\n\t\t\treturn {\n\t\t\t\tstart: moment().startOf('day').toDate(),\n\t\t\t\tend: moment().endOf('day').toDate(),\n\t\t\t};\n\t\t}\n\n\t\tcase 'yesterday': {\n\t\t\treturn {\n\t\t\t\tstart: moment().subtract(1, 'day').startOf('day').toDate(),\n\t\t\t\tend: moment().subtract(1, 'day').endOf('day').toDate(),\n\t\t\t};\n\t\t}\n\n\t\tcase 'this-week': {\n\t\t\treturn {\n\t\t\t\tstart: moment().startOf('week').toDate(),\n\t\t\t\tend: moment().endOf('day').toDate(),\n\t\t\t};\n\t\t}\n\n\t\tcase 'last-week': {\n\t\t\treturn {\n\t\t\t\tstart: moment().subtract(1, 'week').startOf('week').toDate(),\n\t\t\t\tend: moment().subtract(1, 'week').endOf('week').toDate(),\n\t\t\t};\n\t\t}\n\n\t\tcase 'this-month': {\n\t\t\treturn {\n\t\t\t\tstart: moment().startOf('month').toDate(),\n\t\t\t\tend: moment().endOf('day').toDate(),\n\t\t\t};\n\t\t}\n\n\t\tcase 'last-month': {\n\t\t\treturn {\n\t\t\t\tstart: moment().subtract(1, 'month').startOf('month').toDate(),\n\t\t\t\tend: moment().subtract(1, 'month').endOf('month').toDate(),\n\t\t\t};\n\t\t}\n\n\t\tdefault:\n\t\t\tif (typeof action === 'object' && 'newStart' in action) {\n\t\t\t\tif (action.newStart === formatToDateInput(state.start)) {\n\t\t\t\t\treturn state;\n\t\t\t\t}\n\n\t\t\t\treturn { ...state, start: parseFromStartDateInput(action.newStart) };\n\t\t\t}\n\n\t\t\tif (typeof action === 'object' && 'newEnd' in action) {\n\t\t\t\tif (action.newEnd === formatToDateInput(state.end)) {\n\t\t\t\t\treturn state;\n\t\t\t\t}\n\n\t\t\t\treturn { ...state, end: parseFromEndDateInput(action.newEnd) };\n\t\t\t}\n\n\t\t\tconst newState = typeof action === 'function' ? action(state) : action;\n\t\t\treturn newState;\n\t}\n};\n\ntype DateRangePickerProps = Omit<ComponentProps<typeof Box>, 'value' | 'onChange'> & {\n\tvalue?: DateRange;\n\tonChange?: (dateRange: DateRange) => void;\n};\n\nconst DateRangePicker = ({ value, onChange, ...props }: DateRangePickerProps): ReactElement => {\n\tconst dispatch = useMutableCallback((action: DateRangeAction): void => {\n\t\tconst newRange = dateRangeReducer(value ?? { start: undefined, end: undefined }, action);\n\t\tonChange?.(newRange);\n\t});\n\n\tconst handleChangeStart = useMutableCallback(({ currentTarget }) => {\n\t\tdispatch({ newStart: currentTarget.value });\n\t});\n\n\tconst handleChangeEnd = useMutableCallback(({ currentTarget }) => {\n\t\tdispatch({ newEnd: currentTarget.value });\n\t});\n\n\tconst startDate = useMemo(() => formatToDateInput(value?.start), [value?.start]);\n\tconst endDate = useMemo(() => formatToDateInput(value?.end), [value?.end]);\n\tconst maxStartDate = useMemo(() => {\n\t\treturn formatToDateInput(value?.end ? moment.min(moment(value.end), moment()).toDate() : new Date());\n\t}, [value?.end]);\n\tconst minEndDate = startDate;\n\tconst maxEndDate = useMemo(() => formatToDateInput(new Date()), []);\n\n\tconst t = useTranslation();\n\n\tconst presets = useMemo(\n\t\t() =>\n\t\t\t({\n\t\t\t\ttoday: {\n\t\t\t\t\tlabel: t('Today'),\n\t\t\t\t\taction: () => dispatch('today'),\n\t\t\t\t},\n\t\t\t\tyesterday: {\n\t\t\t\t\tlabel: t('Yesterday'),\n\t\t\t\t\taction: () => dispatch('yesterday'),\n\t\t\t\t},\n\t\t\t\tthisWeek: {\n\t\t\t\t\tlabel: t('This_week'),\n\t\t\t\t\taction: () => dispatch('this-week'),\n\t\t\t\t},\n\t\t\t\tpreviousWeek: {\n\t\t\t\t\tlabel: t('Previous_week'),\n\t\t\t\t\taction: () => dispatch('last-week'),\n\t\t\t\t},\n\t\t\t\tthisMonth: {\n\t\t\t\t\tlabel: t('This_month'),\n\t\t\t\t\taction: () => dispatch('this-month'),\n\t\t\t\t},\n\t\t\t\tlastMonth: {\n\t\t\t\t\tlabel: t('Previous_month'),\n\t\t\t\t\taction: () => dispatch('last-month'),\n\t\t\t\t},\n\t\t\t} as const),\n\t\t[dispatch, t],\n\t);\n\n\treturn (\n\t\t<Box marginInline={-4} {...props}>\n\t\t\t<Margins inline={4}>\n\t\t\t\t<InputBox type='date' value={startDate} max={maxStartDate} flexGrow={1} height={20} onChange={handleChangeStart} />\n\t\t\t\t<InputBox type='date' min={minEndDate} value={endDate} max={maxEndDate} flexGrow={1} height={20} onChange={handleChangeEnd} />\n\t\t\t\t<Menu\n\t\t\t\t\toptions={presets}\n\t\t\t\t\trenderItem={(props: ComponentProps<typeof Option>) => <Option icon='history' {...props} />}\n\t\t\t\t\talignSelf='center'\n\t\t\t\t/>\n\t\t\t</Margins>\n\t\t</Box>\n\t);\n};\n\nexport default DateRangePicker;\n",null],"names":["_extends","_objectWithoutProperties","_objectSpread","Box","InputBox","Menu","Margins","Option","useMutableCallback","useTranslation","moment","React","useMemo","module","link","default","v","formatToDateInput","date","yearPart","getFullYear","toString","padStart","slice","monthPart","getMonth","dayPart","getDate","concat","parseFromStartDateInput","startOf","toDate","parseFromEndDateInput","endOf","dateRangeReducer","state","action","start","end","subtract","newStart","newEnd","newState","exportDefault","_ref","value","onChange","props","_excluded","dispatch","newRange","undefined","handleChangeStart","_ref2","currentTarget","handleChangeEnd","_ref3","startDate","endDate","maxStartDate","min","Date","maxEndDate","t","presets","today","label","yesterday","thisWeek","previousWeek","thisMonth","lastMonth","createElement","marginInline","inline","type","max","flexGrow","height","options","renderItem","icon","alignSelf"],"mappings":"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"}