function module(e,t,i){let n,o,s,l,r,a,u,c,p,d,v,k,b;i.export({useVoipClient:()=>h,isOutboundClient:()=>E}),i.link("@rocket.chat/core-typings",{WorkflowTypes(e){n=e}},0),i.link("@rocket.chat/fuselage-hooks",{useSafely(e){o=e}},1),i.link("@rocket.chat/ui-contexts",{useUser(e){s=e},useSetting(e){l=e},useEndpoint(e){r=e},useStream(e){a=e}},2),i.link("jsrsasign",{KJUR(e){u=e}},3),i.link("react",{useEffect(e){c=e},useState(e){p=e}},4),i.link("../../../client/lib/voip/VoIPUser",{VoIPUser(e){d=e}},5),i.link("../../../client/providers/CallProvider/hooks/useWebRtcServers",{useWebRtcServers(e){v=e}},6),i.link("../lib/voip/EEVoipClient",{EEVoipClient(e){k=e}},7),i.link("./useHasLicenseModule",{useHasLicenseModule(e){b=e}},8);let f={},g=e=>"string"==typeof(null==e?void 0:e.result),h=()=>{let e=!!l("VoIP_Enabled"),[t,i]=o(p(!0)),h=l("VoIP_Retry_Count"),E=l("VoIP_Enable_Keep_Alive_For_Unstable_Networks"),_=r("GET","/v1/connector.extension.getRegistrationInfoByUserId"),C=r("GET","/v1/voip/queues.getMembershipSubscription"),S=s(),U=a("notify-logged"),y=v(),[R,w]=o(p({})),I=b("voip-enterprise"),V=e&&t;return c(()=>U("voip.statuschanged",e=>{i(e)}),[w,i,U]),c(()=>{let e;let t=null==S?void 0:S._id,i=null==S?void 0:S.extension;if(!t||!i||!V){w(f);return}return _({id:t}).then(t=>{let i;if(g(t)){var o;let e=u.jws.JWS.parse(t.result);i=null===(o=e.payloadObj)||void 0===o?void 0:o.context}else i=t;let{extensionDetails:{extension:s,password:l},callServerConfig:{websocketPath:r}}=i;(async()=>{try{let t=new URL(r),o=await C({extension:s}),a={authUserName:s,authPassword:l,sipRegistrarHostnameOrIP:t.host,webSocketURI:r,enableVideo:!0,iceServers:y,connectionRetryCount:Number(h),enableKeepAliveUsingOptionsForUnstableNetworks:!!E};(e=await (I?k.create(a):d.create(a))).setWorkflowMode(n.CONTACT_CENTER_USER),e.setMembershipSubscription(o),w({voipClient:e,registrationInfo:i})}catch(e){w({error:e})}})()},e=>{w({error:e})}),()=>{e&&e.clear()}},[y,_,w,C,V,null==S?void 0:S._id,null==S?void 0:S.extension,h,E,I]),R},E=e=>e instanceof k}
//# sourceMappingURL=/dynamic/ee/client/hooks/d77a0352a8c7529e22a77e25ab7e3515c9fff189.map
