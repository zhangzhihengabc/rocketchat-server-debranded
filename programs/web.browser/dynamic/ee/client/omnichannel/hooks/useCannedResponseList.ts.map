)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/hooks/useCannedResponseList.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useEndpoint } from '@rocket.chat/ui-contexts';\nimport { useCallback, useEffect, useState } from 'react';\n\nimport { useScrollableRecordList } from '../../../../client/hooks/lists/useScrollableRecordList';\nimport { useComponentDidUpdate } from '../../../../client/hooks/useComponentDidUpdate';\nimport { CannedResponseList } from '../../../../client/lib/lists/CannedResponseList';\n\nexport const useCannedResponseList = (\n\toptions: any,\n): {\n\treload: () => void;\n\tcannedList: CannedResponseList;\n\tinitialItemCount: number;\n\tloadMoreItems: (start: number, end: number) => void;\n} => {\n\tconst [cannedList, setCannedList] = useState(() => new CannedResponseList(options));\n\tconst reload = useCallback(() => setCannedList(new CannedResponseList(options)), [options]);\n\n\tuseComponentDidUpdate(() => {\n\t\toptions && reload();\n\t}, [options, reload]);\n\n\tuseEffect(() => {\n\t\tif (cannedList.options !== options) {\n\t\t\tcannedList.updateFilters(options);\n\t\t}\n\t}, [cannedList, options]);\n\n\tconst getCannedResponses = useEndpoint('GET', '/v1/canned-responses');\n\tconst getDepartments = useEndpoint('GET', '/v1/livechat/department');\n\n\tconst fetchData = useCallback(\n\t\tasync (start, end) => {\n\t\t\tconst { cannedResponses, total } = await getCannedResponses({\n\t\t\t\t...(options.filter && { text: options.filter }),\n\t\t\t\t...(options.type && ['global', 'user'].find((option) => option === options.type) && { scope: options.type }),\n\t\t\t\t...(options.type &&\n\t\t\t\t\t!['global', 'user', 'all'].find((option) => option === options.type) && {\n\t\t\t\t\t\tscope: 'department',\n\t\t\t\t\t\tdepartmentId: options.type,\n\t\t\t\t\t}),\n\t\t\t\toffset: start,\n\t\t\t\tcount: end + start,\n\t\t\t});\n\n\t\t\tconst { departments } = await getDepartments({ text: '' });\n\n\t\t\treturn {\n\t\t\t\titems: cannedResponses.map((cannedResponse: any) => {\n\t\t\t\t\tif (cannedResponse.departmentId) {\n\t\t\t\t\t\tdepartments.forEach((department: any) => {\n\t\t\t\t\t\t\tif (cannedResponse.departmentId === department._id) {\n\t\t\t\t\t\t\t\tcannedResponse.departmentName = department.name;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tcannedResponse._updatedAt = new Date(cannedResponse._updatedAt);\n\t\t\t\t\tcannedResponse._createdAt = new Date(cannedResponse._createdAt);\n\t\t\t\t\treturn cannedResponse;\n\t\t\t\t}),\n\t\t\t\titemCount: total,\n\t\t\t};\n\t\t},\n\t\t[getCannedResponses, getDepartments, options.filter, options.type],\n\t);\n\n\tconst { loadMoreItems, initialItemCount } = useScrollableRecordList(cannedList, fetchData);\n\n\treturn {\n\t\treload,\n\t\tcannedList,\n\t\tloadMoreItems,\n\t\tinitialItemCount,\n\t};\n};\n",null],"names":["_objectSpread","useEndpoint","useCallback","useEffect","useState","useScrollableRecordList","useComponentDidUpdate","CannedResponseList","module","link","default","export","useCannedResponseList","options","cannedList","setCannedList","reload","updateFilters","getCannedResponses","getDepartments","fetchData","start","end","cannedResponses","total","filter","text","type","find","option","scope","departmentId","offset","count","departments","items","map","cannedResponse","forEach","department","_id","departmentName","name","_updatedAt","Date","_createdAt","itemCount","loadMoreItems","initialItemCount"],"mappings":"2BAAAA,EAAuDC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA9CC,EAAaC,IAAM,CAAA,uCAA2B,CAAAC,QAAAA,CAAAA,EAAAV,EAAAA,CAAA,CAAA,EAAA,GAAvDQ,EAAOG,MAAE,CAAA,CAAAC,sBAAmB,IAAAA,CAA2B,GAAAJ,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAP,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAO,EAAAA,IAAAA,CAAAA,QAAAA,CAAAN,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,UAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,yDAAAA,CAAAH,wBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,iDAAAA,CAAAF,sBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,kDAAAA,CAAAD,mBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAOhD,IAAMK,EACZC,IAOA,GAAM,CAACC,EAAYC,EAAc,CAAGX,EAAS,IAAM,IAAIG,EAAmBM,IACpEG,EAASd,EAAY,IAAMa,EAAc,IAAIR,EAAmBM,IAAW,CAACA,EAAQ,EAE1FP,EAAsB,KACrBO,GAAWG,GACZ,EAAG,CAACH,EAASG,EAAO,EAEpBb,EAAU,KACLW,EAAWD,OAAO,GAAKA,GAC1BC,EAAWG,aAAa,CAACJ,EAE3B,EAAG,CAACC,EAAYD,EAAQ,EAExB,IAAMK,EAAqBjB,EAAY,MAAO,wBACxCkB,EAAiBlB,EAAY,MAAO,2BAEpCmB,EAAYlB,EACjB,MAAOmB,EAAOC,KACb,GAAM,CAAEC,gBAAAA,CAAe,CAAEC,MAAAA,CAAAA,CAAO,CAAG,MAAMN,EAAkBlB,EAAAA,EAAAA,EAAAA,EAAA,CAAA,EACtDa,EAAQY,MAAM,EAAI,CAAEC,KAAMb,EAAQY,MAAAA,AAAM,GACxCZ,EAAQc,IAAI,EAAI,CAAC,SAAU,OAAO,CAACC,IAAI,CAAEC,GAAWA,IAAWhB,EAAQc,IAAI,GAAK,CAAEG,MAAOjB,EAAQc,IAAAA,AAAI,GACrGd,EAAQc,IAAI,EACf,CAAC,CAAC,SAAU,OAAQ,MAAM,CAACC,IAAI,CAAEC,GAAWA,IAAWhB,EAAQc,IAAI,GAAK,CACvEG,MAAO,aACPC,aAAclB,EAAQc,IAAAA,GACtB,CAAA,EAAA,CACFK,OAAQX,EACRY,MAAOX,EAAMD,CAAK,IAGb,CAAEa,YAAAA,CAAAA,CAAa,CAAG,MAAMf,EAAe,CAAEO,KAAM,EAAE,GAEvD,MAAO,CACNS,MAAOZ,EAAgBa,GAAG,CAAEC,IACvBA,EAAeN,YAAY,EAC9BG,EAAYI,OAAO,CAAEC,IAChBF,EAAeN,YAAY,GAAKQ,EAAWC,GAAG,EACjDH,CAAAA,EAAeI,cAAc,CAAGF,EAAWG,IAAI,AAAJA,CAE7C,GAEDL,EAAeM,UAAU,CAAG,IAAIC,KAAKP,EAAeM,UAAU,EAC9DN,EAAeQ,UAAU,CAAG,IAAID,KAAKP,EAAeQ,UAAU,EACvDR,IAERS,UAAWtB,EAEb,EACA,CAACN,EAAoBC,EAAgBN,EAAQY,MAAM,CAAEZ,EAAQc,IAAI,CAAC,EAG7D,CAAEoB,cAAAA,CAAa,CAAEC,iBAAAA,CAAAA,CAAkB,CAAG3C,EAAwBS,EAAYM,GAEhF,MAAO,CACNJ,OAAAA,EACAF,WAAAA,EACAiC,cAAAA,EACAC,iBAAAA,EAEF"}