)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/hooks/useOmnichannelPrioritiesMenu.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { LivechatPriorityWeight } from '@rocket.chat/core-typings';\nimport type { Menu } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useQueryClient } from '@tanstack/react-query';\nimport type { ComponentProps } from 'react';\nimport React, { useCallback, useMemo } from 'react';\n\nimport { dispatchToastMessage } from '../../../../client/lib/toast';\nimport { PriorityIcon } from '../priorities/PriorityIcon';\nimport { useOmnichannelPriorities } from './useOmnichannelPriorities';\n\nexport const useOmnichannelPrioritiesMenu = (rid: string): ComponentProps<typeof Menu>['options'] | Record<string, never> => {\n\tconst t = useTranslation();\n\tconst queryClient = useQueryClient();\n\tconst updateRoomPriority = useEndpoint('POST', '/v1/livechat/room/:rid/priority', { rid });\n\tconst removeRoomPriority = useEndpoint('DELETE', '/v1/livechat/room/:rid/priority', { rid });\n\tconst { data: priorities } = useOmnichannelPriorities();\n\n\tconst handlePriorityChange = useMutableCallback((priorityId: string) => async () => {\n\t\ttry {\n\t\t\tpriorityId ? await updateRoomPriority({ priorityId }) : await removeRoomPriority();\n\t\t\tqueryClient.invalidateQueries(['current-chats']);\n\t\t\tqueryClient.invalidateQueries(['/v1/rooms.info', rid]);\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\tconst renderOption = useCallback((label: string, weight: LivechatPriorityWeight) => {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<PriorityIcon level={weight || LivechatPriorityWeight.NOT_SPECIFIED} showUnprioritized /> {label}\n\t\t\t</>\n\t\t);\n\t}, []);\n\n\treturn useMemo<ComponentProps<typeof Menu>['options']>(() => {\n\t\tconst menuHeading = {\n\t\t\ttype: 'heading',\n\t\t\tlabel: t('Priorities'),\n\t\t};\n\n\t\tconst unprioritizedOption = {\n\t\t\ttype: 'option',\n\t\t\taction: handlePriorityChange(''),\n\t\t\tlabel: {\n\t\t\t\tlabel: renderOption(t('Unprioritized'), LivechatPriorityWeight.NOT_SPECIFIED),\n\t\t\t},\n\t\t};\n\n\t\tconst options = priorities.reduce<Record<string, object>>((items, { _id: priorityId, name, i18n, dirty, sortItem }) => {\n\t\t\tconst label = dirty && name ? name : i18n;\n\n\t\t\titems[label] = {\n\t\t\t\taction: handlePriorityChange(priorityId),\n\t\t\t\tlabel: {\n\t\t\t\t\tlabel: renderOption(label, sortItem),\n\t\t\t\t},\n\t\t\t};\n\n\t\t\treturn items;\n\t\t}, {});\n\n\t\treturn priorities.length ? { menuHeading, Unprioritized: unprioritizedOption, ...options } : {};\n\t}, [t, handlePriorityChange, priorities, renderOption]);\n};\n",null],"names":["_objectSpread","LivechatPriorityWeight","useMutableCallback","useEndpoint","useTranslation","useQueryClient","React","useCallback","useMemo","dispatchToastMessage","PriorityIcon","useOmnichannelPriorities","module","default","export","useOmnichannelPrioritiesMenu","rid","t","queryClient","updateRoomPriority","removeRoomPriority","data","priorities","handlePriorityChange","priorityId","invalidateQueries","error","type","message","renderOption","label","weight","createElement","Fragment","level","NOT_SPECIFIED","showUnprioritized","menuHeading","unprioritizedOption","action","options","reduce","items","_ref","_id","name","i18n","dirty","sortItem","length","Unprioritized"],"mappings":"2BAAAA,EAAmEC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAA1DC,EAAAA,IAAAA,CAAAA,uCAA0D,CAAAC,QAAAA,CAAAA,EAAAb,EAAAA,CAAA,CAAA,EAAA,GAAnEY,EAAOE,MAAE,CAAA,CAAAC,6BAA8B,IAAAA,CAA4B,GAAAH,EAAAA,IAAAA,CAAAA,4BAAAA,CAAAX,uBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAW,EAAAA,IAAAA,CAAAA,8BAAAA,CAAAV,mBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAU,EAAAA,IAAAA,CAAAA,2BAAAA,CAAAT,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAQ,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAP,eAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAO,EAAAA,IAAAA,CAAAA,QAAAA,CAAAC,QAAAA,CAAAA,EAAAP,EAAAA,CAAA,EAAAC,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,QAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,+BAAAA,CAAAH,qBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,6BAAAA,CAAAF,aAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,6BAAAA,CAAAD,yBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAY5D,IAAMI,EAAgCC,IAC5C,IAAMC,EAAIb,IACJc,EAAcb,IACdc,EAAqBhB,EAAY,OAAQ,kCAAmC,CAAEa,IAAAA,CAAG,GACjFI,EAAqBjB,EAAY,SAAU,kCAAmC,CAAEa,IAAAA,CAAG,GACnF,CAAEK,KAAMC,CAAAA,CAAY,CAAGX,IAEvBY,EAAuBrB,EAAoBsB,GAAuB,UACvE,GAAI,CACHA,EAAa,MAAML,EAAmB,CAAEK,WAAAA,CAAU,GAAM,MAAMJ,IAC9DF,EAAYO,iBAAiB,CAAC,CAAC,gBAAgB,EAC/CP,EAAYO,iBAAiB,CAAC,CAAC,iBAAkBT,EAAI,EACpD,MAAOU,EAAO,CACfjB,EAAqB,CAAEkB,KAAM,QAASC,QAASF,CAAK,GAEtD,GAEMG,EAAetB,EAAY,CAACuB,EAAeC,IAE/CzB,EAAA0B,aAAA,CAAA1B,EAAA2B,QAAA,CAAA,KACC3B,EAAA0B,aAAA,CAACtB,EAAY,CAACwB,MAAOH,GAAU9B,EAAuBkC,aAAc,CAACC,kBAAiB,CAAA,CAAA,GAAI,IAACN,GAG3F,EAAE,EAEL,OAAOtB,EAAgD,KACtD,IAAM6B,EAAc,CACnBV,KAAM,UACNG,MAAOb,EAAE,eAGJqB,EAAsB,CAC3BX,KAAM,SACNY,OAAQhB,EAAqB,IAC7BO,MAAO,CACNA,MAAOD,EAAaZ,EAAE,iBAAkBhB,EAAuBkC,aAAa,IAIxEK,EAAUlB,EAAWmB,MAAM,CAAyB,CAACC,EAAKC,KAAsD,GAApD,CAAEC,IAAKpB,CAAU,CAAEqB,KAAAA,CAAI,CAAEC,KAAAA,CAAI,CAAEC,MAAAA,CAAK,CAAEC,SAAAA,CAAAA,CAAU,CAAAL,EAC3Gb,EAAQiB,GAASF,EAAOA,EAAOC,EASrC,OAPAJ,CAAK,CAACZ,EAAM,CAAG,CACdS,OAAQhB,EAAqBC,GAC7BM,MAAO,CACNA,MAAOD,EAAaC,EAAOkB,KAItBN,CACR,EAAG,CAAA,GAEH,OAAOpB,EAAW2B,MAAM,CAAAjD,EAAA,CAAKqC,YAAAA,EAAaa,cAAeZ,CAAmB,EAAKE,GAAY,CAAA,CAC9F,EAAG,CAACvB,EAAGM,EAAsBD,EAAYO,EAAa,CACvD"}