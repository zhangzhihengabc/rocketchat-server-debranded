)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/units/UnitsTable.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Pagination, IconButton } from '@rocket.chat/fuselage';\nimport { useDebouncedValue, useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useEndpoint, useRouter, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useQuery, hashQueryKey } from '@tanstack/react-query';\nimport React, { useMemo, useState } from 'react';\n\nimport FilterByText from '../../../../client/components/FilterByText';\nimport GenericNoResults from '../../../../client/components/GenericNoResults/GenericNoResults';\nimport {\n\tGenericTable,\n\tGenericTableHeader,\n\tGenericTableHeaderCell,\n\tGenericTableBody,\n\tGenericTableCell,\n\tGenericTableLoadingRow,\n\tGenericTableRow,\n} from '../../../../client/components/GenericTable';\nimport { usePagination } from '../../../../client/components/GenericTable/hooks/usePagination';\nimport { useSort } from '../../../../client/components/GenericTable/hooks/useSort';\nimport { useRemoveUnit } from './useRemoveUnit';\n\nconst UnitsTable = () => {\n\tconst t = useTranslation();\n\tconst [filter, setFilter] = useState('');\n\tconst debouncedFilter = useDebouncedValue(filter, 500);\n\tconst router = useRouter();\n\n\tconst { current, itemsPerPage, setItemsPerPage: onSetItemsPerPage, setCurrent: onSetCurrent, ...paginationProps } = usePagination();\n\tconst { sortBy, sortDirection, setSort } = useSort<'name' | 'visibility'>('name');\n\n\tconst query = useMemo(\n\t\t() => ({\n\t\t\tfields: JSON.stringify({ name: 1 }),\n\t\t\ttext: debouncedFilter,\n\t\t\tsort: JSON.stringify({ [sortBy]: sortDirection === 'asc' ? 1 : -1 }),\n\t\t\t...(itemsPerPage && { count: itemsPerPage }),\n\t\t\t...(current && { offset: current }),\n\t\t}),\n\t\t[debouncedFilter, itemsPerPage, current, sortBy, sortDirection],\n\t);\n\n\tconst getUnits = useEndpoint('GET', '/v1/livechat/units');\n\tconst { isSuccess, isLoading, data } = useQuery(['livechat-units', query], async () => getUnits(query));\n\n\tconst [defaultQuery] = useState(hashQueryKey([query]));\n\tconst queryHasChanged = defaultQuery !== hashQueryKey([query]);\n\n\tconst handleAddNew = useMutableCallback(() => router.navigate('/omnichannel/units/new'));\n\tconst onRowClick = useMutableCallback((id) => () => router.navigate(`/omnichannel/units/edit/${id}`));\n\tconst handleDelete = useRemoveUnit();\n\n\tconst headers = (\n\t\t<>\n\t\t\t<GenericTableHeaderCell key='name' direction={sortDirection} active={sortBy === 'name'} onClick={setSort} sort='name'>\n\t\t\t\t{t('Name')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell\n\t\t\t\tkey='visibility'\n\t\t\t\tdirection={sortDirection}\n\t\t\t\tactive={sortBy === 'visibility'}\n\t\t\t\tonClick={setSort}\n\t\t\t\tsort='visibility'\n\t\t\t>\n\t\t\t\t{t('Visibility')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell key='remove' w='x60' />\n\t\t</>\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t{((isSuccess && data?.units.length > 0) || queryHasChanged) && <FilterByText onChange={({ text }): void => setFilter(text)} />}\n\t\t\t{isLoading && (\n\t\t\t\t<GenericTable>\n\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t<GenericTableLoadingRow cols={3} />\n\t\t\t\t\t</GenericTableBody>\n\t\t\t\t</GenericTable>\n\t\t\t)}\n\t\t\t{isSuccess && data.units.length === 0 && queryHasChanged && <GenericNoResults />}\n\t\t\t{isSuccess && data.units.length === 0 && !queryHasChanged && (\n\t\t\t\t<GenericNoResults\n\t\t\t\t\ticon='business'\n\t\t\t\t\ttitle={t('No_units_yet')}\n\t\t\t\t\tdescription={t('No_units_yet_description')}\n\t\t\t\t\tlinkHref='https://go.rocket.chat/omnichannel-docs'\n\t\t\t\t\tbuttonAction={handleAddNew}\n\t\t\t\t\tbuttonTitle={t('Create_unit')}\n\t\t\t\t\tlinkText={t('Learn_more_about_units')}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t{isSuccess && data?.units.length > 0 && (\n\t\t\t\t<>\n\t\t\t\t\t<GenericTable>\n\t\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t\t{data.units.map(({ _id, name, visibility }) => (\n\t\t\t\t\t\t\t\t<GenericTableRow key={_id} tabIndex={0} role='link' onClick={onRowClick(_id)} action qa-user-id={_id}>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>{name}</GenericTableCell>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>{visibility}</GenericTableCell>\n\t\t\t\t\t\t\t\t\t<GenericTableCell>\n\t\t\t\t\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\t\t\t\t\ticon='trash'\n\t\t\t\t\t\t\t\t\t\t\tsmall\n\t\t\t\t\t\t\t\t\t\t\ttitle={t('Remove')}\n\t\t\t\t\t\t\t\t\t\t\tonClick={(e) => {\n\t\t\t\t\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\t\t\t\t\thandleDelete(_id);\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</GenericTableCell>\n\t\t\t\t\t\t\t\t</GenericTableRow>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</GenericTableBody>\n\t\t\t\t\t</GenericTable>\n\t\t\t\t\t<Pagination\n\t\t\t\t\t\tdivider\n\t\t\t\t\t\tcurrent={current}\n\t\t\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\t\t\tcount={data?.total || 0}\n\t\t\t\t\t\tonSetItemsPerPage={onSetItemsPerPage}\n\t\t\t\t\t\tonSetCurrent={onSetCurrent}\n\t\t\t\t\t\t{...paginationProps}\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default UnitsTable;\n",null],"names":["_extends","_objectSpread","_objectWithoutProperties","Pagination","IconButton","useDebouncedValue","useMutableCallback","useEndpoint","useRouter","useTranslation","useQuery","hashQueryKey","React","useMemo","useState","FilterByText","GenericNoResults","GenericTable","GenericTableHeader","GenericTableHeaderCell","GenericTableBody","GenericTableCell","GenericTableLoadingRow","GenericTableRow","usePagination","useSort","useRemoveUnit","module","link","default","v","exportDefault","t","filter","setFilter","debouncedFilter","router","_usePagination","current","itemsPerPage","setItemsPerPage","onSetItemsPerPage","setCurrent","onSetCurrent","paginationProps","_excluded","sortBy","sortDirection","setSort","query","fields","JSON","stringify","name","text","sort","count","offset","getUnits","isSuccess","isLoading","data","defaultQuery","queryHasChanged","handleAddNew","navigate","onRowClick","id","concat","handleDelete","headers","createElement","Fragment","key","direction","active","onClick","w","units","length","onChange","_ref","cols","icon","title","description","linkHref","buttonAction","buttonTitle","linkText","map","_ref2","_id","visibility","tabIndex","role","action","withTruncatedText","small","e","stopPropagation","divider","total"],"mappings":"2BAAAA,EAA+DC,EAAAC,EAA/DC,EAASC,EAAsDC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,kEAAtDC,EAAUC,IAAE,CAAA,iCAAkB,CAAAC,QAAwBC,CAAA,EAAA9B,EAAAA,CAAA,CAAA,EAAA,GAAA2B,EAAAA,IAAAA,CAAAA,uCAAAA,CAAAE,QAAAA,CAAAA,EAAA5B,EAAAA,CAAA,CAAA,EAAA,GAAA0B,EAAAA,IAAAA,CAAAA,iDAAAA,CAAAE,QAAAA,CAAAA,EAAA3B,EAAAA,CAAA,CAAA,EAAA,GAA1CyB,EAAYC,IAAAA,CAAAA,wBAA6B,CAACzB,WAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,WAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAuB,EAAAA,IAAAA,CAAAA,8BAAAA,CAAAtB,kBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,mBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAqB,EAAAA,IAAAA,CAAAA,2BAAAA,CAAApB,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,UAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,eAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAkB,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAjB,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,aAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAgB,EAAAA,IAAAA,CAAAA,QAAAA,CAAAE,QAAAA,CAAAA,EAAAjB,EAAAA,CAAA,EAAAC,QAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,SAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAa,EAAAA,IAAAA,CAAAA,6CAAAA,CAAAE,QAAAA,CAAAA,EAAAd,EAAAA,CAAA,CAAA,EAAA,GAAAY,EAAAA,IAAAA,CAAAA,kEAAAA,CAAAE,QAAAA,CAAAA,EAAAb,EAAAA,CAAA,CAAA,EAAA,GAAAW,EAAAA,IAAAA,CAAAA,6CAAAA,CAAAV,aAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,mBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,uBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,iBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,iBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,uBAAAA,CAAAA,EAAAA,EAAAA,CAAA,EAAAC,gBAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAI,EAAAA,IAAAA,CAAAA,iEAAAA,CAAAH,cAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,2DAAAA,CAAAF,QAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,kBAAAA,CAAAD,cAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,IAA/DC,EAAOI,aAAY,CAqBA,KAClB,IAAMC,EAAIvB,IACJ,CAACwB,EAAQC,EAAU,CAAGpB,EAAS,IAC/BqB,EAAkB9B,EAAkB4B,EAAQ,KAC5CG,EAAS5B,IAEf6B,EAAoHb,IAA9G,CAAEc,QAAAA,CAAO,CAAEC,aAAAA,CAAY,CAAEC,gBAAiBC,CAAiB,CAAEC,WAAYC,CAAAA,CAAkC,CAAAN,EAAjBO,EAAe1C,EAAAmC,EAAAQ,GACzG,CAAEC,OAAAA,CAAM,CAAEC,cAAAA,CAAa,CAAEC,QAAAA,CAAAA,CAAS,CAAGvB,EAA+B,QAEpEwB,EAAQpC,EACb,IAAAZ,EAAAA,EAAA,CACCiD,OAAQC,KAAKC,SAAS,CAAC,CAAEC,KAAM,CAAC,GAChCC,KAAMnB,EACNoB,KAAMJ,KAAKC,SAAS,CAAC,CAAE,CAACN,EAAM,CAAGC,AAAkB,QAAlBA,EAA0B,EAAI,EAAE,EAAG,EAChER,GAAgB,CAAEiB,MAAOjB,CAAY,GACrCD,GAAW,CAAEmB,OAAQnB,CAAO,GAEjC,CAACH,EAAiBI,EAAcD,EAASQ,EAAQC,EAAc,EAG1DW,EAAWnD,EAAY,MAAO,sBAC9B,CAAEoD,UAAAA,CAAS,CAAEC,UAAAA,CAAS,CAAEC,KAAAA,CAAAA,CAAM,CAAGnD,EAAS,CAAC,iBAAkBuC,EAAM,CAAE,SAAYS,EAAST,IAE1F,CAACa,EAAa,CAAGhD,EAASH,EAAa,CAACsC,EAAM,GAC9Cc,EAAkBD,IAAiBnD,EAAa,CAACsC,EAAM,EAEvDe,EAAe1D,EAAmB,IAAM8B,EAAO6B,QAAQ,CAAC,2BACxDC,EAAa5D,EAAoB6D,GAAO,IAAM/B,EAAO6B,QAAQ,CAAA,2BAAAG,MAAA,CAA4BD,KACzFE,EAAe3C,IAEf4C,EACL1D,EAAA2D,aAAA,CAAA3D,EAAA4D,QAAA,CAAA,KACC5D,EAAA2D,aAAA,CAACpD,EAAsB,CAACsD,IAAI,OAAOC,UAAW3B,EAAe4B,OAAQ7B,AAAW,SAAXA,EAAmB8B,QAAS5B,EAASO,KAAK,MAAM,EACnHvB,EAAE,SAEJpB,EAAA2D,aAAA,CAACpD,EAAsB,CACtBsD,IAAI,aACJC,UAAW3B,EACX4B,OAAQ7B,AAAW,eAAXA,EACR8B,QAAS5B,EACTO,KAAK,YAAY,EAEhBvB,EAAE,eAEJpB,EAAA2D,aAAA,CAACpD,EAAsB,CAACsD,IAAI,SAASI,EAAE,KAAK,IAI9C,OACCjE,EAAA2D,aAAA,CAAA3D,EAAA4D,QAAA,CAAA,KACE,AAAEb,CAAAA,GAAa,AAAAE,CAAAA,MAAAA,EAAI,KAAA,EAAJA,EAAMiB,KAAK,CAACC,MAAM,AAANA,EAAS,GAAMhB,CAAAA,GAAoBnD,EAAA2D,aAAA,CAACxD,EAAY,CAACiE,SAAUC,IAAA,GAAC,CAAE3B,KAAAA,CAAAA,CAAM,CAAA2B,EAAA,OAAW/C,EAAUoB,EAAK,CAAC,GAC1HM,GACAhD,EAAA2D,aAAA,CAACtD,EAAY,KACZL,EAAA2D,aAAA,CAACrD,EAAkB,KAAEoD,GACrB1D,EAAA2D,aAAA,CAACnD,EAAgB,KAChBR,EAAA2D,aAAA,CAACjD,EAAsB,CAAC4D,KAAM,CAAE,KAIlCvB,GAAaE,AAAsB,IAAtBA,EAAKiB,KAAK,CAACC,MAAM,EAAUhB,GAAmBnD,EAAA2D,aAAA,CAACvD,EAAgB,MAC5E2C,GAAaE,AAAsB,IAAtBA,EAAKiB,KAAK,CAACC,MAAM,EAAU,CAAChB,GACzCnD,EAAA2D,aAAA,CAACvD,EAAgB,CAChBmE,KAAK,WACLC,MAAOpD,EAAE,gBACTqD,YAAarD,EAAE,4BACfsD,SAAS,0CACTC,aAAcvB,EACdwB,YAAaxD,EAAE,eACfyD,SAAUzD,EAAE,yBAA0B,GAGvC2B,GAAa,AAAAE,CAAAA,MAAAA,EAAI,KAAA,EAAJA,EAAMiB,KAAK,CAACC,MAAM,AAANA,EAAS,GAClCnE,EAAA2D,aAAA,CAAA3D,EAAA4D,QAAA,CAAA,KACC5D,EAAA2D,aAAA,CAACtD,EAAY,KACZL,EAAA2D,aAAA,CAACrD,EAAkB,KAAEoD,GACrB1D,EAAA2D,aAAA,CAACnD,EAAgB,KACfyC,EAAKiB,KAAK,CAACY,GAAG,CAACC,IAAA,GAAC,CAAEC,IAAAA,CAAG,CAAEvC,KAAAA,CAAI,CAAEwC,WAAAA,CAAAA,CAAY,CAAAF,EAAA,OACzC/E,EAAA2D,aAAA,CAAChD,EAAe,CAACkD,IAAKmB,EAAKE,SAAU,EAAGC,KAAK,OAAOnB,QAASV,EAAW0B,GAAMI,OAAM,CAAA,EAAC,aAAYJ,CAAI,EACpGhF,EAAA2D,aAAA,CAAClD,EAAgB,CAAC4E,kBAAiB,CAAA,CAAA,EAAE5C,GACrCzC,EAAA2D,aAAA,CAAClD,EAAgB,CAAC4E,kBAAiB,CAAA,CAAA,EAAEJ,GACrCjF,EAAA2D,aAAA,CAAClD,EAAgB,KAChBT,EAAA2D,aAAA,CAACnE,EAAU,CACV+E,KAAK,QACLe,MAAK,CAAA,EACLd,MAAOpD,EAAE,UACT4C,QAAUuB,IACTA,EAAEC,eAAe,GACjB/B,EAAauB,EACd,CAAE,IAGa,KAIrBhF,EAAA2D,aAAA,CAACpE,EAAUH,EAAA,CACVqG,QAAO,CAAA,EACP/D,QAASA,EACTC,aAAcA,EACdiB,MAAO,AAAAK,CAAAA,MAAAA,EAAI,KAAA,EAAJA,EAAMyC,KAAK,AAALA,GAAS,EACtB7D,kBAAmBA,EACnBE,aAAcA,CAAa,EACvBC,KAMV"}