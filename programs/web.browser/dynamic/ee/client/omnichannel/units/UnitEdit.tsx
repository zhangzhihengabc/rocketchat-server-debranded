function module(e,t,l){let r,i,n,a,o,s,u,d,m,c,v,h,b,p,E,k,f,y,_,C,g,q,F,M,S,x,L,D,T,I,B,R,U,w,N,A;l.link("@babel/runtime/helpers/extends",{default(e){r=e}},0),l.link("@rocket.chat/fuselage",{FieldError(e){i=e},Field(e){n=e},TextInput(e){a=e},Button(e){o=e},PaginatedMultiSelectFiltered(e){s=e},Select(e){u=e},ButtonGroup(e){d=e},FieldGroup(e){m=e},Box(e){c=e},FieldLabel(e){v=e},FieldRow(e){h=e}},0),l.link("@rocket.chat/fuselage-hooks",{useMutableCallback(e){b=e},useDebouncedValue(e){p=e},useUniqueId(e){E=e}},1),l.link("@rocket.chat/ui-contexts",{useToastMessageDispatch(e){k=e},useMethod(e){f=e},useTranslation(e){y=e},useRouter(e){_=e}},2),l.link("@tanstack/react-query",{useQueryClient(e){C=e}},3),l.link("react",{default(e){g=e},useMemo(e){q=e},useState(e){F=e}},4),l.link("react-hook-form",{useForm(e){M=e},Controller(e){S=e}},5),l.link("../../../../client/components/Contextualbar",{ContextualbarScrollableContent(e){x=e},ContextualbarFooter(e){L=e},ContextualbarTitle(e){D=e},Contextualbar(e){T=e},ContextualbarHeader(e){I=e},ContextualbarClose(e){B=e}},6),l.link("../../../../client/hooks/lists/useRecordList",{useRecordList(e){R=e}},7),l.link("../../../../client/hooks/useAsyncState",{AsyncStatePhase(e){U=e}},8),l.link("../../../../client/views/hooks/useDepartmentsByUnitsList",{useDepartmentsByUnitsList(e){w=e}},9),l.link("../../../../client/views/hooks/useMonitorsList",{useMonitorsList(e){N=e}},10),l.link("./useRemoveUnit",{useRemoveUnit(e){A=e}},11),l.exportDefault(e=>{let{unitData:t,unitMonitors:l,unitDepartments:G}=e,P=y(),V=_(),O=f("livechat:saveUnit"),Q=k(),H=C(),j=A(),[z,J]=F(""),K=p(z,500),[W,X]=F(""),Y=p(W,500),{itemsList:Z,loadMoreItems:$}=N(q(()=>({filter:K}),[K])),{phase:ee,items:et,itemCount:el}=R(Z),{itemsList:er,loadMoreItems:ei}=w(q(()=>({filter:Y,unitId:null==t?void 0:t._id}),[Y,null==t?void 0:t._id])),{phase:en,items:ea,itemCount:eo}=R(er),es=[["public",P("Public")],["private",P("Private")]],{_id:eu}=t||{},ed=q(()=>(null==G?void 0:G.map(e=>{let{_id:t,name:l}=e;return{value:t,label:l}}))||[],[G]),em=q(()=>(null==l?void 0:l.map(e=>{let{_id:t,username:l}=e;return{value:t,label:l}}))||[],[l]),{control:ec,formState:{errors:ev,isDirty:eh},handleSubmit:eb,watch:ep}=M({mode:"onBlur",values:{name:(null==t?void 0:t.name)||"",visibility:(null==t?void 0:t.visibility)||"",departments:ed,monitors:em}}),{departments:eE,monitors:ek}=ep(),ef=q(()=>{let e=eE.filter(e=>{let{value:t}=e;return!ea.find(e=>e._id===t)}),t=null==ea?void 0:ea.map(e=>{let{_id:t,name:l}=e;return{value:t,label:l}});return[...t,...e]},[eE,ea]),ey=q(()=>{let e=ek.filter(e=>{let{value:t}=e;return!et.find(e=>e._id===t)}),t=null==et?void 0:et.map(e=>{let{_id:t,name:l}=e;return{value:t,label:l}});return[...t,...e]},[ek,et]),e_=b(async e=>{let{name:t,visibility:l}=e,r=eE.map(e=>({departmentId:e.value})),i=ek.map(e=>({monitorId:e.value,username:e.label}));try{await O(eu,{name:t,visibility:l},i,r),Q({type:"success",message:P("Saved")}),H.invalidateQueries(["livechat-units"]),V.navigate("/omnichannel/units")}catch(e){Q({type:"error",message:e})}}),eC=E(),eg=E(),eq=E(),eF=E(),eM=E();return g.createElement(T,null,g.createElement(I,null,g.createElement(D,null,eu?P("Edit_Unit"):P("New_Unit")),g.createElement(B,{onClick:()=>V.navigate("/omnichannel/units")})),g.createElement(x,null,g.createElement(c,{id:eC,is:"form",autoComplete:"off",onSubmit:eb(e_)},g.createElement(m,null,g.createElement(n,null,g.createElement(v,{htmlFor:eg,required:!0},P("Name")),g.createElement(h,null,g.createElement(S,{name:"name",control:ec,rules:{required:P("The_field_is_required",P("Name"))},render:e=>{var t;let{field:l}=e;return g.createElement(a,r({id:eg},l,{error:null==ev?void 0:null===(t=ev.name)||void 0===t?void 0:t.message,"aria-describedby":"".concat(eg,"-error"),"aria-required":!0,"aria-invalid":!!(null==ev?void 0:ev.name)}))}})),(null==ev?void 0:ev.name)&&g.createElement(i,{"aria-live":"assertive",id:"".concat(eg,"-error")},null==ev?void 0:ev.name.message)),g.createElement(n,null,g.createElement(v,{htmlFor:eq,required:!0},P("Visibility")),g.createElement(h,null,g.createElement(S,{name:"visibility",control:ec,rules:{required:P("The_field_is_required",P("Visibility"))},render:e=>{var t;let{field:l}=e;return g.createElement(u,r({id:eq},l,{options:es,error:null==ev?void 0:null===(t=ev.visibility)||void 0===t?void 0:t.message,placeholder:P("Select_an_option"),"aria-describedby":"".concat(eq,"-error"),"aria-required":!0,"aria-invalid":!!(null==ev?void 0:ev.visibility)}))}})),(null==ev?void 0:ev.visibility)&&g.createElement(i,{id:"".concat(eq,"-error")},null==ev?void 0:ev.visibility.message)),g.createElement(n,null,g.createElement(v,{htmlFor:eF,required:!0},P("Departments")),g.createElement(h,null,g.createElement(S,{name:"departments",control:ec,rules:{required:P("The_field_is_required",P("Departments"))},render:e=>{let{field:{name:t,value:l,onChange:r,onBlur:i}}=e;return g.createElement(s,{id:eF,name:t,value:l,onChange:r,onBlur:i,withTitle:!0,filter:W,setFilter:X,options:ef,error:!!(null==ev?void 0:ev.departments),placeholder:P("Select_an_option"),endReached:en===U.LOADING?void 0:e=>e&&ei(e,Math.min(50,eo)),"aria-describedby":"".concat(eF,"-error"),"aria-required":!0,"aria-invalid":!!(null==ev?void 0:ev.departments)})}})),(null==ev?void 0:ev.departments)&&g.createElement(i,{"aria-live":"assertive",id:"".concat(eF,"-error")},null==ev?void 0:ev.departments.message)),g.createElement(n,null,g.createElement(v,{htmlFor:eM,required:!0},P("Monitors")),g.createElement(h,null,g.createElement(S,{name:"monitors",control:ec,rules:{required:P("The_field_is_required",P("Monitors"))},render:e=>{let{field:{name:t,value:l,onChange:r,onBlur:i}}=e;return g.createElement(s,{id:eM,name:t,value:l,onChange:r,onBlur:i,withTitle:!0,filter:z,setFilter:J,options:ey,error:!!(null==ev?void 0:ev.monitors),placeholder:P("Select_an_option"),endReached:ee===U.LOADING?void 0:e=>e&&$(e,Math.min(50,el)),"aria-describedby":"".concat(eM,"-error"),"aria-required":!0,"aria-invalid":!!(null==ev?void 0:ev.monitors)})}})),(null==ev?void 0:ev.monitors)&&g.createElement(i,{"aria-live":"assertive",id:"".concat(eM,"-error")},null==ev?void 0:ev.monitors.message))))),g.createElement(L,null,g.createElement(d,{stretch:!0},g.createElement(o,{onClick:()=>V.navigate("/omnichannel/units")},P("Cancel")),g.createElement(o,{form:eC,disabled:!eh,type:"submit",primary:!0},P("Save"))),eu&&g.createElement(d,{stretch:!0,mbs:8},g.createElement(o,{icon:"trash",danger:!0,onClick:()=>j(eu)},P("Delete")))))})}
//# sourceMappingURL=/dynamic/ee/client/omnichannel/units/53b04fa5c91f91e4050d1f7014a5705f42ffae10.map
