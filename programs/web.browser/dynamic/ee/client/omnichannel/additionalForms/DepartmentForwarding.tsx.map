)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/additionalForms/DepartmentForwarding.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Field, FieldLabel, FieldRow, FieldHint, Box, PaginatedMultiSelectFiltered } from '@rocket.chat/fuselage';\nimport type { PaginatedMultiSelectOption } from '@rocket.chat/fuselage';\nimport { useDebouncedValue } from '@rocket.chat/fuselage-hooks';\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\nimport { useTranslation } from '@rocket.chat/ui-contexts';\nimport React, { useMemo, useState } from 'react';\n\nimport { useDepartmentsList } from '../../../../client/components/Omnichannel/hooks/useDepartmentsList';\nimport { useRecordList } from '../../../../client/hooks/lists/useRecordList';\nimport { AsyncStatePhase } from '../../../../client/hooks/useAsyncState';\nimport { useHasLicenseModule } from '../../hooks/useHasLicenseModule';\n\ntype DepartmentForwardingProps = {\n\tdepartmentId: string;\n\tvalue?: PaginatedMultiSelectOption[];\n\thandler: (value: PaginatedMultiSelectOption[]) => void;\n\tlabel: TranslationKey;\n};\n\nexport const DepartmentForwarding = ({ departmentId, value = [], handler, label }: DepartmentForwardingProps) => {\n\tconst t = useTranslation();\n\tconst [departmentsFilter, setDepartmentsFilter] = useState('');\n\tconst hasLicense = useHasLicenseModule('livechat-enterprise');\n\n\tconst debouncedDepartmentsFilter = useDebouncedValue(departmentsFilter, 500);\n\n\tconst { itemsList: departmentsList, loadMoreItems: loadMoreDepartments } = useDepartmentsList(\n\t\tuseMemo(() => ({ filter: departmentsFilter, departmentId, showArchived: true }), [departmentId, departmentsFilter]),\n\t);\n\n\tconst { phase: departmentsPhase, items: departmentsItems, itemCount: departmentsTotal } = useRecordList(departmentsList);\n\n\tconst options = useMemo(() => {\n\t\tconst pending = value.filter(({ value }) => !departmentsItems.find((dep) => dep.value === value));\n\t\treturn [...departmentsItems, ...pending];\n\t}, [departmentsItems, value]);\n\n\tif (!hasLicense) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<Field>\n\t\t\t<FieldLabel>{t(label)}</FieldLabel>\n\t\t\t<FieldRow>\n\t\t\t\t<Box w='100%'>\n\t\t\t\t\t<PaginatedMultiSelectFiltered\n\t\t\t\t\t\twithTitle\n\t\t\t\t\t\tmaxWidth='100%'\n\t\t\t\t\t\tw='100%'\n\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\tfilter={debouncedDepartmentsFilter}\n\t\t\t\t\t\tsetFilter={setDepartmentsFilter}\n\t\t\t\t\t\tonChange={handler}\n\t\t\t\t\t\toptions={options}\n\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\tplaceholder={t('Select_an_option')}\n\t\t\t\t\t\tendReached={\n\t\t\t\t\t\t\tdepartmentsPhase === AsyncStatePhase.LOADING\n\t\t\t\t\t\t\t\t? () => undefined\n\t\t\t\t\t\t\t\t: (start?: number) => {\n\t\t\t\t\t\t\t\t\t\tif (start === undefined) {\n\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tloadMoreDepartments(start, Math.min(50, departmentsTotal));\n\t\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t</Box>\n\t\t\t</FieldRow>\n\t\t\t<FieldHint>{t('List_of_departments_for_forward_description')}</FieldHint>\n\t\t</Field>\n\t);\n};\n\nexport default DepartmentForwarding;\n",null],"names":["Field","FieldLabel","FieldRow","FieldHint","Box","PaginatedMultiSelectFiltered","useDebouncedValue","useTranslation","React","useMemo","useState","useDepartmentsList","useRecordList","AsyncStatePhase","useHasLicenseModule","module","export","DepartmentForwarding","default","_ref","departmentId","value","handler","label","t","departmentsFilter","setDepartmentsFilter","hasLicense","debouncedDepartmentsFilter","itemsList","departmentsList","loadMoreItems","loadMoreDepartments","filter","showArchived","phase","departmentsPhase","items","departmentsItems","itemCount","departmentsTotal","options","pending","_ref2","find","dep","createElement","w","withTitle","maxWidth","flexGrow","setFilter","onChange","placeholder","endReached","LOADING","undefined","start","Math","min","exportDefault"],"mappings":"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"}