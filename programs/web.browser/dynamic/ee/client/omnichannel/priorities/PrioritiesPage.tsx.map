)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/priorities/PrioritiesPage.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Button, ButtonGroup } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useEndpoint, useRoute, useSetModal, useToastMessageDispatch, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useQueryClient } from '@tanstack/react-query';\nimport type { ReactElement } from 'react';\nimport React, { useMemo, useState } from 'react';\n\nimport Page from '../../../../client/components/Page';\nimport { useOmnichannelPriorities } from '../hooks/useOmnichannelPriorities';\nimport { PrioritiesResetModal } from './PrioritiesResetModal';\nimport { PrioritiesTable } from './PrioritiesTable';\nimport type { PriorityFormData } from './PriorityEditForm';\nimport PriorityList from './PriorityList';\n\ntype PrioritiesPageProps = {\n\tpriorityId: string;\n\tcontext: 'edit' | undefined;\n};\n\nexport const PrioritiesPage = ({ priorityId, context }: PrioritiesPageProps): ReactElement => {\n\tconst t = useTranslation();\n\tconst queryClient = useQueryClient();\n\tconst prioritiesRoute = useRoute('omnichannel-priorities');\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst setModal = useSetModal();\n\n\tconst [isResetting, setResetting] = useState(false);\n\n\tconst savePriority = useEndpoint('PUT', `/v1/livechat/priorities/:priorityId`, { priorityId });\n\tconst resetPriorities = useEndpoint('POST', '/v1/livechat/priorities.reset');\n\n\tconst { data: priorities, isLoading } = useOmnichannelPriorities();\n\n\tconst isPrioritiesDirty = useMemo(() => !!priorities.length && priorities.some((p) => p.dirty), [priorities]);\n\n\tconst handleReset = (): void => {\n\t\tconst onReset = async (): Promise<void> => {\n\t\t\ttry {\n\t\t\t\tsetResetting(true);\n\t\t\t\tsetModal(null);\n\n\t\t\t\tawait resetPriorities();\n\t\t\t\tawait queryClient.invalidateQueries(['/v1/livechat/priorities'], { exact: true });\n\n\t\t\t\tprioritiesRoute.push({});\n\t\t\t\tdispatchToastMessage({ type: 'success', message: t('Priorities_restored') });\n\t\t\t} catch (error) {\n\t\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t\t} finally {\n\t\t\t\tsetResetting(false);\n\t\t\t}\n\t\t};\n\n\t\tsetModal(<PrioritiesResetModal onReset={onReset} onCancel={(): void => setModal(null)} />);\n\t};\n\n\tconst onRowClick = useMutableCallback((id: string): void => {\n\t\tprioritiesRoute.push({ context: 'edit', id });\n\t});\n\n\tconst onContextualbarClose = (): void => {\n\t\tprioritiesRoute.push({});\n\t};\n\n\tconst onSavePriority = async ({ reset, ...payload }: PriorityFormData): Promise<void> => {\n\t\tawait savePriority(reset ? { reset } : payload);\n\t\tawait queryClient.invalidateQueries(['/v1/livechat/priorities']);\n\n\t\tdispatchToastMessage({ type: 'success', message: t('Priority_saved') });\n\t\tawait queryClient.invalidateQueries(['/v1/livechat/priorities'], { exact: true });\n\t\tprioritiesRoute.push({});\n\t};\n\n\treturn (\n\t\t<Page flexDirection='row'>\n\t\t\t<Page>\n\t\t\t\t<Page.Header title={t('Priorities')}>\n\t\t\t\t\t<ButtonGroup>\n\t\t\t\t\t\t<Button onClick={handleReset} title={t('Reset')} disabled={!isPrioritiesDirty} loading={isResetting}>\n\t\t\t\t\t\t\t{t('Reset')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</ButtonGroup>\n\t\t\t\t</Page.Header>\n\t\t\t\t<Page.Content>\n\t\t\t\t\t<PrioritiesTable priorities={priorities} isLoading={isLoading} onRowClick={onRowClick} />\n\t\t\t\t</Page.Content>\n\t\t\t</Page>\n\n\t\t\t{context === 'edit' && (\n\t\t\t\t<PriorityList priorityId={priorityId} context={context} onSave={onSavePriority} onClose={onContextualbarClose} />\n\t\t\t)}\n\t\t</Page>\n\t);\n};\n",null],"names":["_objectWithoutProperties","Button","ButtonGroup","useMutableCallback","useEndpoint","useRoute","useSetModal","useToastMessageDispatch","useTranslation","useQueryClient","React","useMemo","useState","Page","useOmnichannelPriorities","PrioritiesResetModal","PrioritiesTable","PriorityList","module","link","default","export","PrioritiesPage","_ref","priorityId","context","t","queryClient","prioritiesRoute","dispatchToastMessage","setModal","isResetting","setResetting","savePriority","resetPriorities","data","priorities","isLoading","isPrioritiesDirty","length","some","p","dirty","onRowClick","id","push","onSavePriority","_ref2","reset","payload","_excluded","invalidateQueries","type","message","exact","createElement","flexDirection","Header","title","onClick","onReset","error","onCancel","disabled","loading","Content","onSave","onClose"],"mappings":"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"}