)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/priorities/PriorityEditForm.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { ILivechatPriority, Serialized } from '@rocket.chat/core-typings';\nimport { Field, FieldError, Button, Box, ButtonGroup } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport type { TranslationKey } from '@rocket.chat/ui-contexts';\nimport { useToastMessageDispatch, useTranslation } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React, { useState } from 'react';\nimport { Controller, useForm } from 'react-hook-form';\n\nimport StringSettingInput from '../../../../client/views/admin/settings/inputs/StringSettingInput';\n\nexport type PriorityFormData = { name: string; reset: boolean };\n\ntype ILivechatClientPriority = Serialized<ILivechatPriority> & {\n\ti18n: TranslationKey;\n};\n\nexport type PriorityEditFormProps = {\n\tdata: ILivechatClientPriority;\n\tonCancel: () => void;\n\tonSave: (values: PriorityFormData) => Promise<void>;\n};\n\ntype PrioritySaveException = { success: false; error: TranslationKey | undefined };\n\nconst PriorityEditForm = ({ data, onSave, onCancel }: PriorityEditFormProps): ReactElement => {\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst t = useTranslation();\n\tconst [isSaving, setSaving] = useState(false);\n\n\tconst { name, i18n, dirty } = data;\n\tconst defaultName = t(i18n);\n\n\tconst {\n\t\tcontrol,\n\t\tgetValues,\n\t\tsetValue,\n\t\tformState: { errors, isValid, isDirty },\n\t\tsetError,\n\t\thandleSubmit,\n\t} = useForm<PriorityFormData>({\n\t\tmode: 'onChange',\n\t\tdefaultValues: data ? { name: dirty ? name : defaultName } : {},\n\t});\n\n\tconst handleSave = useMutableCallback(async () => {\n\t\tconst { name } = getValues();\n\n\t\tif (!isValid) {\n\t\t\treturn dispatchToastMessage({ type: 'error', message: t('The_field_is_required') });\n\t\t}\n\n\t\ttry {\n\t\t\tsetSaving(true);\n\t\t\tawait onSave({ name, reset: name === defaultName });\n\t\t} catch (e) {\n\t\t\tconst { error } = e as PrioritySaveException;\n\n\t\t\tif (error) {\n\t\t\t\tsetError('name', { message: t(error) });\n\t\t\t}\n\t\t} finally {\n\t\t\tsetSaving(false);\n\t\t}\n\t});\n\n\tconst onReset = (): void => {\n\t\tsetValue('name', defaultName, {\n\t\t\tshouldDirty: true,\n\t\t\tshouldValidate: true,\n\t\t});\n\t};\n\n\treturn (\n\t\t<Box is='form' onSubmit={handleSubmit(handleSave)} display='flex' flexDirection='column' justifyContent='space-between' flexGrow={1}>\n\t\t\t<Field>\n\t\t\t\t<Controller\n\t\t\t\t\tname='name'\n\t\t\t\t\tcontrol={control}\n\t\t\t\t\trules={{ required: t('The_field_is_required', t('Name')), validate: (v) => v?.trim() !== '' }}\n\t\t\t\t\trender={({ field: { value, onChange } }): ReactElement => (\n\t\t\t\t\t\t<StringSettingInput\n\t\t\t\t\t\t\t_id=''\n\t\t\t\t\t\t\tdisabled={isSaving}\n\t\t\t\t\t\t\terror={errors.name?.message}\n\t\t\t\t\t\t\tlabel={`${t('Name')}*`}\n\t\t\t\t\t\t\tplaceholder={t('Name')}\n\t\t\t\t\t\t\tvalue={value}\n\t\t\t\t\t\t\tname='name'\n\t\t\t\t\t\t\thasResetButton={value !== t(i18n)}\n\t\t\t\t\t\t\tonResetButtonClick={onReset}\n\t\t\t\t\t\t\tonChangeValue={onChange}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t/>\n\t\t\t\t<FieldError>{errors.name?.message}</FieldError>\n\t\t\t</Field>\n\n\t\t\t<ButtonGroup stretch>\n\t\t\t\t<Button onClick={(): void => onCancel()} disabled={isSaving}>\n\t\t\t\t\t{t('Cancel')}\n\t\t\t\t</Button>\n\n\t\t\t\t<Button primary disabled={!isDirty || !isValid} loading={isSaving} onClick={handleSave}>\n\t\t\t\t\t{t('Save')}\n\t\t\t\t</Button>\n\t\t\t</ButtonGroup>\n\t\t</Box>\n\t);\n};\n\nexport default PriorityEditForm;\n",null],"names":["Field","FieldError","Button","Box","useMutableCallback","useToastMessageDispatch","useTranslation","React","useState","Controller","useForm","StringSettingInput","module","v","ButtonGroup","default","exportDefault","_ref","_errors$name2","data","onSave","onCancel","dispatchToastMessage","t","isSaving","setSaving","name","i18n","dirty","defaultName","control","getValues","setValue","formState","errors","isValid","isDirty","setError","handleSubmit","mode","defaultValues","handleSave","type","message","reset","e","error","onReset","shouldDirty","shouldValidate","createElement","is","onSubmit","display","flexDirection","justifyContent","flexGrow","rules","required","validate","trim","render","_ref2","_errors$name","field","value","onChange","_id","disabled","label","concat","placeholder","hasResetButton","onResetButtonClick","onChangeValue","stretch","onClick","primary","loading"],"mappings":"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"}