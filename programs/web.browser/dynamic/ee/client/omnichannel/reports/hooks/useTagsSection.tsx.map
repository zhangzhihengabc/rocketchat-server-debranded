)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/reports/hooks/useTagsSection.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Palette } from '@rocket.chat/fuselage';\nimport { useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useQuery } from '@tanstack/react-query';\nimport { useMemo } from 'react';\n\nimport { getPeriodRange } from '../../../components/dashboards/periods';\nimport { usePeriodSelectorStorage } from '../../../components/dashboards/usePeriodSelectorStorage';\nimport { PERIOD_OPTIONS } from '../components/constants';\nimport { formatPeriodDescription } from '../utils/formatPeriodDescription';\nimport { useDefaultDownload } from './useDefaultDownload';\n\nconst colors = {\n\twarning: Palette.statusColor['status-font-on-warning'].toString(),\n\tdanger: Palette.statusColor['status-font-on-danger'].toString(),\n\tsuccess: Palette.statusColor['status-font-on-success'].toString(),\n\tinfo: Palette.statusColor['status-font-on-info'].toString(),\n};\n\nconst formatChartData = (data: { label: string; value: number }[] | undefined = []) =>\n\tdata.map((item) => ({\n\t\t...item,\n\t\tcolor: colors.info,\n\t}));\n\nexport const useTagsSection = () => {\n\tconst t = useTranslation();\n\tconst [period, periodSelectorProps] = usePeriodSelectorStorage('reports-tags-period', PERIOD_OPTIONS);\n\tconst getConversationsByTags = useEndpoint('GET', '/v1/livechat/analytics/dashboards/conversations-by-tags');\n\n\tconst {\n\t\tdata: { data, total = 0, unspecified = 0 } = { data: [], total: 0 },\n\t\trefetch,\n\t\tisLoading,\n\t\tisError,\n\t\tisSuccess,\n\t} = useQuery(\n\t\t['omnichannel-reports', 'conversations-by-tags', period],\n\t\tasync () => {\n\t\t\tconst { start, end } = getPeriodRange(period);\n\t\t\tconst response = await getConversationsByTags({ start: start.toISOString(), end: end.toISOString() });\n\t\t\treturn { ...response, data: formatChartData(response.data) };\n\t\t},\n\t\t{\n\t\t\trefetchInterval: 5 * 60 * 1000,\n\t\t},\n\t);\n\n\tconst title = t('Conversations_by_tag');\n\tconst subtitleTotals = t('__count__tags__and__count__conversations__period__', {\n\t\tcount: data.length,\n\t\tconversations: total,\n\t\tperiod: formatPeriodDescription(period, t),\n\t});\n\tconst subtitleUnspecified = unspecified > 0 ? `(${t('__count__without__tags__', { count: unspecified })})` : '';\n\tconst subtitle = `${subtitleTotals} ${subtitleUnspecified}`;\n\tconst emptyStateSubtitle = t('Omnichannel_Reports_Tags_Empty_Subtitle');\n\n\tconst downloadProps = useDefaultDownload({ columnName: t('Tags'), title, data, period });\n\n\treturn useMemo(\n\t\t() => ({\n\t\t\tid: 'conversations-by-tags',\n\t\t\ttitle,\n\t\t\tsubtitle,\n\t\t\temptyStateSubtitle,\n\t\t\tdata,\n\t\t\ttotal,\n\t\t\tperiod,\n\t\t\tperiodSelectorProps,\n\t\t\tdownloadProps,\n\t\t\tisError,\n\t\t\tisLoading,\n\t\t\tisDataFound: isSuccess && data.length > 0,\n\t\t\tonRetry: refetch,\n\t\t}),\n\t\t[title, subtitle, emptyStateSubtitle, data, total, isError, isLoading, isSuccess, periodSelectorProps, period, downloadProps, refetch],\n\t);\n};\n",null],"names":["_objectSpread","Palette","useEndpoint","useTranslation","useQuery","useMemo","getPeriodRange","usePeriodSelectorStorage","PERIOD_OPTIONS","formatPeriodDescription","useDefaultDownload","module","link","default","export","useTagsSection","colors","warning","statusColor","toString","danger","success","info","formatChartData","data","map","item","color","t","period","periodSelectorProps","getConversationsByTags","total","unspecified","refetch","isLoading","isError","isSuccess","start","end","response","toISOString","refetchInterval","title","subtitleTotals","count","length","conversations","subtitleUnspecified","concat","subtitle","emptyStateSubtitle","downloadProps","columnName","id","isDataFound","onRetry"],"mappings":"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"}