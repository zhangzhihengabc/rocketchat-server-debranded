)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/reports/hooks/useDepartmentsSection.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { useEndpoint, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useQuery } from '@tanstack/react-query';\nimport { useMemo } from 'react';\n\nimport { getPeriodRange } from '../../../components/dashboards/periods';\nimport { usePeriodSelectorStorage } from '../../../components/dashboards/usePeriodSelectorStorage';\nimport { COLORS, PERIOD_OPTIONS } from '../components/constants';\nimport { formatPeriodDescription } from '../utils/formatPeriodDescription';\nimport { useDefaultDownload } from './useDefaultDownload';\n\nconst formatChartData = (data: { label: string; value: number }[] | undefined = []) =>\n\tdata.map((item) => ({\n\t\t...item,\n\t\tcolor: COLORS.info,\n\t}));\n\nexport const useDepartmentsSection = () => {\n\tconst t = useTranslation();\n\tconst [period, periodSelectorProps] = usePeriodSelectorStorage('reports-department-period', PERIOD_OPTIONS);\n\tconst getConversationsByDepartment = useEndpoint('GET', '/v1/livechat/analytics/dashboards/conversations-by-department');\n\n\tconst {\n\t\tdata: { data, total = 0, unspecified = 0 } = { data: [], total: 0 },\n\t\tisLoading,\n\t\tisError,\n\t\tisSuccess,\n\t\trefetch,\n\t} = useQuery(\n\t\t['omnichannel-reports', 'conversations-by-department', period],\n\t\tasync () => {\n\t\t\tconst { start, end } = getPeriodRange(period);\n\t\t\tconst response = await getConversationsByDepartment({ start: start.toISOString(), end: end.toISOString() });\n\t\t\treturn { ...response, data: formatChartData(response.data) };\n\t\t},\n\t\t{\n\t\t\trefetchInterval: 5 * 60 * 1000,\n\t\t},\n\t);\n\n\tconst title = t('Conversations_by_department');\n\tconst subtitleTotals = t('__departments__departments_and__count__conversations__period__', {\n\t\tdepartments: data.length ?? 0,\n\t\tcount: total,\n\t\tperiod: formatPeriodDescription(period, t),\n\t});\n\tconst subtitleUnspecified = unspecified > 0 ? `(${t('__count__without__department__', { count: unspecified })})` : '';\n\tconst subtitle = `${subtitleTotals} ${subtitleUnspecified}`;\n\tconst emptyStateSubtitle = t('Omnichannel_Reports_Departments_Empty_Subtitle');\n\n\tconst downloadProps = useDefaultDownload({ columnName: t('Departments'), title, data, period });\n\n\treturn useMemo(\n\t\t() => ({\n\t\t\tid: 'conversations-by-department',\n\t\t\ttitle,\n\t\t\tsubtitle,\n\t\t\temptyStateSubtitle,\n\t\t\tdata,\n\t\t\ttotal,\n\t\t\tisLoading,\n\t\t\tisError,\n\t\t\tisDataFound: isSuccess && data.length > 0,\n\t\t\tperiodSelectorProps,\n\t\t\tperiod,\n\t\t\tdownloadProps,\n\t\t\tonRetry: refetch,\n\t\t}),\n\t\t[title, subtitle, emptyStateSubtitle, data, total, isLoading, isError, isSuccess, periodSelectorProps, period, downloadProps, refetch],\n\t);\n};\n",null],"names":["_objectSpread","useEndpoint","useTranslation","useQuery","useMemo","getPeriodRange","usePeriodSelectorStorage","COLORS","PERIOD_OPTIONS","formatPeriodDescription","useDefaultDownload","module","link","default","v","export","useDepartmentsSection","formatChartData","data","map","item","color","info","_data$length","t","period","periodSelectorProps","getConversationsByDepartment","total","unspecified","isLoading","isError","isSuccess","refetch","start","end","response","toISOString","refetchInterval","title","subtitleTotals","departments","length","count","subtitleUnspecified","concat","subtitle","emptyStateSubtitle","downloadProps","columnName","id","isDataFound","onRetry"],"mappings":"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"}