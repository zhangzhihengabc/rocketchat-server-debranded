)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/slaPolicies/SlaTable.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Pagination } from '@rocket.chat/fuselage';\nimport { useDebouncedValue, useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useTranslation, useEndpoint, useRouter } from '@rocket.chat/ui-contexts';\nimport { useQuery, hashQueryKey } from '@tanstack/react-query';\nimport type { MutableRefObject } from 'react';\nimport React, { useMemo, useState, useEffect } from 'react';\n\nimport FilterByText from '../../../../client/components/FilterByText';\nimport GenericNoResults from '../../../../client/components/GenericNoResults/GenericNoResults';\nimport {\n\tGenericTable,\n\tGenericTableHeaderCell,\n\tGenericTableHeader,\n\tGenericTableLoadingRow,\n\tGenericTableBody,\n\tGenericTableRow,\n\tGenericTableCell,\n} from '../../../../client/components/GenericTable';\nimport { usePagination } from '../../../../client/components/GenericTable/hooks/usePagination';\nimport { useSort } from '../../../../client/components/GenericTable/hooks/useSort';\nimport RemoveSlaButton from './RemoveSlaButton';\n\nconst SlaTable = ({ reload }: { reload: MutableRefObject<() => void> }) => {\n\tconst t = useTranslation();\n\tconst router = useRouter();\n\n\tconst [filter, setFilter] = useState('');\n\tconst debouncedFilter = useDebouncedValue(filter, 500);\n\n\tconst { current, itemsPerPage, setItemsPerPage: onSetItemsPerPage, setCurrent: onSetCurrent, ...paginationProps } = usePagination();\n\tconst { sortBy, sortDirection, setSort } = useSort<'name' | 'description' | 'dueTimeInMinutes'>('name');\n\n\tconst query = useMemo(\n\t\t() => ({\n\t\t\ttext: debouncedFilter,\n\t\t\tsort: JSON.stringify({ [sortBy]: sortDirection === 'asc' ? 1 : -1 }),\n\t\t\t...(itemsPerPage && { count: itemsPerPage }),\n\t\t\t...(current && { offset: current }),\n\t\t}),\n\t\t[debouncedFilter, itemsPerPage, current, sortBy, sortDirection],\n\t);\n\n\tconst getSlaData = useEndpoint('GET', '/v1/livechat/sla');\n\tconst { data, isSuccess, isLoading, refetch } = useQuery(['/v1/livechat/sla', query], () => getSlaData(query));\n\n\tconst [defaultQuery] = useState(hashQueryKey([query]));\n\tconst queryHasChanged = defaultQuery !== hashQueryKey([query]);\n\n\tuseEffect(() => {\n\t\treload.current = refetch;\n\t}, [reload, refetch]);\n\n\tconst handleAddNew = useMutableCallback(() => router.navigate('/omnichannel/sla-policies/new'));\n\tconst onRowClick = useMutableCallback((id) => () => router.navigate(`/omnichannel/sla-policies/edit/${id}`));\n\n\tconst headers = (\n\t\t<>\n\t\t\t<GenericTableHeaderCell key='name' direction={sortDirection} active={sortBy === 'name'} onClick={setSort} sort='name'>\n\t\t\t\t{t('Name')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell\n\t\t\t\tkey='description'\n\t\t\t\tdirection={sortDirection}\n\t\t\t\tactive={sortBy === 'description'}\n\t\t\t\tonClick={setSort}\n\t\t\t\tsort='description'\n\t\t\t>\n\t\t\t\t{t('Description')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell\n\t\t\t\tkey='dueTimeInMinutes'\n\t\t\t\tdirection={sortDirection}\n\t\t\t\tactive={sortBy === 'dueTimeInMinutes'}\n\t\t\t\tonClick={setSort}\n\t\t\t\tsort='dueTimeInMinutes'\n\t\t\t>\n\t\t\t\t{t('Estimated_wait_time')}\n\t\t\t</GenericTableHeaderCell>\n\t\t\t<GenericTableHeaderCell key='remove' w='x60'>\n\t\t\t\t{t('Remove')}\n\t\t\t</GenericTableHeaderCell>\n\t\t</>\n\t);\n\n\treturn (\n\t\t<>\n\t\t\t{((isSuccess && data?.sla.length > 0) || queryHasChanged) && <FilterByText onChange={({ text }): void => setFilter(text)} />}\n\t\t\t{isLoading && (\n\t\t\t\t<GenericTable>\n\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t<GenericTableLoadingRow cols={4} />\n\t\t\t\t\t</GenericTableBody>\n\t\t\t\t</GenericTable>\n\t\t\t)}\n\t\t\t{isSuccess && data?.sla.length === 0 && queryHasChanged && <GenericNoResults />}\n\t\t\t{isSuccess && data?.sla.length === 0 && !queryHasChanged && (\n\t\t\t\t<GenericNoResults\n\t\t\t\t\ticon='flag'\n\t\t\t\t\ttitle={t('No_SLA_policies_yet')}\n\t\t\t\t\tdescription={t('No_SLA_policies_yet_description')}\n\t\t\t\t\tbuttonTitle={t('Create_SLA_policy')}\n\t\t\t\t\tbuttonAction={handleAddNew}\n\t\t\t\t\tlinkHref='https://go.rocket.chat/omnichannel-docs'\n\t\t\t\t\tlinkText={t('Learn_more_about_SLA_policies')}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t{isSuccess && data?.sla.length > 0 && (\n\t\t\t\t<>\n\t\t\t\t\t<GenericTable>\n\t\t\t\t\t\t<GenericTableHeader>{headers}</GenericTableHeader>\n\t\t\t\t\t\t<GenericTableBody>\n\t\t\t\t\t\t\t{data?.sla.map(({ _id, name, description, dueTimeInMinutes }) => (\n\t\t\t\t\t\t\t\t<GenericTableRow key={_id} tabIndex={0} role='link' onClick={onRowClick(_id)} action qa-user-id={_id}>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>{name}</GenericTableCell>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>{description}</GenericTableCell>\n\t\t\t\t\t\t\t\t\t<GenericTableCell withTruncatedText>\n\t\t\t\t\t\t\t\t\t\t{dueTimeInMinutes} {t('minutes')}\n\t\t\t\t\t\t\t\t\t</GenericTableCell>\n\t\t\t\t\t\t\t\t\t<RemoveSlaButton _id={_id} reload={refetch} />\n\t\t\t\t\t\t\t\t</GenericTableRow>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</GenericTableBody>\n\t\t\t\t\t</GenericTable>\n\t\t\t\t\t<Pagination\n\t\t\t\t\t\tdivider\n\t\t\t\t\t\tcurrent={current}\n\t\t\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\t\t\tcount={data?.total || 0}\n\t\t\t\t\t\tonSetItemsPerPage={onSetItemsPerPage}\n\t\t\t\t\t\tonSetCurrent={onSetCurrent}\n\t\t\t\t\t\t{...paginationProps}\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default SlaTable;\n",null],"names":["_extends","_objectSpread","_objectWithoutProperties","Pagination","useDebouncedValue","useMutableCallback","useTranslation","useEndpoint","useRouter","useQuery","hashQueryKey","React","useMemo","useState","useEffect","FilterByText","GenericNoResults","GenericTable","GenericTableHeaderCell","GenericTableHeader","GenericTableLoadingRow","GenericTableBody","GenericTableRow","GenericTableCell","usePagination","useSort","RemoveSlaButton","module","link","default","exportDefault","_ref","reload","t","router","filter","setFilter","debouncedFilter","_usePagination","current","itemsPerPage","setItemsPerPage","onSetItemsPerPage","setCurrent","onSetCurrent","paginationProps","_excluded","sortBy","sortDirection","setSort","query","text","sort","JSON","stringify","count","offset","getSlaData","data","isSuccess","isLoading","refetch","defaultQuery","queryHasChanged","handleAddNew","navigate","onRowClick","id","concat","headers","createElement","Fragment","key","direction","active","onClick","w","sla","length","onChange","_ref2","cols","icon","title","description","buttonTitle","buttonAction","linkHref","linkText","map","_ref3","_id","name","dueTimeInMinutes","tabIndex","role","action","withTruncatedText","divider","total"],"mappings":"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"}