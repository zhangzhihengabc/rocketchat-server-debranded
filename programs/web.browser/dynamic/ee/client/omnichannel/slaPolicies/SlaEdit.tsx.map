)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/slaPolicies/SlaEdit.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { IOmnichannelServiceLevelAgreements, Serialized } from '@rocket.chat/core-typings';\nimport { Field, FieldLabel, FieldRow, FieldError, TextInput, Button, Margins, Box, NumberInput } from '@rocket.chat/fuselage';\nimport { useMutableCallback } from '@rocket.chat/fuselage-hooks';\nimport { useToastMessageDispatch, useRoute, useTranslation, useEndpoint } from '@rocket.chat/ui-contexts';\nimport type { ReactElement } from 'react';\nimport React from 'react';\nimport { useController, useForm } from 'react-hook-form';\n\nimport { ContextualbarScrollableContent } from '../../../../client/components/Contextualbar';\n\ntype SlaEditProps = {\n\tisNew?: boolean;\n\tslaId?: string;\n\treload: () => void;\n\tdata?: Serialized<IOmnichannelServiceLevelAgreements>;\n};\n\nfunction SlaEdit({ data, isNew, slaId, reload, ...props }: SlaEditProps): ReactElement {\n\tconst slasRoute = useRoute('omnichannel-sla-policies');\n\tconst saveSLA = useEndpoint('POST', '/v1/livechat/sla');\n\tconst updateSLA = useEndpoint('PUT', `/v1/livechat/sla/:slaId`, { slaId: slaId || '' });\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst t = useTranslation();\n\n\tconst { name, description, dueTimeInMinutes } = data || {};\n\n\tconst {\n\t\tcontrol,\n\t\tgetValues,\n\t\tformState: { errors, isValid, isDirty },\n\t\treset,\n\t} = useForm({\n\t\tmode: 'onChange',\n\t\tdefaultValues: { name, description, dueTimeInMinutes },\n\t});\n\n\tconst { field: nameField } = useController({\n\t\tcontrol,\n\t\tname: 'name',\n\t\trules: { required: t('The_field_is_required', t('Name')) },\n\t});\n\n\tconst { field: dueTimeField } = useController({\n\t\tcontrol,\n\t\tname: 'dueTimeInMinutes',\n\t\trules: {\n\t\t\tvalidate(value) {\n\t\t\t\treturn Number(value || 0) <= 0 ? t('The_field_is_required', t('Estimated_wait_time_in_minutes')) : true;\n\t\t\t},\n\t\t},\n\t});\n\n\tconst { field: descField } = useController({ control, name: 'description' });\n\n\tconst handleSave = useMutableCallback(async () => {\n\t\tconst { name, description, dueTimeInMinutes } = getValues();\n\n\t\tif (!isValid || !name || dueTimeInMinutes === undefined) {\n\t\t\treturn dispatchToastMessage({ type: 'error', message: t('The_field_is_required') });\n\t\t}\n\n\t\ttry {\n\t\t\tconst payload = { name, description, dueTimeInMinutes: Number(dueTimeInMinutes) };\n\t\t\tif (slaId) {\n\t\t\t\tawait updateSLA(payload);\n\t\t\t} else {\n\t\t\t\tawait saveSLA(payload);\n\t\t\t}\n\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\treload();\n\t\t\tslasRoute.push({});\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t}\n\t});\n\n\treturn (\n\t\t<ContextualbarScrollableContent is='form' {...props}>\n\t\t\t<Field>\n\t\t\t\t<FieldLabel>{t('Name')}*</FieldLabel>\n\t\t\t\t<FieldRow>\n\t\t\t\t\t<TextInput placeholder={t('Name')} flexGrow={1} {...nameField} error={errors.name?.message} />\n\t\t\t\t</FieldRow>\n\t\t\t\t<FieldError>{errors.name?.message}</FieldError>\n\t\t\t</Field>\n\t\t\t<Field>\n\t\t\t\t<FieldLabel>{t('Description')}</FieldLabel>\n\t\t\t\t<FieldRow>\n\t\t\t\t\t<TextInput placeholder={t('Description')} flexGrow={1} {...descField} />\n\t\t\t\t</FieldRow>\n\t\t\t</Field>\n\t\t\t<Field>\n\t\t\t\t<FieldLabel>{t('Estimated_wait_time_in_minutes')}*</FieldLabel>\n\t\t\t\t<FieldRow>\n\t\t\t\t\t<NumberInput\n\t\t\t\t\t\tplaceholder={t('Estimated_wait_time_in_minutes')}\n\t\t\t\t\t\tflexGrow={1}\n\t\t\t\t\t\t{...dueTimeField}\n\t\t\t\t\t\terror={errors.dueTimeInMinutes?.message}\n\t\t\t\t\t/>\n\t\t\t\t</FieldRow>\n\t\t\t\t<FieldError>{errors.dueTimeInMinutes?.message}</FieldError>\n\t\t\t</Field>\n\t\t\t<Field>\n\t\t\t\t<FieldRow>\n\t\t\t\t\t<Box display='flex' flexDirection='row' justifyContent='space-between' w='full'>\n\t\t\t\t\t\t<Margins inlineEnd={4}>\n\t\t\t\t\t\t\t{!isNew && (\n\t\t\t\t\t\t\t\t<Button flexGrow={1} type='reset' disabled={!isDirty} onClick={(): void => reset()}>\n\t\t\t\t\t\t\t\t\t{t('Reset')}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<Button primary mie='none' flexGrow={1} disabled={!isDirty || !isValid} onClick={handleSave}>\n\t\t\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</Margins>\n\t\t\t\t\t</Box>\n\t\t\t\t</FieldRow>\n\t\t\t</Field>\n\t\t</ContextualbarScrollableContent>\n\t);\n}\n\nexport default SlaEdit;\n",null],"names":["_extends","_objectWithoutProperties","Field","FieldLabel","FieldRow","FieldError","TextInput","Button","Margins","Box","NumberInput","useMutableCallback","useToastMessageDispatch","useRoute","useTranslation","useEndpoint","React","useController","useForm","ContextualbarScrollableContent","module","link","default","v","exportDefault","_ref","_errors$name","_errors$name2","_errors$dueTimeInMinu","_errors$dueTimeInMinu2","data","isNew","slaId","reload","props","_excluded","slasRoute","saveSLA","updateSLA","dispatchToastMessage","t","name","description","dueTimeInMinutes","control","getValues","formState","errors","isValid","isDirty","reset","mode","defaultValues","field","nameField","rules","required","dueTimeField","validate","value","Number","descField","handleSave","undefined","type","message","payload","push","error","createElement","is","placeholder","flexGrow","display","flexDirection","justifyContent","w","inlineEnd","disabled","onClick","primary","mie"],"mappings":"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"}