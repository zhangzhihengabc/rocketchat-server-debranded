)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/omnichannel/tags/TagEdit.tsx","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { ILivechatDepartment, ILivechatTag, Serialized } from '@rocket.chat/core-typings';\nimport { Field, FieldLabel, FieldRow, FieldError, TextInput, Button, ButtonGroup, FieldGroup, Box } from '@rocket.chat/fuselage';\nimport { useMutableCallback, useUniqueId } from '@rocket.chat/fuselage-hooks';\nimport { useToastMessageDispatch, useRouter, useMethod, useTranslation } from '@rocket.chat/ui-contexts';\nimport { useQueryClient } from '@tanstack/react-query';\nimport React from 'react';\nimport { useForm, Controller } from 'react-hook-form';\n\nimport AutoCompleteDepartmentMultiple from '../../../../client/components/AutoCompleteDepartmentMultiple';\nimport {\n\tContextualbarScrollableContent,\n\tContextualbarFooter,\n\tContextualbarTitle,\n\tContextualbar,\n\tContextualbarHeader,\n\tContextualbarClose,\n} from '../../../../client/components/Contextualbar';\nimport { useRemoveTag } from './useRemoveTag';\n\ntype TagEditPayload = {\n\tname: string;\n\tdescription: string;\n\tdepartments: { label: string; value: string }[];\n};\n\ntype TagEditProps = {\n\ttagData?: ILivechatTag;\n\tcurrentDepartments?: Serialized<ILivechatDepartment>[];\n};\n\nconst TagEdit = ({ tagData, currentDepartments }: TagEditProps) => {\n\tconst t = useTranslation();\n\tconst router = useRouter();\n\tconst queryClient = useQueryClient();\n\tconst handleDeleteTag = useRemoveTag();\n\n\tconst dispatchToastMessage = useToastMessageDispatch();\n\tconst saveTag = useMethod('livechat:saveTag');\n\n\tconst { _id, name, description } = tagData || {};\n\n\tconst {\n\t\tcontrol,\n\t\tformState: { isDirty, errors },\n\t\thandleSubmit,\n\t} = useForm<TagEditPayload>({\n\t\tmode: 'onBlur',\n\t\tvalues: {\n\t\t\tname: name || '',\n\t\t\tdescription: description || '',\n\t\t\tdepartments: currentDepartments?.map((dep) => ({ label: dep.name, value: dep._id })) || [],\n\t\t},\n\t});\n\n\tconst handleSave = useMutableCallback(async ({ name, description, departments }: TagEditPayload) => {\n\t\tconst departmentsId = departments?.map((dep) => dep.value) || [''];\n\n\t\ttry {\n\t\t\tawait saveTag(_id as unknown as string, { name, description }, departmentsId);\n\t\t\tdispatchToastMessage({ type: 'success', message: t('Saved') });\n\t\t\tqueryClient.invalidateQueries(['livechat-tags']);\n\t\t} catch (error) {\n\t\t\tdispatchToastMessage({ type: 'error', message: error });\n\t\t} finally {\n\t\t\trouter.navigate('/omnichannel/tags');\n\t\t}\n\t});\n\n\tconst formId = useUniqueId();\n\tconst nameField = useUniqueId();\n\tconst descriptionField = useUniqueId();\n\tconst departmentsField = useUniqueId();\n\n\treturn (\n\t\t<Contextualbar>\n\t\t\t<ContextualbarHeader>\n\t\t\t\t<ContextualbarTitle>{_id ? t('Edit_Tag') : t('New_Tag')}</ContextualbarTitle>\n\t\t\t\t<ContextualbarClose onClick={() => router.navigate('/omnichannel/tags')}></ContextualbarClose>\n\t\t\t</ContextualbarHeader>\n\t\t\t<ContextualbarScrollableContent>\n\t\t\t\t<Box id={formId} is='form' autoComplete='off' onSubmit={handleSubmit(handleSave)}>\n\t\t\t\t\t<FieldGroup>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<FieldLabel htmlFor={nameField} required>\n\t\t\t\t\t\t\t\t{t('Name')}\n\t\t\t\t\t\t\t</FieldLabel>\n\t\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t\t<Controller\n\t\t\t\t\t\t\t\t\tname='name'\n\t\t\t\t\t\t\t\t\tcontrol={control}\n\t\t\t\t\t\t\t\t\trules={{ required: t('The_field_is_required', 'name') }}\n\t\t\t\t\t\t\t\t\trender={({ field }) => <TextInput {...field} error={errors?.name?.message} aria-describedby={`${nameField}-error`} />}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t\t{errors?.name && (\n\t\t\t\t\t\t\t\t<FieldError aria-live='assertive' id={`${nameField}-error`}>\n\t\t\t\t\t\t\t\t\t{errors?.name?.message}\n\t\t\t\t\t\t\t\t</FieldError>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<FieldLabel htmlFor={descriptionField}>{t('Description')}</FieldLabel>\n\t\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t\t<Controller name='description' control={control} render={({ field }) => <TextInput id={descriptionField} {...field} />} />\n\t\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t\t<Field>\n\t\t\t\t\t\t\t<FieldLabel htmlFor={departmentsField}>{t('Departments')}</FieldLabel>\n\t\t\t\t\t\t\t<FieldRow>\n\t\t\t\t\t\t\t\t<Controller\n\t\t\t\t\t\t\t\t\tname='departments'\n\t\t\t\t\t\t\t\t\tcontrol={control}\n\t\t\t\t\t\t\t\t\trender={({ field: { onChange, value, onBlur } }) => (\n\t\t\t\t\t\t\t\t\t\t<AutoCompleteDepartmentMultiple id={departmentsField} onChange={onChange} value={value} onBlur={onBlur} showArchived />\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</FieldRow>\n\t\t\t\t\t\t</Field>\n\t\t\t\t\t</FieldGroup>\n\t\t\t\t</Box>\n\t\t\t</ContextualbarScrollableContent>\n\t\t\t<ContextualbarFooter>\n\t\t\t\t<ButtonGroup stretch>\n\t\t\t\t\t<Button onClick={() => router.navigate('/omnichannel/tags')}>{t('Cancel')}</Button>\n\t\t\t\t\t<Button form={formId} disabled={!isDirty} type='submit' primary>\n\t\t\t\t\t\t{t('Save')}\n\t\t\t\t\t</Button>\n\t\t\t\t</ButtonGroup>\n\t\t\t\t{_id && (\n\t\t\t\t\t<ButtonGroup stretch mbs={8}>\n\t\t\t\t\t\t<Button icon='trash' danger onClick={() => handleDeleteTag(_id)}>\n\t\t\t\t\t\t\t{t('Delete')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</ButtonGroup>\n\t\t\t\t)}\n\t\t\t</ContextualbarFooter>\n\t\t</Contextualbar>\n\t);\n};\n\nexport default TagEdit;\n",null],"names":["_extends","Field","FieldLabel","FieldRow","FieldError","TextInput","Button","ButtonGroup","FieldGroup","Box","useMutableCallback","useUniqueId","useToastMessageDispatch","useRouter","useMethod","useTranslation","useQueryClient","React","useForm","Controller","AutoCompleteDepartmentMultiple","ContextualbarScrollableContent","ContextualbarFooter","ContextualbarTitle","Contextualbar","ContextualbarHeader","ContextualbarClose","useRemoveTag","module","link","default","v","exportDefault","_ref","_errors$name2","tagData","currentDepartments","t","router","queryClient","handleDeleteTag","dispatchToastMessage","saveTag","_id","name","description","control","formState","isDirty","errors","handleSubmit","mode","values","departments","map","dep","label","value","handleSave","_ref2","departmentsId","type","message","invalidateQueries","error","navigate","formId","nameField","descriptionField","departmentsField","createElement","onClick","id","is","autoComplete","onSubmit","htmlFor","required","rules","render","_ref3","_errors$name","field","concat","_ref4","_ref5","onChange","onBlur","showArchived","stretch","form","disabled","primary","mbs","icon","danger"],"mappings":"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"}