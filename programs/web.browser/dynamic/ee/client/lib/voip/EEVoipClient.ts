function module(e,t,s){let i,r,a,n,o;s.export({EEVoipClient:()=>l}),s.link("@rocket.chat/core-typings",{Operation(e){i=e},UserState(e){r=e}},0),s.link("sip.js",{Inviter(e){a=e},UserAgent(e){n=e}},1),s.link("../../../../client/lib/voip/VoIPUser",{VoIPUser(e){o=e}},2);class l extends o{constructor(e,t){super(e,t)}async makeCallURI(e,t){if(t&&(this.mediaStreamRendered=t),this.session)throw Error("Session exists");if(!this.userAgent)throw Error("No User Agent.");if("REGISTERED"!==this.callState)throw Error("Incorrect UA state");let s=n.makeURI(e);if(!s)throw Error("Failed to create valid URI ".concat(e));let o=new a(this.userAgent,s,{sessionDescriptionHandlerOptions:{constraints:{audio:!0,video:!1}}});this.session=o,this.setupSessionEventHandlers(o),this._opInProgress=i.OP_SEND_INVITE,await o.invite({requestDelegate:{onReject:e=>{e.message.reasonPhrase&&this.emit("callfailed",e.message.reasonPhrase||"unknown")}}}),this._callState="OFFER_SENT";let l={callerId:o.remoteIdentity.uri.user?o.remoteIdentity.uri.user:"",callerName:o.remoteIdentity.displayName,host:o.remoteIdentity.uri.host};this._callerInfo=l,this._userState=r.UAC,this.emit("stateChanged")}async makeCall(e){let t=e.includes("+"),s=e.replace("+","");this.makeCallURI("sip:".concat(t?"*":"").concat(s,"@").concat(this.userConfig.sipRegistrarHostnameOrIP))}static async create(e,t){let s=new l(e,t);return await s.init(),s}}}
//# sourceMappingURL=/dynamic/ee/client/lib/voip/9f13db319242f4bb609c73c8cb9cff98a8d57590.map
