)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/client/lib/onToggledFeature.ts","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import type { LicenseModule } from '@rocket.chat/core-typings';\nimport { QueryObserver } from '@tanstack/react-query';\n\nimport { queryClient } from '../../../client/lib/queryClient';\nimport { fetchFeatures } from './fetchFeatures';\n\nexport const onToggledFeature = (\n\tfeature: LicenseModule,\n\t{\n\t\tup,\n\t\tdown,\n\t}: {\n\t\tup?: () => void;\n\t\tdown?: () => void;\n\t},\n): (() => void) => {\n\tconst observer = new QueryObserver(queryClient, {\n\t\tqueryKey: ['ee.features'],\n\t\tqueryFn: fetchFeatures,\n\t\tstaleTime: Infinity,\n\t});\n\n\tlet enabled = false;\n\n\treturn observer.subscribe((result) => {\n\t\tif (!result.isSuccess) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst features = result.data;\n\t\tconst hasFeature = features.includes(feature);\n\n\t\tif (!enabled && hasFeature) {\n\t\t\tup?.();\n\t\t\tenabled = true;\n\t\t}\n\n\t\tif (enabled && !hasFeature) {\n\t\t\tdown?.();\n\t\t\tenabled = false;\n\t\t}\n\t});\n};\n",null],"names":["QueryObserver","queryClient","fetchFeatures","module","export","onToggledFeature","feature","_ref","up","down","observer","queryKey","queryFn","staleTime","Infinity","enabled","subscribe","result","isSuccess","features","data","hasFeature","includes"],"mappings":"2BACsDA,EAAAC,EAAAC,EAAtDC,EAAOC,MAAE,CAAA,CAAAC,iBAAqB,IAAAA,CAAA,GAAwBF,EAAAA,IAAAA,CAAAA,wBAAAA,CAAAH,cAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAG,EAAAA,IAAAA,CAAAA,kCAAAA,CAAAF,YAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAAAE,EAAAA,IAAAA,CAAAA,kBAAAA,CAAAD,cAAAA,CAAAA,EAAAA,EAAAA,CAAA,CAAA,EAAA,GAK/C,IAAMG,EAAmB,CAC/BC,EAAsBC,KAQL,GAPjB,CACCC,GAAAA,CAAE,CACFC,KAAAA,CAAAA,CAIA,CAAAF,EAEKG,EAAW,IAAIV,EAAcC,EAAa,CAC/CU,SAAU,CAAC,cAAc,CACzBC,QAASV,EACTW,UAAWC,MAGRC,EAAU,CAAA,EAEd,OAAOL,EAASM,SAAS,CAAEC,IAC1B,GAAI,CAACA,EAAOC,SAAS,CACpB,OAGD,IAAMC,EAAWF,EAAOG,IAAI,CACtBC,EAAaF,EAASG,QAAQ,CAAChB,EAEjC,EAACS,GAAWM,IACfb,MAAAA,GAAAA,IACAO,EAAU,CAAA,GAGPA,GAAW,CAACM,IACfZ,MAAAA,GAAAA,IACAM,EAAU,CAAA,EAEZ,EACD"}