)]}'
{"version":3,"sources":["meteor://ðŸ’»app/ee/app/canned-responses/client/startup/responses.js","meteor://ðŸ’»app/<anon>"],"sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { Tracker } from 'meteor/tracker';\n\nimport { hasPermission } from '../../../../../app/authorization/client';\nimport { settings } from '../../../../../app/settings/client';\nimport { sdk } from '../../../../../app/utils/client/lib/SDKClient';\nimport { CannedResponse } from '../collections/CannedResponse';\n\nconst events = {\n\tchanged: ({ type, ...response }) => {\n\t\tCannedResponse.upsert({ _id: response._id }, response);\n\t},\n\tremoved: (response) => CannedResponse.remove({ _id: response._id }),\n};\n\nMeteor.startup(() => {\n\tTracker.autorun(async (c) => {\n\t\tif (!Meteor.userId()) {\n\t\t\treturn;\n\t\t}\n\t\tif (!settings.get('Canned_Responses_Enable')) {\n\t\t\treturn;\n\t\t}\n\t\tif (!hasPermission('view-canned-responses')) {\n\t\t\treturn;\n\t\t}\n\t\tTracker.afterFlush(() => {\n\t\t\ttry {\n\t\t\t\t// TODO: check options\n\t\t\t\tsdk.stream('canned-responses', ['canned-responses'], (response, options) => {\n\t\t\t\t\tconst { agentsId } = options || {};\n\t\t\t\t\tif (Array.isArray(agentsId) && !agentsId.includes(Meteor.userId())) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tevents[response.type](response);\n\t\t\t\t});\n\t\t\t} catch (error) {\n\t\t\t\tconsole.log(error);\n\t\t\t}\n\t\t});\n\n\t\tconst { responses } = await sdk.rest.get('/v1/canned-responses.get');\n\t\tresponses.forEach((response) => CannedResponse.insert(response));\n\t\tc.stop();\n\t});\n});\n",null],"names":["_objectWithoutProperties","Meteor","Tracker","hasPermission","settings","sdk","CannedResponse","module","link","default","v","events","changed","_ref","type","response","_excluded","upsert","_id","removed","remove","startup","autorun","c","userId","get","afterFlush","stream","options","agentsId","Array","isArray","includes","error","console","log","responses","rest","forEach","insert","stop"],"mappings":"2BAAIA,EAAAC,EAAgEC,EAAoEC,EAA+GC,EAA2FC,EAAuFC,iBAA5YC,EAAOC,IAAI,CAAC,iDAAiD,CAACC,QAAQC,CAAC,EAAEV,EAAyBU,CAAC,CAAC,EAAE,GAAxHH,EAAOC,IAAI,CAAC,gBAAgB,CAACP,OAAOS,CAAC,EAAET,EAAOS,CAAC,CAAC,EAAE,GAAeH,EAAOC,IAAI,CAAC,iBAAiB,CAACN,QAAQQ,CAAC,EAAER,EAAQQ,CAAC,CAAC,EAAE,GAAqBH,EAAOC,IAAI,CAAC,0CAA0C,CAACL,cAAcO,CAAC,EAAEP,EAAcO,CAAC,CAAC,EAAE,GAAgBH,EAAOC,IAAI,CAAC,qCAAqC,CAACJ,SAASM,CAAC,EAAEN,EAASM,CAAC,CAAC,EAAE,GAAWH,EAAOC,IAAI,CAAC,gDAAgD,CAACH,IAAIK,CAAC,EAAEL,EAAIK,CAAC,CAAC,EAAE,GAAsBH,EAAOC,IAAI,CAAC,gCAAgC,CAACF,eAAeI,CAAC,EAAEJ,EAAeI,CAAC,CAAC,EAAE,GAQ1gB,IAAMC,EAAS,CACdC,QAASC,IAA2B,GAA1B,CAAEC,KAAAA,CAAAA,CAAmB,CAAAD,EAAVE,EAAQf,EAAAa,EAAAG,GAC5BV,EAAeW,MAAM,CAAC,CAAEC,IAAKH,EAASG,GAAAA,AAAI,EAAGH,EAC9C,EACAI,QAAUJ,GAAaT,EAAec,MAAM,CAAC,CAAEF,IAAKH,EAASG,GAAAA,AAAI,EAClE,EAEAjB,EAAOoB,OAAO,CAAC,KACdnB,EAAQoB,OAAO,CAAC,MAAOC,IACtB,GAAI,CAACtB,EAAOuB,MAAM,IAGd,CAACpB,EAASqB,GAAG,CAAC,4BAGd,CAACtB,EAAc,yBALlB,OAQDD,EAAQwB,UAAU,CAAC,KAClB,GAAI,CAEHrB,EAAIsB,MAAM,CAAC,mBAAoB,CAAC,mBAAmB,CAAE,CAACZ,EAAUa,KAC/D,GAAM,CAAEC,SAAAA,CAAAA,CAAU,CAAGD,GAAW,CAAC,EAC7BE,CAAAA,CAAAA,MAAMC,OAAO,CAACF,IAAcA,EAASG,QAAQ,CAAC/B,EAAOuB,MAAM,GAAE,GAGjEb,CAAM,CAACI,EAASD,IAAI,CAAC,CAACC,EACvB,EACD,CAAE,MAAOkB,EAAO,CACfC,QAAQC,GAAG,CAACF,EACb,CACD,GAEA,GAAM,CAAEG,UAAAA,CAAAA,CAAW,CAAG,MAAM/B,EAAIgC,IAAI,CAACZ,GAAG,CAAC,4BACzCW,EAAUE,OAAO,CAAEvB,GAAaT,EAAeiC,MAAM,CAACxB,IACtDQ,EAAEiB,IAAI,EACP,EACD"}