function module(t,e,n){"use strict";var i=t("hash.js"),r=t("../curves"),o=t("../utils"),s=o.assert,h=o.parseBytes,u=t("./key"),c=t("./signature");function a(t){if(s("ed25519"===t,"only tested with ed25519 so far"),!(this instanceof a))return new a(t);t=r[t].curve,this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8),this.hash=i.sha512}n.exports=a,a.prototype.sign=function t(t,e){t=h(t);var n=this.keyFromSecret(e),i=this.hashInt(n.messagePrefix(),t),r=this.g.mul(i),o=this.encodePoint(r),s=this.hashInt(o,n.pubBytes(),t).mul(n.priv()),u=i.add(s).umod(this.curve.n);return this.makeSignature({R:r,S:u,Rencoded:o})},a.prototype.verify=function t(t,e,n){t=h(t),e=this.makeSignature(e);var i=this.keyFromPublic(n),r=this.hashInt(e.Rencoded(),i.pubBytes(),t),o=this.g.mul(e.S());return e.R().add(i.pub().mul(r)).eq(o)},a.prototype.hashInt=function t(){for(var t=this.hash(),e=0;e<arguments.length;e++)t.update(arguments[e]);return o.intFromLE(t.digest()).umod(this.curve.n)},a.prototype.keyFromPublic=function t(t){return u.fromPublic(this,t)},a.prototype.keyFromSecret=function t(t){return u.fromSecret(this,t)},a.prototype.makeSignature=function t(t){return t instanceof c?t:new c(this,t)},a.prototype.encodePoint=function t(t){var e=t.getY().toArray("le",this.encodingLength);return e[this.encodingLength-1]|=t.getX().isOdd()?128:0,e},a.prototype.decodePoint=function t(t){var e=(t=o.parseBytes(t)).length-1,n=t.slice(0,e).concat(-129&t[e]),i=(128&t[e])!=0,r=o.intFromLE(n);return this.curve.pointFromY(r,i)},a.prototype.encodeInt=function t(t){return t.toArray("le",this.encodingLength)},a.prototype.decodeInt=function t(t){return o.intFromLE(t)},a.prototype.isPoint=function t(t){return t instanceof this.pointClass}}
//# sourceMappingURL=/dynamic/node_modules/elliptic/lib/elliptic/eddsa/5f7ff53d8dcda7ee033da22eec34255e6bbd091b.map
