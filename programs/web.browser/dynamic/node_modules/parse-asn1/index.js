function module(e,r,a){var t=e("./asn1"),c=e("./aesid.json"),i=e("./fixProc"),d=e("browserify-aes"),s=e("pbkdf2"),o=e("safe-buffer").Buffer;function u(e){"object"!=typeof e||o.isBuffer(e)||(v=e.passphrase,e=e.key),"string"==typeof e&&(e=o.from(e));var r,a,u,p,y,n,K,l,P,h,m,v,b,f,E=i(e,v),g=E.tag,A=E.data;switch(g){case"CERTIFICATE":f=t.certificate.decode(A,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(f||(f=t.PublicKey.decode(A,"der")),b=f.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return t.RSAPublicKey.decode(f.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return f.subjectPrivateKey=f.subjectPublicKey,{type:"ec",data:f};case"1.2.840.10040.4.1":return f.algorithm.params.pub_key=t.DSAparam.decode(f.subjectPublicKey.data,"der"),{type:"dsa",data:f.algorithm.params};default:throw Error("unknown key id "+b)}case"ENCRYPTED PRIVATE KEY":r=A=t.EncryptedPrivateKey.decode(A,"der"),a=v,u=r.algorithm.decrypt.kde.kdeparams.salt,p=parseInt(r.algorithm.decrypt.kde.kdeparams.iters.toString(),10),y=c[r.algorithm.decrypt.cipher.algo.join(".")],n=r.algorithm.decrypt.cipher.iv,K=r.subjectPrivateKey,l=parseInt(y.split("-")[1],10)/8,P=s.pbkdf2Sync(a,u,p,l,"sha1"),h=d.createDecipheriv(y,P,n),(m=[]).push(h.update(K)),m.push(h.final()),A=o.concat(m);case"PRIVATE KEY":switch(b=(f=t.PrivateKey.decode(A,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return t.RSAPrivateKey.decode(f.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:f.algorithm.curve,privateKey:t.ECPrivateKey.decode(f.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return f.algorithm.params.priv_key=t.DSAparam.decode(f.subjectPrivateKey,"der"),{type:"dsa",params:f.algorithm.params};default:throw Error("unknown key id "+b)}case"RSA PUBLIC KEY":return t.RSAPublicKey.decode(A,"der");case"RSA PRIVATE KEY":return t.RSAPrivateKey.decode(A,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:t.DSAPrivateKey.decode(A,"der")};case"EC PRIVATE KEY":return{curve:(A=t.ECPrivateKey.decode(A,"der")).parameters.value,privateKey:A.privateKey};default:throw Error("unknown key type "+g)}}a.exports=u,u.signature=t.signature}
//# sourceMappingURL=/dynamic/node_modules/parse-asn1/124882373375164f659d3a30f15b246423ad1377.map
