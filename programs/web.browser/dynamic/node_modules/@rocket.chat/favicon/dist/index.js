function module(t,e,n){let i;n.export({manageFavicon:()=>d},!0),n.link("./badge",{drawBadge(t){i=t}},0);var r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(r,o){function a(t){try{d(i.next(t))}catch(t){o(t)}}function l(t){try{d(i.throw(t))}catch(t){o(t)}}function d(t){var e;t.done?r(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(a,l)}d((i=i.apply(t,e||[])).next())})};let o=()=>{let t=Array.from(document.head.getElementsByTagName("link")).filter(t=>{var e;return/(^|\s)icon(\s|$)/i.test(null!==(e=t.getAttribute("rel"))&&void 0!==e?e:"")});if(0===t.length){let e=document.createElement("link");e.setAttribute("rel","icon"),document.head.appendChild(e),t.push(e)}for(let e of t)e.setAttribute("type","image/png");return t},a=t=>r(void 0,void 0,void 0,function*(){let e=new Image;return t?(e.crossOrigin="anonymous",e.src=t):(e.src="",e.width=32,e.height=32),new Promise((t,n)=>{e.onload=()=>{t(e)},e.onerror=()=>{n(Error("Failed to load image"))}})}),l=({badge:t,canvas:e,favicons:n,context:r,img:o})=>{r.scale(e.width,e.height),r.clearRect(0,0,1,1),r.drawImage(o,0,0,1,1),i(t,r),r.setTransform(1,0,0,1,0,0);let a=e.toDataURL("image/png");for(let t of n)t.setAttribute("href",a)},d=()=>{let t;let e=e=>{t=e};return r(void 0,void 0,void 0,function*(){var n;let i=o(),r=i[i.length-1],d=null!==(n=r.getAttribute("href"))&&void 0!==n?n:void 0,c=yield a(d),h=document.createElement("canvas");h.width=c.width>0?c.width:32,h.height=c.height>0?c.height:32;let u=h.getContext("2d");if(!u)throw Error("Failed to create canvas context");e=t=>{l({badge:t,canvas:h,favicons:i,context:u,img:c})},t&&(e(t),t=void 0)}),t=>{e(t)}}}
//# sourceMappingURL=/dynamic/node_modules/@rocket.chat/favicon/dist/ee6a89e1d5cdb977590a171ef3df5e21b588ce30.map
