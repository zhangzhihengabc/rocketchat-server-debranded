function module(e,t,i){let s,r,n;i.export({NonInviteClientTransaction:()=>o}),i.link("../timers",{Timers(e){s=e}},0),i.link("./client-transaction",{ClientTransaction(e){r=e}},1),i.link("./transaction-state",{TransactionState(e){n=e}},2);class o extends r{constructor(e,t,i){super(e,t,i,n.Trying,"sip.transaction.nict"),this.F=setTimeout(()=>this.timerF(),s.TIMER_F),this.send(e.toString()).catch(e=>{this.logTransportError(e,"Failed to send initial outgoing request.")})}dispose(){this.F&&(clearTimeout(this.F),this.F=void 0),this.K&&(clearTimeout(this.K),this.K=void 0),super.dispose()}get kind(){return"nict"}receiveResponse(e){let t=e.statusCode;if(!t||t<100||t>699)throw Error(`Invalid status code ${t}`);switch(this.state){case n.Trying:if(t>=100&&t<=199){this.stateTransition(n.Proceeding),this.user.receiveResponse&&this.user.receiveResponse(e);return}if(t>=200&&t<=699){if(this.stateTransition(n.Completed),408===t){this.onRequestTimeout();return}this.user.receiveResponse&&this.user.receiveResponse(e);return}break;case n.Proceeding:if(t>=100&&t<=199&&this.user.receiveResponse)return this.user.receiveResponse(e);if(t>=200&&t<=699){if(this.stateTransition(n.Completed),408===t){this.onRequestTimeout();return}this.user.receiveResponse&&this.user.receiveResponse(e);return}break;case n.Completed:case n.Terminated:return;default:throw Error(`Invalid state ${this.state}`)}let i=`Non-INVITE client transaction received unexpected ${t} response while in state ${this.state}.`;this.logger.warn(i)}onTransportError(e){this.user.onTransportError&&this.user.onTransportError(e),this.stateTransition(n.Terminated,!0)}typeToString(){return"non-INVITE client transaction"}stateTransition(e,t=!1){let i=()=>{throw Error(`Invalid state transition from ${this.state} to ${e}`)};switch(e){case n.Trying:i();break;case n.Proceeding:this.state!==n.Trying&&i();break;case n.Completed:this.state!==n.Trying&&this.state!==n.Proceeding&&i();break;case n.Terminated:this.state===n.Trying||this.state===n.Proceeding||this.state===n.Completed||t||i();break;default:i()}e===n.Completed&&(this.F&&(clearTimeout(this.F),this.F=void 0),this.K=setTimeout(()=>this.timerK(),s.TIMER_K)),e===n.Terminated&&this.dispose(),this.setState(e)}timerF(){this.logger.debug(`Timer F expired for non-INVITE client transaction ${this.id}.`),(this.state===n.Trying||this.state===n.Proceeding)&&(this.onRequestTimeout(),this.stateTransition(n.Terminated))}timerK(){this.state===n.Completed&&this.stateTransition(n.Terminated)}}}
//# sourceMappingURL=/dynamic/node_modules/sip.js/lib/core/transactions/14e22aa295090c896798f3dfdbc801aef698c9d6.map
