{"version":3,"file":"rocketchat-livechat.min.js","mappings":"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","sources":["webpack://@rocket.chat/livechat/./src/widget.js","webpack://@rocket.chat/livechat/../../node_modules/mitt/dist/mitt.es.js"],"sourcesContent":["import mitt from 'mitt';\n\nconst log =\n\tprocess.env.NODE_ENV === 'development'\n\t\t? (...args) => window.console.log('%cwidget%c', 'color: red', 'color: initial', ...args)\n\t\t: () => {};\n\nconst WIDGET_OPEN_WIDTH = 365;\nconst WIDGET_OPEN_HEIGHT = 525;\nconst WIDGET_MINIMIZED_WIDTH = 54;\nconst WIDGET_MINIMIZED_HEIGHT = 54;\nconst WIDGET_MARGIN = 16;\n\nwindow.RocketChat = window.RocketChat || { _: [] };\nconst config = {};\nlet widget;\nlet iframe;\nlet hookQueue = [];\nlet ready = false;\nlet smallScreen = false;\nlet scrollPosition;\nlet widget_height;\n\nexport const validCallbacks = [\n\t'chat-maximized',\n\t'chat-minimized',\n\t'chat-started',\n\t'chat-ended',\n\t'pre-chat-form-submit',\n\t'offline-form-submit',\n\t'show-widget',\n\t'hide-widget',\n\t'assign-agent',\n\t'agent-status-change',\n\t'queue-position-change',\n\t'no-agent-online',\n];\n\nconst callbacks = mitt();\n\nfunction registerCallback(eventName, fn) {\n\tif (validCallbacks.indexOf(eventName) === -1) {\n\t\treturn false;\n\t}\n\n\treturn callbacks.on(eventName, fn);\n}\n\nfunction emitCallback(eventName, data) {\n\tif (typeof data !== 'undefined') {\n\t\tcallbacks.emit(eventName, data);\n\t} else {\n\t\tcallbacks.emit(eventName);\n\t}\n}\n\n// hooks\nfunction callHook(action, params) {\n\tif (!ready) {\n\t\treturn hookQueue.push([action, params]);\n\t}\n\tconst data = {\n\t\tsrc: 'rocketchat',\n\t\tfn: action,\n\t\targs: params,\n\t};\n\tiframe.contentWindow.postMessage(data, '*');\n}\n\nconst updateWidgetStyle = (isOpened) => {\n\tconst isFullscreen = smallScreen && widget.dataset.state !== 'triggered';\n\n\tif (smallScreen && isOpened) {\n\t\tscrollPosition = document.documentElement.scrollTop;\n\t\tdocument.body.classList.add('rc-livechat-mobile-full-screen');\n\t} else {\n\t\tdocument.body.classList.remove('rc-livechat-mobile-full-screen');\n\t\tif (smallScreen) {\n\t\t\tdocument.documentElement.scrollTop = scrollPosition;\n\t\t}\n\t}\n\n\tif (isOpened) {\n\t\twidget.style.left = isFullscreen ? '0' : 'auto';\n\n\t\t/**\n\t\t * If we use widget.style.height = smallScreen ? '100vh' : ...\n\t\t * In above case some browser's viewport height is not rendered correctly\n\t\t * so, as 100vh will resolve to 100% of the current viewport height,\n\t\t * so fixed it to 100% avoiding problem for some browsers. Similar resolution\n\t\t * for widget.style.width\n\t\t */\n\n\t\twidget.style.height = isFullscreen ? '100%' : `${WIDGET_MARGIN + widget_height + WIDGET_MARGIN + WIDGET_MINIMIZED_HEIGHT}px`;\n\t\twidget.style.width = isFullscreen ? '100%' : `${WIDGET_MARGIN + WIDGET_OPEN_WIDTH + WIDGET_MARGIN}px`;\n\t} else {\n\t\twidget.style.left = 'auto';\n\t\twidget.style.width = `${WIDGET_MARGIN + WIDGET_MINIMIZED_WIDTH + WIDGET_MARGIN}px`;\n\t\twidget.style.height = `${WIDGET_MARGIN + WIDGET_MINIMIZED_HEIGHT + WIDGET_MARGIN}px`;\n\t}\n};\n\nconst createWidget = (url) => {\n\twidget = document.createElement('div');\n\twidget.className = 'rocketchat-widget';\n\twidget.style.position = 'fixed';\n\twidget.style.width = `${WIDGET_MARGIN + WIDGET_MINIMIZED_WIDTH + WIDGET_MARGIN}px`;\n\twidget.style.height = `${WIDGET_MARGIN + WIDGET_MINIMIZED_HEIGHT + WIDGET_MARGIN}px`;\n\twidget.style.maxHeight = '100vh';\n\twidget.style.bottom = '0';\n\twidget.style.right = '0';\n\twidget.style.zIndex = '12345';\n\twidget.dataset.state = 'closed';\n\n\tconst container = document.createElement('div');\n\tcontainer.className = 'rocketchat-container';\n\tcontainer.style.width = '100%';\n\tcontainer.style.height = '100%';\n\n\tiframe = document.createElement('iframe');\n\tiframe.id = 'rocketchat-iframe';\n\tiframe.allowTransparency = 'true';\n\tiframe.src = url;\n\tiframe.style.width = '100%';\n\tiframe.style.height = '100%';\n\tiframe.style.border = 'none';\n\tiframe.style.backgroundColor = 'transparent';\n\n\tcontainer.appendChild(iframe);\n\twidget.appendChild(container);\n\tdocument.body.appendChild(widget);\n\n\tconst handleMediaQueryTest = ({ matches }) => {\n\t\tif (!widget) {\n\t\t\treturn;\n\t\t}\n\n\t\tsmallScreen = matches;\n\t\tupdateWidgetStyle(widget.dataset.state === 'opened');\n\t\tcallHook('setExpanded', smallScreen);\n\t\tcallHook('setParentUrl', window.location.href);\n\t};\n\n\tconst mediaQueryList = window.matchMedia('screen and (max-device-width: 480px)');\n\tmediaQueryList.addListener(handleMediaQueryTest);\n\thandleMediaQueryTest(mediaQueryList);\n};\n\nconst openWidget = () => {\n\tif (widget.dataset.state === 'opened') {\n\t\treturn;\n\t}\n\n\twidget_height = WIDGET_OPEN_HEIGHT;\n\twidget.dataset.state = 'opened';\n\tupdateWidgetStyle(true);\n\tiframe.focus();\n\temitCallback('chat-maximized');\n};\n\nconst resizeWidget = (height) => {\n\twidget_height = height;\n\twidget.dataset.state = 'triggered';\n\tupdateWidgetStyle(true);\n};\n\nfunction closeWidget() {\n\tif (widget.dataset.state === 'closed') {\n\t\treturn;\n\t}\n\n\twidget.dataset.state = 'closed';\n\tupdateWidgetStyle(false);\n\temitCallback('chat-minimized');\n}\n\nconst api = {\n\tpopup: null,\n\n\tready() {\n\t\tready = true;\n\t\tif (hookQueue.length > 0) {\n\t\t\thookQueue.forEach(function (hookParams) {\n\t\t\t\tcallHook.apply(this, hookParams);\n\t\t\t});\n\t\t\thookQueue = [];\n\t\t}\n\t},\n\n\tminimizeWindow() {\n\t\tcloseWidget();\n\t},\n\n\trestoreWindow() {\n\t\tif (api.popup && api.popup.closed !== true) {\n\t\t\tapi.popup.close();\n\t\t\tapi.popup = null;\n\t\t}\n\t\topenWidget();\n\t},\n\n\topenPopout() {\n\t\tcloseWidget();\n\t\tapi.popup = window.open(\n\t\t\t`${config.url}${config.url.lastIndexOf('?') > -1 ? '&' : '?'}mode=popout`,\n\t\t\t'livechat-popout',\n\t\t\t`width=${WIDGET_OPEN_WIDTH}, height=${widget_height}, toolbars=no`,\n\t\t);\n\t\tapi.popup.focus();\n\t},\n\n\topenWidget() {\n\t\topenWidget();\n\t},\n\n\tresizeWidget(height) {\n\t\tresizeWidget(height);\n\t},\n\n\tremoveWidget() {\n\t\tdocument.body.removeChild(widget);\n\t},\n\n\tcallback(eventName, data) {\n\t\temitCallback(eventName, data);\n\t},\n\n\tshowWidget() {\n\t\tiframe.style.display = 'initial';\n\t\temitCallback('show-widget');\n\t},\n\n\thideWidget() {\n\t\tiframe.style.display = 'none';\n\t\temitCallback('hide-widget');\n\t},\n\n\tresetDocumentStyle() {\n\t\tdocument.body.classList.remove('rc-livechat-mobile-full-screen');\n\t},\n\n\tsetFullScreenDocumentMobile() {\n\t\tsmallScreen && document.body.classList.add('rc-livechat-mobile-full-screen');\n\t},\n};\n\nfunction pageVisited(change) {\n\tcallHook('pageVisited', {\n\t\tchange,\n\t\tlocation: JSON.parse(JSON.stringify(document.location)),\n\t\ttitle: document.title,\n\t});\n}\n\nfunction setCustomField(key, value, overwrite) {\n\tif (typeof overwrite === 'undefined') {\n\t\toverwrite = true;\n\t}\n\tcallHook('setCustomField', [key, value, overwrite]);\n}\n\nfunction setTheme(theme) {\n\tcallHook('setTheme', theme);\n}\n\nfunction setDepartment(department) {\n\tcallHook('setDepartment', department);\n}\n\nfunction setBusinessUnit(businessUnit) {\n\tcallHook('setBusinessUnit', businessUnit);\n}\n\nfunction clearBusinessUnit() {\n\tcallHook('clearBusinessUnit');\n}\n\nfunction setGuestToken(token) {\n\tcallHook('setGuestToken', token);\n}\n\nfunction setGuestName(name) {\n\tcallHook('setGuestName', name);\n}\n\nfunction setGuestEmail(email) {\n\tcallHook('setGuestEmail', email);\n}\n\nfunction registerGuest(guest) {\n\tcallHook('registerGuest', guest);\n}\n\nfunction clearDepartment() {\n\tcallHook('clearDepartment');\n}\n\nfunction setAgent(agent) {\n\tcallHook('setAgent', agent);\n}\n\nfunction setLanguage(language) {\n\tcallHook('setLanguage', language);\n}\n\nfunction showWidget() {\n\tcallHook('showWidget');\n}\n\nfunction hideWidget() {\n\tcallHook('hideWidget');\n}\n\nfunction maximizeWidget() {\n\tcallHook('maximizeWidget');\n}\n\nfunction minimizeWidget() {\n\tcallHook('minimizeWidget');\n}\n\nfunction setParentUrl(url) {\n\tcallHook('setParentUrl', url);\n}\n\nfunction initialize(params) {\n\tfor (const method in params) {\n\t\tif (!params.hasOwnProperty(method)) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tswitch (method) {\n\t\t\tcase 'customField':\n\t\t\t\tconst { key, value, overwrite } = params[method];\n\t\t\t\tsetCustomField(key, value, overwrite);\n\t\t\t\tcontinue;\n\t\t\tcase 'setCustomFields':\n\t\t\t\tif (!Array.isArray(params[method])) {\n\t\t\t\t\tconsole.log('Error: Invalid parameters. Value must be an array of objects');\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tparams[method].forEach((data) => {\n\t\t\t\t\tconst { key, value, overwrite } = data;\n\t\t\t\t\tsetCustomField(key, value, overwrite);\n\t\t\t\t});\n\t\t\t\tcontinue;\n\t\t\tcase 'theme':\n\t\t\t\tsetTheme(params[method]);\n\t\t\t\tcontinue;\n\t\t\tcase 'department':\n\t\t\t\tsetDepartment(params[method]);\n\t\t\t\tcontinue;\n\t\t\tcase 'businessUnit': {\n\t\t\t\tsetBusinessUnit(params[method]);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tcase 'guestToken':\n\t\t\t\tsetGuestToken(params[method]);\n\t\t\t\tcontinue;\n\t\t\tcase 'guestName':\n\t\t\t\tsetGuestName(params[method]);\n\t\t\t\tcontinue;\n\t\t\tcase 'guestEmail':\n\t\t\t\tsetGuestEmail(params[method]);\n\t\t\t\tcontinue;\n\t\t\tcase 'registerGuest':\n\t\t\t\tregisterGuest(params[method]);\n\t\t\t\tcontinue;\n\t\t\tcase 'language':\n\t\t\t\tsetLanguage(params[method]);\n\t\t\t\tcontinue;\n\t\t\tcase 'agent':\n\t\t\t\tsetAgent(params[method]);\n\t\t\t\tcontinue;\n\t\t\tcase 'parentUrl':\n\t\t\t\tsetParentUrl(params[method]);\n\t\t\t\tcontinue;\n\t\t\tdefault:\n\t\t\t\tcontinue;\n\t\t}\n\t}\n}\n\nconst currentPage = {\n\thref: null,\n\ttitle: null,\n};\n\nconst attachMessageListener = () => {\n\twindow.addEventListener(\n\t\t'message',\n\t\t(msg) => {\n\t\t\tif (typeof msg.data === 'object' && msg.data.src !== undefined && msg.data.src === 'rocketchat') {\n\t\t\t\tif (api[msg.data.fn] !== undefined && typeof api[msg.data.fn] === 'function') {\n\t\t\t\t\tconst args = [].concat(msg.data.args || []);\n\t\t\t\t\tlog(`api.${msg.data.fn}`, ...args);\n\t\t\t\t\tapi[msg.data.fn].apply(null, args);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tfalse,\n\t);\n};\n\nconst trackNavigation = () => {\n\tsetInterval(() => {\n\t\tif (document.location.href !== currentPage.href) {\n\t\t\tpageVisited('url');\n\t\t\tcurrentPage.href = document.location.href;\n\t\t}\n\n\t\tif (document.title !== currentPage.title) {\n\t\t\tpageVisited('title');\n\t\t\tcurrentPage.title = document.title;\n\t\t}\n\t}, 800);\n};\n\nconst init = (url) => {\n\tconst trimmedUrl = url.trim();\n\tif (!trimmedUrl) {\n\t\treturn;\n\t}\n\n\tconfig.url = trimmedUrl;\n\n\tcreateWidget(trimmedUrl);\n\tattachMessageListener();\n\ttrackNavigation();\n};\n\nif (typeof window.initRocket !== 'undefined') {\n\tconsole.warn('initRocket is now deprecated. Please update the livechat code.');\n\tinit(window.initRocket[0]);\n}\n\nif (typeof window.RocketChat.url !== 'undefined') {\n\tinit(window.RocketChat.url);\n}\n\nconst queue = window.RocketChat._;\n\nwindow.RocketChat._.push = function (c) {\n\tc.call(window.RocketChat.livechat);\n};\nwindow.RocketChat = window.RocketChat._.push;\n\n// exports\nwindow.RocketChat.livechat = {\n\t// methods\n\tpageVisited,\n\tsetCustomField,\n\tinitialize,\n\tsetTheme,\n\tsetDepartment,\n\tclearDepartment,\n\tsetGuestToken,\n\tsetGuestName,\n\tsetGuestEmail,\n\tsetAgent,\n\tregisterGuest,\n\tsetLanguage,\n\tshowWidget,\n\thideWidget,\n\tmaximizeWidget,\n\tminimizeWidget,\n\tsetBusinessUnit,\n\tclearBusinessUnit,\n\tsetParentUrl,\n\n\t// callbacks\n\tonChatMaximized(fn) {\n\t\tregisterCallback('chat-maximized', fn);\n\t},\n\tonChatMinimized(fn) {\n\t\tregisterCallback('chat-minimized', fn);\n\t},\n\tonChatStarted(fn) {\n\t\tregisterCallback('chat-started', fn);\n\t},\n\tonChatEnded(fn) {\n\t\tregisterCallback('chat-ended', fn);\n\t},\n\tonPrechatFormSubmit(fn) {\n\t\tregisterCallback('pre-chat-form-submit', fn);\n\t},\n\tonOfflineFormSubmit(fn) {\n\t\tregisterCallback('offline-form-submit', fn);\n\t},\n\tonWidgetShown(fn) {\n\t\tregisterCallback('show-widget', fn);\n\t},\n\tonWidgetHidden(fn) {\n\t\tregisterCallback('hide-widget', fn);\n\t},\n\tonAssignAgent(fn) {\n\t\tregisterCallback('assign-agent', fn);\n\t},\n\tonAgentStatusChange(fn) {\n\t\tregisterCallback('agent-status-change', fn);\n\t},\n\tonQueuePositionChange(fn) {\n\t\tregisterCallback('queue-position-change', fn);\n\t},\n\tonServiceOffline(fn) {\n\t\tregisterCallback('no-agent-online', fn);\n\t},\n};\n\n// proccess queue\nqueue.forEach((c) => {\n\tc.call(window.RocketChat.livechat);\n});\n","export default function(n){return{all:n=n||new Map,on:function(t,e){var i=n.get(t);i&&i.push(e)||n.set(t,[e])},off:function(t,e){var i=n.get(t);i&&i.splice(i.indexOf(e)>>>0,1)},emit:function(t,e){(n.get(t)||[]).slice().map(function(n){n(e)}),(n.get(\"*\")||[]).slice().map(function(n){n(t,e)})}}}\n//# sourceMappingURL=mitt.es.js.map\n"],"names":["window","RocketChat","_","config","widget","iframe","scrollPosition","widget_height","hookQueue","ready","smallScreen","validCallbacks","callbacks","all","n","Map","on","t","e","i","get","push","set","off","splice","indexOf","emit","slice","map","registerCallback","eventName","fn","emitCallback","data","callHook","action","params","src","args","contentWindow","postMessage","updateWidgetStyle","isOpened","isFullscreen","dataset","state","document","documentElement","scrollTop","body","classList","add","remove","style","left","height","width","openWidget","focus","closeWidget","api","popup","length","forEach","hookParams","apply","this","minimizeWindow","restoreWindow","closed","close","openPopout","open","url","lastIndexOf","resizeWidget","removeWidget","removeChild","callback","showWidget","display","hideWidget","resetDocumentStyle","setFullScreenDocumentMobile","pageVisited","change","location","JSON","parse","stringify","title","setCustomField","key","value","overwrite","setTheme","theme","setDepartment","department","setBusinessUnit","businessUnit","setGuestToken","token","setGuestName","name","setGuestEmail","email","registerGuest","guest","setAgent","agent","setLanguage","language","setParentUrl","currentPage","href","init","trimmedUrl","trim","createElement","className","position","maxHeight","bottom","right","zIndex","container","id","allowTransparency","border","backgroundColor","appendChild","handleMediaQueryTest","matches","mediaQueryList","matchMedia","addListener","createWidget","addEventListener","msg","undefined","concat","setInterval","initRocket","console","warn","queue","c","call","livechat","initialize","method","hasOwnProperty","Array","isArray","log","clearDepartment","maximizeWidget","minimizeWidget","clearBusinessUnit","onChatMaximized","onChatMinimized","onChatStarted","onChatEnded","onPrechatFormSubmit","onOfflineFormSubmit","onWidgetShown","onWidgetHidden","onAssignAgent","onAgentStatusChange","onQueuePositionChange","onServiceOffline"],"sourceRoot":""}